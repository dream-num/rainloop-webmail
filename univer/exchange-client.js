(function(x,d){typeof exports=="object"&&typeof module<"u"?d(exports,require("@univerjs/core"),require("rxjs"),require("@univerjs/network"),require("@univerjs/ui"),require("react"),require("@univerjs/design")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","rxjs","@univerjs/network","@univerjs/ui","react","@univerjs/design"],d):(x=typeof globalThis<"u"?globalThis:x||self,d(x.UniverExchangeClient={},x.UniverCore,x.rxjs,x.UniverNetwork,x.UniverUi,x.React,x.UniverDesign))})(this,function(x,d,ee,be,Ye,C,Z){"use strict";var Ws=Object.defineProperty;var Qs=(x,d,ee)=>d in x?Ws(x,d,{enumerable:!0,configurable:!0,writable:!0,value:ee}):x[d]=ee;var K=(x,d,ee)=>Qs(x,typeof d!="symbol"?d+"":d,ee);var Jt;var L=(e=>(e[e.UNDEFINED=0]="UNDEFINED",e[e.OK=1]="OK",e[e.INTERNAL_ERROR=2]="INTERNAL_ERROR",e[e.PERMISSION_DENIED=3]="PERMISSION_DENIED",e[e.NOT_FOUND=4]="NOT_FOUND",e[e.UNAUTHENTICATED=5]="UNAUTHENTICATED",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.INVALID_ARGUMENT=7]="INVALID_ARGUMENT",e[e.TOO_MANY_REQUESTS=8]="TOO_MANY_REQUESTS",e[e.COMPLETION_FINISHED=9]="COMPLETION_FINISHED",e[e.CHANGESET_REVISION_CONFILICT=5001]="CHANGESET_REVISION_CONFILICT",e[e.SNAPSHOT_INVALID_SNAPSHOT=6001]="SNAPSHOT_INVALID_SNAPSHOT",e[e.SNAPSHOT_HAS_BEEN_REMOVED=6002]="SNAPSHOT_HAS_BEEN_REMOVED",e[e.APPLY_REJECT=7001]="APPLY_REJECT",e[e.APPLY_NON_SEQUENTIAL_REVISION=7002]="APPLY_NON_SEQUENTIAL_REVISION",e[e.APPLY_REVISION_CONFILICT=7003]="APPLY_REVISION_CONFILICT",e[e.APPLY_PERMISSION_DENIED=7004]="APPLY_PERMISSION_DENIED",e[e.CONNECTOR_DATA_TOO_LARGE=8001]="CONNECTOR_DATA_TOO_LARGE",e[e.LICENSE_MAX_UNITS_EXCEEDED=9001]="LICENSE_MAX_UNITS_EXCEEDED",e[e.LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED=9002]="LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED",e[e.LICENSE_IMPORT_SIZE_EXCEEDED=9003]="LICENSE_IMPORT_SIZE_EXCEEDED",e[e.LICENSE_EXPORT_SIZE_EXCEEDED=9004]="LICENSE_EXPORT_SIZE_EXCEEDED",e[e.LICENSE_DISTRO_REJECTED=9005]="LICENSE_DISTRO_REJECTED",e[e.YUUMI_UNABLE_LOAD_URL=10001]="YUUMI_UNABLE_LOAD_URL",e[e.YUUMI_URL_COL_OUT_OF_RANGE=10002]="YUUMI_URL_COL_OUT_OF_RANGE",e[e.YUUMI_RATE_OVER_LIMIT=10003]="YUUMI_RATE_OVER_LIMIT",e[e.YUUMI_SUBSCRIPTION_NOT_FOUND=10004]="YUUMI_SUBSCRIPTION_NOT_FOUND",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(L||{}),A=(e=>(e[e.UNIVER_UNKNOWN=0]="UNIVER_UNKNOWN",e[e.UNIVER_DOC=1]="UNIVER_DOC",e[e.UNIVER_SHEET=2]="UNIVER_SHEET",e[e.UNIVER_SLIDE=3]="UNIVER_SLIDE",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(A||{});/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const qi=4,Wt=0,Qt=1,Ji=2;function me(e){let n=e.length;for(;--n>=0;)e[n]=0}const Wi=0,en=1,Qi=2,ea=3,ta=258,xt=29,Te=256,Ce=Te+1+xt,Ie=30,Et=19,tn=2*Ce+1,he=15,wt=16,na=7,vt=256,nn=16,an=17,rn=18,St=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),qe=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),ia=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),on=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),aa=512,te=new Array((Ce+2)*2);me(te);const De=new Array(Ie*2);me(De);const Oe=new Array(aa);me(Oe);const Ae=new Array(ta-ea+1);me(Ae);const bt=new Array(xt);me(bt);const Je=new Array(Ie);me(Je);function mt(e,n,t,i,a){this.static_tree=e,this.extra_bits=n,this.extra_base=t,this.elems=i,this.max_length=a,this.has_stree=e&&e.length}let sn,ln,cn;function It(e,n){this.dyn_tree=e,this.max_code=0,this.stat_desc=n}const fn=e=>e<256?Oe[e]:Oe[256+(e>>>7)],He=(e,n)=>{e.pending_buf[e.pending++]=n&255,e.pending_buf[e.pending++]=n>>>8&255},F=(e,n,t)=>{e.bi_valid>wt-t?(e.bi_buf|=n<<e.bi_valid&65535,He(e,e.bi_buf),e.bi_buf=n>>wt-e.bi_valid,e.bi_valid+=t-wt):(e.bi_buf|=n<<e.bi_valid&65535,e.bi_valid+=t)},Y=(e,n,t)=>{F(e,t[n*2],t[n*2+1])},_n=(e,n)=>{let t=0;do t|=e&1,e>>>=1,t<<=1;while(--n>0);return t>>>1},ra=e=>{e.bi_valid===16?(He(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},oa=(e,n)=>{const t=n.dyn_tree,i=n.max_code,a=n.stat_desc.static_tree,r=n.stat_desc.has_stree,o=n.stat_desc.extra_bits,s=n.stat_desc.extra_base,_=n.stat_desc.max_length;let l,c,w,h,f,p,D=0;for(h=0;h<=he;h++)e.bl_count[h]=0;for(t[e.heap[e.heap_max]*2+1]=0,l=e.heap_max+1;l<tn;l++)c=e.heap[l],h=t[t[c*2+1]*2+1]+1,h>_&&(h=_,D++),t[c*2+1]=h,!(c>i)&&(e.bl_count[h]++,f=0,c>=s&&(f=o[c-s]),p=t[c*2],e.opt_len+=p*(h+f),r&&(e.static_len+=p*(a[c*2+1]+f)));if(D!==0){do{for(h=_-1;e.bl_count[h]===0;)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[_]--,D-=2}while(D>0);for(h=_;h!==0;h--)for(c=e.bl_count[h];c!==0;)w=e.heap[--l],!(w>i)&&(t[w*2+1]!==h&&(e.opt_len+=(h-t[w*2+1])*t[w*2],t[w*2+1]=h),c--)}},hn=(e,n,t)=>{const i=new Array(he+1);let a=0,r,o;for(r=1;r<=he;r++)a=a+t[r-1]<<1,i[r]=a;for(o=0;o<=n;o++){let s=e[o*2+1];s!==0&&(e[o*2]=_n(i[s]++,s))}},sa=()=>{let e,n,t,i,a;const r=new Array(he+1);for(t=0,i=0;i<xt-1;i++)for(bt[i]=t,e=0;e<1<<St[i];e++)Ae[t++]=i;for(Ae[t-1]=i,a=0,i=0;i<16;i++)for(Je[i]=a,e=0;e<1<<qe[i];e++)Oe[a++]=i;for(a>>=7;i<Ie;i++)for(Je[i]=a<<7,e=0;e<1<<qe[i]-7;e++)Oe[256+a++]=i;for(n=0;n<=he;n++)r[n]=0;for(e=0;e<=143;)te[e*2+1]=8,e++,r[8]++;for(;e<=255;)te[e*2+1]=9,e++,r[9]++;for(;e<=279;)te[e*2+1]=7,e++,r[7]++;for(;e<=287;)te[e*2+1]=8,e++,r[8]++;for(hn(te,Ce+1,r),e=0;e<Ie;e++)De[e*2+1]=5,De[e*2]=_n(e,5);sn=new mt(te,St,Te+1,Ce,he),ln=new mt(De,qe,0,Ie,he),cn=new mt(new Array(0),ia,0,Et,na)},dn=e=>{let n;for(n=0;n<Ce;n++)e.dyn_ltree[n*2]=0;for(n=0;n<Ie;n++)e.dyn_dtree[n*2]=0;for(n=0;n<Et;n++)e.bl_tree[n*2]=0;e.dyn_ltree[vt*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},un=e=>{e.bi_valid>8?He(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},pn=(e,n,t,i)=>{const a=n*2,r=t*2;return e[a]<e[r]||e[a]===e[r]&&i[n]<=i[t]},Nt=(e,n,t)=>{const i=e.heap[t];let a=t<<1;for(;a<=e.heap_len&&(a<e.heap_len&&pn(n,e.heap[a+1],e.heap[a],e.depth)&&a++,!pn(n,i,e.heap[a],e.depth));)e.heap[t]=e.heap[a],t=a,a<<=1;e.heap[t]=i},gn=(e,n,t)=>{let i,a,r=0,o,s;if(e.sym_next!==0)do i=e.pending_buf[e.sym_buf+r++]&255,i+=(e.pending_buf[e.sym_buf+r++]&255)<<8,a=e.pending_buf[e.sym_buf+r++],i===0?Y(e,a,n):(o=Ae[a],Y(e,o+Te+1,n),s=St[o],s!==0&&(a-=bt[o],F(e,a,s)),i--,o=fn(i),Y(e,o,t),s=qe[o],s!==0&&(i-=Je[o],F(e,i,s)));while(r<e.sym_next);Y(e,vt,n)},Ut=(e,n)=>{const t=n.dyn_tree,i=n.stat_desc.static_tree,a=n.stat_desc.has_stree,r=n.stat_desc.elems;let o,s,_=-1,l;for(e.heap_len=0,e.heap_max=tn,o=0;o<r;o++)t[o*2]!==0?(e.heap[++e.heap_len]=_=o,e.depth[o]=0):t[o*2+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=_<2?++_:0,t[l*2]=1,e.depth[l]=0,e.opt_len--,a&&(e.static_len-=i[l*2+1]);for(n.max_code=_,o=e.heap_len>>1;o>=1;o--)Nt(e,t,o);l=r;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Nt(e,t,1),s=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=s,t[l*2]=t[o*2]+t[s*2],e.depth[l]=(e.depth[o]>=e.depth[s]?e.depth[o]:e.depth[s])+1,t[o*2+1]=t[s*2+1]=l,e.heap[1]=l++,Nt(e,t,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],oa(e,n),hn(t,_,e.bl_count)},xn=(e,n,t)=>{let i,a=-1,r,o=n[0*2+1],s=0,_=7,l=4;for(o===0&&(_=138,l=3),n[(t+1)*2+1]=65535,i=0;i<=t;i++)r=o,o=n[(i+1)*2+1],!(++s<_&&r===o)&&(s<l?e.bl_tree[r*2]+=s:r!==0?(r!==a&&e.bl_tree[r*2]++,e.bl_tree[nn*2]++):s<=10?e.bl_tree[an*2]++:e.bl_tree[rn*2]++,s=0,a=r,o===0?(_=138,l=3):r===o?(_=6,l=3):(_=7,l=4))},En=(e,n,t)=>{let i,a=-1,r,o=n[0*2+1],s=0,_=7,l=4;for(o===0&&(_=138,l=3),i=0;i<=t;i++)if(r=o,o=n[(i+1)*2+1],!(++s<_&&r===o)){if(s<l)do Y(e,r,e.bl_tree);while(--s!==0);else r!==0?(r!==a&&(Y(e,r,e.bl_tree),s--),Y(e,nn,e.bl_tree),F(e,s-3,2)):s<=10?(Y(e,an,e.bl_tree),F(e,s-3,3)):(Y(e,rn,e.bl_tree),F(e,s-11,7));s=0,a=r,o===0?(_=138,l=3):r===o?(_=6,l=3):(_=7,l=4)}},la=e=>{let n;for(xn(e,e.dyn_ltree,e.l_desc.max_code),xn(e,e.dyn_dtree,e.d_desc.max_code),Ut(e,e.bl_desc),n=Et-1;n>=3&&e.bl_tree[on[n]*2+1]===0;n--);return e.opt_len+=3*(n+1)+5+5+4,n},ca=(e,n,t,i)=>{let a;for(F(e,n-257,5),F(e,t-1,5),F(e,i-4,4),a=0;a<i;a++)F(e,e.bl_tree[on[a]*2+1],3);En(e,e.dyn_ltree,n-1),En(e,e.dyn_dtree,t-1)},fa=e=>{let n=4093624447,t;for(t=0;t<=31;t++,n>>>=1)if(n&1&&e.dyn_ltree[t*2]!==0)return Wt;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Qt;for(t=32;t<Te;t++)if(e.dyn_ltree[t*2]!==0)return Qt;return Wt};let wn=!1;const _a=e=>{wn||(sa(),wn=!0),e.l_desc=new It(e.dyn_ltree,sn),e.d_desc=new It(e.dyn_dtree,ln),e.bl_desc=new It(e.bl_tree,cn),e.bi_buf=0,e.bi_valid=0,dn(e)},vn=(e,n,t,i)=>{F(e,(Wi<<1)+(i?1:0),3),un(e),He(e,t),He(e,~t),t&&e.pending_buf.set(e.window.subarray(n,n+t),e.pending),e.pending+=t},ha=e=>{F(e,en<<1,3),Y(e,vt,te),ra(e)},da=(e,n,t,i)=>{let a,r,o=0;e.level>0?(e.strm.data_type===Ji&&(e.strm.data_type=fa(e)),Ut(e,e.l_desc),Ut(e,e.d_desc),o=la(e),a=e.opt_len+3+7>>>3,r=e.static_len+3+7>>>3,r<=a&&(a=r)):a=r=t+5,t+4<=a&&n!==-1?vn(e,n,t,i):e.strategy===qi||r===a?(F(e,(en<<1)+(i?1:0),3),gn(e,te,De)):(F(e,(Qi<<1)+(i?1:0),3),ca(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),gn(e,e.dyn_ltree,e.dyn_dtree)),dn(e),i&&un(e)},ua=(e,n,t)=>(e.pending_buf[e.sym_buf+e.sym_next++]=n,e.pending_buf[e.sym_buf+e.sym_next++]=n>>8,e.pending_buf[e.sym_buf+e.sym_next++]=t,n===0?e.dyn_ltree[t*2]++:(e.matches++,n--,e.dyn_ltree[(Ae[t]+Te+1)*2]++,e.dyn_dtree[fn(n)*2]++),e.sym_next===e.sym_end);var pa=_a,ga=vn,xa=da,Ea=ua,wa=ha,va={_tr_init:pa,_tr_stored_block:ga,_tr_flush_block:xa,_tr_tally:Ea,_tr_align:wa},ze=(e,n,t,i)=>{let a=e&65535|0,r=e>>>16&65535|0,o=0;for(;t!==0;){o=t>2e3?2e3:t,t-=o;do a=a+n[i++]|0,r=r+a|0;while(--o);a%=65521,r%=65521}return a|r<<16|0};const Sa=()=>{let e,n=[];for(var t=0;t<256;t++){e=t;for(var i=0;i<8;i++)e=e&1?3988292384^e>>>1:e>>>1;n[t]=e}return n},ba=new Uint32Array(Sa());var H=(e,n,t,i)=>{const a=ba,r=i+t;e^=-1;for(let o=i;o<r;o++)e=e>>>8^a[(e^n[o])&255];return e^-1},de={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ue={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:ma,_tr_stored_block:Rt,_tr_flush_block:Ia,_tr_tally:oe,_tr_align:Na}=va,{Z_NO_FLUSH:se,Z_PARTIAL_FLUSH:Ua,Z_FULL_FLUSH:Ra,Z_FINISH:G,Z_BLOCK:Sn,Z_OK:M,Z_STREAM_END:bn,Z_STREAM_ERROR:q,Z_DATA_ERROR:ka,Z_BUF_ERROR:kt,Z_DEFAULT_COMPRESSION:ya,Z_FILTERED:La,Z_HUFFMAN_ONLY:We,Z_RLE:Ta,Z_FIXED:Ca,Z_DEFAULT_STRATEGY:Da,Z_UNKNOWN:Oa,Z_DEFLATED:Qe}=ue,Aa=9,Ha=15,za=8,yt=256+1+29,Ma=30,Pa=19,Za=2*yt+1,ja=15,m=3,le=258,J=le+m+1,Fa=32,Ne=42,Lt=57,Tt=69,Ct=73,Dt=91,Ot=103,pe=113,Me=666,j=1,Ue=2,ge=3,Re=4,$a=3,xe=(e,n)=>(e.msg=de[n],n),mn=e=>e*2-(e>4?9:0),ce=e=>{let n=e.length;for(;--n>=0;)e[n]=0},Ba=e=>{let n,t,i,a=e.w_size;n=e.hash_size,i=n;do t=e.head[--i],e.head[i]=t>=a?t-a:0;while(--n);n=a,i=n;do t=e.prev[--i],e.prev[i]=t>=a?t-a:0;while(--n)};let fe=(e,n,t)=>(n<<e.hash_shift^t)&e.hash_mask;const $=e=>{const n=e.state;let t=n.pending;t>e.avail_out&&(t=e.avail_out),t!==0&&(e.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+t),e.next_out),e.next_out+=t,n.pending_out+=t,e.total_out+=t,e.avail_out-=t,n.pending-=t,n.pending===0&&(n.pending_out=0))},B=(e,n)=>{Ia(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,n),e.block_start=e.strstart,$(e.strm)},R=(e,n)=>{e.pending_buf[e.pending++]=n},Pe=(e,n)=>{e.pending_buf[e.pending++]=n>>>8&255,e.pending_buf[e.pending++]=n&255},At=(e,n,t,i)=>{let a=e.avail_in;return a>i&&(a=i),a===0?0:(e.avail_in-=a,n.set(e.input.subarray(e.next_in,e.next_in+a),t),e.state.wrap===1?e.adler=ze(e.adler,n,a,t):e.state.wrap===2&&(e.adler=H(e.adler,n,a,t)),e.next_in+=a,e.total_in+=a,a)},In=(e,n)=>{let t=e.max_chain_length,i=e.strstart,a,r,o=e.prev_length,s=e.nice_match;const _=e.strstart>e.w_size-J?e.strstart-(e.w_size-J):0,l=e.window,c=e.w_mask,w=e.prev,h=e.strstart+le;let f=l[i+o-1],p=l[i+o];e.prev_length>=e.good_match&&(t>>=2),s>e.lookahead&&(s=e.lookahead);do if(a=n,!(l[a+o]!==p||l[a+o-1]!==f||l[a]!==l[i]||l[++a]!==l[i+1])){i+=2,a++;do;while(l[++i]===l[++a]&&l[++i]===l[++a]&&l[++i]===l[++a]&&l[++i]===l[++a]&&l[++i]===l[++a]&&l[++i]===l[++a]&&l[++i]===l[++a]&&l[++i]===l[++a]&&i<h);if(r=le-(h-i),i=h-le,r>o){if(e.match_start=n,o=r,r>=s)break;f=l[i+o-1],p=l[i+o]}}while((n=w[n&c])>_&&--t!==0);return o<=e.lookahead?o:e.lookahead},ke=e=>{const n=e.w_size;let t,i,a;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=n+(n-J)&&(e.window.set(e.window.subarray(n,n+n-i),0),e.match_start-=n,e.strstart-=n,e.block_start-=n,e.insert>e.strstart&&(e.insert=e.strstart),Ba(e),i+=n),e.strm.avail_in===0)break;if(t=At(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=t,e.lookahead+e.insert>=m)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=fe(e,e.ins_h,e.window[a+1]);e.insert&&(e.ins_h=fe(e,e.ins_h,e.window[a+m-1]),e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<m)););}while(e.lookahead<J&&e.strm.avail_in!==0)},Nn=(e,n)=>{let t=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,i,a,r,o=0,s=e.strm.avail_in;do{if(i=65535,r=e.bi_valid+42>>3,e.strm.avail_out<r||(r=e.strm.avail_out-r,a=e.strstart-e.block_start,i>a+e.strm.avail_in&&(i=a+e.strm.avail_in),i>r&&(i=r),i<t&&(i===0&&n!==G||n===se||i!==a+e.strm.avail_in)))break;o=n===G&&i===a+e.strm.avail_in?1:0,Rt(e,0,0,o),e.pending_buf[e.pending-4]=i,e.pending_buf[e.pending-3]=i>>8,e.pending_buf[e.pending-2]=~i,e.pending_buf[e.pending-1]=~i>>8,$(e.strm),a&&(a>i&&(a=i),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+a),e.strm.next_out),e.strm.next_out+=a,e.strm.avail_out-=a,e.strm.total_out+=a,e.block_start+=a,i-=a),i&&(At(e.strm,e.strm.output,e.strm.next_out,i),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i)}while(o===0);return s-=e.strm.avail_in,s&&(s>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=s&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-s,e.strm.next_in),e.strstart),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),o?Re:n!==se&&n!==G&&e.strm.avail_in===0&&e.strstart===e.block_start?Ue:(r=e.window_size-e.strstart,e.strm.avail_in>r&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,r+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),r>e.strm.avail_in&&(r=e.strm.avail_in),r&&(At(e.strm,e.window,e.strstart,r),e.strstart+=r,e.insert+=r>e.w_size-e.insert?e.w_size-e.insert:r),e.high_water<e.strstart&&(e.high_water=e.strstart),r=e.bi_valid+42>>3,r=e.pending_buf_size-r>65535?65535:e.pending_buf_size-r,t=r>e.w_size?e.w_size:r,a=e.strstart-e.block_start,(a>=t||(a||n===G)&&n!==se&&e.strm.avail_in===0&&a<=r)&&(i=a>r?r:a,o=n===G&&e.strm.avail_in===0&&i===a?1:0,Rt(e,e.block_start,i,o),e.block_start+=i,$(e.strm)),o?ge:j)},Ht=(e,n)=>{let t,i;for(;;){if(e.lookahead<J){if(ke(e),e.lookahead<J&&n===se)return j;if(e.lookahead===0)break}if(t=0,e.lookahead>=m&&(e.ins_h=fe(e,e.ins_h,e.window[e.strstart+m-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),t!==0&&e.strstart-t<=e.w_size-J&&(e.match_length=In(e,t)),e.match_length>=m)if(i=oe(e,e.strstart-e.match_start,e.match_length-m),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=m){e.match_length--;do e.strstart++,e.ins_h=fe(e,e.ins_h,e.window[e.strstart+m-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=fe(e,e.ins_h,e.window[e.strstart+1]);else i=oe(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(B(e,!1),e.strm.avail_out===0))return j}return e.insert=e.strstart<m-1?e.strstart:m-1,n===G?(B(e,!0),e.strm.avail_out===0?ge:Re):e.sym_next&&(B(e,!1),e.strm.avail_out===0)?j:Ue},ye=(e,n)=>{let t,i,a;for(;;){if(e.lookahead<J){if(ke(e),e.lookahead<J&&n===se)return j;if(e.lookahead===0)break}if(t=0,e.lookahead>=m&&(e.ins_h=fe(e,e.ins_h,e.window[e.strstart+m-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=m-1,t!==0&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-J&&(e.match_length=In(e,t),e.match_length<=5&&(e.strategy===La||e.match_length===m&&e.strstart-e.match_start>4096)&&(e.match_length=m-1)),e.prev_length>=m&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-m,i=oe(e,e.strstart-1-e.prev_match,e.prev_length-m),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=a&&(e.ins_h=fe(e,e.ins_h,e.window[e.strstart+m-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=m-1,e.strstart++,i&&(B(e,!1),e.strm.avail_out===0))return j}else if(e.match_available){if(i=oe(e,0,e.window[e.strstart-1]),i&&B(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return j}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=oe(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<m-1?e.strstart:m-1,n===G?(B(e,!0),e.strm.avail_out===0?ge:Re):e.sym_next&&(B(e,!1),e.strm.avail_out===0)?j:Ue},Ga=(e,n)=>{let t,i,a,r;const o=e.window;for(;;){if(e.lookahead<=le){if(ke(e),e.lookahead<=le&&n===se)return j;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=m&&e.strstart>0&&(a=e.strstart-1,i=o[a],i===o[++a]&&i===o[++a]&&i===o[++a])){r=e.strstart+le;do;while(i===o[++a]&&i===o[++a]&&i===o[++a]&&i===o[++a]&&i===o[++a]&&i===o[++a]&&i===o[++a]&&i===o[++a]&&a<r);e.match_length=le-(r-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=m?(t=oe(e,1,e.match_length-m),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(t=oe(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),t&&(B(e,!1),e.strm.avail_out===0))return j}return e.insert=0,n===G?(B(e,!0),e.strm.avail_out===0?ge:Re):e.sym_next&&(B(e,!1),e.strm.avail_out===0)?j:Ue},Xa=(e,n)=>{let t;for(;;){if(e.lookahead===0&&(ke(e),e.lookahead===0)){if(n===se)return j;break}if(e.match_length=0,t=oe(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,t&&(B(e,!1),e.strm.avail_out===0))return j}return e.insert=0,n===G?(B(e,!0),e.strm.avail_out===0?ge:Re):e.sym_next&&(B(e,!1),e.strm.avail_out===0)?j:Ue};function W(e,n,t,i,a){this.good_length=e,this.max_lazy=n,this.nice_length=t,this.max_chain=i,this.func=a}const Ze=[new W(0,0,0,0,Nn),new W(4,4,8,4,Ht),new W(4,5,16,8,Ht),new W(4,6,32,32,Ht),new W(4,4,16,16,ye),new W(8,16,32,32,ye),new W(8,16,128,128,ye),new W(8,32,128,256,ye),new W(32,128,258,1024,ye),new W(32,258,258,4096,ye)],Va=e=>{e.window_size=2*e.w_size,ce(e.head),e.max_lazy_match=Ze[e.level].max_lazy,e.good_match=Ze[e.level].good_length,e.nice_match=Ze[e.level].nice_length,e.max_chain_length=Ze[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=m-1,e.match_available=0,e.ins_h=0};function Ka(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Qe,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(Za*2),this.dyn_dtree=new Uint16Array((2*Ma+1)*2),this.bl_tree=new Uint16Array((2*Pa+1)*2),ce(this.dyn_ltree),ce(this.dyn_dtree),ce(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(ja+1),this.heap=new Uint16Array(2*yt+1),ce(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*yt+1),ce(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const je=e=>{if(!e)return 1;const n=e.state;return!n||n.strm!==e||n.status!==Ne&&n.status!==Lt&&n.status!==Tt&&n.status!==Ct&&n.status!==Dt&&n.status!==Ot&&n.status!==pe&&n.status!==Me?1:0},Un=e=>{if(je(e))return xe(e,q);e.total_in=e.total_out=0,e.data_type=Oa;const n=e.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap===2?Lt:n.wrap?Ne:pe,e.adler=n.wrap===2?0:1,n.last_flush=-2,ma(n),M},Rn=e=>{const n=Un(e);return n===M&&Va(e.state),n},Ya=(e,n)=>je(e)||e.state.wrap!==2?q:(e.state.gzhead=n,M),kn=(e,n,t,i,a,r)=>{if(!e)return q;let o=1;if(n===ya&&(n=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),a<1||a>Aa||t!==Qe||i<8||i>15||n<0||n>9||r<0||r>Ca||i===8&&o!==1)return xe(e,q);i===8&&(i=9);const s=new Ka;return e.state=s,s.strm=e,s.status=Ne,s.wrap=o,s.gzhead=null,s.w_bits=i,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=a+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+m-1)/m),s.window=new Uint8Array(s.w_size*2),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<a+6,s.pending_buf_size=s.lit_bufsize*4,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=(s.lit_bufsize-1)*3,s.level=n,s.strategy=r,s.method=t,Rn(e)},qa=(e,n)=>kn(e,n,Qe,Ha,za,Da),Ja=(e,n)=>{if(je(e)||n>Sn||n<0)return e?xe(e,q):q;const t=e.state;if(!e.output||e.avail_in!==0&&!e.input||t.status===Me&&n!==G)return xe(e,e.avail_out===0?kt:q);const i=t.last_flush;if(t.last_flush=n,t.pending!==0){if($(e),e.avail_out===0)return t.last_flush=-1,M}else if(e.avail_in===0&&mn(n)<=mn(i)&&n!==G)return xe(e,kt);if(t.status===Me&&e.avail_in!==0)return xe(e,kt);if(t.status===Ne&&t.wrap===0&&(t.status=pe),t.status===Ne){let a=Qe+(t.w_bits-8<<4)<<8,r=-1;if(t.strategy>=We||t.level<2?r=0:t.level<6?r=1:t.level===6?r=2:r=3,a|=r<<6,t.strstart!==0&&(a|=Fa),a+=31-a%31,Pe(t,a),t.strstart!==0&&(Pe(t,e.adler>>>16),Pe(t,e.adler&65535)),e.adler=1,t.status=pe,$(e),t.pending!==0)return t.last_flush=-1,M}if(t.status===Lt){if(e.adler=0,R(t,31),R(t,139),R(t,8),t.gzhead)R(t,(t.gzhead.text?1:0)+(t.gzhead.hcrc?2:0)+(t.gzhead.extra?4:0)+(t.gzhead.name?8:0)+(t.gzhead.comment?16:0)),R(t,t.gzhead.time&255),R(t,t.gzhead.time>>8&255),R(t,t.gzhead.time>>16&255),R(t,t.gzhead.time>>24&255),R(t,t.level===9?2:t.strategy>=We||t.level<2?4:0),R(t,t.gzhead.os&255),t.gzhead.extra&&t.gzhead.extra.length&&(R(t,t.gzhead.extra.length&255),R(t,t.gzhead.extra.length>>8&255)),t.gzhead.hcrc&&(e.adler=H(e.adler,t.pending_buf,t.pending,0)),t.gzindex=0,t.status=Tt;else if(R(t,0),R(t,0),R(t,0),R(t,0),R(t,0),R(t,t.level===9?2:t.strategy>=We||t.level<2?4:0),R(t,$a),t.status=pe,$(e),t.pending!==0)return t.last_flush=-1,M}if(t.status===Tt){if(t.gzhead.extra){let a=t.pending,r=(t.gzhead.extra.length&65535)-t.gzindex;for(;t.pending+r>t.pending_buf_size;){let s=t.pending_buf_size-t.pending;if(t.pending_buf.set(t.gzhead.extra.subarray(t.gzindex,t.gzindex+s),t.pending),t.pending=t.pending_buf_size,t.gzhead.hcrc&&t.pending>a&&(e.adler=H(e.adler,t.pending_buf,t.pending-a,a)),t.gzindex+=s,$(e),t.pending!==0)return t.last_flush=-1,M;a=0,r-=s}let o=new Uint8Array(t.gzhead.extra);t.pending_buf.set(o.subarray(t.gzindex,t.gzindex+r),t.pending),t.pending+=r,t.gzhead.hcrc&&t.pending>a&&(e.adler=H(e.adler,t.pending_buf,t.pending-a,a)),t.gzindex=0}t.status=Ct}if(t.status===Ct){if(t.gzhead.name){let a=t.pending,r;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>a&&(e.adler=H(e.adler,t.pending_buf,t.pending-a,a)),$(e),t.pending!==0)return t.last_flush=-1,M;a=0}t.gzindex<t.gzhead.name.length?r=t.gzhead.name.charCodeAt(t.gzindex++)&255:r=0,R(t,r)}while(r!==0);t.gzhead.hcrc&&t.pending>a&&(e.adler=H(e.adler,t.pending_buf,t.pending-a,a)),t.gzindex=0}t.status=Dt}if(t.status===Dt){if(t.gzhead.comment){let a=t.pending,r;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>a&&(e.adler=H(e.adler,t.pending_buf,t.pending-a,a)),$(e),t.pending!==0)return t.last_flush=-1,M;a=0}t.gzindex<t.gzhead.comment.length?r=t.gzhead.comment.charCodeAt(t.gzindex++)&255:r=0,R(t,r)}while(r!==0);t.gzhead.hcrc&&t.pending>a&&(e.adler=H(e.adler,t.pending_buf,t.pending-a,a))}t.status=Ot}if(t.status===Ot){if(t.gzhead.hcrc){if(t.pending+2>t.pending_buf_size&&($(e),t.pending!==0))return t.last_flush=-1,M;R(t,e.adler&255),R(t,e.adler>>8&255),e.adler=0}if(t.status=pe,$(e),t.pending!==0)return t.last_flush=-1,M}if(e.avail_in!==0||t.lookahead!==0||n!==se&&t.status!==Me){let a=t.level===0?Nn(t,n):t.strategy===We?Xa(t,n):t.strategy===Ta?Ga(t,n):Ze[t.level].func(t,n);if((a===ge||a===Re)&&(t.status=Me),a===j||a===ge)return e.avail_out===0&&(t.last_flush=-1),M;if(a===Ue&&(n===Ua?Na(t):n!==Sn&&(Rt(t,0,0,!1),n===Ra&&(ce(t.head),t.lookahead===0&&(t.strstart=0,t.block_start=0,t.insert=0))),$(e),e.avail_out===0))return t.last_flush=-1,M}return n!==G?M:t.wrap<=0?bn:(t.wrap===2?(R(t,e.adler&255),R(t,e.adler>>8&255),R(t,e.adler>>16&255),R(t,e.adler>>24&255),R(t,e.total_in&255),R(t,e.total_in>>8&255),R(t,e.total_in>>16&255),R(t,e.total_in>>24&255)):(Pe(t,e.adler>>>16),Pe(t,e.adler&65535)),$(e),t.wrap>0&&(t.wrap=-t.wrap),t.pending!==0?M:bn)},Wa=e=>{if(je(e))return q;const n=e.state.status;return e.state=null,n===pe?xe(e,ka):M},Qa=(e,n)=>{let t=n.length;if(je(e))return q;const i=e.state,a=i.wrap;if(a===2||a===1&&i.status!==Ne||i.lookahead)return q;if(a===1&&(e.adler=ze(e.adler,n,t,0)),i.wrap=0,t>=i.w_size){a===0&&(ce(i.head),i.strstart=0,i.block_start=0,i.insert=0);let _=new Uint8Array(i.w_size);_.set(n.subarray(t-i.w_size,t),0),n=_,t=i.w_size}const r=e.avail_in,o=e.next_in,s=e.input;for(e.avail_in=t,e.next_in=0,e.input=n,ke(i);i.lookahead>=m;){let _=i.strstart,l=i.lookahead-(m-1);do i.ins_h=fe(i,i.ins_h,i.window[_+m-1]),i.prev[_&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=_,_++;while(--l);i.strstart=_,i.lookahead=m-1,ke(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=m-1,i.match_available=0,e.next_in=o,e.input=s,e.avail_in=r,i.wrap=a,M};var er=qa,tr=kn,nr=Rn,ir=Un,ar=Ya,rr=Ja,or=Wa,sr=Qa,lr="pako deflate (from Nodeca project)",Fe={deflateInit:er,deflateInit2:tr,deflateReset:nr,deflateResetKeep:ir,deflateSetHeader:ar,deflate:rr,deflateEnd:or,deflateSetDictionary:sr,deflateInfo:lr};const cr=(e,n)=>Object.prototype.hasOwnProperty.call(e,n);var fr=function(e){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const t=n.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const i in t)cr(t,i)&&(e[i]=t[i])}}return e},_r=e=>{let n=0;for(let i=0,a=e.length;i<a;i++)n+=e[i].length;const t=new Uint8Array(n);for(let i=0,a=0,r=e.length;i<r;i++){let o=e[i];t.set(o,a),a+=o.length}return t},et={assign:fr,flattenChunks:_r};let yn=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{yn=!1}const $e=new Uint8Array(256);for(let e=0;e<256;e++)$e[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;$e[254]=$e[254]=1;var hr=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let n,t,i,a,r,o=e.length,s=0;for(a=0;a<o;a++)t=e.charCodeAt(a),(t&64512)===55296&&a+1<o&&(i=e.charCodeAt(a+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),a++)),s+=t<128?1:t<2048?2:t<65536?3:4;for(n=new Uint8Array(s),r=0,a=0;r<s;a++)t=e.charCodeAt(a),(t&64512)===55296&&a+1<o&&(i=e.charCodeAt(a+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),a++)),t<128?n[r++]=t:t<2048?(n[r++]=192|t>>>6,n[r++]=128|t&63):t<65536?(n[r++]=224|t>>>12,n[r++]=128|t>>>6&63,n[r++]=128|t&63):(n[r++]=240|t>>>18,n[r++]=128|t>>>12&63,n[r++]=128|t>>>6&63,n[r++]=128|t&63);return n};const dr=(e,n)=>{if(n<65534&&e.subarray&&yn)return String.fromCharCode.apply(null,e.length===n?e:e.subarray(0,n));let t="";for(let i=0;i<n;i++)t+=String.fromCharCode(e[i]);return t};var ur=(e,n)=>{const t=n||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,n));let i,a;const r=new Array(t*2);for(a=0,i=0;i<t;){let o=e[i++];if(o<128){r[a++]=o;continue}let s=$e[o];if(s>4){r[a++]=65533,i+=s-1;continue}for(o&=s===2?31:s===3?15:7;s>1&&i<t;)o=o<<6|e[i++]&63,s--;if(s>1){r[a++]=65533;continue}o<65536?r[a++]=o:(o-=65536,r[a++]=55296|o>>10&1023,r[a++]=56320|o&1023)}return dr(r,a)},pr=(e,n)=>{n=n||e.length,n>e.length&&(n=e.length);let t=n-1;for(;t>=0&&(e[t]&192)===128;)t--;return t<0||t===0?n:t+$e[e[t]]>n?t:n},Be={string2buf:hr,buf2string:ur,utf8border:pr};function gr(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Ln=gr;const Tn=Object.prototype.toString,{Z_NO_FLUSH:xr,Z_SYNC_FLUSH:Er,Z_FULL_FLUSH:wr,Z_FINISH:vr,Z_OK:tt,Z_STREAM_END:Sr,Z_DEFAULT_COMPRESSION:br,Z_DEFAULT_STRATEGY:mr,Z_DEFLATED:Ir}=ue;function Ge(e){this.options=et.assign({level:br,method:Ir,chunkSize:16384,windowBits:15,memLevel:8,strategy:mr},e||{});let n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ln,this.strm.avail_out=0;let t=Fe.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(t!==tt)throw new Error(de[t]);if(n.header&&Fe.deflateSetHeader(this.strm,n.header),n.dictionary){let i;if(typeof n.dictionary=="string"?i=Be.string2buf(n.dictionary):Tn.call(n.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(n.dictionary):i=n.dictionary,t=Fe.deflateSetDictionary(this.strm,i),t!==tt)throw new Error(de[t]);this._dict_set=!0}}Ge.prototype.push=function(e,n){const t=this.strm,i=this.options.chunkSize;let a,r;if(this.ended)return!1;for(n===~~n?r=n:r=n===!0?vr:xr,typeof e=="string"?t.input=Be.string2buf(e):Tn.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;;){if(t.avail_out===0&&(t.output=new Uint8Array(i),t.next_out=0,t.avail_out=i),(r===Er||r===wr)&&t.avail_out<=6){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(a=Fe.deflate(t,r),a===Sr)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),a=Fe.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===tt;if(t.avail_out===0){this.onData(t.output);continue}if(r>0&&t.next_out>0){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(t.avail_in===0)break}return!0},Ge.prototype.onData=function(e){this.chunks.push(e)},Ge.prototype.onEnd=function(e){e===tt&&(this.result=et.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function zt(e,n){const t=new Ge(n);if(t.push(e,!0),t.err)throw t.msg||de[t.err];return t.result}function Nr(e,n){return n=n||{},n.raw=!0,zt(e,n)}function Ur(e,n){return n=n||{},n.gzip=!0,zt(e,n)}var Rr=Ge,kr=zt,yr=Nr,Lr=Ur,Tr=ue,Cr={Deflate:Rr,deflate:kr,deflateRaw:yr,gzip:Lr,constants:Tr};const nt=16209,Dr=16191;var Or=function(n,t){let i,a,r,o,s,_,l,c,w,h,f,p,D,N,S,y,b,u,k,z,g,T,U,v;const I=n.state;i=n.next_in,U=n.input,a=i+(n.avail_in-5),r=n.next_out,v=n.output,o=r-(t-n.avail_out),s=r+(n.avail_out-257),_=I.dmax,l=I.wsize,c=I.whave,w=I.wnext,h=I.window,f=I.hold,p=I.bits,D=I.lencode,N=I.distcode,S=(1<<I.lenbits)-1,y=(1<<I.distbits)-1;e:do{p<15&&(f+=U[i++]<<p,p+=8,f+=U[i++]<<p,p+=8),b=D[f&S];t:for(;;){if(u=b>>>24,f>>>=u,p-=u,u=b>>>16&255,u===0)v[r++]=b&65535;else if(u&16){k=b&65535,u&=15,u&&(p<u&&(f+=U[i++]<<p,p+=8),k+=f&(1<<u)-1,f>>>=u,p-=u),p<15&&(f+=U[i++]<<p,p+=8,f+=U[i++]<<p,p+=8),b=N[f&y];n:for(;;){if(u=b>>>24,f>>>=u,p-=u,u=b>>>16&255,u&16){if(z=b&65535,u&=15,p<u&&(f+=U[i++]<<p,p+=8,p<u&&(f+=U[i++]<<p,p+=8)),z+=f&(1<<u)-1,z>_){n.msg="invalid distance too far back",I.mode=nt;break e}if(f>>>=u,p-=u,u=r-o,z>u){if(u=z-u,u>c&&I.sane){n.msg="invalid distance too far back",I.mode=nt;break e}if(g=0,T=h,w===0){if(g+=l-u,u<k){k-=u;do v[r++]=h[g++];while(--u);g=r-z,T=v}}else if(w<u){if(g+=l+w-u,u-=w,u<k){k-=u;do v[r++]=h[g++];while(--u);if(g=0,w<k){u=w,k-=u;do v[r++]=h[g++];while(--u);g=r-z,T=v}}}else if(g+=w-u,u<k){k-=u;do v[r++]=h[g++];while(--u);g=r-z,T=v}for(;k>2;)v[r++]=T[g++],v[r++]=T[g++],v[r++]=T[g++],k-=3;k&&(v[r++]=T[g++],k>1&&(v[r++]=T[g++]))}else{g=r-z;do v[r++]=v[g++],v[r++]=v[g++],v[r++]=v[g++],k-=3;while(k>2);k&&(v[r++]=v[g++],k>1&&(v[r++]=v[g++]))}}else if(u&64){n.msg="invalid distance code",I.mode=nt;break e}else{b=N[(b&65535)+(f&(1<<u)-1)];continue n}break}}else if(u&64)if(u&32){I.mode=Dr;break e}else{n.msg="invalid literal/length code",I.mode=nt;break e}else{b=D[(b&65535)+(f&(1<<u)-1)];continue t}break}}while(i<a&&r<s);k=p>>3,i-=k,p-=k<<3,f&=(1<<p)-1,n.next_in=i,n.next_out=r,n.avail_in=i<a?5+(a-i):5-(i-a),n.avail_out=r<s?257+(s-r):257-(r-s),I.hold=f,I.bits=p};const Le=15,Cn=852,Dn=592,On=0,Mt=1,An=2,Ar=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Hr=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),zr=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Mr=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Xe=(e,n,t,i,a,r,o,s)=>{const _=s.bits;let l=0,c=0,w=0,h=0,f=0,p=0,D=0,N=0,S=0,y=0,b,u,k,z,g,T=null,U;const v=new Uint16Array(Le+1),I=new Uint16Array(Le+1);let Se=null,Yi,pt,gt;for(l=0;l<=Le;l++)v[l]=0;for(c=0;c<i;c++)v[n[t+c]]++;for(f=_,h=Le;h>=1&&v[h]===0;h--);if(f>h&&(f=h),h===0)return a[r++]=1<<24|64<<16|0,a[r++]=1<<24|64<<16|0,s.bits=1,0;for(w=1;w<h&&v[w]===0;w++);for(f<w&&(f=w),N=1,l=1;l<=Le;l++)if(N<<=1,N-=v[l],N<0)return-1;if(N>0&&(e===On||h!==1))return-1;for(I[1]=0,l=1;l<Le;l++)I[l+1]=I[l]+v[l];for(c=0;c<i;c++)n[t+c]!==0&&(o[I[n[t+c]]++]=c);if(e===On?(T=Se=o,U=20):e===Mt?(T=Ar,Se=Hr,U=257):(T=zr,Se=Mr,U=0),y=0,c=0,l=w,g=r,p=f,D=0,k=-1,S=1<<f,z=S-1,e===Mt&&S>Cn||e===An&&S>Dn)return 1;for(;;){Yi=l-D,o[c]+1<U?(pt=0,gt=o[c]):o[c]>=U?(pt=Se[o[c]-U],gt=T[o[c]-U]):(pt=96,gt=0),b=1<<l-D,u=1<<p,w=u;do u-=b,a[g+(y>>D)+u]=Yi<<24|pt<<16|gt|0;while(u!==0);for(b=1<<l-1;y&b;)b>>=1;if(b!==0?(y&=b-1,y+=b):y=0,c++,--v[l]===0){if(l===h)break;l=n[t+o[c]]}if(l>f&&(y&z)!==k){for(D===0&&(D=f),g+=w,p=l-D,N=1<<p;p+D<h&&(N-=v[p+D],!(N<=0));)p++,N<<=1;if(S+=1<<p,e===Mt&&S>Cn||e===An&&S>Dn)return 1;k=y&z,a[k]=f<<24|p<<16|g-r|0}}return y!==0&&(a[g+y]=l-D<<24|64<<16|0),s.bits=f,0};const Pr=0,Hn=1,zn=2,{Z_FINISH:Mn,Z_BLOCK:Zr,Z_TREES:it,Z_OK:Ee,Z_STREAM_END:jr,Z_NEED_DICT:Fr,Z_STREAM_ERROR:X,Z_DATA_ERROR:Pn,Z_MEM_ERROR:Zn,Z_BUF_ERROR:$r,Z_DEFLATED:jn}=ue,at=16180,Fn=16181,$n=16182,Bn=16183,Gn=16184,Xn=16185,Vn=16186,Kn=16187,Yn=16188,qn=16189,rt=16190,ne=16191,Pt=16192,Jn=16193,Zt=16194,Wn=16195,Qn=16196,ei=16197,ti=16198,ot=16199,st=16200,ni=16201,ii=16202,ai=16203,ri=16204,oi=16205,jt=16206,si=16207,li=16208,O=16209,ci=16210,fi=16211,Br=852,Gr=592,Xr=15,_i=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function Vr(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const we=e=>{if(!e)return 1;const n=e.state;return!n||n.strm!==e||n.mode<at||n.mode>fi?1:0},hi=e=>{if(we(e))return X;const n=e.state;return e.total_in=e.total_out=n.total=0,e.msg="",n.wrap&&(e.adler=n.wrap&1),n.mode=at,n.last=0,n.havedict=0,n.flags=-1,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(Br),n.distcode=n.distdyn=new Int32Array(Gr),n.sane=1,n.back=-1,Ee},di=e=>{if(we(e))return X;const n=e.state;return n.wsize=0,n.whave=0,n.wnext=0,hi(e)},ui=(e,n)=>{let t;if(we(e))return X;const i=e.state;return n<0?(t=0,n=-n):(t=(n>>4)+5,n<48&&(n&=15)),n&&(n<8||n>15)?X:(i.window!==null&&i.wbits!==n&&(i.window=null),i.wrap=t,i.wbits=n,di(e))},pi=(e,n)=>{if(!e)return X;const t=new Vr;e.state=t,t.strm=e,t.window=null,t.mode=at;const i=ui(e,n);return i!==Ee&&(e.state=null),i},Kr=e=>pi(e,Xr);let gi=!0,Ft,$t;const Yr=e=>{if(gi){Ft=new Int32Array(512),$t=new Int32Array(32);let n=0;for(;n<144;)e.lens[n++]=8;for(;n<256;)e.lens[n++]=9;for(;n<280;)e.lens[n++]=7;for(;n<288;)e.lens[n++]=8;for(Xe(Hn,e.lens,0,288,Ft,0,e.work,{bits:9}),n=0;n<32;)e.lens[n++]=5;Xe(zn,e.lens,0,32,$t,0,e.work,{bits:5}),gi=!1}e.lencode=Ft,e.lenbits=9,e.distcode=$t,e.distbits=5},xi=(e,n,t,i)=>{let a;const r=e.state;return r.window===null&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),i>=r.wsize?(r.window.set(n.subarray(t-r.wsize,t),0),r.wnext=0,r.whave=r.wsize):(a=r.wsize-r.wnext,a>i&&(a=i),r.window.set(n.subarray(t-i,t-i+a),r.wnext),i-=a,i?(r.window.set(n.subarray(t-i,t),0),r.wnext=i,r.whave=r.wsize):(r.wnext+=a,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=a))),0},qr=(e,n)=>{let t,i,a,r,o,s,_,l,c,w,h,f,p,D,N=0,S,y,b,u,k,z,g,T;const U=new Uint8Array(4);let v,I;const Se=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(we(e)||!e.output||!e.input&&e.avail_in!==0)return X;t=e.state,t.mode===ne&&(t.mode=Pt),o=e.next_out,a=e.output,_=e.avail_out,r=e.next_in,i=e.input,s=e.avail_in,l=t.hold,c=t.bits,w=s,h=_,T=Ee;e:for(;;)switch(t.mode){case at:if(t.wrap===0){t.mode=Pt;break}for(;c<16;){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}if(t.wrap&2&&l===35615){t.wbits===0&&(t.wbits=15),t.check=0,U[0]=l&255,U[1]=l>>>8&255,t.check=H(t.check,U,2,0),l=0,c=0,t.mode=Fn;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((l&255)<<8)+(l>>8))%31){e.msg="incorrect header check",t.mode=O;break}if((l&15)!==jn){e.msg="unknown compression method",t.mode=O;break}if(l>>>=4,c-=4,g=(l&15)+8,t.wbits===0&&(t.wbits=g),g>15||g>t.wbits){e.msg="invalid window size",t.mode=O;break}t.dmax=1<<t.wbits,t.flags=0,e.adler=t.check=1,t.mode=l&512?qn:ne,l=0,c=0;break;case Fn:for(;c<16;){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}if(t.flags=l,(t.flags&255)!==jn){e.msg="unknown compression method",t.mode=O;break}if(t.flags&57344){e.msg="unknown header flags set",t.mode=O;break}t.head&&(t.head.text=l>>8&1),t.flags&512&&t.wrap&4&&(U[0]=l&255,U[1]=l>>>8&255,t.check=H(t.check,U,2,0)),l=0,c=0,t.mode=$n;case $n:for(;c<32;){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}t.head&&(t.head.time=l),t.flags&512&&t.wrap&4&&(U[0]=l&255,U[1]=l>>>8&255,U[2]=l>>>16&255,U[3]=l>>>24&255,t.check=H(t.check,U,4,0)),l=0,c=0,t.mode=Bn;case Bn:for(;c<16;){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}t.head&&(t.head.xflags=l&255,t.head.os=l>>8),t.flags&512&&t.wrap&4&&(U[0]=l&255,U[1]=l>>>8&255,t.check=H(t.check,U,2,0)),l=0,c=0,t.mode=Gn;case Gn:if(t.flags&1024){for(;c<16;){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}t.length=l,t.head&&(t.head.extra_len=l),t.flags&512&&t.wrap&4&&(U[0]=l&255,U[1]=l>>>8&255,t.check=H(t.check,U,2,0)),l=0,c=0}else t.head&&(t.head.extra=null);t.mode=Xn;case Xn:if(t.flags&1024&&(f=t.length,f>s&&(f=s),f&&(t.head&&(g=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(i.subarray(r,r+f),g)),t.flags&512&&t.wrap&4&&(t.check=H(t.check,i,f,r)),s-=f,r+=f,t.length-=f),t.length))break e;t.length=0,t.mode=Vn;case Vn:if(t.flags&2048){if(s===0)break e;f=0;do g=i[r+f++],t.head&&g&&t.length<65536&&(t.head.name+=String.fromCharCode(g));while(g&&f<s);if(t.flags&512&&t.wrap&4&&(t.check=H(t.check,i,f,r)),s-=f,r+=f,g)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=Kn;case Kn:if(t.flags&4096){if(s===0)break e;f=0;do g=i[r+f++],t.head&&g&&t.length<65536&&(t.head.comment+=String.fromCharCode(g));while(g&&f<s);if(t.flags&512&&t.wrap&4&&(t.check=H(t.check,i,f,r)),s-=f,r+=f,g)break e}else t.head&&(t.head.comment=null);t.mode=Yn;case Yn:if(t.flags&512){for(;c<16;){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}if(t.wrap&4&&l!==(t.check&65535)){e.msg="header crc mismatch",t.mode=O;break}l=0,c=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=ne;break;case qn:for(;c<32;){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}e.adler=t.check=_i(l),l=0,c=0,t.mode=rt;case rt:if(t.havedict===0)return e.next_out=o,e.avail_out=_,e.next_in=r,e.avail_in=s,t.hold=l,t.bits=c,Fr;e.adler=t.check=1,t.mode=ne;case ne:if(n===Zr||n===it)break e;case Pt:if(t.last){l>>>=c&7,c-=c&7,t.mode=jt;break}for(;c<3;){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}switch(t.last=l&1,l>>>=1,c-=1,l&3){case 0:t.mode=Jn;break;case 1:if(Yr(t),t.mode=ot,n===it){l>>>=2,c-=2;break e}break;case 2:t.mode=Qn;break;case 3:e.msg="invalid block type",t.mode=O}l>>>=2,c-=2;break;case Jn:for(l>>>=c&7,c-=c&7;c<32;){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}if((l&65535)!==(l>>>16^65535)){e.msg="invalid stored block lengths",t.mode=O;break}if(t.length=l&65535,l=0,c=0,t.mode=Zt,n===it)break e;case Zt:t.mode=Wn;case Wn:if(f=t.length,f){if(f>s&&(f=s),f>_&&(f=_),f===0)break e;a.set(i.subarray(r,r+f),o),s-=f,r+=f,_-=f,o+=f,t.length-=f;break}t.mode=ne;break;case Qn:for(;c<14;){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}if(t.nlen=(l&31)+257,l>>>=5,c-=5,t.ndist=(l&31)+1,l>>>=5,c-=5,t.ncode=(l&15)+4,l>>>=4,c-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=O;break}t.have=0,t.mode=ei;case ei:for(;t.have<t.ncode;){for(;c<3;){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}t.lens[Se[t.have++]]=l&7,l>>>=3,c-=3}for(;t.have<19;)t.lens[Se[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,v={bits:t.lenbits},T=Xe(Pr,t.lens,0,19,t.lencode,0,t.work,v),t.lenbits=v.bits,T){e.msg="invalid code lengths set",t.mode=O;break}t.have=0,t.mode=ti;case ti:for(;t.have<t.nlen+t.ndist;){for(;N=t.lencode[l&(1<<t.lenbits)-1],S=N>>>24,y=N>>>16&255,b=N&65535,!(S<=c);){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}if(b<16)l>>>=S,c-=S,t.lens[t.have++]=b;else{if(b===16){for(I=S+2;c<I;){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}if(l>>>=S,c-=S,t.have===0){e.msg="invalid bit length repeat",t.mode=O;break}g=t.lens[t.have-1],f=3+(l&3),l>>>=2,c-=2}else if(b===17){for(I=S+3;c<I;){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}l>>>=S,c-=S,g=0,f=3+(l&7),l>>>=3,c-=3}else{for(I=S+7;c<I;){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}l>>>=S,c-=S,g=0,f=11+(l&127),l>>>=7,c-=7}if(t.have+f>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=O;break}for(;f--;)t.lens[t.have++]=g}}if(t.mode===O)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=O;break}if(t.lenbits=9,v={bits:t.lenbits},T=Xe(Hn,t.lens,0,t.nlen,t.lencode,0,t.work,v),t.lenbits=v.bits,T){e.msg="invalid literal/lengths set",t.mode=O;break}if(t.distbits=6,t.distcode=t.distdyn,v={bits:t.distbits},T=Xe(zn,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,v),t.distbits=v.bits,T){e.msg="invalid distances set",t.mode=O;break}if(t.mode=ot,n===it)break e;case ot:t.mode=st;case st:if(s>=6&&_>=258){e.next_out=o,e.avail_out=_,e.next_in=r,e.avail_in=s,t.hold=l,t.bits=c,Or(e,h),o=e.next_out,a=e.output,_=e.avail_out,r=e.next_in,i=e.input,s=e.avail_in,l=t.hold,c=t.bits,t.mode===ne&&(t.back=-1);break}for(t.back=0;N=t.lencode[l&(1<<t.lenbits)-1],S=N>>>24,y=N>>>16&255,b=N&65535,!(S<=c);){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}if(y&&!(y&240)){for(u=S,k=y,z=b;N=t.lencode[z+((l&(1<<u+k)-1)>>u)],S=N>>>24,y=N>>>16&255,b=N&65535,!(u+S<=c);){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}l>>>=u,c-=u,t.back+=u}if(l>>>=S,c-=S,t.back+=S,t.length=b,y===0){t.mode=oi;break}if(y&32){t.back=-1,t.mode=ne;break}if(y&64){e.msg="invalid literal/length code",t.mode=O;break}t.extra=y&15,t.mode=ni;case ni:if(t.extra){for(I=t.extra;c<I;){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}t.length+=l&(1<<t.extra)-1,l>>>=t.extra,c-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=ii;case ii:for(;N=t.distcode[l&(1<<t.distbits)-1],S=N>>>24,y=N>>>16&255,b=N&65535,!(S<=c);){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}if(!(y&240)){for(u=S,k=y,z=b;N=t.distcode[z+((l&(1<<u+k)-1)>>u)],S=N>>>24,y=N>>>16&255,b=N&65535,!(u+S<=c);){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}l>>>=u,c-=u,t.back+=u}if(l>>>=S,c-=S,t.back+=S,y&64){e.msg="invalid distance code",t.mode=O;break}t.offset=b,t.extra=y&15,t.mode=ai;case ai:if(t.extra){for(I=t.extra;c<I;){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}t.offset+=l&(1<<t.extra)-1,l>>>=t.extra,c-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=O;break}t.mode=ri;case ri:if(_===0)break e;if(f=h-_,t.offset>f){if(f=t.offset-f,f>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=O;break}f>t.wnext?(f-=t.wnext,p=t.wsize-f):p=t.wnext-f,f>t.length&&(f=t.length),D=t.window}else D=a,p=o-t.offset,f=t.length;f>_&&(f=_),_-=f,t.length-=f;do a[o++]=D[p++];while(--f);t.length===0&&(t.mode=st);break;case oi:if(_===0)break e;a[o++]=t.length,_--,t.mode=st;break;case jt:if(t.wrap){for(;c<32;){if(s===0)break e;s--,l|=i[r++]<<c,c+=8}if(h-=_,e.total_out+=h,t.total+=h,t.wrap&4&&h&&(e.adler=t.check=t.flags?H(t.check,a,h,o-h):ze(t.check,a,h,o-h)),h=_,t.wrap&4&&(t.flags?l:_i(l))!==t.check){e.msg="incorrect data check",t.mode=O;break}l=0,c=0}t.mode=si;case si:if(t.wrap&&t.flags){for(;c<32;){if(s===0)break e;s--,l+=i[r++]<<c,c+=8}if(t.wrap&4&&l!==(t.total&4294967295)){e.msg="incorrect length check",t.mode=O;break}l=0,c=0}t.mode=li;case li:T=jr;break e;case O:T=Pn;break e;case ci:return Zn;case fi:default:return X}return e.next_out=o,e.avail_out=_,e.next_in=r,e.avail_in=s,t.hold=l,t.bits=c,(t.wsize||h!==e.avail_out&&t.mode<O&&(t.mode<jt||n!==Mn))&&xi(e,e.output,e.next_out,h-e.avail_out),w-=e.avail_in,h-=e.avail_out,e.total_in+=w,e.total_out+=h,t.total+=h,t.wrap&4&&h&&(e.adler=t.check=t.flags?H(t.check,a,h,e.next_out-h):ze(t.check,a,h,e.next_out-h)),e.data_type=t.bits+(t.last?64:0)+(t.mode===ne?128:0)+(t.mode===ot||t.mode===Zt?256:0),(w===0&&h===0||n===Mn)&&T===Ee&&(T=$r),T},Jr=e=>{if(we(e))return X;let n=e.state;return n.window&&(n.window=null),e.state=null,Ee},Wr=(e,n)=>{if(we(e))return X;const t=e.state;return t.wrap&2?(t.head=n,n.done=!1,Ee):X},Qr=(e,n)=>{const t=n.length;let i,a,r;return we(e)||(i=e.state,i.wrap!==0&&i.mode!==rt)?X:i.mode===rt&&(a=1,a=ze(a,n,t,0),a!==i.check)?Pn:(r=xi(e,n,t,t),r?(i.mode=ci,Zn):(i.havedict=1,Ee))};var eo=di,to=ui,no=hi,io=Kr,ao=pi,ro=qr,oo=Jr,so=Wr,lo=Qr,co="pako inflate (from Nodeca project)",ie={inflateReset:eo,inflateReset2:to,inflateResetKeep:no,inflateInit:io,inflateInit2:ao,inflate:ro,inflateEnd:oo,inflateGetHeader:so,inflateSetDictionary:lo,inflateInfo:co};function fo(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var _o=fo;const Ei=Object.prototype.toString,{Z_NO_FLUSH:ho,Z_FINISH:uo,Z_OK:Ve,Z_STREAM_END:Bt,Z_NEED_DICT:Gt,Z_STREAM_ERROR:po,Z_DATA_ERROR:wi,Z_MEM_ERROR:go}=ue;function Ke(e){this.options=et.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,n.windowBits===0&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(e&&e.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&(n.windowBits&15||(n.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ln,this.strm.avail_out=0;let t=ie.inflateInit2(this.strm,n.windowBits);if(t!==Ve)throw new Error(de[t]);if(this.header=new _o,ie.inflateGetHeader(this.strm,this.header),n.dictionary&&(typeof n.dictionary=="string"?n.dictionary=Be.string2buf(n.dictionary):Ei.call(n.dictionary)==="[object ArrayBuffer]"&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(t=ie.inflateSetDictionary(this.strm,n.dictionary),t!==Ve)))throw new Error(de[t])}Ke.prototype.push=function(e,n){const t=this.strm,i=this.options.chunkSize,a=this.options.dictionary;let r,o,s;if(this.ended)return!1;for(n===~~n?o=n:o=n===!0?uo:ho,Ei.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(i),t.next_out=0,t.avail_out=i),r=ie.inflate(t,o),r===Gt&&a&&(r=ie.inflateSetDictionary(t,a),r===Ve?r=ie.inflate(t,o):r===wi&&(r=Gt));t.avail_in>0&&r===Bt&&t.state.wrap>0&&e[t.next_in]!==0;)ie.inflateReset(t),r=ie.inflate(t,o);switch(r){case po:case wi:case Gt:case go:return this.onEnd(r),this.ended=!0,!1}if(s=t.avail_out,t.next_out&&(t.avail_out===0||r===Bt))if(this.options.to==="string"){let _=Be.utf8border(t.output,t.next_out),l=t.next_out-_,c=Be.buf2string(t.output,_);t.next_out=l,t.avail_out=i-l,l&&t.output.set(t.output.subarray(_,_+l),0),this.onData(c)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(r===Ve&&s===0)){if(r===Bt)return r=ie.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(t.avail_in===0)break}}return!0},Ke.prototype.onData=function(e){this.chunks.push(e)},Ke.prototype.onEnd=function(e){e===Ve&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=et.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Xt(e,n){const t=new Ke(n);if(t.push(e),t.err)throw t.msg||de[t.err];return t.result}function xo(e,n){return n=n||{},n.raw=!0,Xt(e,n)}var Eo=Ke,wo=Xt,vo=xo,So=Xt,bo=ue,mo={Inflate:Eo,inflate:wo,inflateRaw:vo,ungzip:So,constants:bo};const{Deflate:Io,deflate:No,deflateRaw:Uo,gzip:Ro}=Cr,{Inflate:ko,inflate:yo,inflateRaw:Lo,ungzip:To}=mo;var Co=Io,Do=No,Oo=Uo,Ao=Ro,Ho=ko,zo=yo,Mo=Lo,Po=To,Zo=ue,jo={Deflate:Co,deflate:Do,deflateRaw:Oo,gzip:Ao,Inflate:Ho,inflate:zo,inflateRaw:Mo,ungzip:Po,constants:Zo};function Fo(e,n,t){const i=document.createElement("a");i.href=e,i.style.display="none",i.download=`${n}.${t}`,document.body.appendChild(i),i.click(),document.body.removeChild(i)}function Vt(e,n,t){const i=URL.createObjectURL(e);Fo(i,n,t),URL.revokeObjectURL(i)}const lt={[A.UNIVER_UNKNOWN]:"",[A.UNIVER_DOC]:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",[A.UNIVER_SHEET]:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",[A.UNIVER_SLIDE]:"application/vnd.openxmlformats-officedocument.presentationml.presentation",[A.UNRECOGNIZED]:""},$o={"application/vnd.openxmlformats-officedocument.wordprocessingml.document":"docx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"xlsx","application/vnd.openxmlformats-officedocument.presentationml.presentation":"pptx"};function Bo(e){return Go(e.type)?A.UNIVER_SHEET:Xo(e.type)?A.UNIVER_DOC:Vo(e.type)?A.UNIVER_SLIDE:A.UNIVER_UNKNOWN}function Go(e){return e===lt[A.UNIVER_SHEET]}function Xo(e){return e===lt[A.UNIVER_DOC]}function Vo(e){return e===lt[A.UNIVER_SLIDE]}function ct(e,n=!1){const t=e.map(i=>lt[i]).join(",");return new Promise((i,a)=>{const r=document.createElement("input");r.type="file",r.accept=t,r.multiple=n,r.addEventListener("change",o=>{const s=o.currentTarget;if(!s.files||s.files.length===0)throw a(null),new Error("No file selected");i(s.files)}),r.click()})}async function vi(e){try{const n=await fetch(e);if(!n.ok)throw new Error(`HTTP error! Status: ${n.status}`);const t=await n.blob(),i=n.headers.get("Content-Type")||"application/octet-stream",a=$o[i]||"xlsx",r=Ko(e)||`file.${a}`;return new File([t],r,{type:i})}catch(n){console.error("Error fetching file from URL:",n);return}}function Ko(e){return new URL(e).pathname.split("/").pop()}async function Yo(e){try{const n=await fetch(e);if(!n.ok)throw new Error(`HTTP error! Status: ${n.status}`);return await n.text()}catch(n){console.error("Error fetching text from URL:",n);return}}function qo(e){const n=new Blob([e],{type:"application/json"});return new File([n],"file.json")}function Si(e,n){return e.replace("{type}",n)}function Jo(e,n){return e.replace("{taskID}",n)}function Wo(e,n){return e.replace("{fileID}",n)}var Qo=Object.defineProperty,es=Object.getOwnPropertyDescriptor,ts=(e,n,t,i)=>{for(var a=i>1?void 0:i?es(n,t):n,r=e.length-1,o;r>=0;r--)(o=e[r])&&(a=(i?o(n,t,a):o(a))||a);return i&&a&&Qo(n,t,a),a},bi=(e,n)=>(t,i)=>n(t,i,e);const mi="EXCHANGE_UPLOAD_FILE_SERVER_URL_KEY",ns="/universer-api/stream/file/upload",Ii="EXCHANGE_IMPORT_SERVER_URL_KEY",is="/universer-api/exchange/{type}/import",Ni="EXCHANGE_EXPORT_SERVER_URL_KEY",as="/universer-api/exchange/{type}/export",Ui="EXCHANGE_GET_TASK_SERVER_URL_KEY",rs="/universer-api/exchange/task/{taskID}",Ri="EXCHANGE_SIGN_URL_SERVER_URL_KEY",os="/universer-api/file/{fileID}/sign-url";var ae=(e=>(e[e.UNDEFINED=0]="UNDEFINED",e[e.UNIT=1]="UNIT",e[e.JSON=2]="JSON",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(ae||{});const Kt=d.createIdentifier("univer-pro.exchange-client.request.service");x.RequestService=class{constructor(n,t){this._configService=n,this._httpService=t}dispose(){}async upload(n,t=0,i=!1){if(typeof n=="string"){const r=await vi(n);if(!r)return;n=r}t=t||n.size;const a=new FormData;a.append("file",n);try{const r=`${this._getUploadFileURL()}?size=${t}&flate=${i}`;return await(await fetch(r,{method:"POST",body:a,credentials:"include"})).json()}catch{return}}async import(n){const{fileID:t,type:i,outputType:a}=n;try{const r=Si(this._getImportURL(),`${i}`);return await(await fetch(r,{method:"POST",body:JSON.stringify({body:{fileID:t,outputType:a}}.body),headers:{"Content-Type":"application/json"},credentials:"include"})).json()}catch{return}}async export(n){const{unitID:t,jsonID:i,type:a}=n;try{const r=Si(this._getExportURL(),`${a}`);return await(await fetch(r,{method:"POST",body:JSON.stringify({body:{unitID:t,jsonID:i,type:a}}.body),headers:{"Content-Type":"application/json"},credentials:"include"})).json()}catch{return}}async getTask(n){return new Promise((t,i)=>{try{let a=0;const r=Jo(this._getTaskURL(),`${n}`),o=async()=>{const _=(await this._httpService.get(r,{withCredentials:!0})).body;if(_.error&&_.error.code===L.OK)if(_.status==="done")t(_);else if(_.status==="pending"){let l=1e3;if(a>=6e4){i(_);return}else a>=3e4&&(l=5e3);a+=l,setTimeout(o,l)}else i(_);else i(_)};o()}catch(a){i(a instanceof Error?a:new Error(String(a)))}})}async signUrl(n){try{const t=Wo(this._getSignURL(),`${n}`);return(await this._httpService.get(t,{withCredentials:!0})).body}catch{return}}_getUploadFileURL(){var n;return(n=this._configService.getConfig(mi))!=null?n:ns}_getImportURL(){var n;return(n=this._configService.getConfig(Ii))!=null?n:is}_getExportURL(){var n;return(n=this._configService.getConfig(Ni))!=null?n:as}_getTaskURL(){var n;return(n=this._configService.getConfig(Ui))!=null?n:rs}_getSignURL(){var n;return(n=this._configService.getConfig(Ri))!=null?n:os}},x.RequestService=ts([bi(0,d.IConfigService),bi(1,d.Inject(be.HTTPService))],x.RequestService);function ss(e){const n=e.workbook;if(!n)return null;const t={};n.sheets&&Object.keys(n.sheets).forEach(a=>{const r=n.sheets[a];t[a]={...r,originalMeta:d.b64EncodeUnicode(d.textDecoder.decode(r.originalMeta))}});const i=d.b64EncodeUnicode(d.textDecoder.decode(n.originalMeta));return{...e,workbook:{...n,originalMeta:i,sheets:t},doc:{}}}function ls(e){const n={};return e.forEach(t=>{n[t.id]={...t,data:d.b64EncodeUnicode(d.textDecoder.decode(t.data))}}),n}async function cs(e){var _;const n={metadata:void 0},t=e.id,i=(_=e.rev)!=null?_:0,a=new d.ClientSnapshotServerService,{snapshot:r}=await d.transformWorkbookDataToSnapshot(n,e,t,i,a),o=await d.getSheetBlocksFromSnapshot(r,a),s=ss(r);if(!s)throw new Error("Failed to transform snapshot to string");return{snapshot:s,sheetBlocks:ls(o)}}var fs=Object.defineProperty,_s=Object.getOwnPropertyDescriptor,hs=(e,n,t,i)=>{for(var a=i>1?void 0:i?_s(n,t):n,r=e.length-1,o;r>=0;r--)(o=e[r])&&(a=(i?o(n,t,a):o(a))||a);return i&&a&&fs(n,t,a),a},ds=(e,n)=>(t,i)=>n(t,i,e);const Yt=d.createIdentifier("univer-pro.exchange-client.exchange.service");x.ExchangeService=class extends d.Disposable{constructor(t){super();K(this,"_requestState$",new ee.Subject);K(this,"requestState$",this._requestState$.asObservable());this._requestService=t}dispose(){super.dispose(),this._requestState$.complete()}async importDOCXToSnapshot(t){const i=await this._importToSnapshot(t,A.UNIVER_DOC);if(!i||!i.snapshot)return;const a=d.transformSnapshotToDocumentData(i.snapshot);if(a)return a}exportDOCXByUnitId(t){throw new Error("Method not implemented.")}exportDOCXBySnapshot(t){throw new Error("Method not implemented.")}async importXLSXToSnapshot(t){const i=await this._importToSnapshot(t,A.UNIVER_SHEET);if(!i)return;const a=i.snapshot,r=i.sheetBlocks,o=Object.keys(r).map(_=>r[_]),s=d.transformSnapshotToWorkbookData(a,o);if(s)return s}async exportXLSXByUnitId(t){return this._export(t,ae.UNIT,A.UNIVER_SHEET)}async exportXLSXBySnapshot(t){const i=await cs(t);return this._exportBySnapshot(i,A.UNIVER_SHEET)}async importFileToUnitId(t,i){var l,c;const a=await this._upload(t);if(!a)return;const r=await this._import(a,ae.UNIT,i);if(!r)return;const o=await this._requestService.getTask(r).catch(w=>{var f;const h=w instanceof Error?w.message:(f=w.error)==null?void 0:f.message;this._requestState$.next({error:{code:L.UNRECOGNIZED,message:h||""},state:3})});if(!o)return;const s=(l=o.import)==null?void 0:l.outputType,_=((c=o.import)==null?void 0:c.unitID)||"";if(s!==ae.UNIT){this._requestState$.next({error:{code:L.UNRECOGNIZED,message:"Get outputType error"},state:3});return}if(_.length===0){this._requestState$.next({error:{code:L.UNRECOGNIZED,message:"Failed to get unitID from task"},state:3});return}return this._requestState$.next({error:o.error,state:3}),_}async _importToSnapshot(t,i){var w,h;const a=await this._upload(t);if(!a)return;const r=await this._import(a,ae.JSON,i);if(!r)return;const o=await this._requestService.getTask(r).catch(f=>{var D;const p=f instanceof Error?f.message:(D=f.error)==null?void 0:D.message;this._requestState$.next({error:{code:L.UNRECOGNIZED,message:p||""},state:3})});if(!o)return;const s=(w=o.import)==null?void 0:w.outputType,_=((h=o.import)==null?void 0:h.jsonID)||"";if(s!==ae.JSON){this._requestState$.next({error:{code:L.UNRECOGNIZED,message:"Get outputType error"},state:3});return}if(_.length===0){this._requestState$.next({error:{code:L.UNRECOGNIZED,message:"Failed to get jsonID from task"},state:3});return}this._requestState$.next({error:o.error,state:3});const l=await this._signUrl(_);if(!l)return;const c=await Yo(l);if(!c){this._requestState$.next({error:{code:L.UNRECOGNIZED,message:"Failed to get text from url"},state:5});return}try{const f=JSON.parse(c);return this._requestState$.next({error:{code:L.OK,message:"success"},state:5}),f}catch{this._requestState$.next({error:{code:L.UNRECOGNIZED,message:"Failed to parse json"},state:5})}}async _exportBySnapshot(t,i){const a=JSON.stringify(t),r=jo.deflateRaw(a),o=d.textEncoder.encode(a).length,s=qo(r),_=await this._upload(s,o,!0);if(_)return this._export(_,ae.JSON,i)}async _export(t,i,a){var w;const r=await this._requestService.export({unitID:i===ae.UNIT?t:"",jsonID:i===ae.JSON?t:"",type:a});if(!r){this._requestState$.next({error:{code:L.UNRECOGNIZED,message:"export error"},state:2});return}if(this._requestState$.next({error:r.error,state:2}),r.error&&r.error.code!==L.OK)return;const o=r.taskID,s=await this._requestService.getTask(o).catch(h=>{var p;const f=h instanceof Error?h.message:(p=h.error)==null?void 0:p.message;this._requestState$.next({error:{code:L.UNRECOGNIZED,message:f||""},state:3})});if(!s)return;const _=((w=s.export)==null?void 0:w.fileID)||"";if(_.length===0){this._requestState$.next({error:{code:L.UNRECOGNIZED,message:"Failed to get fileID from task"},state:3});return}this._requestState$.next({error:s.error,state:3});const l=await this._signUrl(_);if(!l)return;const c=await vi(l);if(!c){this._requestState$.next({error:{code:L.UNRECOGNIZED,message:"Failed to get file from url"},state:6});return}return this._requestState$.next({error:{code:L.OK,message:"success"},state:6}),c}async _upload(t,i,a){const r=await this._requestService.upload(t,i,a);if(!r||typeof r.FileId!="string"){this._requestState$.next({error:{code:L.UNRECOGNIZED,message:"upload error"},state:0});return}const o=r.FileId;if(o.length===0){this._requestState$.next({error:{code:L.UNRECOGNIZED,message:"upload error"},state:0});return}return this._requestState$.next({error:{code:L.OK,message:"success"},state:0}),o}async _import(t,i,a){const r={fileID:t,type:a,outputType:i,fileUrl:""},o=await this._requestService.import(r);if(!o){this._requestState$.next({error:{code:L.UNRECOGNIZED,message:"import error"},state:1});return}if(o.error&&o.error.code!==L.OK){this._requestState$.next({error:o.error,state:1});return}const s=o.taskID;if(s.length===0){this._requestState$.next({error:{code:L.UNRECOGNIZED,message:"Failed to get taskID from import response"},state:1});return}return this._requestState$.next({error:o.error,state:1}),s}async _signUrl(t){const i=await this._requestService.signUrl(t);if(!i){this._requestState$.next({error:{code:L.UNRECOGNIZED,message:"sign url error"},state:4});return}if(i.error&&i.error.code!==L.OK){this._requestState$.next({error:i.error,state:4});return}const a=i.url;if(a.length===0){this._requestState$.next({error:{code:L.UNRECOGNIZED,message:"sign url error"},state:4});return}return this._requestState$.next({error:i.error,state:4}),a}},x.ExchangeService=hs([ds(0,d.Inject(Kt))],x.ExchangeService);var P=(e=>(e[e.UPLOADING=0]="UPLOADING",e[e.SUCCESS=1]="SUCCESS",e[e.ERROR=2]="ERROR",e))(P||{});const ft=d.createIdentifier("univer-pro.exchange-client.upload-notification.service");class ki extends d.Disposable{constructor(){super();K(this,"_visible$",new ee.Subject);K(this,"_state$",new ee.Subject);K(this,"_list$",new ee.Subject);K(this,"visible$",this._visible$.asObservable());K(this,"state$",this._state$.asObservable());K(this,"list$",this._list$.asObservable());K(this,"_list",[])}dispose(){super.dispose(),this._visible$.complete(),this._state$.complete(),this._list$.complete()}show(){this._visible$.next(!0)}hide(){this._visible$.next(!1)}updateState(t){this._state$.next(t)}pushLink(t){this._list.unshift(t),this._list$.next(this._list)}}class yi extends Ye.ProgressService{}const _t=d.createIdentifier("univer-pro.exchange-client.upload-progress.service");var Li={exports:{}},ht={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var us=C,ps=Symbol.for("react.element"),gs=Symbol.for("react.fragment"),xs=Object.prototype.hasOwnProperty,Es=us.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ws={key:!0,ref:!0,__self:!0,__source:!0};function Ti(e,n,t){var i,a={},r=null,o=null;t!==void 0&&(r=""+t),n.key!==void 0&&(r=""+n.key),n.ref!==void 0&&(o=n.ref);for(i in n)xs.call(n,i)&&!ws.hasOwnProperty(i)&&(a[i]=n[i]);if(e&&e.defaultProps)for(i in n=e.defaultProps,n)a[i]===void 0&&(a[i]=n[i]);return{$$typeof:ps,type:e,key:r,ref:o,props:a,_owner:Es.current}}ht.Fragment=gs,ht.jsx=Ti,ht.jsxs=Ti,Li.exports=ht;var E=Li.exports,V=function(){return V=Object.assign||function(e){for(var n,t=1,i=arguments.length;t<i;t++){n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},V.apply(this,arguments)},vs=function(e,n){var t={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&n.indexOf(i)<0&&(t[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(e);a<i.length;a++)n.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(t[i[a]]=e[i[a]]);return t},re=C.forwardRef(function(e,n){var t=e.icon,i=e.id,a=e.className,r=e.extend,o=vs(e,["icon","id","className","extend"]),s="univerjs-icon univerjs-icon-".concat(i," ").concat(a||"").trim(),_=C.useRef("_".concat(ms()));return Ci(t,"".concat(i),{defIds:t.defIds,idSuffix:_.current},V({ref:n,className:s},o),r)});function Ci(e,n,t,i,a){return C.createElement(e.tag,V(V({key:n},Ss(e,t,a)),i),(bs(e,t).children||[]).map(function(r,o){return Ci(r,"".concat(n,"-").concat(e.tag,"-").concat(o),t,void 0,a)}))}function Ss(e,n,t){var i=V({},e.attrs);t!=null&&t.colorChannel1&&i.fill==="colorChannel1"&&(i.fill=t.colorChannel1);var a=n.defIds;return!a||a.length===0||(e.tag==="use"&&i["xlink:href"]&&(i["xlink:href"]=i["xlink:href"]+n.idSuffix),Object.entries(i).forEach(function(r){var o=r[0],s=r[1];typeof s=="string"&&(i[o]=s.replace(/url\(#(.*)\)/,"url(#$1".concat(n.idSuffix,")")))})),i}function bs(e,n){var t,i=n.defIds;return!i||i.length===0?e:e.tag==="defs"&&(!((t=e.children)===null||t===void 0)&&t.length)?V(V({},e),{children:e.children.map(function(a){return typeof a.attrs.id=="string"&&i&&i.indexOf(a.attrs.id)>-1?V(V({},a),{attrs:V(V({},a.attrs),{id:a.attrs.id+n.idSuffix})}):a})}):e}function ms(){return Math.random().toString(36).substring(2,8)}re.displayName="UniverIcon";var Is={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.24483 4.80026C8.24487 4.46889 7.97627 4.20023 7.6449 4.2002C7.31353 4.20016 7.04487 4.46876 7.04483 4.80013L7.04443 8.40306C7.04442 8.56222 7.10763 8.71486 7.22017 8.82739L9.64664 11.2539C9.88095 11.4882 10.2608 11.4882 10.4952 11.2539C10.7295 11.0195 10.7295 10.6396 10.4952 10.4053L8.24446 8.15463L8.24483 4.80026Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.14248 0.899902C4.22126 0.899902 1.04248 4.07868 1.04248 7.9999C1.04248 11.9211 4.22126 15.0999 8.14248 15.0999C12.0637 15.0999 15.2425 11.9211 15.2425 7.9999C15.2425 4.07868 12.0637 0.899902 8.14248 0.899902ZM2.24248 7.9999C2.24248 4.74142 4.884 2.0999 8.14248 2.0999C11.401 2.0999 14.0425 4.74142 14.0425 7.9999C14.0425 11.2584 11.401 13.8999 8.14248 13.8999C4.884 13.8999 2.24248 11.2584 2.24248 7.9999Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Di=C.forwardRef(function(e,n){return C.createElement(re,Object.assign({},e,{id:"clock-single",ref:n,icon:Is}))});Di.displayName="ClockSingle";var Ns={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.71274 2.86421C3.47843 2.6299 3.09853 2.6299 2.86421 2.86421C2.6299 3.09853 2.6299 3.47843 2.86421 3.71274L7.15154 8.00007L2.86421 12.2874C2.6299 12.5217 2.6299 12.9016 2.86421 13.1359C3.09853 13.3702 3.47843 13.3702 3.71274 13.1359L8.00007 8.84859L12.2874 13.1359C12.5217 13.3702 12.9016 13.3702 13.1359 13.1359C13.3702 12.9016 13.3702 12.5217 13.1359 12.2874L8.84859 8.00007L13.1359 3.71274C13.3702 3.47843 13.3702 3.09853 13.1359 2.86421C12.9016 2.6299 12.5217 2.6299 12.2874 2.86421L8.00007 7.15154L3.71274 2.86421Z"}}]},Oi=C.forwardRef(function(e,n){return C.createElement(re,Object.assign({},e,{id:"close-single",ref:n,icon:Ns}))});Oi.displayName="CloseSingle";var Us={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"#4B7DFF",d:"M3.4535 1.12549C2.7002 1.12549 2.08954 1.73615 2.08954 2.48945V13.5104C2.08954 14.2637 2.7002 14.8744 3.4535 14.8744H12.5465C13.2998 14.8744 13.9105 14.2637 13.9105 13.5104V5.0992L10.0091 1.12549H3.4535Z"}},{tag:"path",attrs:{fill:"#fff",d:"M4.57245 7.27962C4.57245 7.09553 4.72169 6.94629 4.90578 6.94629H10.2391C10.4232 6.94629 10.5724 7.09553 10.5724 7.27962 10.5724 7.46372 10.4232 7.61296 10.2391 7.61296H4.90578C4.72169 7.61296 4.57245 7.46372 4.57245 7.27962zM4.57245 9.62638C4.57245 9.44229 4.72169 9.29305 4.90578 9.29305H10.2391C10.4232 9.29305 10.5724 9.44229 10.5724 9.62638 10.5724 9.81048 10.4232 9.95972 10.2391 9.95972H4.90578C4.72169 9.95972 4.57245 9.81048 4.57245 9.62638zM4.90578 11.6398C4.72169 11.6398 4.57245 11.789 4.57245 11.9731 4.57245 12.1572 4.72169 12.3065 4.90578 12.3065H7.57245C7.75654 12.3065 7.90578 12.1572 7.90578 11.9731 7.90578 11.789 7.75654 11.6398 7.57245 11.6398H4.90578z"}},{tag:"path",attrs:{stroke:"#fff",d:"M4.57245 7.27962C4.57245 7.09553 4.72169 6.94629 4.90578 6.94629H10.2391C10.4232 6.94629 10.5724 7.09553 10.5724 7.27962 10.5724 7.46372 10.4232 7.61296 10.2391 7.61296H4.90578C4.72169 7.61296 4.57245 7.46372 4.57245 7.27962zM4.57245 9.62638C4.57245 9.44229 4.72169 9.29305 4.90578 9.29305H10.2391C10.4232 9.29305 10.5724 9.44229 10.5724 9.62638 10.5724 9.81048 10.4232 9.95972 10.2391 9.95972H4.90578C4.72169 9.95972 4.57245 9.81048 4.57245 9.62638zM4.90578 11.6398C4.72169 11.6398 4.57245 11.789 4.57245 11.9731 4.57245 12.1572 4.72169 12.3065 4.90578 12.3065H7.57245C7.75654 12.3065 7.90578 12.1572 7.90578 11.9731 7.90578 11.789 7.75654 11.6398 7.57245 11.6398H4.90578z",strokeLinecap:"round",strokeWidth:.03}},{tag:"path",attrs:{fill:"#305CFA",d:"M10.0075 1.12549L13.9104 5.09842H10.6742C10.306 5.09842 10.0075 4.79994 10.0075 4.43175V1.12549Z"}}]},Ai=C.forwardRef(function(e,n){return C.createElement(re,Object.assign({},e,{id:"doc",ref:n,icon:Us}))});Ai.displayName="Doc";var Rs={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1C11.866 1 15 4.13401 15 8ZM10.3097 5.69014C10.544 5.92445 10.544 6.30435 10.3097 6.53867L8.84843 7.9999L10.3099 9.46137C10.5442 9.69569 10.5442 10.0756 10.3099 10.3099C10.0756 10.5442 9.69569 10.5442 9.46137 10.3099L7.9999 8.84843L6.53842 10.3099C6.30411 10.5442 5.92421 10.5442 5.6899 10.3099C5.45558 10.0756 5.45558 9.69569 5.6899 9.46137L7.15137 7.9999L5.69014 6.53867C5.45583 6.30435 5.45583 5.92445 5.69014 5.69014C5.92445 5.45583 6.30435 5.45583 6.53867 5.69014L7.9999 7.15137L9.46113 5.69014C9.69544 5.45583 10.0753 5.45583 10.3097 5.69014Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Hi=C.forwardRef(function(e,n){return C.createElement(re,Object.assign({},e,{id:"error-single",ref:n,icon:Rs}))});Hi.displayName="ErrorSingle";var ks={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.88699 2.34478L3.65371 2.3448C2.88051 2.34481 2.25372 2.97161 2.25372 3.7448L2.25371 12.4445C2.25371 13.2177 2.88052 13.8445 3.65372 13.8445L12.3535 13.8445C13.1267 13.8445 13.7535 13.2177 13.7535 12.4445V10.0256C13.7535 9.69425 14.0221 9.42562 14.3535 9.42562C14.6849 9.42562 14.9535 9.69425 14.9535 10.0256V12.4445C14.9535 13.8804 13.7894 15.0444 12.3535 15.0445L3.65373 15.0445C2.21778 15.0445 1.05371 13.8805 1.05371 12.4445L1.05372 3.7448C1.05372 2.30888 2.21776 1.14482 3.65369 1.1448L5.88697 1.14478C6.21834 1.14477 6.48698 1.4134 6.48698 1.74477C6.48699 2.07614 6.21836 2.34477 5.88699 2.34478Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.71094 1.75039C8.71094 1.41902 8.97956 1.15039 9.31094 1.15039H13.7497C14.3572 1.15039 14.8497 1.64288 14.8497 2.25039V6.68919C14.8497 7.02056 14.5811 7.28919 14.2497 7.28919C13.9184 7.28919 13.6497 7.02056 13.6497 6.68919V3.19854L8.95883 7.88944C8.72452 8.12375 8.34462 8.12375 8.1103 7.88944C7.87599 7.65512 7.87599 7.27523 8.1103 7.04091L12.8008 2.35039H9.31094C8.97956 2.35039 8.71094 2.08176 8.71094 1.75039Z"}}]},zi=C.forwardRef(function(e,n){return C.createElement(re,Object.assign({},e,{id:"share-range-single",ref:n,icon:ks}))});zi.displayName="ShareRangeSingle";var ys={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"#FF6B4B",d:"M3.4535 1.12549C2.7002 1.12549 2.08954 1.73615 2.08954 2.48945V13.5104C2.08954 14.2637 2.7002 14.8744 3.4535 14.8744H12.5465C13.2998 14.8744 13.9105 14.2637 13.9105 13.5104V5.0992L10.0091 1.12549H3.4535Z"}},{tag:"path",attrs:{fill:"#EC4F2D",d:"M10.0075 1.12549L13.9104 5.09842H10.6742C10.306 5.09842 10.0075 4.79994 10.0075 4.43175V1.12549Z"}},{tag:"path",attrs:{fill:"#fff",d:"M7.76493 7.24535C7.76493 7.07967 7.63024 6.94371 7.46548 6.96123C7.01146 7.00953 6.57426 7.16714 6.19216 7.42245C5.72662 7.73351 5.36378 8.17564 5.14951 8.69292C4.93525 9.2102 4.87918 9.77941 4.98842 10.3285C5.09765 10.8777 5.36727 11.3821 5.76318 11.778C6.15909 12.1739 6.66351 12.4436 7.21265 12.5528C7.76179 12.662 8.33099 12.606 8.84828 12.3917C9.36556 12.1774 9.80769 11.8146 10.1188 11.349C10.3741 10.9669 10.5317 10.5297 10.58 10.0757C10.5975 9.91096 10.4615 9.77627 10.2958 9.77627L8.06493 9.77627C7.89925 9.77627 7.76493 9.64195 7.76493 9.47627L7.76493 7.24535Z"}},{tag:"path",attrs:{fill:"#fff",d:"M10.4097 9.35206C10.5753 9.35206 10.7115 9.21728 10.6918 9.05277C10.6645 8.82511 10.6062 8.60178 10.5181 8.38909C10.3917 8.08379 10.2063 7.80639 9.97264 7.57272C9.73897 7.33905 9.46157 7.1537 9.15627 7.02724C8.94358 6.93914 8.72024 6.88083 8.49259 6.85356C8.32808 6.83385 8.1933 6.97001 8.1933 7.13569V9.05206C8.1933 9.21774 8.32761 9.35206 8.4933 9.35206H10.4097Z"}}]},Mi=C.forwardRef(function(e,n){return C.createElement(re,Object.assign({},e,{id:"slide",ref:n,icon:ys}))});Mi.displayName="Slide";var Ls={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8 15C11.866 15 15 11.866 15 8C15 4.13401 11.866 1 8 1C4.13401 1 1 4.13401 1 8C1 11.866 4.13401 15 8 15ZM11.7245 6.42417C11.9588 6.18985 11.9588 5.80995 11.7245 5.57564C11.4901 5.34132 11.1102 5.34132 10.8759 5.57564L7.3002 9.15137L5.72446 7.57564C5.49014 7.34132 5.11025 7.34132 4.87593 7.57564C4.64162 7.80995 4.64162 8.18985 4.87593 8.42417L6.87593 10.4242C7.11025 10.6585 7.49014 10.6585 7.72446 10.4242L11.7245 6.42417Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Pi=C.forwardRef(function(e,n){return C.createElement(re,Object.assign({},e,{id:"success-single",ref:n,icon:Ls}))});Pi.displayName="SuccessSingle";var Ts={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"#35BD4B",d:"M3.4535 1.12549C2.7002 1.12549 2.08954 1.73615 2.08954 2.48945V13.5104C2.08954 14.2637 2.7002 14.8744 3.4535 14.8744H12.5465C13.2998 14.8744 13.9105 14.2637 13.9105 13.5104V5.0992L10.0091 1.12549H3.4535Z"}},{tag:"path",attrs:{fill:"#32A846",d:"M10.0075 1.12549L13.9104 5.09842H10.6742C10.306 5.09842 10.0075 4.79994 10.0075 4.43175V1.12549Z"}},{tag:"path",attrs:{fill:"#fff",d:"M7.8088 10.2949L6.3764 12.403C6.26259 12.5705 6.03455 12.614 5.86705 12.5002C5.69955 12.3864 5.65603 12.1584 5.76984 11.9909L7.3655 9.64252L5.94042 7.54519C5.82661 7.37769 5.87013 7.14964 6.03763 7.03583C6.20512 6.92202 6.43317 6.96555 6.54698 7.13304L7.8088 8.9901L9.07062 7.13304C9.18443 6.96555 9.41248 6.92202 9.57997 7.03583C9.74747 7.14964 9.79099 7.37769 9.67718 7.54519L8.2521 9.64252L9.84776 11.9909C9.96157 12.1584 9.91805 12.3864 9.75055 12.5002C9.58305 12.614 9.35501 12.5705 9.2412 12.403L7.8088 10.2949Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Zi=C.forwardRef(function(e,n){return C.createElement(re,Object.assign({},e,{id:"xlsx",ref:n,icon:Ts}))});Zi.displayName="Xlsx";const qt={exchangeUploading:"univer-exchange-uploading",exchangeUploadingTip:"univer-exchange-uploading-tip",exchangeUploadingProgress:"univer-exchange-uploading-progress"},ji={exchangeUploadProgress:"univer-exchange-upload-progress",exchangeUploadProgressInner:"univer-exchange-upload-progress-inner"};function Cs(e){const{barColor:n}=e,t=d.useDependency(_t),[i,a]=C.useState(0);return C.useEffect(()=>{const r=t.progressChange$.subscribe(o=>{const{step:s}=o;a(_=>_+(1-_)*s)});return()=>{r.unsubscribe()}},[]),E.jsx("div",{className:ji.exchangeUploadProgress,children:E.jsx("div",{className:ji.exchangeUploadProgressInner,style:{width:`${Math.floor(i*100)}%`,backgroundColor:n}})})}const Ds={exchangeUploadButton:"univer-exchange-upload-button"};function Fi(e){const{onClick:n,children:t,className:i}=e;return E.jsx("button",{className:`${Ds.exchangeUploadButton} ${i}`,type:"button",onClick:n,children:t})}var Os=Object.defineProperty,As=Object.getOwnPropertyDescriptor,Hs=(e,n,t,i)=>{for(var a=i>1?void 0:i?As(n,t):n,r=e.length-1,o;r>=0;r--)(o=e[r])&&(a=(i?o(n,t,a):o(a))||a);return i&&a&&Os(n,t,a),a},ve=(e,n)=>(t,i)=>n(t,i,e);const dt=d.createIdentifier("univer-pro.exchange-client.operate.service");x.ExchangeOperateService=class extends d.Disposable{constructor(t,i,a,r,o,s,_){super();K(this,"_interrupted",!1);this._univerInstanceService=t,this._messageService=i,this._localeService=a,this._exchangeService=r,this._uploadNotificationService=o,this._uploadProgressService=s,this._logService=_,this.disposeWithMe(d.toDisposable(this._exchangeService.requestState$.subscribe(l=>{var c;((c=l.error)==null?void 0:c.code)===L.OK?this._uploadProgressService.pushTask({count:1}):this._showNetworkError(l.error)})))}interrupt(){this._uploadProgressService.stop(),this._uploadNotificationService.updateState(P.ERROR),this._interrupted=!0}async uploadFileToUnitId(t){throw new Error("Method not implemented.")}async importDOCXToUnitId(){const t=await ct([A.UNIVER_DOC]);if(t)return this._importFileToUnitId(t[0],A.UNIVER_DOC)}importDOCXToSnapshot(){throw new Error("Method not implemented.")}exportDOCXByUnitId(t,i,a){throw new Error("Method not implemented.")}exportDOCXBySnapshot(){throw new Error("Method not implemented.")}async importXLSXToUnitId(){const t=await ct([A.UNIVER_SHEET]);if(t)return this._importFileToUnitId(t[0],A.UNIVER_SHEET)}async importXLSXToSnapshot(){const t=await ct([A.UNIVER_SHEET]);if(!t)return;this._showUploadMessage(Z.MessageType.Info);const i=await this._exchangeService.importXLSXToSnapshot(t[0]);i&&(this._refresh(i),this._showUploadMessage(Z.MessageType.Success))}async exportXLSXByUnitId(t,i){this._showDownloadMessage(Z.MessageType.Info);const a=await this._exchangeService.exportXLSXByUnitId(t||this._getUnitID());a&&(Vt(a,i||this._getUnitName(a),"xlsx"),this._showDownloadMessage(Z.MessageType.Success))}async exportXLSXBySnapshot(){this._showDownloadMessage(Z.MessageType.Info);const t=await this._getUnitJson(),i=await this._exchangeService.exportXLSXBySnapshot(t);i&&(Vt(i,this._getUnitName(i),"xlsx"),this._showDownloadMessage(Z.MessageType.Success))}registerLink(t){this._getLinkByUnitId=t}async _importFileToUnitId(t,i){this._uploadNotificationService.show(),this._uploadNotificationService.updateState(P.UPLOADING),this._uploadProgressService.insertTaskCount(4),this._uploadProgressService.pushTask({count:1});const a=await this._exchangeService.importFileToUnitId(t,i);if(this._interrupted){this._interrupted=!1;return}if(!a){this._uploadProgressService.stop(),this._uploadNotificationService.updateState(P.ERROR);return}const r={link:this._getLinkByUnitId(a,i),name:t.name,type:i};return this._uploadNotificationService.pushLink(r),this._uploadProgressService.complete(),this._uploadNotificationService.updateState(P.SUCCESS),a}_getUnitID(){return this._univerInstanceService.getCurrentUnitForType(d.UniverInstanceType.UNIVER_SHEET).getUnitId()}_getUnitName(t){return t.name.split(".").shift()||this._univerInstanceService.getCurrentUnitForType(d.UniverInstanceType.UNIVER_SHEET).getActiveSpreadsheet().getName()||document.title}async _getUnitJson(){return this._univerInstanceService.getCurrentUnitForType(d.UniverInstanceType.UNIVER_SHEET).getSnapshot()}_getLinkByUnitId(t,i){const a=new URL(window.location.href);return a.searchParams.set("unit",t),a.searchParams.set("type",`${i}`),a.toString()}_refresh(t){const i=this._univerInstanceService.getCurrentUnitForType(d.UniverInstanceType.UNIVER_SHEET).getUnitId();this._univerInstanceService.disposeUnit(i),this._univerInstanceService.createUnit(d.UniverInstanceType.UNIVER_SHEET,t)}_showNetworkError(t){if(t){const{code:i}=t;switch(i){case L.CONNECTOR_DATA_TOO_LARGE:this._messageService.show({type:Z.MessageType.Error,content:this._localeService.t("exchange.tooLarge")});break;case L.INTERNAL_ERROR:this._messageService.show({type:Z.MessageType.Error,content:this._localeService.t("exchange.internalError")});break;default:this._messageService.show({type:Z.MessageType.Error,content:this._localeService.t("exchange.networkError")});break}return null}return this._messageService.show({type:Z.MessageType.Error,content:this._localeService.t("exchange.networkError")}),null}_showDownloadMessage(t){let i="";switch(t){case Z.MessageType.Success:i=this._localeService.t("exchange.downloadSuccess");break;case Z.MessageType.Info:i=this._localeService.t("exchange.downloading");break}this._messageService.show({type:t,content:i})}_showUploadMessage(t){let i="";switch(t){case Z.MessageType.Success:i=this._localeService.t("exchange.uploadSuccess");break;case Z.MessageType.Info:i=this._localeService.t("exchange.uploading");break}this._messageService.show({type:t,content:i})}},x.ExchangeOperateService=Hs([ve(0,d.Inject(d.IUniverInstanceService)),ve(1,Ye.IMessageService),ve(2,d.Inject(d.LocaleService)),ve(3,d.Inject(Yt)),ve(4,d.Inject(ft)),ve(5,d.Inject(_t)),ve(6,d.ILogService)],x.ExchangeOperateService);const zs={};function Ms(){const e=d.useDependency(dt),n=d.useDependency(d.LocaleService);function t(){e.interrupt()}return E.jsx(Fi,{className:zs.exchangeUploadCancel,onClick:t,children:n.t("exchange.cancel")})}function Ps(){const e=d.useDependency(d.ThemeService),n=d.useDependency(d.LocaleService),t=e.getCurrentTheme().primaryColor;return E.jsxs("div",{className:qt.exchangeUploading,children:[E.jsx("span",{className:qt.exchangeUploadingTip,children:n.t("exchange.wait")}),E.jsx("div",{className:qt.exchangeUploadingProgress,children:E.jsx(Cs,{barColor:t})}),E.jsx(Ms,{})]})}const _e={exchangeLinkList:"univer-exchange-link-list",exchangeLinkListInner:"univer-exchange-link-list-inner",exchangeLinkListInnerItemLink:"univer-exchange-link-list-inner-item-link",exchangeLinkListInnerItemLinkContent:"univer-exchange-link-list-inner-item-link-content",exchangeLinkListInnerItemLinkIcon:"univer-exchange-link-list-inner-item-link-icon",exchangeLinkListInnerItemLinkName:"univer-exchange-link-list-inner-item-link-name",exchangeLinkListInnerItemLinkDirect:"univer-exchange-link-list-inner-item-link-direct"};function Zs(e){const{list:n}=e;function t(i){switch(i){case 1:return E.jsx(Ai,{});case 2:return E.jsx(Zi,{});case 3:return E.jsx(Mi,{});default:return null}}return E.jsx("div",{className:_e.exchangeLinkList,children:E.jsx("ul",{className:_e.exchangeLinkListInner,children:n.map((i,a)=>E.jsx("li",{className:_e.exchangeLinkListInnerItem,children:E.jsxs("a",{className:_e.exchangeLinkListInnerItemLink,href:i.link,target:"_blank",rel:"noreferrer",children:[E.jsxs("span",{className:_e.exchangeLinkListInnerItemLinkContent,children:[E.jsx("span",{className:_e.exchangeLinkListInnerItemLinkIcon,children:t(i.type)}),E.jsx(Z.Tooltip,{showIfEllipsis:!0,title:i.name,children:E.jsx("span",{className:_e.exchangeLinkListInnerItemLinkName,children:i.name})})]}),E.jsx("span",{className:_e.exchangeLinkListInnerItemLinkDirect,children:E.jsx(zi,{})})]})},a))})})}function $i(){const e=d.useDependency(dt),n=d.useDependency(d.LocaleService);function t(){e.importXLSXToUnitId()}return E.jsx(Fi,{onClick:t,children:n.t("exchange.uploadAgain")})}const Bi={exchangeUploadError:"univer-exchange-upload-error",exchangeUploadErrorTip:"univer-exchange-upload-error-tip"};function js(){const e=d.useDependency(d.LocaleService);return E.jsxs("div",{className:Bi.exchangeUploadError,children:[E.jsx("span",{className:Bi.exchangeUploadErrorTip,children:e.t("exchange.interrupt")}),E.jsx($i,{})]})}const Gi={exchangeUploadSuccess:"univer-exchange-upload-success",exchangeUploadSuccessTip:"univer-exchange-upload-success-tip"};function Fs(e){const{count:n}=e,t=d.useDependency(d.LocaleService);return E.jsxs("div",{className:Gi.exchangeUploadSuccess,children:[E.jsx("span",{className:Gi.exchangeUploadSuccessTip,children:t.t("exchange.uploadSuccessTip",`${n}`)}),E.jsx($i,{})]})}const Q={exchangeUploadNotification:"univer-exchange-upload-notification",exchangeUploadNotificationHeader:"univer-exchange-upload-notification-header",exchangeUploadNotificationHeaderTitle:"univer-exchange-upload-notification-header-title",exchangeUploadNotificationHeaderIcon:"univer-exchange-upload-notification-header-icon",exchangeUploadNotificationHeaderIconSuccess:"univer-exchange-upload-notification-header-icon-success",exchangeUploadNotificationHeaderIconUploading:"univer-exchange-upload-notification-header-icon-uploading",exchangeUploadNotificationHeaderIconError:"univer-exchange-upload-notification-header-icon-error",exchangeUploadNotificationHeaderText:"univer-exchange-upload-notification-header-text",exchangeUploadNotificationHeaderClose:"univer-exchange-upload-notification-header-close"},$s={[P.SUCCESS]:E.jsx(Pi,{className:Q.exchangeUploadNotificationHeaderIconSuccess}),[P.UPLOADING]:E.jsx(Di,{className:Q.exchangeUploadNotificationHeaderIconUploading}),[P.ERROR]:E.jsx(Hi,{className:Q.exchangeUploadNotificationHeaderIconError})};function Bs(){const[e,n]=C.useState(P.UPLOADING),[t,i]=C.useState(!1),[a,r]=C.useState([]),o=d.useDependency(ft),s=d.useDependency(d.LocaleService);C.useEffect(()=>{const c=o.visible$.subscribe(f=>{i(f)}),w=o.list$.subscribe(f=>{r(f)}),h=o.state$.subscribe(f=>{n(f)});return()=>{c.unsubscribe(),w.unsubscribe(),h.unsubscribe()}},[]);function _(){i(!1)}function l(c){switch(c){case P.SUCCESS:return s.t("exchange.uploadSuccess");case P.UPLOADING:return s.t("exchange.uploading");case P.ERROR:return s.t("exchange.unknownMistake");default:return""}}return t&&E.jsxs("div",{className:Q.exchangeUploadNotification,children:[E.jsxs("div",{className:Q.exchangeUploadNotificationHeader,children:[E.jsxs("span",{className:Q.exchangeUploadNotificationHeaderTitle,children:[E.jsx("span",{className:Q.exchangeUploadNotificationHeaderIcon,children:$s[e]}),E.jsx("span",{className:Q.exchangeUploadNotificationHeaderText,children:l(e)})]}),E.jsx("span",{className:Q.exchangeUploadNotificationHeaderClose,onClick:_,children:E.jsx(Oi,{})})]}),E.jsxs("div",{className:Q.exchangeUploadNotificationContent,children:[e===P.UPLOADING&&E.jsx(Ps,{}),e===P.ERROR&&E.jsx(js,{}),a.length>0&&E.jsx(Zs,{list:a}),e===P.SUCCESS&&E.jsx(Fs,{count:a.length})]})]})}function Xi(){return E.jsx(Bs,{})}var Gs=Object.defineProperty,Xs=Object.getOwnPropertyDescriptor,Vs=(e,n,t,i)=>{for(var a=i>1?void 0:i?Xs(n,t):n,r=e.length-1,o;r>=0;r--)(o=e[r])&&(a=(i?o(n,t,a):o(a))||a);return i&&a&&Gs(n,t,a),a},Vi=(e,n)=>(t,i)=>n(t,i,e);let ut=class extends d.Disposable{constructor(e,n){super(),this._injector=e,this._uiPartsService=n,this._registerComponents()}_registerComponents(){this.disposeWithMe(this._uiPartsService.registerComponent(Ye.BuiltInUIPart.CONTENT,()=>d.connectInjector(Xi,this._injector)))}};ut=Vs([d.OnLifecycle(d.LifecycleStages.Ready,ut),Vi(0,d.Inject(d.Injector)),Vi(1,Ye.IUIPartsService)],ut);var Ks=Object.defineProperty,Ys=Object.getOwnPropertyDescriptor,qs=(e,n,t,i)=>{for(var a=i>1?void 0:i?Ys(n,t):n,r=e.length-1,o;r>=0;r--)(o=e[r])&&(a=(i?o(n,t,a):o(a))||a);return i&&a&&Ks(n,t,a),a},Ki=(e,n)=>(t,i)=>n(t,i,e);const Js="EXCHANGE_CLIENT_PLUGIN";x.UniverExchangeClientPlugin=(Jt=class extends d.Plugin{constructor(n,t,i){super(),this._=n,this._injector=t,this._localeService=i}initialize(){[[ut],[dt,{useClass:x.ExchangeOperateService}],[Yt,{useClass:x.ExchangeService}],[Kt,{useClass:x.RequestService}],[ft,{useClass:ki}],[_t,{useClass:yi}]].forEach(t=>this._injector.add(t)),this._injector.has(be.HTTPService)||this._injector.add([be.HTTPService]),this._injector.has(be.IHTTPImplementation)||this._injector.add([be.IHTTPImplementation,{useClass:be.XHRHTTPImplementation}])}onReady(){this.initialize()}},K(Jt,"pluginName",Js),Jt),x.UniverExchangeClientPlugin=qs([Ki(1,d.Inject(d.Injector)),Ki(2,d.Inject(d.LocaleService))],x.UniverExchangeClientPlugin),x.EXCHANGE_EXPORT_SERVER_URL_KEY=Ni,x.EXCHANGE_GET_TASK_SERVER_URL_KEY=Ui,x.EXCHANGE_IMPORT_SERVER_URL_KEY=Ii,x.EXCHANGE_SIGN_URL_SERVER_URL_KEY=Ri,x.EXCHANGE_UPLOAD_FILE_SERVER_URL_KEY=mi,x.IExchangeOperateService=dt,x.IExchangeService=Yt,x.IRequestService=Kt,x.IUploadNotificationService=ft,x.IUploadProgressService=_t,x.UploadNotificationContainer=Xi,x.UploadNotificationService=ki,x.UploadNotificationState=P,x.UploadProgressService=yi,x.downloadFile=Vt,x.getUniverTypeByFile=Bo,x.getUploadFile=ct,Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})});
