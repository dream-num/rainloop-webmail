(function(_0x457c9f,_0x58c03f){const _0x55b938=_0x4438,_0x111602=_0x457c9f();while(!![]){try{const _0x56b023=-parseInt(_0x55b938(0x21d))/0x1+parseInt(_0x55b938(0x523))/0x2*(parseInt(_0x55b938(0x24b))/0x3)+-parseInt(_0x55b938(0x42f))/0x4*(-parseInt(_0x55b938(0x4c2))/0x5)+parseInt(_0x55b938(0x558))/0x6*(parseInt(_0x55b938(0x492))/0x7)+-parseInt(_0x55b938(0x51c))/0x8*(-parseInt(_0x55b938(0x4af))/0x9)+parseInt(_0x55b938(0x29f))/0xa*(-parseInt(_0x55b938(0x369))/0xb)+parseInt(_0x55b938(0x4f8))/0xc*(-parseInt(_0x55b938(0x401))/0xd);if(_0x56b023===_0x58c03f)break;else _0x111602['push'](_0x111602['shift']());}catch(_0x189fdb){_0x111602['push'](_0x111602['shift']());}}}(_0x1b3e,0x81705),function(_0xd8677c,_0x118d86){const _0x1ca576=_0x4438;typeof exports=='object'&&typeof module<'u'?_0x118d86(exports,require(_0x1ca576(0x37e)),require(_0x1ca576(0x32a)),require(_0x1ca576(0x24d)),require(_0x1ca576(0x2aa)),require(_0x1ca576(0x36f)),require('rxjs'),require('rxjs/operators'),require(_0x1ca576(0x474)),require('@univerjs/network'),require(_0x1ca576(0x44a)),require(_0x1ca576(0x563)),require(_0x1ca576(0x4e8)),require(_0x1ca576(0x4a4)),require('@univerjs/sheets-ui'),require(_0x1ca576(0x237)),require('clsx'),require(_0x1ca576(0x346)),require(_0x1ca576(0x343))):typeof define==_0x1ca576(0x2c0)&&define[_0x1ca576(0x514)]?define([_0x1ca576(0x4e7),_0x1ca576(0x37e),_0x1ca576(0x32a),_0x1ca576(0x24d),_0x1ca576(0x2aa),_0x1ca576(0x36f),_0x1ca576(0x535),_0x1ca576(0x389),_0x1ca576(0x474),'@univerjs/network',_0x1ca576(0x44a),_0x1ca576(0x563),_0x1ca576(0x4e8),_0x1ca576(0x4a4),'@univerjs/sheets-ui',_0x1ca576(0x237),_0x1ca576(0x22a),_0x1ca576(0x346),_0x1ca576(0x343)],_0x118d86):(_0xd8677c=typeof globalThis<'u'?globalThis:_0xd8677c||self,_0x118d86(_0xd8677c[_0x1ca576(0x2be)]={},_0xd8677c[_0x1ca576(0x298)],_0xd8677c[_0x1ca576(0x590)],_0xd8677c['UniverDesign'],_0xd8677c['UniverUi'],_0xd8677c[_0x1ca576(0x377)],_0xd8677c[_0x1ca576(0x535)],_0xd8677c['rxjs'][_0x1ca576(0x43c)],_0xd8677c['UniverDocs'],_0xd8677c[_0x1ca576(0x1e7)],_0xd8677c[_0x1ca576(0x26f)],_0xd8677c[_0x1ca576(0x425)],_0xd8677c[_0x1ca576(0x280)],_0xd8677c[_0x1ca576(0x382)][_0x1ca576(0x295)],_0xd8677c['UniverSheetsUi'],_0xd8677c[_0x1ca576(0x26d)],_0xd8677c[_0x1ca576(0x22a)],_0xd8677c['UniverRpc'],_0xd8677c[_0x1ca576(0x2be)]));}(this,function(_0x11abd7,_0x207f05,_0x4aca4a,_0x2e1001,_0xd6a4eb,_0x245d5b,_0xb87526,_0x9f6f32,_0x23e2c7,_0x516ade,_0x44a76c,_0x1bdf92,_0x5337d8,_0x3426d0,_0x40f102,_0x18e53c,_0x1fc32a,_0x2bdf07,_0x239cf6){'use strict';const _0x216ec2=_0x4438;var _0x7c446a=Object['defineProperty'],_0x4e09c1=(_0x3b2513,_0x4e5681,_0x3d6836)=>_0x4e5681 in _0x3b2513?_0x7c446a(_0x3b2513,_0x4e5681,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x3d6836}):_0x3b2513[_0x4e5681]=_0x3d6836,_0x574c73=(_0x1eebcf,_0x23f478,_0x53ffa0)=>_0x4e09c1(_0x1eebcf,typeof _0x23f478!=_0x216ec2(0x3db)?_0x23f478+'':_0x23f478,_0x53ffa0);const _0x2a71a9=_0x216ec2(0x513),_0x5be84a='/universer-api/snapshot',_0x26db56='SNAPSHOT_URL_KEY',_0x4e28eb=_0x216ec2(0x30a),_0x1d407f=_0x216ec2(0x1fc),_0x4d7790=_0x216ec2(0x4b7),_0x4650ae=_0x216ec2(0x225),_0x4bf8c1=_0x216ec2(0x393),_0x3cfdb4=_0x216ec2(0x57b),_0x4d42bc=_0x216ec2(0x5a6),_0x1e09ef=_0x216ec2(0x302),_0xc11f9d=_0x216ec2(0x5ac),_0x165515=_0x216ec2(0x526),_0xa3ef5a='LOGIN_URL_KEY';var _0x407969=(_0x56e227=>(_0x56e227[_0x56e227['UNDEFINED']=0x0]='UNDEFINED',_0x56e227[_0x56e227['OK']=0x1]='OK',_0x56e227[_0x56e227[_0x216ec2(0x470)]=0x2]=_0x216ec2(0x470),_0x56e227[_0x56e227[_0x216ec2(0x47f)]=0x3]=_0x216ec2(0x47f),_0x56e227[_0x56e227[_0x216ec2(0x524)]=0x4]=_0x216ec2(0x524),_0x56e227[_0x56e227[_0x216ec2(0x2f7)]=0x5]=_0x216ec2(0x2f7),_0x56e227[_0x56e227[_0x216ec2(0x242)]=0x6]=_0x216ec2(0x242),_0x56e227[_0x56e227[_0x216ec2(0x2ee)]=0x7]=_0x216ec2(0x2ee),_0x56e227[_0x56e227['TOO_MANY_REQUESTS']=0x8]=_0x216ec2(0x5ad),_0x56e227[_0x56e227[_0x216ec2(0x230)]=0x9]=_0x216ec2(0x230),_0x56e227[_0x56e227[_0x216ec2(0x23b)]=0x1389]=_0x216ec2(0x23b),_0x56e227[_0x56e227['SNAPSHOT_INVALID_SNAPSHOT']=0x1771]='SNAPSHOT_INVALID_SNAPSHOT',_0x56e227[_0x56e227[_0x216ec2(0x399)]=0x1772]=_0x216ec2(0x399),_0x56e227[_0x56e227[_0x216ec2(0x37d)]=0x1b59]='APPLY_REJECT',_0x56e227[_0x56e227[_0x216ec2(0x4b3)]=0x1b5a]=_0x216ec2(0x4b3),_0x56e227[_0x56e227[_0x216ec2(0x415)]=0x1b5b]=_0x216ec2(0x415),_0x56e227[_0x56e227[_0x216ec2(0x50e)]=0x1b5c]='APPLY_PERMISSION_DENIED',_0x56e227[_0x56e227[_0x216ec2(0x2d1)]=0x1f41]='CONNECTOR_DATA_TOO_LARGE',_0x56e227[_0x56e227[_0x216ec2(0x385)]=0x2329]=_0x216ec2(0x385),_0x56e227[_0x56e227[_0x216ec2(0x1ff)]=0x232a]=_0x216ec2(0x1ff),_0x56e227[_0x56e227[_0x216ec2(0x510)]=0x232b]=_0x216ec2(0x510),_0x56e227[_0x56e227[_0x216ec2(0x2f4)]=0x232c]=_0x216ec2(0x2f4),_0x56e227[_0x56e227['LICENSE_DISTRO_REJECTED']=0x232d]=_0x216ec2(0x1c4),_0x56e227[_0x56e227[_0x216ec2(0x480)]=0x2711]=_0x216ec2(0x480),_0x56e227[_0x56e227['YUUMI_URL_COL_OUT_OF_RANGE']=0x2712]='YUUMI_URL_COL_OUT_OF_RANGE',_0x56e227[_0x56e227['UNRECOGNIZED']=-0x1]=_0x216ec2(0x58a),_0x56e227))(_0x407969||{}),_0x18cf2f=(_0x3c32e3=>(_0x3c32e3[_0x3c32e3['UNIVER_UNKNOWN']=0x0]=_0x216ec2(0x24c),_0x3c32e3[_0x3c32e3[_0x216ec2(0x27f)]=0x1]=_0x216ec2(0x27f),_0x3c32e3[_0x3c32e3[_0x216ec2(0x429)]=0x2]=_0x216ec2(0x429),_0x3c32e3[_0x3c32e3[_0x216ec2(0x278)]=0x3]=_0x216ec2(0x278),_0x3c32e3[_0x3c32e3[_0x216ec2(0x58a)]=-0x1]=_0x216ec2(0x58a),_0x3c32e3))(_0x18cf2f||{}),_0x416d8c=(_0x1e3a30=>(_0x1e3a30[_0x1e3a30[_0x216ec2(0x3c8)]=0x0]='UNKNOWN_CMD',_0x1e3a30[_0x1e3a30['HELLO']=0x1]='HELLO',_0x1e3a30[_0x1e3a30[_0x216ec2(0x435)]=0x2]=_0x216ec2(0x435),_0x1e3a30[_0x1e3a30['LEAVE']=0x3]=_0x216ec2(0x2f3),_0x1e3a30[_0x1e3a30[_0x216ec2(0x2ba)]=0x4]=_0x216ec2(0x2ba),_0x1e3a30[_0x1e3a30[_0x216ec2(0x541)]=0x5]=_0x216ec2(0x541),_0x1e3a30[_0x1e3a30['RECV']=0x6]=_0x216ec2(0x36b),_0x1e3a30[_0x1e3a30['UNRECOGNIZED']=-0x1]='UNRECOGNIZED',_0x1e3a30))(_0x416d8c||{}),_0x3ed514=(_0x1a5c3f=>(_0x1a5c3f[_0x1a5c3f['UNKNOWN_CODE']=0x0]='UNKNOWN_CODE',_0x1a5c3f[_0x1a5c3f['OK']=0x1]='OK',_0x1a5c3f[_0x1a5c3f['FAIL']=0x2]=_0x216ec2(0x1ea),_0x1a5c3f[_0x1a5c3f[_0x216ec2(0x58a)]=-0x1]=_0x216ec2(0x58a),_0x1a5c3f))(_0x3ed514||{}),_0x13e83b=Object[_0x216ec2(0x3d2)],_0x53885e=Object[_0x216ec2(0x498)],_0x10d502=(_0x26bee3,_0xabbfed,_0x17aee4,_0x5bec31)=>{const _0x53d9e9=_0x216ec2;for(var _0x47e07f=_0x5bec31>0x1?void 0x0:_0x5bec31?_0x53885e(_0xabbfed,_0x17aee4):_0xabbfed,_0x2f5d3b=_0x26bee3[_0x53d9e9(0x48b)]-0x1,_0x6da9e9;_0x2f5d3b>=0x0;_0x2f5d3b--)(_0x6da9e9=_0x26bee3[_0x2f5d3b])&&(_0x47e07f=(_0x5bec31?_0x6da9e9(_0xabbfed,_0x17aee4,_0x47e07f):_0x6da9e9(_0x47e07f))||_0x47e07f);return _0x5bec31&&_0x47e07f&&_0x13e83b(_0xabbfed,_0x17aee4,_0x47e07f),_0x47e07f;},_0x43527f=(_0x22f146,_0xfa39de)=>(_0x4ca605,_0x254859)=>_0xfa39de(_0x4ca605,_0x254859,_0x22f146);let _0x35ecb0=class extends _0x207f05[_0x216ec2(0x1c5)]{constructor(_0x1fc2de,_0x10986b){const _0x12b16b=_0x216ec2;super(),_0x574c73(this,_0x12b16b(0x521),new Map()),(this['_univerInstanceService']=_0x1fc2de,this[_0x12b16b(0x25a)]=_0x10986b,this[_0x12b16b(0x38d)](_0x207f05[_0x12b16b(0x232)](_0xb87526[_0x12b16b(0x427)](this[_0x12b16b(0x255)][_0x12b16b(0x4fa)](_0x207f05['UniverInstanceType'][_0x12b16b(0x429)])[_0x12b16b(0x2bb)](_0x9f6f32[_0x12b16b(0x386)](_0x47042f=>_0x47042f[_0x12b16b(0x559)]())),this[_0x12b16b(0x255)]['getTypeOfUnitDisposed$'](_0x207f05[_0x12b16b(0x583)][_0x12b16b(0x27f)])['pipe'](_0x9f6f32[_0x12b16b(0x386)](_0x5ab8ac=>_0x5ab8ac['getUnitId']())),this['_univerInstanceService'][_0x12b16b(0x4fa)](_0x207f05['UniverInstanceType'][_0x12b16b(0x278)])['pipe'](_0x9f6f32[_0x12b16b(0x386)](_0x57990a=>_0x57990a[_0x12b16b(0x559)]())))[_0x12b16b(0x314)](_0x57271f=>this[_0x12b16b(0x459)](_0x57271f)))));}[_0x216ec2(0x3a6)](_0x40fdeb){const _0x12318c=_0x216ec2;this[_0x12318c(0x25a)][_0x12318c(0x3a6)](_0x40fdeb);}[_0x216ec2(0x34c)](){const _0x3db779=_0x216ec2;return this[_0x3db779(0x25a)][_0x3db779(0x34c)]();}[_0x216ec2(0x58c)](_0x2441cd,_0x2be523){const _0x65e41f=_0x216ec2;let _0x26fa44=this[_0x65e41f(0x521)][_0x65e41f(0x458)](_0x2441cd);_0x26fa44||(_0x26fa44=new _0x516ab8(),this['_roomMembers'][_0x65e41f(0x252)](_0x2441cd,_0x26fa44)),_0x26fa44[_0x65e41f(0x58c)](_0x2be523);}[_0x216ec2(0x482)](_0x831959,_0x5e944d){const _0x597e6b=_0x216ec2,_0x171012=this[_0x597e6b(0x521)][_0x597e6b(0x458)](_0x831959);_0x171012&&_0x171012[_0x597e6b(0x482)](_0x5e944d);}[_0x216ec2(0x45e)](_0x27f521){const _0x29614c=_0x216ec2;return this[_0x29614c(0x521)][_0x29614c(0x458)](_0x27f521);}[_0x216ec2(0x1f6)](_0x2608e4,_0x5f8564){const _0x429abb=_0x216ec2,_0x2d9ce6=this[_0x429abb(0x521)]['get'](_0x2608e4);if(_0x2d9ce6)return _0x2d9ce6[_0x429abb(0x1f6)](_0x5f8564);}[_0x216ec2(0x459)](_0xd8fd97){const _0xd9f9a0=_0x216ec2,_0x40476c=this['_roomMembers'][_0xd9f9a0(0x458)](_0xd8fd97);_0x40476c&&(_0x40476c[_0xd9f9a0(0x3a0)](),this[_0xd9f9a0(0x521)][_0xd9f9a0(0x3b1)](_0xd8fd97));}[_0x216ec2(0x3a0)](){const _0x570fcd=_0x216ec2;this[_0x570fcd(0x521)][_0x570fcd(0x43f)](_0xc774ae=>_0xc774ae[_0x570fcd(0x3a0)]()),this[_0x570fcd(0x521)][_0x570fcd(0x434)]();}};_0x35ecb0=_0x10d502([_0x43527f(0x0,_0x207f05[_0x216ec2(0x1f4)]),_0x43527f(0x1,_0x207f05[_0x216ec2(0x511)](_0x207f05['UserManagerService']))],_0x35ecb0);class _0x516ab8 extends _0x207f05['Disposable']{constructor(){const _0x115a6c=_0x216ec2;super(...arguments),_0x574c73(this,_0x115a6c(0x45f),new Map());}[_0x216ec2(0x3a0)](){const _0x4ddd91=_0x216ec2;this['_members'][_0x4ddd91(0x434)]();}[_0x216ec2(0x58c)](_0x5d3e19){const _0x593a64=_0x216ec2;this['_members'][_0x593a64(0x252)](_0x5d3e19[_0x593a64(0x305)],_0x5d3e19);}[_0x216ec2(0x482)](_0x7e5399){const _0x3c345f=_0x216ec2;this[_0x3c345f(0x45f)][_0x3c345f(0x3b1)](_0x7e5399);}[_0x216ec2(0x1f6)](_0xfe383c){return this['_members']['get'](_0xfe383c);}}function _0x3ae630(_0x59f00b){const _0x100329=_0x216ec2;var _0x38c45c,_0x40f9c6,_0x3f2555,_0x4a115d;const _0x567931=_0x59f00b[_0x100329(0x2fd)],_0x5887b8=JSON[_0x100329(0x552)](_0x567931);switch(_0x5887b8[_0x100329(0x39b)]){case _0x416d8c['HEARTBEAT']:case _0x416d8c[_0x100329(0x3a1)]:{const _0x124612=_0x5887b8[_0x100329(0x51a)];return{..._0x5887b8,'data':_0x124612,'cmd':_0x5887b8[_0x100329(0x39b)]};}case _0x416d8c[_0x100329(0x435)]:{const _0x194946=_0x5887b8['joinRsp'];return{..._0x5887b8,'data':_0x194946,'cmd':_0x5887b8['cmd']};}case _0x416d8c[_0x100329(0x36b)]:{const _0x25cc76=_0x5887b8[_0x100329(0x4c1)];switch(_0x25cc76[_0x100329(0x5a3)]){case _0x245d5b['CollaborationEvent'][_0x100329(0x287)]:return{..._0x5887b8,'data':{..._0x25cc76,'data':(_0x38c45c=_0x25cc76['permissionRejEvent'])==null?void 0x0:_0x38c45c['cs']},'cmd':_0x5887b8[_0x100329(0x39b)]};case _0x245d5b[_0x100329(0x46a)]['CHANGESET_ACK']:return{..._0x5887b8,'data':{..._0x25cc76,'data':(_0x40f9c6=_0x25cc76['csAckEvent'])==null?void 0x0:_0x40f9c6['cs']},'cmd':_0x5887b8[_0x100329(0x39b)]};case _0x245d5b['CollaborationEvent'][_0x100329(0x203)]:return{..._0x5887b8,'data':{..._0x25cc76,'data':(_0x3f2555=_0x25cc76[_0x100329(0x4bc)])==null?void 0x0:_0x3f2555['cs']},'cmd':_0x5887b8[_0x100329(0x39b)]};case _0x245d5b['CollaborationEvent'][_0x100329(0x32b)]:return{..._0x5887b8,'data':{..._0x25cc76,'data':(_0x4a115d=_0x25cc76[_0x100329(0x361)])==null?void 0x0:_0x4a115d['cs']},'cmd':_0x5887b8['cmd']};case _0x245d5b[_0x100329(0x46a)]['UPDATE_CURSOR']:return{..._0x5887b8,'data':{..._0x25cc76,'data':_0x25cc76[_0x100329(0x395)]},'cmd':_0x5887b8[_0x100329(0x39b)]};case _0x245d5b['CollaborationEvent'][_0x100329(0x4ff)]:return{..._0x5887b8,'data':{..._0x25cc76,'data':_0x25cc76[_0x100329(0x1d1)]},'cmd':_0x5887b8[_0x100329(0x39b)]};case _0x245d5b[_0x100329(0x46a)][_0x100329(0x4e0)]:return{..._0x5887b8,'data':{..._0x25cc76,'data':_0x25cc76[_0x100329(0x545)]},'cmd':_0x5887b8[_0x100329(0x39b)]};case _0x245d5b[_0x100329(0x46a)][_0x100329(0x5bc)]:return{..._0x5887b8,'data':{..._0x25cc76,'data':_0x25cc76[_0x100329(0x40d)]},'cmd':_0x5887b8[_0x100329(0x39b)]};case _0x245d5b[_0x100329(0x46a)][_0x100329(0x477)]:case _0x245d5b[_0x100329(0x46a)]['LIVESHARE_OPERATION']:return{..._0x5887b8,'data':{..._0x25cc76,'data':_0x25cc76['liveShareOperation']},'cmd':_0x5887b8[_0x100329(0x39b)]};case _0x245d5b[_0x100329(0x46a)][_0x100329(0x461)]:return{..._0x5887b8,'data':{..._0x25cc76,'data':_0x25cc76[_0x100329(0x40d)]},'cmd':_0x5887b8[_0x100329(0x39b)]};case _0x245d5b[_0x100329(0x46a)][_0x100329(0x34d)]:return{..._0x5887b8,'data':_0x25cc76,'cmd':_0x5887b8[_0x100329(0x39b)]};case _0x245d5b[_0x100329(0x46a)][_0x100329(0x570)]:return{..._0x5887b8,'data':{..._0x25cc76,'data':_0x25cc76[_0x100329(0x2c5)]},'cmd':_0x5887b8['cmd']};case _0x245d5b[_0x100329(0x46a)][_0x100329(0x55a)]:return{..._0x5887b8,'data':{..._0x25cc76,'data':_0x25cc76[_0x100329(0x351)]},'cmd':_0x5887b8[_0x100329(0x39b)]};case _0x245d5b['CollaborationEvent']['SHOULD_CLOSE_CONN']:return{..._0x5887b8,'data':{..._0x25cc76,'data':_0x25cc76['shouldCloseConn']},'cmd':_0x5887b8['cmd']};default:return _0x5887b8;}}default:return _0x5887b8;}}function _0x3f25e2(_0x2006b8){const _0x37fbfa=_0x216ec2;switch(_0x2006b8['cmd']){case _0x416d8c['HEARTBEAT']:case _0x416d8c[_0x37fbfa(0x3a1)]:return JSON[_0x37fbfa(0x562)]({'cmd':_0x2006b8[_0x37fbfa(0x39b)],'routeKey':_0x2006b8['routeKey']});case _0x416d8c[_0x37fbfa(0x2ba)]:{let _0x5aaec9;switch(_0x2006b8[_0x37fbfa(0x2fd)][_0x37fbfa(0x5a3)]){case _0x245d5b['CollaborationEvent'][_0x37fbfa(0x29a)]:{_0x5aaec9={'eventID':_0x245d5b[_0x37fbfa(0x46a)]['UPDATE_CURSOR'],'updateCursorEvent':_0x2006b8[_0x37fbfa(0x2fd)]['data']};break;}case _0x245d5b[_0x37fbfa(0x46a)][_0x37fbfa(0x4e0)]:{_0x5aaec9={'eventID':_0x245d5b[_0x37fbfa(0x46a)][_0x37fbfa(0x4e0)],'leaveEvent':_0x2006b8['data'][_0x37fbfa(0x2fd)]};break;}case _0x245d5b[_0x37fbfa(0x46a)][_0x37fbfa(0x4ff)]:{_0x5aaec9={'eventID':_0x245d5b['CollaborationEvent']['USERS_ENTER'],'joinEvent':_0x2006b8['data'][_0x37fbfa(0x2fd)]};break;}case _0x245d5b[_0x37fbfa(0x46a)][_0x37fbfa(0x5bc)]:{_0x5aaec9={'eventID':_0x245d5b[_0x37fbfa(0x46a)][_0x37fbfa(0x5bc)],'liveShareNewHost':_0x2006b8[_0x37fbfa(0x2fd)][_0x37fbfa(0x2fd)]};break;}case _0x245d5b[_0x37fbfa(0x46a)][_0x37fbfa(0x296)]:{_0x5aaec9={'eventID':_0x245d5b[_0x37fbfa(0x46a)][_0x37fbfa(0x296)],'liveShareOperation':_0x2006b8[_0x37fbfa(0x2fd)][_0x37fbfa(0x2fd)]};break;}case _0x245d5b[_0x37fbfa(0x46a)]['LIVESHARE_TERMINATE']:{_0x5aaec9={'eventID':_0x245d5b[_0x37fbfa(0x46a)]['LIVESHARE_TERMINATE'],'liveShareTerminate':_0x2006b8[_0x37fbfa(0x2fd)][_0x37fbfa(0x2fd)]};break;}case _0x245d5b['CollaborationEvent'][_0x37fbfa(0x2f0)]:{_0x5aaec9={'eventID':_0x245d5b['CollaborationEvent'][_0x37fbfa(0x2f0)],'liveShareRequestHost':_0x2006b8[_0x37fbfa(0x2fd)]['data']};break;}case _0x245d5b[_0x37fbfa(0x46a)][_0x37fbfa(0x477)]:{_0x5aaec9={'eventID':_0x245d5b[_0x37fbfa(0x46a)]['LIVESHARE_FETCH_OPERATIONS']};break;}default:_0x5aaec9={'eventID':_0x2006b8['data']['eventID']};}return JSON[_0x37fbfa(0x562)]({'cmd':_0x2006b8[_0x37fbfa(0x39b)],'routeKey':_0x2006b8[_0x37fbfa(0x3be)],'collaMsg':_0x5aaec9});}case _0x416d8c[_0x37fbfa(0x435)]:return JSON[_0x37fbfa(0x562)]({'cmd':_0x2006b8[_0x37fbfa(0x39b)],'routeKey':_0x2006b8[_0x37fbfa(0x3be)],'joinReq':_0x2006b8[_0x37fbfa(0x2fd)]});case _0x416d8c[_0x37fbfa(0x2f3)]:return JSON['stringify']({'cmd':_0x2006b8[_0x37fbfa(0x39b)],'routeKey':_0x2006b8['routeKey'],'leaveReq':_0x2006b8[_0x37fbfa(0x2fd)]});default:throw new Error('[serializeCombRequest]:\x20should\x20not\x20fall\x20into\x20default\x20branch!');}}var _0x406a23=Object[_0x216ec2(0x3d2)],_0x39fa80=Object[_0x216ec2(0x498)],_0x22d95e=(_0x5dcc9d,_0x587912,_0x4844ed,_0x3274c8)=>{for(var _0x5dcab3=_0x3274c8>0x1?void 0x0:_0x3274c8?_0x39fa80(_0x587912,_0x4844ed):_0x587912,_0x25f603=_0x5dcc9d['length']-0x1,_0x1e2390;_0x25f603>=0x0;_0x25f603--)(_0x1e2390=_0x5dcc9d[_0x25f603])&&(_0x5dcab3=(_0x3274c8?_0x1e2390(_0x587912,_0x4844ed,_0x5dcab3):_0x1e2390(_0x5dcab3))||_0x5dcab3);return _0x3274c8&&_0x5dcab3&&_0x406a23(_0x587912,_0x4844ed,_0x5dcab3),_0x5dcab3;},_0x10d117=(_0x39d283,_0x1b4967)=>(_0x23d880,_0x43e82d)=>_0x1b4967(_0x23d880,_0x43e82d,_0x39d283);const _0x240746=_0x207f05['createIdentifier']('univer-pro.collaboration-client-socket-service');function _0x2ce507(_0x2923a7,_0x28ca9c,_0x6ddd23){const _0x1f5819=_0x216ec2;return _0x2923a7+'/'+_0x28ca9c+_0x1f5819(0x3ce)+_0x6ddd23+_0x1f5819(0x4f7);}_0x11abd7[_0x216ec2(0x1d0)]=class{constructor(_0x376803,_0x38ef2f,_0x4ad244,_0x230c66,_0x4b9297){const _0x334068=_0x216ec2;this[_0x334068(0x2ca)]=_0x376803,this[_0x334068(0x311)]=_0x38ef2f,this[_0x334068(0x1e1)]=_0x4ad244,this['_logService']=_0x230c66,this[_0x334068(0x3b4)]=_0x4b9297;}[_0x216ec2(0x239)](_0x261caf){const _0x31d679=_0x216ec2,_0x4887fb=this[_0x31d679(0x311)]['createSocket'](_0x261caf);if(!_0x4887fb)throw new Error('[CollaborationSocketService]:\x20failed\x20to\x20create\x20socket!');const _0x3ca256=new _0x207f05[(_0x31d679(0x497))](),_0x4fb621=new _0xb87526[(_0x31d679(0x29e))]();_0x3ca256[_0x31d679(0x28f)](_0x207f05[_0x31d679(0x232)](_0x4887fb[_0x31d679(0x504)][_0x31d679(0x314)](_0x458fae=>_0x4fb621['next'](_0x458fae)))),_0x3ca256[_0x31d679(0x28f)](_0x207f05[_0x31d679(0x232)](()=>_0x4fb621[_0x31d679(0x39c)]()));const _0x13edca=new _0xb87526['Subject']();_0x3ca256[_0x31d679(0x28f)](_0x207f05[_0x31d679(0x232)](_0x4887fb[_0x31d679(0x328)][_0x31d679(0x314)](_0x2bb0e3=>_0x13edca[_0x31d679(0x473)](_0x2bb0e3)))),_0x3ca256[_0x31d679(0x28f)](_0x207f05['toDisposable'](()=>_0x13edca['complete']()));const _0x381939=new _0xb87526['Subject']();_0x3ca256[_0x31d679(0x28f)](_0x207f05[_0x31d679(0x232)](_0x4887fb['message$'][_0x31d679(0x314)](_0x1199c8=>{const _0xbe182d=_0x31d679,_0x557ec5=_0x3ae630(_0x1199c8);_0x381939[_0xbe182d(0x473)](_0x557ec5);}))),_0x3ca256[_0x31d679(0x28f)](_0x207f05[_0x31d679(0x232)](()=>_0x381939[_0x31d679(0x39c)]()));const _0x3f3fa7=()=>{const _0x291d82=_0x31d679;_0x13edca[_0x291d82(0x473)](new Event('connection\x20error')),_0x4fb621['next'](new CloseEvent(_0x291d82(0x495))),_0x383b92[_0x291d82(0x47c)]();},_0x383b92={'memberID':'','close$':_0x4fb621[_0x31d679(0x330)](),'error$':_0x13edca[_0x31d679(0x330)](),'open$':_0x4887fb[_0x31d679(0x3ff)],'message$':_0x381939[_0x31d679(0x330)](),'send':_0x459b31=>{const _0x3d2ef9=_0x31d679;if(_0x459b31['cmd']===_0x416d8c[_0x3d2ef9(0x2ba)]){if(_0x459b31[_0x3d2ef9(0x2fd)][_0x3d2ef9(0x5a3)]===_0x245d5b[_0x3d2ef9(0x46a)][_0x3d2ef9(0x41e)]){this[_0x3d2ef9(0x59d)](_0x383b92,_0x459b31[_0x3d2ef9(0x2fd)])['catch'](_0x1d5821=>{const _0x12577e=_0x3d2ef9;this[_0x12577e(0x352)][_0x12577e(0x2ff)](_0x1d5821),_0x3f3fa7();});return;}if(_0x459b31[_0x3d2ef9(0x2fd)][_0x3d2ef9(0x5a3)]===_0x245d5b[_0x3d2ef9(0x46a)][_0x3d2ef9(0x2f5)]){const _0x451d0d=_0x459b31[_0x3d2ef9(0x2fd)];this['_fetchMissChangesets'](_0x451d0d)[_0x3d2ef9(0x4bd)](_0x2cbf54=>{const _0x43c937=_0x3d2ef9;_0x381939[_0x43c937(0x473)]({'cmd':_0x416d8c[_0x43c937(0x36b)],'code':_0x3ed514['OK'],'routeKey':_0x451d0d['data'][_0x43c937(0x281)],'routeType':'','data':{'eventID':_0x245d5b[_0x43c937(0x46a)][_0x43c937(0x2c3)],'data':{'changesets':_0x2cbf54}}});})[_0x3d2ef9(0x387)](_0x438b04=>{const _0x33000d=_0x3d2ef9;this[_0x33000d(0x352)]['error'](_0x438b04),_0x3f3fa7();});return;}}_0x4887fb[_0x3d2ef9(0x204)](_0x3f25e2(_0x459b31));},'close':()=>{const _0x3d9dd5=_0x31d679;_0x4887fb[_0x3d9dd5(0x47c)](),_0x3ca256['dispose']();}};return _0x383b92;}async[_0x216ec2(0x59d)](_0xcd63cb,_0x36d2e4){const _0x34f6a6=_0x216ec2;var _0x5c32e0;const {unitType:_0x2c9c8b,unitID:_0x21de51,changeset:_0x12c510}=_0x36d2e4['data'],_0x365409={'unitID':_0x21de51,'memberID':_0xcd63cb[_0x34f6a6(0x305)],'type':_0x2c9c8b,'changeset':_0x245d5b[_0x34f6a6(0x3bc)](_0x12c510)},_0x2d8a6f=_0x2ce507((_0x5c32e0=this['_configService'][_0x34f6a6(0x426)](_0xc11f9d))!=null?_0x5c32e0:_0x165515,_0x2c9c8b,_0x21de51);try{await this[_0x34f6a6(0x2ca)][_0x34f6a6(0x30c)](_0x2d8a6f,{'body':_0x365409});}catch(_0x3515e1){throw this[_0x34f6a6(0x352)][_0x34f6a6(0x2ff)](_0x34f6a6(0x4d6),'submit\x20changeset\x20error!'),_0x3515e1;}}async[_0x216ec2(0x507)](_0x10c060){const _0x455bd2=_0x216ec2,{unitID:_0x41dd80,from:_0x375c38,to:_0x77ed04,unitType:_0x23ae0a}=_0x10c060['data'];return(await this['_snapshotServerService'][_0x455bd2(0x374)]({'metadata':void 0x0},{'unitID':_0x41dd80,'type':_0x23ae0a,'from':_0x375c38,'to':_0x77ed04}))['changesets'];}},_0x11abd7[_0x216ec2(0x1d0)]=_0x22d95e([_0x10d117(0x0,_0x207f05[_0x216ec2(0x511)](_0x516ade[_0x216ec2(0x529)])),_0x10d117(0x1,_0x207f05[_0x216ec2(0x511)](_0x516ade[_0x216ec2(0x383)])),_0x10d117(0x2,_0x207f05[_0x216ec2(0x244)]),_0x10d117(0x3,_0x207f05['ILogService']),_0x10d117(0x4,_0x207f05['ISnapshotServerService'])],_0x11abd7[_0x216ec2(0x1d0)]);class _0x3329b7{constructor(){const _0x5138a3=_0x216ec2;_0x574c73(this,_0x5138a3(0x2b1),new _0xb87526[(_0x5138a3(0x29e))]()),_0x574c73(this,_0x5138a3(0x2dc),this['_commentUpdate$'][_0x5138a3(0x330)]());}[_0x216ec2(0x217)](_0x21659a){const _0x120066=_0x216ec2;this[_0x120066(0x2b1)]['next'](_0x21659a);}}var _0x39bc66=Object[_0x216ec2(0x3d2)],_0x1cc68f=Object[_0x216ec2(0x498)],_0x4f9f57=(_0x53ee9e,_0x4e9bdd,_0x3d8d61,_0x20ba36)=>{for(var _0x4b2a97=_0x20ba36>0x1?void 0x0:_0x20ba36?_0x1cc68f(_0x4e9bdd,_0x3d8d61):_0x4e9bdd,_0x381886=_0x53ee9e['length']-0x1,_0x5743be;_0x381886>=0x0;_0x381886--)(_0x5743be=_0x53ee9e[_0x381886])&&(_0x4b2a97=(_0x20ba36?_0x5743be(_0x4e9bdd,_0x3d8d61,_0x4b2a97):_0x5743be(_0x4b2a97))||_0x4b2a97);return _0x20ba36&&_0x4b2a97&&_0x39bc66(_0x4e9bdd,_0x3d8d61,_0x4b2a97),_0x4b2a97;},_0x290e69=(_0x31ce75,_0x394ebd)=>(_0x4f1fb2,_0x177e87)=>_0x394ebd(_0x4f1fb2,_0x177e87,_0x31ce75),_0x3f8a1a=(_0xd1d5c5=>(_0xd1d5c5[_0xd1d5c5['IDLE']=0x0]=_0x216ec2(0x491),_0xd1d5c5[_0xd1d5c5[_0x216ec2(0x52c)]=0x1]=_0x216ec2(0x52c),_0xd1d5c5[_0xd1d5c5[_0x216ec2(0x483)]=0x2]=_0x216ec2(0x483),_0xd1d5c5[_0xd1d5c5['ONLINE']=0x3]=_0x216ec2(0x1f3),_0xd1d5c5))(_0x3f8a1a||{});_0x11abd7[_0x216ec2(0x3aa)]=class extends _0x207f05[_0x216ec2(0x48f)]{constructor(_0x257638,_0x30726a,_0x540eab,_0x540d1d,_0x21eb24,_0x447c23,_0x2a9765,_0x5c67bf,_0x44f743){const _0x39cee7=_0x216ec2;super(),_0x574c73(this,_0x39cee7(0x372),new _0xb87526['BehaviorSubject'](0x0)),_0x574c73(this,'sessionStatus$',this['_sessionStatus$'][_0x39cee7(0x330)]()),_0x574c73(this,_0x39cee7(0x493),new _0xb87526[(_0x39cee7(0x29e))]()),_0x574c73(this,_0x39cee7(0x35f),this[_0x39cee7(0x493)][_0x39cee7(0x330)]()),_0x574c73(this,_0x39cee7(0x4a9)),_0x574c73(this,_0x39cee7(0x323)),_0x574c73(this,_0x39cee7(0x515)),(this[_0x39cee7(0x290)]=_0x257638,this['_logService']=_0x540eab,this['_beforeCloseService']=_0x540d1d,this['_messageService']=_0x21eb24,this[_0x39cee7(0x1e1)]=_0x447c23,this[_0x39cee7(0x220)]=_0x2a9765,this[_0x39cee7(0x250)]=_0x5c67bf,this[_0x39cee7(0x33c)]=_0x44f743,_0x30726a[_0x39cee7(0x2bb)](_0x9f6f32[_0x39cee7(0x516)](this['dispose$']))[_0x39cee7(0x314)](_0x55e975=>{const _0x5bd6f8=_0x39cee7;var _0x42c6ce;typeof _0x55e975>'u'||(this[_0x5bd6f8(0x4a9)]=_0x55e975,_0x55e975?(this[_0x5bd6f8(0x2c6)](_0x55e975),this[_0x5bd6f8(0x323)]=this[_0x5bd6f8(0x4a9)][_0x5bd6f8(0x408)][_0x5bd6f8(0x314)](_0xab16bc=>{const _0x446adc=_0x5bd6f8;_0xab16bc['routeKey']===this[_0x446adc(0x290)]&&this[_0x446adc(0x327)](_0xab16bc);})):(this[_0x5bd6f8(0x372)][_0x5bd6f8(0x473)](0x2),(_0x42c6ce=this[_0x5bd6f8(0x323)])==null||_0x42c6ce[_0x5bd6f8(0x518)](),this[_0x5bd6f8(0x323)]=null));}),this['disposeWithMe'](this[_0x39cee7(0x258)][_0x39cee7(0x1f0)](()=>{const _0x475c3a=_0x39cee7;var _0x3f6704;(_0x3f6704=this[_0x475c3a(0x4a9)])==null||_0x3f6704[_0x475c3a(0x204)]({'cmd':_0x416d8c['LEAVE'],'data':{'roomID':this[_0x475c3a(0x290)]}});})));}get[_0x216ec2(0x4b4)](){const _0x2944f6=_0x216ec2;return this['_sessionStatus$'][_0x2944f6(0x263)]();}[_0x216ec2(0x2f8)](){const _0x5048ee=_0x216ec2;var _0x377aae,_0x32c41d;return(_0x32c41d=(_0x377aae=this['_socket'])==null?void 0x0:_0x377aae[_0x5048ee(0x305)])!=null?_0x32c41d:null;}['dispose'](){const _0x364017=_0x216ec2;super['dispose'](),this['dispose$'][_0x364017(0x473)](),this[_0x364017(0x274)][_0x364017(0x39c)]();}['close'](){const _0x3dbe58=_0x216ec2;var _0x25c8f1,_0x9c9b5b;(_0x25c8f1=this['_socket'])==null||_0x25c8f1['send']({'cmd':_0x416d8c[_0x3dbe58(0x2f3)],'data':{'roomID':this[_0x3dbe58(0x290)]}}),this[_0x3dbe58(0x493)][_0x3dbe58(0x39c)](),this['_sessionStatus$'][_0x3dbe58(0x39c)](),(_0x9c9b5b=this['_socket'])==null||_0x9c9b5b[_0x3dbe58(0x47c)](),this[_0x3dbe58(0x3a0)]();}[_0x216ec2(0x327)](_0x56046e){const _0x5474a0=_0x216ec2;_0x56046e[_0x5474a0(0x39b)]===_0x416d8c[_0x5474a0(0x435)]?this['_onJoinRoomEvent'](_0x56046e):_0x56046e[_0x5474a0(0x39b)]===_0x416d8c[_0x5474a0(0x36b)]&&this[_0x5474a0(0x3d7)](_0x56046e);}[_0x216ec2(0x2c6)](_0x22280a){const _0x3dc160=_0x216ec2;this[_0x3dc160(0x372)][_0x3dc160(0x473)](0x1),_0x22280a[_0x3dc160(0x204)]({'cmd':_0x416d8c[_0x3dc160(0x435)],'routeKey':this[_0x3dc160(0x290)],'routeType':'','data':{'rooms':[{'roomID':this[_0x3dc160(0x290)]}]}});}['_onJoinRoomEvent'](_0x48f611){const _0x5731a7=_0x216ec2;var _0x1efcef;if(_0x48f611['code']===_0x3ed514[_0x5731a7(0x1ea)]){this['_messageService'][_0x5731a7(0x4ec)]({'type':_0x2e1001[_0x5731a7(0x5ae)][_0x5731a7(0x29c)],'content':this['_localeService']['t'](_0x5731a7(0x3ac))}),this[_0x5731a7(0x372)][_0x5731a7(0x473)](0x2);return;}this[_0x5731a7(0x372)][_0x5731a7(0x473)](0x3);const _0x1122bd=(_0x1efcef=_0x48f611[_0x5731a7(0x2fd)][_0x5731a7(0x345)][this[_0x5731a7(0x290)]])==null?void 0x0:_0x1efcef[_0x5731a7(0x2d9)];_0x1122bd&&_0x1122bd['forEach'](_0x5294ec=>this[_0x5731a7(0x250)]['updateMember'](this[_0x5731a7(0x290)],_0x5294ec));}[_0x216ec2(0x3d7)](_0x2b9d11){const _0x333127=_0x216ec2;try{const _0xb36a4a=_0x2b9d11[_0x333127(0x2fd)];switch(_0xb36a4a[_0x333127(0x5a3)]){case _0x245d5b['CollaborationEvent'][_0x333127(0x4ff)]:this[_0x333127(0x364)](_0xb36a4a),this[_0x333127(0x493)]['next'](_0xb36a4a);break;case _0x245d5b[_0x333127(0x46a)][_0x333127(0x4e0)]:this[_0x333127(0x261)](_0xb36a4a),this[_0x333127(0x493)][_0x333127(0x473)](_0xb36a4a);break;case _0x245d5b[_0x333127(0x46a)]['CHANGESET_ACK']:this['_clearCollaborationTimeoutTimer'](),this[_0x333127(0x493)][_0x333127(0x473)](_0xb36a4a);break;case _0x245d5b[_0x333127(0x46a)][_0x333127(0x34d)]:this[_0x333127(0x352)][_0x333127(0x2ff)](_0x333127(0x3f6)+JSON[_0x333127(0x562)](_0xb36a4a)),this[_0x333127(0x493)][_0x333127(0x473)](_0xb36a4a);break;case _0x245d5b[_0x333127(0x46a)]['COMMENT_UPDATE']:this[_0x333127(0x33c)][_0x333127(0x217)](_0xb36a4a[_0x333127(0x2fd)]),this[_0x333127(0x493)]['next'](_0xb36a4a);break;default:this[_0x333127(0x493)][_0x333127(0x473)](_0xb36a4a);}}catch(_0x527e45){this[_0x333127(0x352)][_0x333127(0x2ff)](_0x527e45,_0x2b9d11);}}[_0x216ec2(0x364)](_0x42c93b){const _0x3a93c3=_0x216ec2;this[_0x3a93c3(0x250)][_0x3a93c3(0x58c)](this[_0x3a93c3(0x290)],_0x42c93b[_0x3a93c3(0x2fd)]);}['_onUserLeave'](_0x4220c3){const _0x38cfcc=_0x216ec2;this[_0x38cfcc(0x250)]['removeMember'](this[_0x38cfcc(0x290)],_0x4220c3['data']['memberID']);}async[_0x216ec2(0x204)](_0x5e1e7f,_0x4820d4){const _0x14943b=_0x216ec2;if(this[_0x14943b(0x4b4)]!==0x3||!this[_0x14943b(0x4a9)])throw new Error(_0x14943b(0x350));try{_0x5e1e7f[_0x14943b(0x5a3)]===_0x245d5b[_0x14943b(0x46a)][_0x14943b(0x203)]&&this[_0x14943b(0x329)](),this[_0x14943b(0x4a9)][_0x14943b(0x204)]({'cmd':_0x416d8c[_0x14943b(0x2ba)],'routeKey':_0x4820d4,'routeType':'','data':_0x5e1e7f});}catch(_0x2cae7a){this[_0x14943b(0x352)][_0x14943b(0x2ff)](_0x2cae7a);}}['_scheduleCollaborationTimeoutTimer'](){const _0x2607c0=_0x216ec2;var _0x2dc0fe;this[_0x2607c0(0x515)]=window[_0x2607c0(0x2cc)](()=>{const _0x993944=_0x2607c0;this['_collaborationTimeoutTimer']=null,this['_messageService'][_0x993944(0x4ec)]({'type':_0x2e1001['MessageType']['Error'],'content':this[_0x993944(0x220)]['t'](_0x993944(0x2c2))});},(_0x2dc0fe=this[_0x2607c0(0x1e1)][_0x2607c0(0x426)](_0x4bf8c1))!=null?_0x2dc0fe:0x2710);}[_0x216ec2(0x340)](){const _0x885dfb=_0x216ec2;this[_0x885dfb(0x515)]&&(clearTimeout(this[_0x885dfb(0x515)]),this[_0x885dfb(0x515)]=null);}},_0x11abd7[_0x216ec2(0x3aa)]=_0x4f9f57([_0x290e69(0x2,_0x207f05[_0x216ec2(0x3ba)]),_0x290e69(0x3,_0xd6a4eb['IBeforeCloseService']),_0x290e69(0x4,_0xd6a4eb[_0x216ec2(0x1f5)]),_0x290e69(0x5,_0x207f05[_0x216ec2(0x244)]),_0x290e69(0x6,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x267)])),_0x290e69(0x7,_0x207f05[_0x216ec2(0x511)](_0x35ecb0)),_0x290e69(0x8,_0x207f05['Inject'](_0x3329b7))],_0x11abd7[_0x216ec2(0x3aa)]),_0x11abd7[_0x216ec2(0x3e1)]=class extends _0x207f05['Disposable']{constructor(_0x5cd2c2,_0x2ed43a,_0x30e8e3,_0x5d82ff,_0x1e2a61,_0x34af68){const _0xf6bfba=_0x216ec2;super(),_0x574c73(this,_0xf6bfba(0x300),new _0xb87526[(_0xf6bfba(0x31f))](void 0x0)),_0x574c73(this,_0xf6bfba(0x4e3),new Map()),_0x574c73(this,_0xf6bfba(0x413),new _0xb87526['BehaviorSubject'](0x0)),_0x574c73(this,'status$',this[_0xf6bfba(0x413)][_0xf6bfba(0x330)]()),_0x574c73(this,'_socketReady',!0x1),_0x574c73(this,_0xf6bfba(0x572)),_0x574c73(this,_0xf6bfba(0x3ab)),_0x574c73(this,_0xf6bfba(0x27c)),_0x574c73(this,_0xf6bfba(0x365),0x0),(this[_0xf6bfba(0x400)]=_0x5cd2c2,this['_localeService']=_0x2ed43a,this['_messageService']=_0x30e8e3,this['_logService']=_0x5d82ff,this[_0xf6bfba(0x1e1)]=_0x1e2a61,this['_socketService']=_0x34af68);}get[_0x216ec2(0x4a9)](){const _0x910bc5=_0x216ec2;return this[_0x910bc5(0x300)][_0x910bc5(0x263)]();}[_0x216ec2(0x3a0)](){const _0x1f7e76=_0x216ec2;super[_0x1f7e76(0x3a0)](),this[_0x1f7e76(0x4e3)]['forEach'](_0x3455ad=>_0x3455ad['dispose']()),this[_0x1f7e76(0x4e3)][_0x1f7e76(0x434)](),this[_0x1f7e76(0x413)]['complete']();}async['requireSession'](_0x139b7f){const _0x255b76=_0x216ec2;if(this[_0x255b76(0x4e3)]['has'](_0x139b7f))return this[_0x255b76(0x4e3)][_0x255b76(0x458)](_0x139b7f);this[_0x255b76(0x4e1)]();const _0x126de7=this[_0x255b76(0x400)][_0x255b76(0x596)](_0x11abd7['CollaborationSession'],_0x139b7f,this['_socket$']['asObservable']());return this['_sessions'][_0x255b76(0x252)](_0x139b7f,_0x126de7),_0x126de7;}['closeSession'](_0x3fb358){const _0x37b850=_0x216ec2;var _0x2de0c5;const _0x150810=this[_0x37b850(0x4e3)]['get'](_0x3fb358);_0x150810&&(this[_0x37b850(0x4e3)][_0x37b850(0x3b1)](_0x3fb358),_0x150810[_0x37b850(0x47c)]()),this[_0x37b850(0x4e3)][_0x37b850(0x326)]||(_0x2de0c5=this['_socket'])==null||_0x2de0c5['close']();}['_createSocket'](){const _0x15084a=_0x216ec2;var _0xd1f848;const _0x227373=(_0xd1f848=this[_0x15084a(0x1e1)][_0x15084a(0x426)](_0x1d407f))!=null?_0xd1f848:_0x4d7790;return this['_socketService'][_0x15084a(0x239)](_0x227373);}[_0x216ec2(0x4e1)](){const _0x5aa8ee=_0x216ec2;try{const _0x1e01b8=this[_0x5aa8ee(0x34e)]();if(_0x1e01b8){const _0x5ef94b=_0x1e01b8['send'];_0x1e01b8[_0x5aa8ee(0x204)]=_0x3cbadc=>(this[_0x5aa8ee(0x484)](),_0x5ef94b[_0x5aa8ee(0x34f)](_0x1e01b8,[_0x3cbadc])),_0x1e01b8[_0x5aa8ee(0x408)]['subscribe'](_0x1c01f3=>this[_0x5aa8ee(0x3af)](_0x1e01b8,_0x1c01f3)),_0x1e01b8['error$'][_0x5aa8ee(0x2bb)](_0x9f6f32[_0x5aa8ee(0x294)](0x1))[_0x5aa8ee(0x314)](_0x42b31b=>this[_0x5aa8ee(0x352)][_0x5aa8ee(0x2ff)](_0x5aa8ee(0x436),_0x42b31b)),_0x1e01b8['open$'][_0x5aa8ee(0x2bb)](_0x9f6f32[_0x5aa8ee(0x294)](0x1))['subscribe'](()=>{const _0x53bf88=_0x5aa8ee;this[_0x53bf88(0x283)](_0x1e01b8);}),_0x1e01b8[_0x5aa8ee(0x504)][_0x5aa8ee(0x2bb)](_0x9f6f32[_0x5aa8ee(0x294)](0x1))[_0x5aa8ee(0x314)](_0x59c2cf=>{const _0x40a0d8=_0x5aa8ee;this['_logService'][_0x40a0d8(0x339)]('[CollaborationSessionService]',_0x40a0d8(0x226),_0x59c2cf),this[_0x40a0d8(0x45b)]();});}}catch(_0x358f06){this[_0x5aa8ee(0x352)]['error'](_0x358f06),this[_0x5aa8ee(0x45b)]();}}[_0x216ec2(0x283)](_0x517248){const _0x264571=_0x216ec2;this[_0x264571(0x352)][_0x264571(0x339)](_0x264571(0x246),_0x264571(0x5af)),_0x517248[_0x264571(0x204)]({'cmd':_0x416d8c[_0x264571(0x3a1)]}),this[_0x264571(0x484)]();}[_0x216ec2(0x45b)](){const _0x5b8fe0=_0x216ec2;var _0x2fc75e;this[_0x5b8fe0(0x413)]['next'](0x2),this[_0x5b8fe0(0x300)][_0x5b8fe0(0x473)](null),this[_0x5b8fe0(0x31c)](),this['_clearHeartbeatTimer'](),this[_0x5b8fe0(0x4ba)]=!0x1,this[_0x5b8fe0(0x365)]<((_0x2fc75e=this[_0x5b8fe0(0x1e1)][_0x5b8fe0(0x426)](_0x4d42bc))!=null?_0x2fc75e:0x3)?(this[_0x5b8fe0(0x5a2)](this['_retryCount']),this[_0x5b8fe0(0x365)]+=0x1):this['_messageService'][_0x5b8fe0(0x4ec)]({'type':_0x2e1001[_0x5b8fe0(0x5ae)][_0x5b8fe0(0x1fe)],'content':this['_localeService']['t'](_0x5b8fe0(0x2e8))});}['_scheduleReconnection'](_0x560f9f){const _0x225030=_0x216ec2;var _0x3c4f33;const _0x3aaf8d=((_0x3c4f33=this[_0x225030(0x1e1)][_0x225030(0x426)](_0x3cfdb4))!=null?_0x3c4f33:0x4e20)*0x2**_0x560f9f;this[_0x225030(0x312)][_0x225030(0x4ec)]({'type':_0x2e1001[_0x225030(0x5ae)][_0x225030(0x29c)],'content':this[_0x225030(0x220)]['t'](_0x225030(0x439))}),this[_0x225030(0x27c)]=setTimeout(()=>{const _0x161efe=_0x225030;this[_0x161efe(0x4e1)](),clearTimeout(this[_0x161efe(0x27c)]),this['_retryConnectingTimer']=null;},_0x3aaf8d);}['_rescheduleHeartbeatEvent'](){const _0x4443e1=_0x216ec2;var _0x13339b;this[_0x4443e1(0x4dd)](),this[_0x4443e1(0x572)]=setTimeout(()=>this[_0x4443e1(0x4d8)](),(_0x13339b=this[_0x4443e1(0x1e1)][_0x4443e1(0x426)](_0x4650ae))!=null?_0x13339b:0x7530);}[_0x216ec2(0x4d8)](){const _0x5ab1d9=_0x216ec2;this[_0x5ab1d9(0x4a9)]['send']({'cmd':_0x416d8c[_0x5ab1d9(0x541)]}),this[_0x5ab1d9(0x32c)]();}[_0x216ec2(0x32c)](){const _0x1c31ec=_0x216ec2;var _0x33e141;this[_0x1c31ec(0x3ab)]=setTimeout(()=>this['_onConnectionFailed'](),(_0x33e141=this['_configService'][_0x1c31ec(0x426)](_0x4bf8c1))!=null?_0x33e141:0x2710);}[_0x216ec2(0x3af)](_0x1a29ce,_0x915968){const _0x858030=_0x216ec2,{cmd:_0x4870d1}=_0x915968;_0x4870d1===_0x416d8c['HELLO']&&!this[_0x858030(0x4ba)]&&(_0x1a29ce['memberID']=_0x915968[_0x858030(0x2fd)]['memberID'],this[_0x858030(0x300)][_0x858030(0x473)](_0x1a29ce),this[_0x858030(0x413)][_0x858030(0x473)](0x3),this['_socketReady']=!0x0),_0x4870d1===_0x416d8c[_0x858030(0x541)]&&this[_0x858030(0x31c)](),this[_0x858030(0x484)]();}[_0x216ec2(0x4dd)](){const _0x2b468f=_0x216ec2;this[_0x2b468f(0x572)]!=null&&(clearTimeout(this[_0x2b468f(0x572)]),this[_0x2b468f(0x572)]=null);}['_clearTimeoutTimer'](){const _0x39596d=_0x216ec2;this['_timeoutTimer']!=null&&(clearTimeout(this[_0x39596d(0x3ab)]),this[_0x39596d(0x3ab)]=null);}},_0x11abd7[_0x216ec2(0x3e1)]=_0x4f9f57([_0x290e69(0x0,_0x207f05[_0x216ec2(0x511)](_0x207f05['Injector'])),_0x290e69(0x1,_0x207f05[_0x216ec2(0x511)](_0x207f05['LocaleService'])),_0x290e69(0x2,_0xd6a4eb['IMessageService']),_0x290e69(0x3,_0x207f05['ILogService']),_0x290e69(0x4,_0x207f05[_0x216ec2(0x244)]),_0x290e69(0x5,_0x240746)],_0x11abd7[_0x216ec2(0x3e1)]);var _0x18be56=Object['defineProperty'],_0x5356cb=Object[_0x216ec2(0x498)],_0x5b9547=(_0xff97ae,_0x24630c,_0x23b998,_0x4852b9)=>{for(var _0x31563f=_0x4852b9>0x1?void 0x0:_0x4852b9?_0x5356cb(_0x24630c,_0x23b998):_0x24630c,_0x2cdec8=_0xff97ae['length']-0x1,_0x3b0d95;_0x2cdec8>=0x0;_0x2cdec8--)(_0x3b0d95=_0xff97ae[_0x2cdec8])&&(_0x31563f=(_0x4852b9?_0x3b0d95(_0x24630c,_0x23b998,_0x31563f):_0x3b0d95(_0x31563f))||_0x31563f);return _0x4852b9&&_0x31563f&&_0x18be56(_0x24630c,_0x23b998,_0x31563f),_0x31563f;},_0x3ab368=(_0x53b97c,_0x1c3c69)=>(_0x599b4f,_0x2d8d34)=>_0x1c3c69(_0x599b4f,_0x2d8d34,_0x53b97c);_0x11abd7[_0x216ec2(0x1d2)]=class extends _0x207f05[_0x216ec2(0x1c5)]{constructor(_0x5be17e,_0x113e4a,_0x54ce67,_0x261583,_0x4c2db1){const _0x121d03=_0x216ec2;super(),_0x574c73(this,'_cachedData',new Map()),_0x574c73(this,_0x121d03(0x39a),new Map()),_0x574c73(this,_0x121d03(0x254),!0x1),(this[_0x121d03(0x1e1)]=_0x5be17e,this[_0x121d03(0x522)]=_0x113e4a,this[_0x121d03(0x258)]=_0x54ce67,this[_0x121d03(0x220)]=_0x261583,this[_0x121d03(0x317)]=_0x4c2db1,this[_0x121d03(0x2a7)]());}[_0x216ec2(0x272)](){const _0x44f99a=_0x216ec2;this[_0x44f99a(0x254)]=!0x0;}[_0x216ec2(0x46f)](){const _0x36d9e6=_0x216ec2;this[_0x36d9e6(0x254)]=!0x1;}[_0x216ec2(0x3a0)](){const _0x2b2765=_0x216ec2;this[_0x2b2765(0x1df)]()['then'](()=>super[_0x2b2765(0x3a0)]());}async[_0x216ec2(0x416)](_0x1cf219){const _0x4fba99=_0x216ec2;return this[_0x4fba99(0x254)]?null:this[_0x4fba99(0x522)][_0x4fba99(0x248)](_0x522b61(_0x1cf219));}async[_0x216ec2(0x38c)](_0x32ef34,_0x2279f5){const _0x3013b3=_0x216ec2;return!!this[_0x3013b3(0x522)][_0x3013b3(0x1c9)](_0x32ef34,_0x2279f5);}['updateOfflineData'](_0x3daa28,_0x5a6b39,_0x107f2e,_0x44d9a8){const _0x20ab47=_0x216ec2,_0x1fddff=this['_revisionService']['getCurrentRevForDocument'](_0x3daa28);this['_cachedData'][_0x20ab47(0x252)](_0x3daa28,{'unitID':_0x3daa28,'type':_0x5a6b39,'awaitingChangeset':_0x107f2e,'mutations':_0x44d9a8,'rev':_0x1fddff}),this[_0x20ab47(0x39a)]['has'](_0x3daa28)||this['_scheduleSaving'](_0x3daa28);}[_0x216ec2(0x3bd)](_0x5af877){const _0x23f388=_0x216ec2,_0x23cc73=this[_0x23f388(0x21c)]();_0x23cc73===0x0?this[_0x23f388(0x347)](_0x5af877):this[_0x23f388(0x39a)][_0x23f388(0x252)](_0x5af877,setTimeout(()=>this[_0x23f388(0x347)](_0x5af877),_0x23cc73));}[_0x216ec2(0x21c)](){const _0x4aaab4=_0x216ec2;var _0x27de45;return(_0x27de45=this['_configService'][_0x4aaab4(0x426)](_0x1e09ef))!=null?_0x27de45:0x3e8;}[_0x216ec2(0x347)](_0x5d33ef){const _0xb01d62=_0x216ec2,_0x2f3008=this[_0xb01d62(0x39a)][_0xb01d62(0x458)](_0x5d33ef);return _0x2f3008!==void 0x0&&window[_0xb01d62(0x4bf)](_0x2f3008),this[_0xb01d62(0x522)]['setItem'](_0x522b61(_0x5d33ef),this[_0xb01d62(0x2d6)]['get'](_0x5d33ef))['then'](()=>this[_0xb01d62(0x39a)][_0xb01d62(0x3b1)](_0x5d33ef));}async[_0x216ec2(0x1df)](){const _0x46f979=_0x216ec2,_0xc93b7e=[];this[_0x46f979(0x39a)][_0x46f979(0x43f)]((_0x49e3fe,_0xd013c)=>{const _0xa24d39=_0x46f979;window[_0xa24d39(0x4bf)](_0x49e3fe),_0xc93b7e[_0xa24d39(0x2af)](this[_0xa24d39(0x347)](_0xd013c)[_0xa24d39(0x4bd)](()=>{this['_saveTaskMap']['delete'](_0xd013c);}));}),await Promise[_0x46f979(0x2f9)](_0xc93b7e);}[_0x216ec2(0x2a7)](){const _0x38dab6=_0x216ec2;this[_0x38dab6(0x38d)](this[_0x38dab6(0x258)][_0x38dab6(0x241)](()=>{const _0x58ebf1=_0x38dab6;if(this[_0x58ebf1(0x39a)][_0x58ebf1(0x326)])return this[_0x58ebf1(0x220)]['t']('collaboration-client.offline-data-not-saved');}));}},_0x11abd7['LocalCacheService']=_0x5b9547([_0x3ab368(0x0,_0x207f05[_0x216ec2(0x244)]),_0x3ab368(0x1,_0x207f05[_0x216ec2(0x424)]),_0x3ab368(0x2,_0xd6a4eb[_0x216ec2(0x584)]),_0x3ab368(0x3,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x267)])),_0x3ab368(0x4,_0x207f05[_0x216ec2(0x511)](_0x245d5b[_0x216ec2(0x586)]))],_0x11abd7[_0x216ec2(0x1d2)]);function _0x522b61(_0x4b1f79){return'unit-cache-'+_0x4b1f79;}const _0x2d3969=_0x207f05['createIdentifier'](_0x216ec2(0x59b));var _0x1adef1=(_0x13136b=>(_0x13136b[_0x13136b[_0x216ec2(0x23c)]=0x0]=_0x216ec2(0x23c),_0x13136b[_0x13136b[_0x216ec2(0x5a8)]=0x1]=_0x216ec2(0x5a8),_0x13136b))(_0x1adef1||{});const _0x162b98=0x7530,_0x210db7=_0x216ec2(0x500);class _0x3e538f extends _0x207f05['Disposable']{constructor(){const _0x32e19c=_0x216ec2;super(),_0x574c73(this,_0x32e19c(0x441),_0x207f05['Tools'][_0x32e19c(0x304)]()),_0x574c73(this,_0x32e19c(0x1f8),new Set()),_0x574c73(this,_0x32e19c(0x3d3),new Map()),_0x574c73(this,_0x32e19c(0x2d8),null),_0x574c73(this,'_clearOtherTimers',new Map()),_0x574c73(this,_0x32e19c(0x4da),new Map()),this[_0x32e19c(0x299)]();}[_0x216ec2(0x3a0)](){const _0x1a93b0=_0x216ec2;super[_0x1a93b0(0x3a0)](),this[_0x1a93b0(0x52f)]['forEach']((_0xcb4208,_0x29f3f0)=>this[_0x1a93b0(0x3d8)](_0x29f3f0)),this[_0x1a93b0(0x2d8)]&&window[_0x1a93b0(0x320)](this[_0x1a93b0(0x2d8)]);}[_0x216ec2(0x2bd)](_0x37cd95){const _0x169828=_0x216ec2;return this[_0x169828(0x288)](_0x37cd95)[_0x169828(0x2bb)](_0xb87526[_0x169828(0x37a)]());}[_0x216ec2(0x25f)](_0x2a7393){const _0x490152=_0x216ec2;this['_selfUnitIDs']['size']===0x0&&this[_0x490152(0x546)](),this[_0x490152(0x1f8)][_0x490152(0x28f)](_0x2a7393),this[_0x490152(0x22e)]({'type':0x0,'memberID':this['_id'],'unitIDs':[_0x2a7393],'isForwarded':!0x1});}[_0x216ec2(0x5bf)](_0x424afb){const _0x55d513=_0x216ec2;this['_selfUnitIDs'][_0x55d513(0x3b1)](_0x424afb),this[_0x55d513(0x1f8)][_0x55d513(0x326)]===0x0&&this['_heartbeatTimer']&&window[_0x55d513(0x320)](this[_0x55d513(0x2d8)]);}[_0x216ec2(0x299)](){const _0x3990bd=_0x216ec2;this[_0x3990bd(0x38d)](_0x207f05['toDisposable'](_0xb87526[_0x3990bd(0x4d9)](window,_0x3990bd(0x46c))[_0x3990bd(0x314)](_0x29bf5a=>{const _0x17235a=_0x3990bd;if(_0x29bf5a['key']!==_0x210db7||!_0x29bf5a[_0x17235a(0x2db)])return;const _0x129759=JSON['parse'](_0x29bf5a[_0x17235a(0x2db)]);this['_handleEvent'](_0x129759);}))),window[_0x3990bd(0x444)]('unload',()=>this[_0x3990bd(0x22e)]({'type':0x1,'memberID':this['_id'],'unitIDs':Array[_0x3990bd(0x411)](this[_0x3990bd(0x1f8)])}));}[_0x216ec2(0x29d)](_0x348017){const _0x361d10=_0x216ec2;switch(_0x348017[_0x361d10(0x42a)]){case 0x0:this['_handleJoinEvent'](_0x348017);break;case 0x1:this[_0x361d10(0x3fc)](_0x348017);break;case 0x2:this[_0x361d10(0x3e5)](_0x348017);break;}}['_handleJoinEvent'](_0x5a1051){const _0x46ba5f=_0x216ec2,{unitIDs:_0x3fcebf,memberID:_0x31531c,isForwarded:_0x4432b5}=_0x5a1051;_0x3fcebf[_0x46ba5f(0x43f)](_0x34026b=>{const _0x4e9e58=_0x46ba5f;if(!_0x4432b5&&this[_0x4e9e58(0x3d3)][_0x4e9e58(0x1dc)](_0x34026b)&&this[_0x4e9e58(0x288)](_0x34026b)[_0x4e9e58(0x473)](0x1),!this[_0x4e9e58(0x3d3)][_0x4e9e58(0x1dc)](_0x34026b)||!this['_unitOnClients'][_0x4e9e58(0x458)](_0x34026b)[_0x4e9e58(0x1dc)](_0x31531c)){const _0x4d3997=this[_0x4e9e58(0x3d3)]['get'](_0x34026b)||new Set();_0x4d3997['add'](_0x31531c),this[_0x4e9e58(0x3d3)][_0x4e9e58(0x252)](_0x34026b,_0x4d3997),this[_0x4e9e58(0x1e0)](_0x31531c);}}),_0x4432b5||this[_0x46ba5f(0x22e)]({'type':0x0,'memberID':this[_0x46ba5f(0x441)],'unitIDs':[...this[_0x46ba5f(0x1f8)]],'isForwarded':!0x0});}[_0x216ec2(0x1e0)](_0x19c42e){const _0x2afe0b=_0x216ec2;this[_0x2afe0b(0x3d8)](_0x19c42e);const _0xfd61b5=window[_0x2afe0b(0x2cc)](()=>{const _0x387e07=_0x2afe0b;this[_0x387e07(0x3d3)][_0x387e07(0x43f)](_0x1c1cc8=>{const _0x5ebd52=_0x387e07;_0x1c1cc8[_0x5ebd52(0x3b1)](_0x19c42e);});},_0x162b98*0x2);this['_clearOtherTimers'][_0x2afe0b(0x252)](_0x19c42e,_0xfd61b5);}[_0x216ec2(0x3d8)](_0x46ec02){const _0x1e6ce4=_0x216ec2;if(this[_0x1e6ce4(0x52f)][_0x1e6ce4(0x1dc)](_0x46ec02)){const _0x69eea2=this[_0x1e6ce4(0x52f)][_0x1e6ce4(0x458)](_0x46ec02);_0x69eea2&&window[_0x1e6ce4(0x4bf)](_0x69eea2),this[_0x1e6ce4(0x52f)][_0x1e6ce4(0x252)](_0x46ec02,null);}}[_0x216ec2(0x3fc)](_0x333393){const _0x5ba9cb=_0x216ec2,{memberID:_0x10602c,unitIDs:_0x358533}=_0x333393;_0x358533[_0x5ba9cb(0x43f)](_0x36d236=>{const _0x38b466=_0x5ba9cb;var _0x31a067;const _0x413bfd=this[_0x38b466(0x3d3)][_0x38b466(0x458)](_0x36d236);_0x413bfd&&(_0x413bfd[_0x38b466(0x3b1)](_0x10602c),(_0x31a067=this[_0x38b466(0x288)](_0x36d236))==null||_0x31a067[_0x38b466(0x473)](_0x413bfd['size']===0x0?0x0:0x1));}),this[_0x5ba9cb(0x3d8)](_0x10602c);}[_0x216ec2(0x3e5)](_0x477cbd){const _0x4c71de=_0x216ec2;this['_scheduleClearOtherTimer'](_0x477cbd[_0x4c71de(0x305)]);}['_send'](_0xcdaea9){const _0x28a170=_0x216ec2;localStorage[_0x28a170(0x1c9)](_0x210db7,JSON['stringify'](_0xcdaea9));}['_scheduleHeartbeat'](){const _0x4de89f=_0x216ec2;this[_0x4de89f(0x2d8)]=window['setInterval'](()=>{const _0x3d7068=_0x4de89f;this[_0x3d7068(0x22e)]({'type':0x2,'memberID':this[_0x3d7068(0x441)]});},_0x162b98);}[_0x216ec2(0x288)](_0x4e6d64){const _0x3928a1=_0x216ec2;return this[_0x3928a1(0x4da)][_0x3928a1(0x1dc)](_0x4e6d64)||this[_0x3928a1(0x4da)][_0x3928a1(0x252)](_0x4e6d64,new _0xb87526[(_0x3928a1(0x31f))](0x0)),this[_0x3928a1(0x4da)][_0x3928a1(0x458)](_0x4e6d64);}}var _0x480673=Object[_0x216ec2(0x3d2)],_0x5d7ecd=Object[_0x216ec2(0x498)],_0x2dfc6b=(_0x5b702a,_0x135159,_0x39cbd0,_0x3a59a1)=>{const _0x464932=_0x216ec2;for(var _0x492972=_0x3a59a1>0x1?void 0x0:_0x3a59a1?_0x5d7ecd(_0x135159,_0x39cbd0):_0x135159,_0x779d3c=_0x5b702a[_0x464932(0x48b)]-0x1,_0x2282e7;_0x779d3c>=0x0;_0x779d3c--)(_0x2282e7=_0x5b702a[_0x779d3c])&&(_0x492972=(_0x3a59a1?_0x2282e7(_0x135159,_0x39cbd0,_0x492972):_0x2282e7(_0x492972))||_0x492972);return _0x3a59a1&&_0x492972&&_0x480673(_0x135159,_0x39cbd0,_0x492972),_0x492972;},_0x46bd3c=(_0x38e6ad,_0x782a58)=>(_0xab3db7,_0x37c46d)=>_0x782a58(_0xab3db7,_0x37c46d,_0x38e6ad);let _0x36a396=class{constructor(_0x5521cd,_0x322c11){const _0x575303=_0x216ec2;this[_0x575303(0x400)]=_0x5521cd,this[_0x575303(0x2b7)]=_0x322c11;}['transformIMECache'](_0x1422ab){const _0x5e0939=_0x216ec2;this[_0x5e0939(0x3a8)](_0x1422ab),this[_0x5e0939(0x355)](_0x1422ab);}['transformRemoteChangeset'](_0x2661c7){const _0x218f42=_0x216ec2,_0x3b8465=this['_injector']['get'](_0x23e2c7[_0x218f42(0x251)]),{redoCache:_0x29190a}=_0x3b8465[_0x218f42(0x256)]();if(_0x29190a['length']===0x0)return _0x2661c7;let _0x51d289=_0x207f05[_0x218f42(0x46e)][_0x218f42(0x442)](_0x2661c7[_0x218f42(0x1cc)][0x0]);for(let _0x283230=0x0;_0x283230<_0x29190a[_0x218f42(0x48b)];_0x283230++){const _0x568c7d={'id':_0x218f42(0x462),'params':{..._0x29190a[_0x283230]}},_0x451d15=this['_transformService'][_0x218f42(0x1cf)](_0x51d289,_0x568c7d,!0x1);if(_0x245d5b[_0x218f42(0x50c)](_0x451d15))throw _0x451d15[_0x218f42(0x2ff)];_0x51d289=_0x451d15[_0x218f42(0x569)];}return{..._0x207f05['Tools'][_0x218f42(0x442)](_0x2661c7),'mutations':[_0x51d289]};}[_0x216ec2(0x3a8)](_0x2e135d){const _0x153925=_0x216ec2,_0xa230dc=this[_0x153925(0x400)][_0x153925(0x458)](_0x23e2c7[_0x153925(0x251)]),{undoCache:_0xe7b60,redoCache:_0x17ebfd}=_0xa230dc[_0x153925(0x256)]();if(_0xe7b60[_0x153925(0x48b)]===0x0||_0x17ebfd['length']===0x0)return;const _0x1671a4=[],_0x489458=[];let _0x3b31a2=_0x207f05[_0x153925(0x46e)][_0x153925(0x442)](_0x2e135d['mutations'][0x0]),_0xee011d=_0x207f05[_0x153925(0x46e)][_0x153925(0x442)](_0x2e135d[_0x153925(0x1cc)][0x0]);for(let _0x300452=_0xe7b60[_0x153925(0x48b)]-0x1;_0x300452>=0x0;_0x300452--){const _0x4f9bfe={'id':_0x153925(0x462),'params':{..._0xe7b60[_0x300452]}},_0x3b9a22={'id':_0x153925(0x462),'params':{..._0x17ebfd[_0x300452]}},_0x1a44c6=this[_0x153925(0x2b7)][_0x153925(0x1cf)](_0x3b31a2,_0x4f9bfe,!0x1),_0x194eb1=this[_0x153925(0x2b7)][_0x153925(0x1cf)](_0xee011d,_0x3b9a22,!0x1);if(_0x245d5b[_0x153925(0x50c)](_0x1a44c6))throw _0x1a44c6[_0x153925(0x2ff)];if(_0x245d5b[_0x153925(0x50c)](_0x194eb1))throw _0x194eb1[_0x153925(0x2ff)];_0x1671a4[_0x153925(0x499)](_0x1a44c6[_0x153925(0x49e)]['params']),_0x489458['unshift'](_0x194eb1[_0x153925(0x49e)][_0x153925(0x31b)]),_0x3b31a2=_0x1a44c6[_0x153925(0x569)],_0xee011d=_0x194eb1[_0x153925(0x569)];}_0xa230dc[_0x153925(0x2a1)]({'undoCache':_0x1671a4,'redoCache':_0x489458});}[_0x216ec2(0x355)](_0x334885){const _0x26bb5d=_0x216ec2,_0x4d9a46=this[_0x26bb5d(0x400)][_0x26bb5d(0x458)](_0x23e2c7[_0x26bb5d(0x251)]),_0xcfc480=_0x4d9a46[_0x26bb5d(0x520)]();if(_0xcfc480==null)return;const _0x523807=[{'id':_0x26bb5d(0x462),'params':{'unitId':_0x334885['unitID'],'actions':null,'textRanges':[_0xcfc480]}}],_0x501ace=this['_transformService'][_0x26bb5d(0x342)](_0x334885,_0x523807);if(!_0x245d5b['isTransformMutationsWithChangesetSuccess'](_0x501ace))throw _0x501ace[_0x26bb5d(0x2ff)];const _0x4d9823=_0x501ace[_0x26bb5d(0x49e)][0x0][_0x26bb5d(0x31b)][_0x26bb5d(0x53d)];Array[_0x26bb5d(0x240)](_0x4d9823)&&_0x4d9823[_0x26bb5d(0x48b)]&&_0x4d9a46[_0x26bb5d(0x3b0)](_0x4d9823[0x0]);}};_0x36a396=_0x2dfc6b([_0x46bd3c(0x0,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x236)])),_0x46bd3c(0x1,_0x245d5b[_0x216ec2(0x3e8)])],_0x36a396);var _0x17d1db=Object[_0x216ec2(0x3d2)],_0x96d9f9=Object[_0x216ec2(0x498)],_0x350098=(_0x5bad21,_0x5d38dd,_0xf88b2b,_0x14bba4)=>{for(var _0x4caf76=_0x14bba4>0x1?void 0x0:_0x14bba4?_0x96d9f9(_0x5d38dd,_0xf88b2b):_0x5d38dd,_0x353682=_0x5bad21['length']-0x1,_0x1021a4;_0x353682>=0x0;_0x353682--)(_0x1021a4=_0x5bad21[_0x353682])&&(_0x4caf76=(_0x14bba4?_0x1021a4(_0x5d38dd,_0xf88b2b,_0x4caf76):_0x1021a4(_0x4caf76))||_0x4caf76);return _0x14bba4&&_0x4caf76&&_0x17d1db(_0x5d38dd,_0xf88b2b,_0x4caf76),_0x4caf76;},_0x92337=(_0x3dde97,_0x5785dc)=>(_0x5dcd61,_0x4fca71)=>_0x5785dc(_0x5dcd61,_0x4fca71,_0x3dde97);let _0x178dc5=class{constructor(_0x3274c6,_0xc0c9ab){const _0x11f9af=_0x216ec2;this['_injector']=_0x3274c6,this[_0x11f9af(0x2b7)]=_0xc0c9ab;}[_0x216ec2(0x1ec)](_0x5c7203){const _0x2cddae=_0x216ec2;var _0x507ea8;const _0x45e234=this[_0x2cddae(0x400)][_0x2cddae(0x458)](_0x23e2c7['TextSelectionManagerService']),_0x371d00=(_0x507ea8=_0x45e234[_0x2cddae(0x214)]())!=null?_0x507ea8:[],_0x4e8df2=_0x371d00==null?void 0x0:_0x371d00['map'](_0x23e2c7[_0x2cddae(0x2b4)]);if(_0x4e8df2['length']===0x0)return;const _0x4fb2cd=[{'id':_0x2cddae(0x462),'params':{'unitId':_0x5c7203[_0x2cddae(0x281)],'actions':null,'textRanges':_0x4e8df2}}],_0x3eafd6=this[_0x2cddae(0x2b7)][_0x2cddae(0x342)](_0x5c7203,_0x4fb2cd);if(!_0x245d5b[_0x2cddae(0x566)](_0x3eafd6))throw _0x3eafd6[_0x2cddae(0x2ff)];const _0x39f5a1=_0x3eafd6['m2Prime'][0x0][_0x2cddae(0x31b)][_0x2cddae(0x53d)];Array[_0x2cddae(0x240)](_0x39f5a1)&&_0x39f5a1[_0x2cddae(0x48b)]&&_0x45e234[_0x2cddae(0x587)](_0x39f5a1,!0x1);}};_0x178dc5=_0x350098([_0x92337(0x0,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x236)])),_0x92337(0x1,_0x245d5b[_0x216ec2(0x3e8)])],_0x178dc5);function _0x30178f(_0x495c75){let _0x118758='';for(const _0x3c2c47 of _0x495c75){const {startOffset:_0x30a53e,endOffset:_0x40db13,isActive:_0xd46cab}=_0x3c2c47;_0x118758['length']&&(_0x118758+=','),_0x118758+=_0x30a53e+':'+_0x40db13+':'+(_0xd46cab?'1':'0');}return _0x118758;}function _0x7f9667(_0x6d917f){const _0x3f9821=_0x216ec2,_0x5d8b5d=_0x6d917f['split'](','),_0x2e7f91=[];for(const _0x302777 of _0x5d8b5d){const [_0x148631,_0x111fd2,_0x985f8c]=_0x302777['split'](':');_0x2e7f91[_0x3f9821(0x2af)]({'startOffset':Number(_0x148631),'endOffset':Number(_0x111fd2),'collapsed':_0x148631===_0x111fd2,'isActive':_0x985f8c==='1'});}return _0x2e7f91[_0x3f9821(0x548)](_0x56c001=>_0x56c001[_0x3f9821(0x3d9)])||(_0x2e7f91[0x0][_0x3f9821(0x3d9)]=!0x0),_0x2e7f91;}class _0x6344ed extends _0x207f05[_0x216ec2(0x48f)]{constructor(){const _0x870f36=_0x216ec2;super(...arguments),_0x574c73(this,_0x870f36(0x51d),new _0xb87526['BehaviorSubject'](null)),_0x574c73(this,'collabCursorState$',this[_0x870f36(0x51d)][_0x870f36(0x330)]());}[_0x216ec2(0x5b6)](_0x1fe0ba){const _0xd23881=_0x216ec2,{unitID:_0x12a305,memberID:_0x48bc06,textRanges:_0x43c3ee}=_0x1fe0ba,_0x5efe69=_0x30178f(_0x43c3ee),_0x2fd168={'unitID':_0x12a305,'memberID':_0x48bc06,'selection':_0x5efe69};this[_0xd23881(0x51d)][_0xd23881(0x473)](_0x2fd168);}}var _0x25315f=Object['defineProperty'],_0x2c4bf9=Object[_0x216ec2(0x498)],_0x1ba12d=(_0x4077c5,_0x59180b,_0x395c1b,_0x2a086c)=>{const _0x314485=_0x216ec2;for(var _0x3bbc36=_0x2a086c>0x1?void 0x0:_0x2a086c?_0x2c4bf9(_0x59180b,_0x395c1b):_0x59180b,_0x397a76=_0x4077c5[_0x314485(0x48b)]-0x1,_0x5a6779;_0x397a76>=0x0;_0x397a76--)(_0x5a6779=_0x4077c5[_0x397a76])&&(_0x3bbc36=(_0x2a086c?_0x5a6779(_0x59180b,_0x395c1b,_0x3bbc36):_0x5a6779(_0x3bbc36))||_0x3bbc36);return _0x2a086c&&_0x3bbc36&&_0x25315f(_0x59180b,_0x395c1b,_0x3bbc36),_0x3bbc36;},_0x4a5661=(_0x2351a0,_0x4b68f1)=>(_0x547a38,_0x1066b6)=>_0x4b68f1(_0x547a38,_0x1066b6,_0x2351a0);function _0x879376(_0x3714b1){const _0x3770be=_0x216ec2,{unitID:_0x101829,mutations:_0x27854f}=_0x3714b1;return{'unitId':_0x101829,'subUnitId':_0x27854f[0x0]['params'][_0x3770be(0x22d)]};}let _0x53b567=class{constructor(_0x30478d,_0x137ff2){const _0x276f62=_0x216ec2;this[_0x276f62(0x400)]=_0x30478d,this['_transformService']=_0x137ff2;}[_0x216ec2(0x1ec)](_0x3d89db){const _0x426a17=_0x216ec2;var _0x544b7f,_0x21a738,_0x5684b5;const _0x1044c7=this[_0x426a17(0x400)][_0x426a17(0x458)](_0x4aca4a['SheetsSelectionsService']),{unitId:_0xf3f569,subUnitId:_0x55ecdc}=_0x879376(_0x3d89db),_0x2a23c4=_0x1044c7[_0x426a17(0x455)](_0xf3f569)[_0x426a17(0x214)]();if(_0x2a23c4['length']===0x0||!_0xf3f569||!_0x55ecdc)return;const _0x231c0c=[{'id':_0x4aca4a[_0x426a17(0x308)]['id'],'params':{'unitId':_0xf3f569,'subUnitId':_0x55ecdc,'selections':_0x207f05[_0x426a17(0x46e)][_0x426a17(0x442)](_0x2a23c4)}}],_0xfc92ce=this[_0x426a17(0x2b7)][_0x426a17(0x342)](_0x3d89db,_0x231c0c);if(!_0x245d5b[_0x426a17(0x566)](_0xfc92ce))throw _0xfc92ce[_0x426a17(0x2ff)];const _0x15e0b8=(_0x5684b5=(_0x21a738=(_0x544b7f=_0xfc92ce[_0x426a17(0x49e)][0x0])==null?void 0x0:_0x544b7f[_0x426a17(0x31b)])==null?void 0x0:_0x21a738[_0x426a17(0x502)])!=null?_0x5684b5:_0x2a23c4;Array[_0x426a17(0x240)](_0x15e0b8)&&_0x15e0b8['length']&&this[_0x426a17(0x400)][_0x426a17(0x458)](_0x207f05[_0x426a17(0x460)])[_0x426a17(0x2d7)](_0x4aca4a['SetSelectionsOperation']['id'],{'unitId':_0xf3f569,'subUnitId':_0x55ecdc,'selections':_0x15e0b8});}};_0x53b567=_0x1ba12d([_0x4a5661(0x0,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x236)])),_0x4a5661(0x1,_0x245d5b['ITransformService'])],_0x53b567);const _0x42cada=new Set([_0x4aca4a[_0x216ec2(0x3d5)]['id']]);function _0x4e0660(_0x4b4b92,_0x35f9f6,_0x1080ab,_0x3c92a5,_0x1231eb){const _0xe46f05=_0x216ec2;var _0x3b162e,_0x5b0133,_0xf4455f,_0x1b38d4;const _0x12e63e=[];for(const _0x49a458 of _0x4b4b92)if(_0x42cada['has'](_0x49a458['id'])){if(_0x12e63e['length']>0x0)break;_0x12e63e[_0xe46f05(0x2af)](_0x49a458);break;}else _0x12e63e[_0xe46f05(0x2af)](_0x49a458);const _0x27ab3c=(_0x5b0133=(_0x3b162e=_0x1231eb[_0xe46f05(0x34c)]())==null?void 0x0:_0x3b162e[_0xe46f05(0x414)])!=null?_0x5b0133:_0xe46f05(0x471),_0x14dbbd=(_0x1b38d4=(_0xf4455f=_0x1231eb[_0xe46f05(0x34c)]())==null?void 0x0:_0xf4455f[_0xe46f05(0x305)])!=null?_0x1b38d4:_0xe46f05(0x471);return{'changeset':{'unitID':_0x35f9f6,'type':_0x245d5b[_0xe46f05(0x3cf)](_0x1080ab[_0xe46f05(0x26c)](_0x35f9f6)),'baseRev':_0x3c92a5[_0xe46f05(0x4c4)](_0x35f9f6),'revision':0x0,'userID':_0x27ab3c,'memberID':_0x14dbbd,'mutations':_0x12e63e},'pendingMutations':_0x4b4b92[_0xe46f05(0x276)](_0x12e63e[_0xe46f05(0x48b)])};}function _0x3487ec(_0x3c7f16,_0x507e21,_0x2bc0ae,_0x33a216,_0x1b201e){const _0x4f6726=_0x216ec2;var _0x49ec1d,_0x42b761,_0x22294b,_0x597cb9;const _0x563eef=[_0x3c7f16[_0x4f6726(0x59f)]((_0x43bdf1,_0x35d794)=>{const _0x471848=_0x4f6726;var _0x558558;const {id:_0x2a8ff5}=_0x43bdf1,{id:_0x4ce7cc,type:_0x170289}=_0x35d794,_0x14b707=(_0x558558=_0x43bdf1[_0x471848(0x31b)])!=null?_0x558558:{'actions':null},_0x349742=_0x35d794[_0x471848(0x31b)];if(_0x2a8ff5&&_0x2a8ff5!==_0x4ce7cc)throw new Error('Cannot\x20assemble\x20a\x20changeset\x20from\x20multiple\x20mutations\x20of\x20different\x20types:\x20'+_0x2a8ff5+'\x20-\x20'+_0x4ce7cc+'.');return{..._0x43bdf1,'id':_0x4ce7cc,'type':_0x170289,'params':{'unitId':_0x349742[_0x471848(0x432)],'textRanges':_0x349742['textRanges'],'actions':_0x207f05['JSONX'][_0x471848(0x337)](_0x14b707[_0x471848(0x3f2)],_0x349742[_0x471848(0x3f2)])}};},{})],_0x467459=(_0x42b761=(_0x49ec1d=_0x1b201e['getCurrentUser']())==null?void 0x0:_0x49ec1d['userID'])!=null?_0x42b761:'unknown',_0x937e08=(_0x597cb9=(_0x22294b=_0x1b201e['getCurrentUser']())==null?void 0x0:_0x22294b[_0x4f6726(0x305)])!=null?_0x597cb9:_0x4f6726(0x471);return{'changeset':{'unitID':_0x507e21,'type':_0x245d5b[_0x4f6726(0x3cf)](_0x2bc0ae[_0x4f6726(0x26c)](_0x507e21)),'baseRev':_0x33a216[_0x4f6726(0x4c4)](_0x507e21),'revision':0x0,'userID':_0x467459,'memberID':_0x937e08,'mutations':_0x563eef},'pendingMutations':[]};}const _0x5392a9={'id':_0x4aca4a[_0x216ec2(0x36e)]['id'],'type':_0x207f05['CommandType'][_0x216ec2(0x53e)],'params':{}};var _0x2faf0a=Object[_0x216ec2(0x3d2)],_0x4cc503=Object[_0x216ec2(0x498)],_0x5dabb1=(_0x46e590,_0x3167bb,_0x2a19d1,_0x3cbfda)=>{const _0x19bc88=_0x216ec2;for(var _0x5c28a1=_0x3cbfda>0x1?void 0x0:_0x3cbfda?_0x4cc503(_0x3167bb,_0x2a19d1):_0x3167bb,_0x350933=_0x46e590[_0x19bc88(0x48b)]-0x1,_0x5463fb;_0x350933>=0x0;_0x350933--)(_0x5463fb=_0x46e590[_0x350933])&&(_0x5c28a1=(_0x3cbfda?_0x5463fb(_0x3167bb,_0x2a19d1,_0x5c28a1):_0x5463fb(_0x5c28a1))||_0x5c28a1);return _0x3cbfda&&_0x5c28a1&&_0x2faf0a(_0x3167bb,_0x2a19d1,_0x5c28a1),_0x5c28a1;},_0x55c4fb=(_0x127494,_0x30f260)=>(_0x17d2f3,_0x1d2573)=>_0x30f260(_0x17d2f3,_0x1d2573,_0x127494),_0x128ded=(_0x399a72=>(_0x399a72[_0x216ec2(0x3fe)]=_0x216ec2(0x51f),_0x399a72[_0x216ec2(0x41b)]=_0x216ec2(0x52b),_0x399a72[_0x216ec2(0x48e)]='pending',_0x399a72[_0x216ec2(0x224)]=_0x216ec2(0x4c9),_0x399a72['AWAITING_WITH_PENDING']=_0x216ec2(0x49d),_0x399a72['FETCH_MISS']=_0x216ec2(0x5b4),_0x399a72['CONFLICT']=_0x216ec2(0x1ef),_0x399a72['OFFLINE']=_0x216ec2(0x579),_0x399a72))(_0x128ded||{});class _0x40ef25{constructor(_0x19b18d,_0xaa6188,_0x849476,_0x1875a3,_0x22808e,_0x581a23,_0x4ac83c,_0x536262,_0x591a8b){const _0x4df244=_0x216ec2;_0x574c73(this,_0x4df244(0x301),null),_0x574c73(this,_0x4df244(0x376),[]),(this['unitID']=_0x19b18d,this[_0x4df244(0x42a)]=_0xaa6188,this['_handler']=_0x22808e,this['_commandService']=_0x581a23,this[_0x4df244(0x1fa)]=_0x4ac83c,this['_revisionService']=_0x536262,this[_0x4df244(0x503)]=_0x591a8b,this['_awaitingChangeset']=_0x849476,this[_0x4df244(0x376)]=_0x1875a3);}[_0x216ec2(0x3fb)](_0x14a688){const _0x25b660=_0x216ec2,_0x25eae2=this[_0x25b660(0x317)][_0x25b660(0x4c4)](this[_0x25b660(0x281)]);return _0x14a688[_0x25b660(0x40c)]>_0x25eae2+0x1?(this['_handler']['onMissingChangesets']({'from':_0x25eae2,'to':_0x14a688[_0x25b660(0x40c)]-0x1}),!0x0):!0x1;}['_transformUndoredo'](_0x372050){const _0x353479=_0x216ec2;this[_0x353479(0x1fa)][_0x353479(0x3de)](this[_0x353479(0x281)],_0x372050);}['_transformSelections'](_0x288064){const _0x30e46a=_0x216ec2;var _0x29efb0,_0x5de3a1;(_0x5de3a1=(_0x29efb0=this[_0x30e46a(0x4bb)])[_0x30e46a(0x5b2)])==null||_0x5de3a1[_0x30e46a(0x2cf)](_0x29efb0,_0x288064);}[_0x216ec2(0x39e)](_0x3fc904){const _0x59389e=_0x216ec2;var _0x4b6247,_0xa7bb96;return(_0xa7bb96=(_0x4b6247=this[_0x59389e(0x4bb)])['onTransformIME'])==null?void 0x0:_0xa7bb96['call'](_0x4b6247,_0x3fc904);}[_0x216ec2(0x4f4)](_0x9b3dc6){const _0x5151c2=_0x216ec2;var _0x3eebce,_0x2424a6,_0x6bc85e;return(_0x6bc85e=(_0x2424a6=(_0x3eebce=this['_handler'])['onTransformRemoteChangesetByIMECache'])==null?void 0x0:_0x2424a6[_0x5151c2(0x2cf)](_0x3eebce,_0x9b3dc6))!=null?_0x6bc85e:_0x9b3dc6;}['_syncEditingCollabCursor'](_0x240ef8){const _0x197078=_0x216ec2;var _0xf366bf,_0x46e311;if(this[_0x197078(0x42a)]===_0x18cf2f[_0x197078(0x27f)]){const {unitID:_0x298d2f,mutations:_0x5e0cad,memberID:_0x230458}=_0x240ef8,_0xbd61c3=_0x5e0cad[0x0]['params'][_0x197078(0x53d)];Array[_0x197078(0x240)](_0xbd61c3)&&_0xbd61c3[_0x197078(0x48b)]>0x0&&((_0x46e311=(_0xf366bf=this['_handler'])['onSyncEditingCollabCursor'])==null||_0x46e311[_0x197078(0x2cf)](_0xf366bf,{'unitID':_0x298d2f,'memberID':_0x230458,'textRanges':_0xbd61c3}));}}[_0x216ec2(0x2ed)](){const _0x34a61c=_0x216ec2;this['_localCacheService']['updateOfflineData'](this[_0x34a61c(0x281)],this[_0x34a61c(0x42a)],this[_0x34a61c(0x301)],this['_pendingMutations']);}['_getCurrentRevision'](){const _0x25793c=_0x216ec2;return this[_0x25793c(0x317)][_0x25793c(0x4c4)](this[_0x25793c(0x281)]);}[_0x216ec2(0x3a5)](){const _0x3f0c77=_0x216ec2;this[_0x3f0c77(0x317)][_0x3f0c77(0x1ed)](this[_0x3f0c77(0x281)]);}[_0x216ec2(0x50a)](_0x582491){const _0x1b682e=_0x216ec2;var _0x5a8b04;const _0x4e57a6=this[_0x1b682e(0x4f4)](_0x582491),_0x56303f=_0x207f05['sequenceExecute'](_0x4e57a6[_0x1b682e(0x1cc)],this[_0x1b682e(0x2e7)],{'fromCollab':!0x0});if(!_0x56303f[_0x1b682e(0x20e)])throw _0x56303f[_0x1b682e(0x2ff)]instanceof Error?_0x56303f['error']:new Error((_0x5a8b04=_0x56303f['error'])!=null?_0x5a8b04:_0x1b682e(0x223));this[_0x1b682e(0x39e)](_0x4e57a6),this[_0x1b682e(0x25c)](_0x582491),this[_0x1b682e(0x26e)](_0x4e57a6),this[_0x1b682e(0x3a4)](_0x4e57a6),this[_0x1b682e(0x3a5)]();}}let _0x1c6675=class extends _0x40ef25{constructor(_0x125539,_0x26a368,_0xde0abe,_0x13af56,_0x4833cb,_0x3e9575,_0x2288a3,_0x8dd3dc,_0x164c8f,_0x84e320){const _0x598b89=_0x216ec2;super(_0x125539,_0x26a368,null,[],_0xde0abe,_0x8dd3dc,_0x2288a3,_0x13af56,_0x4833cb),_0x574c73(this,_0x598b89(0x200),'synced'),(this['_injector']=_0x3e9575,this[_0x598b89(0x352)]=_0x164c8f,this[_0x598b89(0x2b7)]=_0x84e320);}[_0x216ec2(0x4a6)](_0x5b71aa){const _0x5a7cd4=_0x216ec2,_0x5e00a7=this[_0x5a7cd4(0x400)]['createInstance'](_0x1d3c19,this['unitID'],this[_0x5a7cd4(0x42a)],[_0x5b71aa],this['_handler']);return _0x5e00a7[_0x5a7cd4(0x428)](),_0x5e00a7['_updateLocalCache'](),_0x5e00a7;}[_0x216ec2(0x41a)](_0x112acf){const _0x3421c8=_0x216ec2;if(this['_checkMissing'](_0x112acf))return this[_0x3421c8(0x400)][_0x3421c8(0x596)](_0x33e1bf,this[_0x3421c8(0x281)],this[_0x3421c8(0x42a)],null,[],null,[_0x112acf],this[_0x3421c8(0x4bb)]);try{const _0x5ba76b=this['_transformService']['transformMutationsWithChangeset'](_0x112acf,[_0x5392a9]);if(_0x245d5b['isTransformMutationsWithChangesetSuccess'](_0x5ba76b)){const {c1Prime:_0x1a1512}=_0x5ba76b;return this[_0x3421c8(0x50a)](_0x1a1512),this;}throw _0x5ba76b['error'];}catch(_0x4efd4a){return this[_0x3421c8(0x352)][_0x3421c8(0x2ff)](_0x4efd4a),this[_0x3421c8(0x4e4)](!0x1);}}[_0x216ec2(0x4e4)](_0x5a1ec2){const _0x5715c1=_0x216ec2;return this[_0x5715c1(0x400)][_0x5715c1(0x596)](_0x31c2f6,this[_0x5715c1(0x281)],this[_0x5715c1(0x42a)],null,[],this[_0x5715c1(0x4bb)],_0x5a1ec2);}[_0x216ec2(0x561)](){throw new Error('[SyncedState]:\x20received\x20acknowledgement.');}['onRemoteRej'](){const _0xfc6128=_0x216ec2;throw new Error(_0xfc6128(0x286));}[_0x216ec2(0x1f7)](){const _0x469f89=_0x216ec2;return this['_injector'][_0x469f89(0x596)](_0x15e845,this[_0x469f89(0x281)],this[_0x469f89(0x42a)],null,[],this['_handler']);}['toggleOnline'](){return this;}[_0x216ec2(0x3ec)](){const _0x1ca827=_0x216ec2;throw new Error(_0x1ca827(0x487));}};_0x1c6675=_0x5dabb1([_0x55c4fb(0x3,_0x207f05[_0x216ec2(0x511)](_0x245d5b[_0x216ec2(0x586)])),_0x55c4fb(0x4,_0x207f05[_0x216ec2(0x511)](_0x11abd7[_0x216ec2(0x1d2)])),_0x55c4fb(0x5,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x236)])),_0x55c4fb(0x6,_0x207f05[_0x216ec2(0x3f3)]),_0x55c4fb(0x7,_0x207f05[_0x216ec2(0x460)]),_0x55c4fb(0x8,_0x207f05[_0x216ec2(0x3ba)]),_0x55c4fb(0x9,_0x245d5b[_0x216ec2(0x3e8)])],_0x1c6675);let _0x1d3c19=class extends _0x40ef25{constructor(_0x341254,_0xc76290,_0x508dd3,_0x16725e,_0x15265b,_0x3c9e01,_0x456409,_0x35e89e,_0x2ef493,_0x13a264,_0x47e9bd,_0xac4407,_0x1506bc,_0x2d18a3){const _0x275c77=_0x216ec2;super(_0x341254,_0xc76290,null,_0x508dd3,_0x16725e,_0x13a264,_0x2d18a3,_0x3c9e01,_0x456409),_0x574c73(this,_0x275c77(0x200),_0x275c77(0x556)),_0x574c73(this,_0x275c77(0x564),null),_0x574c73(this,'_sendingTimer',null),(this[_0x275c77(0x400)]=_0x15265b,this[_0x275c77(0x250)]=_0x35e89e,this[_0x275c77(0x352)]=_0x2ef493,this['_configService']=_0x47e9bd,this[_0x275c77(0x2b7)]=_0xac4407,this[_0x275c77(0x255)]=_0x1506bc);}[_0x216ec2(0x4a6)](_0x2431b2){const _0x1529e2=_0x216ec2;return this[_0x1529e2(0x376)][_0x1529e2(0x2af)](_0x2431b2),this[_0x1529e2(0x2ed)](),this;}[_0x216ec2(0x41a)](_0x579624){const _0x3c3865=_0x216ec2;if(this[_0x3c3865(0x3fb)](_0x579624))return this[_0x3c3865(0x30f)](),this[_0x3c3865(0x400)][_0x3c3865(0x596)](_0x33e1bf,this['unitID'],this[_0x3c3865(0x42a)],null,this[_0x3c3865(0x376)],null,[_0x579624],this[_0x3c3865(0x4bb)]);try{const _0x492a16=this[_0x3c3865(0x2b7)][_0x3c3865(0x342)](_0x579624,this[_0x3c3865(0x376)]);if(_0x245d5b['isTransformMutationsWithChangesetSuccess'](_0x492a16)){const {c1Prime:_0x4a673f,m2Prime:_0x2d7d39}=_0x492a16;this[_0x3c3865(0x50a)](_0x4a673f);const _0x5dc327=this[_0x3c3865(0x400)][_0x3c3865(0x596)](_0x1d3c19,this[_0x3c3865(0x281)],this['type'],_0x2d7d39,this[_0x3c3865(0x4bb)]);return this[_0x3c3865(0x30f)](),_0x5dc327[_0x3c3865(0x428)](this[_0x3c3865(0x564)]?Math[_0x3c3865(0x4b1)](0x0,new Date()['getTime']()-this['_scheduleTimestamp']):this[_0x3c3865(0x418)]()),_0x5dc327;}throw _0x492a16[_0x3c3865(0x2ff)];}catch(_0x9a0c51){return this[_0x3c3865(0x352)][_0x3c3865(0x2ff)](_0x9a0c51),this[_0x3c3865(0x4e4)](!0x1);}}[_0x216ec2(0x561)](){const _0x5cc4b6=_0x216ec2;throw new Error(_0x5cc4b6(0x3cd));}[_0x216ec2(0x2ad)](){throw new Error('[PendingState]:\x20received\x20rejection.');}[_0x216ec2(0x1f7)](){const _0x22b3de=_0x216ec2;return this[_0x22b3de(0x30f)](),this[_0x22b3de(0x400)]['createInstance'](_0x15e845,this[_0x22b3de(0x281)],this[_0x22b3de(0x42a)],null,this[_0x22b3de(0x376)],this['_handler']);}[_0x216ec2(0x388)](){return this;}[_0x216ec2(0x428)](_0x2a16b5){const _0x5a2bea=_0x216ec2;_0x2a16b5=_0x2a16b5!=null?_0x2a16b5:this[_0x5a2bea(0x418)](),this['_scheduleTimestamp']=new Date()[_0x5a2bea(0x245)](),this[_0x5a2bea(0x2d2)]=setTimeout(()=>{const _0x1c70d4=_0x5a2bea;this['_clearScheduledTask']();let _0x538f4f=null;switch(this[_0x1c70d4(0x42a)]){case _0x18cf2f[_0x1c70d4(0x429)]:{_0x538f4f=_0x4e0660(this['_pendingMutations'],this[_0x1c70d4(0x281)],this['_univerInstanceService'],this[_0x1c70d4(0x317)],this[_0x1c70d4(0x250)]);break;}case _0x18cf2f[_0x1c70d4(0x27f)]:{this[_0x1c70d4(0x376)]['every'](_0x1071bf=>_0x1071bf['id']===_0x23e2c7[_0x1c70d4(0x437)]['id'])?_0x538f4f=_0x3487ec(this[_0x1c70d4(0x376)],this['unitID'],this[_0x1c70d4(0x255)],this[_0x1c70d4(0x317)],this[_0x1c70d4(0x250)]):_0x538f4f=_0x4e0660(this[_0x1c70d4(0x376)],this[_0x1c70d4(0x281)],this['_univerInstanceService'],this[_0x1c70d4(0x317)],this[_0x1c70d4(0x250)]);break;}default:throw new Error(_0x1c70d4(0x527)+this[_0x1c70d4(0x42a)]+'\x20in\x20_schedule.');}const {changeset:_0x1e46af,pendingMutations:_0x5dd52f}=_0x538f4f;this['_handler'][_0x1c70d4(0x417)](_0x1e46af);const _0x105170=_0x5dd52f[_0x1c70d4(0x48b)]?this['_injector'][_0x1c70d4(0x596)](_0x467ffb,this['unitID'],this['type'],_0x1e46af,_0x5dd52f,this[_0x1c70d4(0x4bb)]):this[_0x1c70d4(0x400)][_0x1c70d4(0x596)](_0x5e9373,this['unitID'],this[_0x1c70d4(0x42a)],_0x1e46af,this[_0x1c70d4(0x4bb)]);_0x105170[_0x1c70d4(0x2ed)](),this['_handler'][_0x1c70d4(0x2e5)](this,_0x105170);},_0x2a16b5);}[_0x216ec2(0x418)](){const _0x4bfdc1=_0x216ec2;var _0x84a0bc;return(_0x84a0bc=this['_configService'][_0x4bfdc1(0x426)](_0x4e28eb))!=null?_0x84a0bc:0x7d0;}['resend'](){const _0xd138c6=_0x216ec2;throw new Error(_0xd138c6(0x2ae));}[_0x216ec2(0x30f)](){const _0x166d86=_0x216ec2;this[_0x166d86(0x2d2)]!=null&&(clearTimeout(this[_0x166d86(0x2d2)]),this['_sendingTimer']=null);}[_0x216ec2(0x4e4)](_0x2133b9){const _0x31fb69=_0x216ec2;return this[_0x31fb69(0x30f)](),this['_injector'][_0x31fb69(0x596)](_0x31c2f6,this[_0x31fb69(0x281)],this['type'],null,this[_0x31fb69(0x376)],this[_0x31fb69(0x4bb)],_0x2133b9);}};_0x1d3c19=_0x5dabb1([_0x55c4fb(0x4,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x236)])),_0x55c4fb(0x5,_0x207f05['Inject'](_0x245d5b['RevisionService'])),_0x55c4fb(0x6,_0x207f05[_0x216ec2(0x511)](_0x11abd7[_0x216ec2(0x1d2)])),_0x55c4fb(0x7,_0x207f05[_0x216ec2(0x511)](_0x35ecb0)),_0x55c4fb(0x8,_0x207f05[_0x216ec2(0x3ba)]),_0x55c4fb(0x9,_0x207f05[_0x216ec2(0x460)]),_0x55c4fb(0xa,_0x207f05[_0x216ec2(0x244)]),_0x55c4fb(0xb,_0x245d5b[_0x216ec2(0x3e8)]),_0x55c4fb(0xc,_0x207f05['IUniverInstanceService']),_0x55c4fb(0xd,_0x207f05['IUndoRedoService'])],_0x1d3c19);let _0x5e9373=class extends _0x40ef25{constructor(_0x593201,_0x51d690,_0x22454d,_0x3a904c,_0x1a73b4,_0x199a69,_0x5387ec,_0x3fb027,_0x94672b,_0x15611f,_0x136c95){const _0x104af4=_0x216ec2;super(_0x593201,_0x51d690,_0x22454d,[],_0x3a904c,_0x3fb027,_0x136c95,_0x199a69,_0x5387ec),_0x574c73(this,'status',_0x104af4(0x4c9)),(this['_injector']=_0x1a73b4,this['_logService']=_0x94672b,this[_0x104af4(0x2b7)]=_0x15611f);}[_0x216ec2(0x4a6)](_0x510551){const _0x6e02d=_0x216ec2,_0xfbe889=this['_injector']['createInstance'](_0x467ffb,this['unitID'],this[_0x6e02d(0x42a)],this[_0x6e02d(0x301)],[_0x510551],this['_handler']);return _0xfbe889[_0x6e02d(0x2ed)](),_0xfbe889;}[_0x216ec2(0x41a)](_0x462694){const _0x2c6880=_0x216ec2;if(this[_0x2c6880(0x3fb)](_0x462694))return this[_0x2c6880(0x400)]['createInstance'](_0x33e1bf,this[_0x2c6880(0x281)],this[_0x2c6880(0x42a)],this[_0x2c6880(0x301)],[],null,[_0x462694],this[_0x2c6880(0x4bb)]);try{const _0x240f73=this['_transformService'][_0x2c6880(0x3c5)]([_0x462694],[this[_0x2c6880(0x301)]],!0x1);if(_0x245d5b[_0x2c6880(0x2d0)](_0x240f73)){const {c1Prime:_0x41d7bf,c2Prime:_0x5c4d40}=_0x240f73;this[_0x2c6880(0x50a)](_0x41d7bf[0x0]),_0x5c4d40[0x0]['baseRev']=this['_getCurrentRevision']();const _0x4c4602=this['_injector'][_0x2c6880(0x596)](_0x5e9373,this[_0x2c6880(0x281)],this[_0x2c6880(0x42a)],_0x5c4d40[0x0],this[_0x2c6880(0x4bb)]);return _0x4c4602[_0x2c6880(0x2ed)](),_0x4c4602;}return this[_0x2c6880(0x4e4)](!0x1);}catch(_0x31eabb){return this[_0x2c6880(0x352)][_0x2c6880(0x2ff)](_0x31eabb),this['_onConflict'](!0x1);}}['onRemoteAck'](_0x2083bb){const _0x416499=_0x216ec2,_0x531630=this[_0x416499(0x317)][_0x416499(0x4c4)](this[_0x416499(0x281)]);if(_0x2083bb[_0x416499(0x40c)]<_0x531630-0x1)return this;if(this[_0x416499(0x3fb)](_0x2083bb))return this['_injector']['createInstance'](_0x33e1bf,this[_0x416499(0x281)],this['type'],null,[],this[_0x416499(0x301)],[],this[_0x416499(0x4bb)]);this['_incrementRevisionNumber']();const _0x159dde=this['_injector'][_0x416499(0x596)](_0x1c6675,this['unitID'],this[_0x416499(0x42a)],this[_0x416499(0x4bb)]);return _0x159dde[_0x416499(0x2ed)](),_0x159dde;}['onRemoteRej'](_0x4663cb){const _0xa64bf3=_0x216ec2;return this[_0xa64bf3(0x4e4)](!!(_0x4663cb!=null&&_0x4663cb[_0xa64bf3(0x397)]));}[_0x216ec2(0x1f7)](){const _0xcfd270=_0x216ec2;return this[_0xcfd270(0x400)][_0xcfd270(0x596)](_0x15e845,this[_0xcfd270(0x281)],this[_0xcfd270(0x42a)],this[_0xcfd270(0x301)],[],this[_0xcfd270(0x4bb)]);}[_0x216ec2(0x388)](){return this;}[_0x216ec2(0x3ec)](){const _0x46757e=_0x216ec2;this[_0x46757e(0x4bb)]['onSendChangeset'](this['_awaitingChangeset']);}[_0x216ec2(0x4e4)](_0x1d533){const _0x17621e=_0x216ec2;return this['_injector'][_0x17621e(0x596)](_0x31c2f6,this[_0x17621e(0x281)],this[_0x17621e(0x42a)],this[_0x17621e(0x301)],[],this[_0x17621e(0x4bb)],_0x1d533);}};_0x5e9373=_0x5dabb1([_0x55c4fb(0x4,_0x207f05['Inject'](_0x207f05[_0x216ec2(0x236)])),_0x55c4fb(0x5,_0x207f05[_0x216ec2(0x511)](_0x245d5b[_0x216ec2(0x586)])),_0x55c4fb(0x6,_0x207f05[_0x216ec2(0x511)](_0x11abd7[_0x216ec2(0x1d2)])),_0x55c4fb(0x7,_0x207f05['ICommandService']),_0x55c4fb(0x8,_0x207f05['ILogService']),_0x55c4fb(0x9,_0x245d5b[_0x216ec2(0x3e8)]),_0x55c4fb(0xa,_0x207f05[_0x216ec2(0x3f3)])],_0x5e9373);let _0x467ffb=class extends _0x40ef25{constructor(_0x138073,_0x54e714,_0x32ddb,_0x7875e9,_0x162d39,_0x346945,_0x5bfd9d,_0x217fa2,_0x412988,_0x2537b2,_0x4ca668,_0x4c8b56){const _0x35aaa7=_0x216ec2;super(_0x138073,_0x54e714,_0x32ddb,_0x7875e9,_0x162d39,_0x412988,_0x4c8b56,_0x5bfd9d,_0x217fa2),_0x574c73(this,'status',_0x35aaa7(0x49d)),(this['_injector']=_0x346945,this['_logService']=_0x2537b2,this[_0x35aaa7(0x2b7)]=_0x4ca668);}[_0x216ec2(0x4a6)](_0x134c11){const _0x5a182e=_0x216ec2;return this[_0x5a182e(0x376)][_0x5a182e(0x2af)](_0x134c11),this;}['onRemoteChangeset'](_0x11144e){const _0x24768a=_0x216ec2;if(this[_0x24768a(0x3fb)](_0x11144e))return this['_injector'][_0x24768a(0x596)](_0x33e1bf,this[_0x24768a(0x281)],this[_0x24768a(0x42a)],this[_0x24768a(0x301)],this['_pendingMutations'],null,[_0x11144e],this[_0x24768a(0x4bb)]);try{const _0xa35a0c=this['_transformService'][_0x24768a(0x3c5)]([_0x11144e],[this['_awaitingChangeset']],!0x1);if(_0x245d5b[_0x24768a(0x2d0)](_0xa35a0c)){const {c1Prime:_0x2047b4,c2Prime:_0x5b7f79}=_0xa35a0c,_0x4223a9=this[_0x24768a(0x2b7)][_0x24768a(0x342)](_0x2047b4[0x0],this[_0x24768a(0x376)]);if(_0x245d5b[_0x24768a(0x566)](_0x4223a9)){const {c1Prime:_0x42dc18,m2Prime:_0x55b09c}=_0x4223a9;return this[_0x24768a(0x50a)](_0x42dc18),_0x5b7f79[0x0][_0x24768a(0x54c)]=this[_0x24768a(0x3a3)](),this['_injector'][_0x24768a(0x596)](_0x467ffb,this[_0x24768a(0x281)],this[_0x24768a(0x42a)],_0x5b7f79[0x0],_0x55b09c,this[_0x24768a(0x4bb)]);}throw _0x4223a9[_0x24768a(0x2ff)];}throw _0xa35a0c[_0x24768a(0x2ff)];}catch(_0x3d7597){return this['_logService'][_0x24768a(0x2ff)](_0x3d7597),this[_0x24768a(0x4e4)](!0x1);}}[_0x216ec2(0x561)](_0x52a4e7){const _0x265e78=_0x216ec2;if(this[_0x265e78(0x3fb)](_0x52a4e7))return this[_0x265e78(0x400)][_0x265e78(0x596)](_0x33e1bf,this['unitID'],this[_0x265e78(0x42a)],null,this[_0x265e78(0x376)],this[_0x265e78(0x301)],[],this[_0x265e78(0x4bb)]);this[_0x265e78(0x3a5)]();const _0x25437d=this[_0x265e78(0x400)][_0x265e78(0x596)](_0x1d3c19,this[_0x265e78(0x281)],this['type'],this[_0x265e78(0x376)],this[_0x265e78(0x4bb)]);return _0x25437d[_0x265e78(0x428)](),_0x25437d[_0x265e78(0x2ed)](),_0x25437d;}[_0x216ec2(0x2ad)](_0x22d309){const _0x5222ea=_0x216ec2;return this[_0x5222ea(0x4e4)](!!(_0x22d309!=null&&_0x22d309[_0x5222ea(0x397)]));}[_0x216ec2(0x1f7)](){const _0x4b4cae=_0x216ec2;return this[_0x4b4cae(0x400)][_0x4b4cae(0x596)](_0x15e845,this[_0x4b4cae(0x281)],this[_0x4b4cae(0x42a)],this[_0x4b4cae(0x301)],this[_0x4b4cae(0x376)],this[_0x4b4cae(0x4bb)]);}['toggleOnline'](){return this;}[_0x216ec2(0x3ec)](){const _0x43e90d=_0x216ec2;this[_0x43e90d(0x4bb)][_0x43e90d(0x417)](this[_0x43e90d(0x301)]);}['_onConflict'](_0x238862){const _0x59dd1a=_0x216ec2;return this[_0x59dd1a(0x400)][_0x59dd1a(0x596)](_0x31c2f6,this[_0x59dd1a(0x281)],this[_0x59dd1a(0x42a)],null,this[_0x59dd1a(0x376)],this['_handler'],_0x238862);}};_0x467ffb=_0x5dabb1([_0x55c4fb(0x5,_0x207f05['Inject'](_0x207f05['Injector'])),_0x55c4fb(0x6,_0x207f05[_0x216ec2(0x511)](_0x245d5b[_0x216ec2(0x586)])),_0x55c4fb(0x7,_0x207f05['Inject'](_0x11abd7[_0x216ec2(0x1d2)])),_0x55c4fb(0x8,_0x207f05[_0x216ec2(0x460)]),_0x55c4fb(0x9,_0x207f05['ILogService']),_0x55c4fb(0xa,_0x245d5b['ITransformService']),_0x55c4fb(0xb,_0x207f05[_0x216ec2(0x3f3)])],_0x467ffb);let _0x31c2f6=class extends _0x40ef25{constructor(_0x3756f3,_0x17801b,_0x2fef20,_0x37bd00,_0x4fc6ad,_0xf9fc1e=!0x1,_0x243804,_0x3f34ce,_0x4556c2,_0x36c734,_0x38ae86,_0x56f4a7,_0x37ab98){const _0x2ffd34=_0x216ec2;super(_0x3756f3,_0x17801b,_0x2fef20,_0x37bd00,_0x4fc6ad,_0x3f34ce,_0x4556c2,_0x38ae86,_0x36c734),_0x574c73(this,_0x2ffd34(0x200),_0x2ffd34(0x1ef)),(this[_0x2ffd34(0x24e)]=_0xf9fc1e,this[_0x2ffd34(0x306)]=_0x243804,this[_0x2ffd34(0x220)]=_0x56f4a7,this[_0x2ffd34(0x410)]=_0x37ab98,this[_0x2ffd34(0x356)](),this[_0x2ffd34(0x406)](),this[_0x2ffd34(0x366)]());}['appendMutation'](){return this;}[_0x216ec2(0x41a)](){return this;}[_0x216ec2(0x561)](){return this;}['onRemoteRej'](){return this;}[_0x216ec2(0x1f7)](){return this;}[_0x216ec2(0x388)](){return this;}[_0x216ec2(0x3ec)](){const _0x2d0f1b=_0x216ec2;throw new Error(_0x2d0f1b(0x40f));}[_0x216ec2(0x406)](){const _0x14beae=_0x216ec2;this[_0x14beae(0x503)][_0x14beae(0x20a)](this[_0x14beae(0x281)],this[_0x14beae(0x42a)],null,[]);}[_0x216ec2(0x356)](){const _0x333c5b=_0x216ec2;this[_0x333c5b(0x24e)]?this['_notificationService']['show']({'title':this['_localeService']['t'](_0x333c5b(0x597)),'content':this[_0x333c5b(0x220)]['t'](_0x333c5b(0x2ce)),'type':_0x333c5b(0x2ff),'duration':0x0}):this['_notificationService'][_0x333c5b(0x4ec)]({'title':this[_0x333c5b(0x220)]['t']('conflict.title'),'content':this[_0x333c5b(0x220)]['t'](_0x333c5b(0x2fb)),'type':_0x333c5b(0x2ff),'duration':0x0});}[_0x216ec2(0x366)](){const _0x48f6e0=_0x216ec2;this[_0x48f6e0(0x306)]['updatePermissionPoint'](new _0x4aca4a['WorkbookEditablePermission'](this[_0x48f6e0(0x281)])['id'],!0x1);}};_0x31c2f6=_0x5dabb1([_0x55c4fb(0x6,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x30b)])),_0x55c4fb(0x7,_0x207f05['ICommandService']),_0x55c4fb(0x8,_0x207f05[_0x216ec2(0x3f3)]),_0x55c4fb(0x9,_0x207f05[_0x216ec2(0x511)](_0x11abd7[_0x216ec2(0x1d2)])),_0x55c4fb(0xa,_0x207f05[_0x216ec2(0x511)](_0x245d5b[_0x216ec2(0x586)])),_0x55c4fb(0xb,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x267)])),_0x55c4fb(0xc,_0xd6a4eb[_0x216ec2(0x58d)])],_0x31c2f6);let _0x15e845=class extends _0x40ef25{constructor(_0x1a7aff,_0x1ad8c3,_0x2c376e,_0x9434db,_0x42b2e5,_0x346030,_0x19b9a9,_0x25ce95,_0x59bd0e,_0x54c73c){const _0xcec1c3=_0x216ec2;super(_0x1a7aff,_0x1ad8c3,_0x2c376e,_0x9434db,_0x42b2e5,_0x59bd0e,_0x54c73c,_0x19b9a9,_0x25ce95),_0x574c73(this,'status',_0xcec1c3(0x579)),this['_injector']=_0x346030;}['appendMutation'](_0x52b816){const _0x509abf=_0x216ec2;return this['_pendingMutations']['push'](_0x52b816),this[_0x509abf(0x2ed)](),this;}[_0x216ec2(0x41a)](_0x5b2706){const _0x394903=_0x216ec2;throw new Error(_0x394903(0x4ce));}[_0x216ec2(0x561)](){throw new Error('[OfflineState]:\x20received\x20acknowledgement.');}[_0x216ec2(0x2ad)](){const _0xcf59ef=_0x216ec2;throw new Error(_0xcf59ef(0x28e));}[_0x216ec2(0x1f7)](){return this;}['toggleOnline'](){const _0x5e1290=_0x216ec2,{_injector:_0x3a1efe,_pendingMutations:_0x3ff5b8,_awaitingChangeset:_0x1e4cbf,unitID:_0x17807f,_handler:_0x19c474,type:_0x29d51e}=this,_0x3a651a=_0x57ef53(_0x3a1efe,_0x17807f,_0x29d51e,_0x1e4cbf,_0x3ff5b8,_0x19c474);return _0x3a651a instanceof _0x1d3c19?_0x3a651a[_0x5e1290(0x428)]():(_0x3a651a instanceof _0x467ffb||_0x3a651a instanceof _0x5e9373)&&_0x3a651a['resend'](),_0x3a651a;}[_0x216ec2(0x3ec)](){const _0xf57062=_0x216ec2;throw new Error(_0xf57062(0x315));}};_0x15e845=_0x5dabb1([_0x55c4fb(0x5,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x236)])),_0x55c4fb(0x6,_0x207f05[_0x216ec2(0x511)](_0x245d5b[_0x216ec2(0x586)])),_0x55c4fb(0x7,_0x207f05[_0x216ec2(0x511)](_0x11abd7[_0x216ec2(0x1d2)])),_0x55c4fb(0x8,_0x207f05[_0x216ec2(0x460)]),_0x55c4fb(0x9,_0x207f05[_0x216ec2(0x3f3)])],_0x15e845);let _0x33e1bf=class extends _0x40ef25{constructor(_0x8b2bff,_0x41584a,_0xd3ab96,_0x18fed0,_0x12275a,_0x22f1b6,_0x1212eb,_0x1bdc93,_0x129204,_0x4102e4,_0x2e5530,_0x247464,_0x539f26,_0x19c731){const _0x353b20=_0x216ec2;super(_0x8b2bff,_0x41584a,_0xd3ab96,_0x18fed0,_0x1212eb,_0x247464,_0x539f26,_0x129204,_0x4102e4),_0x574c73(this,_0x353b20(0x200),_0x353b20(0x5b4)),(this[_0x353b20(0x4ef)]=_0x12275a,this[_0x353b20(0x4f5)]=_0x22f1b6,this['_injector']=_0x1bdc93,this[_0x353b20(0x352)]=_0x2e5530,this[_0x353b20(0x2b7)]=_0x19c731);}['onMissedChangesetFetched'](_0x2c46e3){const _0x1fe9d5=_0x216ec2;try{const _0x19bea1=[..._0x2c46e3,...this[_0x1fe9d5(0x4f5)]],_0x5f6cfe=[this[_0x1fe9d5(0x301)]||this[_0x1fe9d5(0x4ef)]][_0x1fe9d5(0x449)](_0x1be50b=>!!_0x1be50b);let _0x741ac,_0x94d7a2;if(_0x5f6cfe[_0x1fe9d5(0x48b)]){const _0x39f65d=this[_0x1fe9d5(0x2b7)][_0x1fe9d5(0x3c5)](_0x19bea1,_0x5f6cfe,!0x1);if(!_0x245d5b[_0x1fe9d5(0x2d0)](_0x39f65d))throw _0x39f65d['error'];_0x741ac=_0x39f65d[_0x1fe9d5(0x25d)],_0x94d7a2=_0x39f65d[_0x1fe9d5(0x211)];}else _0x741ac=_0x19bea1,_0x94d7a2=[];let _0x276d3c=this[_0x1fe9d5(0x376)];_0x741ac[_0x1fe9d5(0x43f)](_0x471b59=>{const _0x3ef0e2=_0x1fe9d5;let _0x26c0a2;if(_0x276d3c['length']){const _0x3273b8=this['_transformService'][_0x3ef0e2(0x342)](_0x471b59,_0x276d3c);if(!_0x245d5b['isTransformMutationsWithChangesetSuccess'](_0x3273b8))throw _0x3273b8[_0x3ef0e2(0x2ff)];_0x26c0a2=_0x3273b8[_0x3ef0e2(0x25d)],_0x276d3c=_0x3273b8[_0x3ef0e2(0x49e)];}else _0x26c0a2=_0x471b59;this[_0x3ef0e2(0x50a)](_0x26c0a2);}),this['_acknowledgedAwaitingChangeset']&&this['_incrementRevisionNumber'](),this[_0x1fe9d5(0x301)]&&_0x94d7a2['length']&&(_0x94d7a2[0x0]['baseRev']=this['_getCurrentRevision']());let _0x2cb5f4;if(this['_awaitingChangeset']&&_0x276d3c['length']!==0x0)_0x2cb5f4=this[_0x1fe9d5(0x400)][_0x1fe9d5(0x596)](_0x467ffb,this[_0x1fe9d5(0x281)],this['type'],_0x94d7a2[0x0],_0x276d3c,this[_0x1fe9d5(0x4bb)]);else{if(this[_0x1fe9d5(0x301)]&&_0x276d3c[_0x1fe9d5(0x48b)]===0x0)_0x94d7a2[0x0]['baseRev']=this[_0x1fe9d5(0x3a3)](),_0x2cb5f4=this[_0x1fe9d5(0x400)][_0x1fe9d5(0x596)](_0x5e9373,this['unitID'],this[_0x1fe9d5(0x42a)],_0x94d7a2[0x0],this[_0x1fe9d5(0x4bb)]);else{if(_0x276d3c['length']!==0x0){const _0x151b2b=this[_0x1fe9d5(0x400)]['createInstance'](_0x1d3c19,this[_0x1fe9d5(0x281)],this[_0x1fe9d5(0x42a)],_0x276d3c,this[_0x1fe9d5(0x4bb)]);_0x151b2b[_0x1fe9d5(0x428)](),_0x2cb5f4=_0x151b2b;}else _0x2cb5f4=this[_0x1fe9d5(0x400)][_0x1fe9d5(0x596)](_0x1c6675,this[_0x1fe9d5(0x281)],this[_0x1fe9d5(0x42a)],this[_0x1fe9d5(0x4bb)]);}}return _0x2cb5f4[_0x1fe9d5(0x2ed)](),_0x2cb5f4;}catch(_0x20592f){return this['_logService'][_0x1fe9d5(0x2ff)]('[FetchMissState]','failed\x20to\x20apply\x20missed\x20changesets!',_0x20592f),this['_injector'][_0x1fe9d5(0x596)](_0x31c2f6,this['unitID'],this[_0x1fe9d5(0x42a)],this[_0x1fe9d5(0x301)],this[_0x1fe9d5(0x376)],this[_0x1fe9d5(0x4bb)],!0x1);}}[_0x216ec2(0x3ec)](){throw new Error('[FetchingMissState]:\x20invalid\x20calling\x20to\x20`resend`.');}['appendMutation'](_0xa6bf2b){const _0x47900a=_0x216ec2;return this['_pendingMutations'][_0x47900a(0x2af)](_0xa6bf2b),this;}[_0x216ec2(0x41a)](_0x31f77f){const _0x4a8ebd=_0x216ec2;return this[_0x4a8ebd(0x4f5)][_0x4a8ebd(0x2af)](_0x31f77f),this;}[_0x216ec2(0x561)](_0x255def){const _0x2c1316=_0x216ec2;if(this[_0x2c1316(0x301)])return this['_acknowledgedAwaitingChangeset']=this[_0x2c1316(0x301)],this[_0x2c1316(0x301)]=null,this;throw new Error(_0x2c1316(0x21f));}[_0x216ec2(0x2ad)](_0x2a648c){const _0x288108=_0x216ec2;return this[_0x288108(0x4e4)](!!(_0x2a648c!=null&&_0x2a648c[_0x288108(0x397)]));}['toggleOffline'](){const _0x18fab2=_0x216ec2;return this['_injector'][_0x18fab2(0x596)](_0x15e845,this['unitID'],this[_0x18fab2(0x42a)],this[_0x18fab2(0x301)],this[_0x18fab2(0x376)],this[_0x18fab2(0x4bb)]);}[_0x216ec2(0x388)](){return this;}[_0x216ec2(0x4e4)](_0x3d6f65){const _0xfd0fbc=_0x216ec2;return this[_0xfd0fbc(0x400)][_0xfd0fbc(0x596)](_0x31c2f6,this['unitID'],this[_0xfd0fbc(0x42a)],this[_0xfd0fbc(0x301)],this[_0xfd0fbc(0x376)],this[_0xfd0fbc(0x4bb)],_0x3d6f65);}};_0x33e1bf=_0x5dabb1([_0x55c4fb(0x7,_0x207f05[_0x216ec2(0x511)](_0x207f05['Injector'])),_0x55c4fb(0x8,_0x207f05['Inject'](_0x245d5b['RevisionService'])),_0x55c4fb(0x9,_0x207f05[_0x216ec2(0x511)](_0x11abd7[_0x216ec2(0x1d2)])),_0x55c4fb(0xa,_0x207f05[_0x216ec2(0x3ba)]),_0x55c4fb(0xb,_0x207f05[_0x216ec2(0x460)]),_0x55c4fb(0xc,_0x207f05[_0x216ec2(0x3f3)]),_0x55c4fb(0xd,_0x245d5b[_0x216ec2(0x3e8)])],_0x33e1bf);function _0x57ef53(_0x4f2915,_0x22ac45,_0x444b8a,_0x43d42c,_0x369b8a,_0x50cae4){const _0xa5472e=_0x216ec2;return _0x43d42c&&_0x369b8a[_0xa5472e(0x48b)]?_0x4f2915[_0xa5472e(0x596)](_0x467ffb,_0x22ac45,_0x444b8a,_0x43d42c,_0x369b8a,_0x50cae4):_0x43d42c?_0x4f2915['createInstance'](_0x5e9373,_0x22ac45,_0x444b8a,_0x43d42c,_0x50cae4):_0x369b8a['length']?_0x4f2915[_0xa5472e(0x596)](_0x1d3c19,_0x22ac45,_0x444b8a,_0x369b8a,_0x50cae4):_0x4f2915[_0xa5472e(0x596)](_0x1c6675,_0x22ac45,_0x444b8a,_0x50cae4);}var _0x54ad02=Object[_0x216ec2(0x3d2)],_0x379fb0=Object[_0x216ec2(0x498)],_0x176b7f=(_0x121330,_0x32d8b3,_0x422792,_0x1e5115)=>{for(var _0x396f0c=_0x1e5115>0x1?void 0x0:_0x1e5115?_0x379fb0(_0x32d8b3,_0x422792):_0x32d8b3,_0x2fc88a=_0x121330['length']-0x1,_0x2ba460;_0x2fc88a>=0x0;_0x2fc88a--)(_0x2ba460=_0x121330[_0x2fc88a])&&(_0x396f0c=(_0x1e5115?_0x2ba460(_0x32d8b3,_0x422792,_0x396f0c):_0x2ba460(_0x396f0c))||_0x396f0c);return _0x1e5115&&_0x396f0c&&_0x54ad02(_0x32d8b3,_0x422792,_0x396f0c),_0x396f0c;},_0x54a956=(_0x3b0436,_0x2cef11)=>(_0x43b8ef,_0x56c0a0)=>_0x2cef11(_0x43b8ef,_0x56c0a0,_0x3b0436);_0x11abd7[_0x216ec2(0x4a8)]=class extends _0x207f05['RxDisposable']{constructor(_0x25ea4d,_0x45e3d1,_0x561f79){const _0x205ae6=_0x216ec2;super(),_0x574c73(this,'_entities',new Map()),_0x574c73(this,_0x205ae6(0x4ab),new _0xb87526[(_0x205ae6(0x29e))]()),(this[_0x205ae6(0x400)]=_0x25ea4d,this['_collabSessionService']=_0x45e3d1,this[_0x205ae6(0x255)]=_0x561f79,this['_init']());}['dispose'](){const _0x177ddb=_0x216ec2;super[_0x177ddb(0x3a0)](),this['_entities'][_0x177ddb(0x43f)](_0x2b0632=>_0x2b0632[_0x177ddb(0x3a0)]()),this[_0x177ddb(0x3b7)]['clear']();}[_0x216ec2(0x598)](_0x274585){const _0x2f8dc7=_0x216ec2;var _0x9893b8;return(_0x9893b8=this[_0x2f8dc7(0x3b7)]['get'](_0x274585))!=null?_0x9893b8:null;}[_0x216ec2(0x486)](_0x1952ef){const _0x145b20=_0x216ec2,_0x3712bc=this['getCollabEntity'](_0x1952ef);return _0x3712bc?_0xb87526['of'](_0x3712bc):this[_0x145b20(0x4ab)][_0x145b20(0x2bb)](_0x9f6f32['filter'](_0x1ac669=>_0x1ac669['unitID']===_0x1952ef));}[_0x216ec2(0x299)](){const _0x2cca70=_0x216ec2;this[_0x2cca70(0x255)][_0x2cca70(0x334)](_0x207f05[_0x2cca70(0x583)][_0x2cca70(0x429)])[_0x2cca70(0x2bb)](_0xb87526['takeUntil'](this[_0x2cca70(0x274)]),_0x9f6f32[_0x2cca70(0x228)](0x10))[_0x2cca70(0x314)](async _0x2067e3=>{const _0x57dc25=_0x2cca70,_0xce65a6=_0x2067e3[_0x57dc25(0x559)](),_0x425856=await this[_0x57dc25(0x4c7)](_0xce65a6,_0x18cf2f[_0x57dc25(0x429)]);this['_entities'][_0x57dc25(0x252)](_0xce65a6,_0x425856);}),this[_0x2cca70(0x255)][_0x2cca70(0x334)](_0x207f05[_0x2cca70(0x583)][_0x2cca70(0x27f)])[_0x2cca70(0x2bb)](_0xb87526['takeUntil'](this[_0x2cca70(0x274)]),_0x9f6f32[_0x2cca70(0x228)](0x10))['pipe'](_0x9f6f32[_0x2cca70(0x449)](_0x13b125=>!_0x13b125['getUnitId']()[_0x2cca70(0x322)]('__')))[_0x2cca70(0x314)](async _0xe66bc1=>{const _0x8a165c=_0x2cca70,_0x4862c2=_0xe66bc1[_0x8a165c(0x559)](),_0x58e23c=await this['_startCollaboration'](_0x4862c2,_0x18cf2f['UNIVER_DOC']);this[_0x8a165c(0x3b7)][_0x8a165c(0x252)](_0x4862c2,_0x58e23c);}),_0xb87526[_0x2cca70(0x427)](this[_0x2cca70(0x255)]['getTypeOfUnitDisposed$'](_0x207f05[_0x2cca70(0x583)][_0x2cca70(0x429)]),this[_0x2cca70(0x255)][_0x2cca70(0x4fa)](_0x207f05[_0x2cca70(0x583)][_0x2cca70(0x27f)]))[_0x2cca70(0x2bb)](_0xb87526[_0x2cca70(0x516)](this['dispose$']))[_0x2cca70(0x314)](_0x5c028e=>{const _0xe09870=_0x2cca70,_0x5962c3=_0x5c028e['getUnitId'](),_0x1277c0=this[_0xe09870(0x3b7)][_0xe09870(0x458)](_0x5962c3);_0x1277c0&&(_0x1277c0[_0xe09870(0x3a0)](),this[_0xe09870(0x3b7)][_0xe09870(0x3b1)](_0x5962c3));});}async[_0x216ec2(0x4c7)](_0x160426,_0x266b3d){const _0x555ba6=_0x216ec2,_0xc50c1b=await this[_0x555ba6(0x2fc)][_0x555ba6(0x2da)](_0x160426),_0x240a07=this[_0x555ba6(0x400)][_0x555ba6(0x596)](this[_0x555ba6(0x4a3)](_0x266b3d),_0x160426,_0x266b3d,_0xc50c1b);return await _0x240a07[_0x555ba6(0x1eb)](),this['_entityInit$'][_0x555ba6(0x473)](_0x240a07),_0x240a07;}[_0x216ec2(0x4a3)](_0x5924fc){const _0x574d76=_0x216ec2;switch(_0x5924fc){case _0x18cf2f[_0x574d76(0x27f)]:return _0x9bb660;case _0x18cf2f[_0x574d76(0x429)]:return _0x11abd7[_0x574d76(0x32d)];default:throw new Error(_0x574d76(0x403)+_0x5924fc);}}},_0x11abd7[_0x216ec2(0x4a8)]=_0x176b7f([_0x207f05[_0x216ec2(0x26a)](_0x207f05[_0x216ec2(0x2fe)]['Starting'],_0x11abd7[_0x216ec2(0x4a8)]),_0x54a956(0x0,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x236)])),_0x54a956(0x1,_0x207f05[_0x216ec2(0x511)](_0x11abd7['CollaborationSessionService'])),_0x54a956(0x2,_0x207f05['IUniverInstanceService'])],_0x11abd7[_0x216ec2(0x4a8)]);let _0xbfd383=class extends _0x207f05[_0x216ec2(0x48f)]{constructor(_0x47da8e,_0x1712d6,_0x2563bf,_0xfaaaf5,_0x477289,_0x3e7d14,_0x34145d,_0xc36d81,_0x31ad4b,_0x18262e,_0xc2add6,_0xbe60a8,_0x5209c2){const _0x3828c6=_0x216ec2;super(),_0x574c73(this,'_state$',new _0xb87526[(_0x3828c6(0x31f))](null)),_0x574c73(this,_0x3828c6(0x555),this['_state$']['asObservable']()),_0x574c73(this,_0x3828c6(0x221)),_0x574c73(this,'_collaborationPaused',!0x1),_0x574c73(this,_0x3828c6(0x381),this[_0x3828c6(0x555)][_0x3828c6(0x2bb)](_0x9f6f32[_0x3828c6(0x386)](_0x15f692=>_0x15f692?_0x15f692[_0x3828c6(0x200)]:_0x128ded[_0x3828c6(0x483)]),_0x9f6f32[_0x3828c6(0x1f2)](0x1))),_0x574c73(this,_0x3828c6(0x53c),!0x1),_0x574c73(this,_0x3828c6(0x34b),[]),(this[_0x3828c6(0x281)]=_0x47da8e,this['_type']=_0x1712d6,this[_0x3828c6(0x22f)]=_0x2563bf,this[_0x3828c6(0x400)]=_0xfaaaf5,this['_localCacheService']=_0x477289,this[_0x3828c6(0x3e7)]=_0x3e7d14,this[_0x3828c6(0x220)]=_0x34145d,this['_revisionService']=_0xc36d81,this['_logService']=_0x31ad4b,this[_0x3828c6(0x2e7)]=_0x18262e,this[_0x3828c6(0x312)]=_0xc2add6,this[_0x3828c6(0x306)]=_0xbe60a8,this['_singleActiveUnitService']=_0x5209c2);}get[_0x216ec2(0x3d6)](){const _0x5c8197=_0x216ec2;return this[_0x5c8197(0x221)];}async[_0x216ec2(0x1eb)](){const _0x4565d2=_0x216ec2;if(this[_0x4565d2(0x3d6)])throw new Error(_0x4565d2(0x22b));await this[_0x4565d2(0x299)]();}['pauseCollaboration'](){const _0x39975f=_0x216ec2;return this[_0x39975f(0x44d)]=!0x0,_0x207f05[_0x39975f(0x232)](()=>{const _0x33a3bc=_0x39975f;this[_0x33a3bc(0x44d)]=!0x1,this[_0x33a3bc(0x2c7)]();});}[_0x216ec2(0x45a)](_0x551f34){const _0x1c6a36=_0x216ec2;this['_state']=_0x551f34,this[_0x1c6a36(0x3b9)][_0x1c6a36(0x473)](_0x551f34);}async[_0x216ec2(0x299)](){const _0x24dc03=_0x216ec2;var _0x47bed0;return this[_0x24dc03(0x45a)](await this[_0x24dc03(0x44c)]()),this['_singleActiveUnitService']&&((_0x47bed0=this[_0x24dc03(0x3d0)])==null||_0x47bed0[_0x24dc03(0x25f)](this[_0x24dc03(0x281)]),this[_0x24dc03(0x38d)](_0x207f05[_0x24dc03(0x232)](this[_0x24dc03(0x3d0)][_0x24dc03(0x2bd)](this[_0x24dc03(0x281)])[_0x24dc03(0x314)](_0x2da318=>{const _0x16909c=_0x24dc03;this[_0x16909c(0x352)][_0x16909c(0x339)](_0x16909c(0x24a),_0x16909c(0x310),_0x2da318),_0x2da318===_0x1adef1['OTHER_CLIENTS_EDITING']?(this['_messageService'][_0x16909c(0x4ec)]({'content':this['_localeService']['t'](_0x16909c(0x3c6)),'type':_0x2e1001[_0x16909c(0x5ae)][_0x16909c(0x29c)]}),this[_0x16909c(0x306)][_0x16909c(0x533)](new _0x4aca4a[(_0x16909c(0x229))](this[_0x16909c(0x281)])['id'],!0x1)):this[_0x16909c(0x306)][_0x16909c(0x533)](new _0x4aca4a['WorkbookEditablePermission'](this[_0x16909c(0x281)])['id'],!0x0);})))),this[_0x24dc03(0x38d)](_0x207f05[_0x24dc03(0x232)](this['_session'][_0x24dc03(0x2ef)]['subscribe'](_0x3e4d00=>{const _0x42b273=_0x24dc03;_0x3e4d00===_0x3f8a1a['ONLINE']?this[_0x42b273(0x4f2)]():_0x3e4d00===_0x3f8a1a['OFFLINE']&&this[_0x42b273(0x580)]();}))),this[_0x24dc03(0x38d)](_0x207f05['toDisposable'](this[_0x24dc03(0x22f)][_0x24dc03(0x35f)][_0x24dc03(0x314)](_0x3adf97=>{const _0x5ad71=_0x24dc03;try{switch(_0x3adf97[_0x5ad71(0x5a3)]){case _0x245d5b['CollaborationEvent']['NEW_CHANGESETS']:{this[_0x5ad71(0x4df)](_0x245d5b['parseProtocolChangeset'](_0x3adf97[_0x5ad71(0x2fd)]));break;}case _0x245d5b['CollaborationEvent'][_0x5ad71(0x44e)]:{this[_0x5ad71(0x43b)](_0x3adf97['data']);break;}case _0x245d5b[_0x5ad71(0x46a)][_0x5ad71(0x32b)]:{this['_onRemoteRejected']();break;}case _0x245d5b[_0x5ad71(0x46a)]['PSEUDO_FETCH_MISSING_RESULT']:{this[_0x5ad71(0x2eb)](_0x3adf97[_0x5ad71(0x2fd)][_0x5ad71(0x5a0)][_0x5ad71(0x386)](_0x1371d3=>_0x245d5b[_0x5ad71(0x2bc)](_0x1371d3)));break;}case _0x245d5b[_0x5ad71(0x46a)][_0x5ad71(0x287)]:this[_0x5ad71(0x464)]({'isPermissionRej':!0x0});}}catch(_0x4e819a){throw console[_0x5ad71(0x2ff)](_0x5ad71(0x1e2),_0x4e819a),_0x4e819a;}}))),this[_0x24dc03(0x221)];}[_0x216ec2(0x506)](){const _0x306b4a=_0x216ec2;this[_0x306b4a(0x53c)]=!0x1;}['_lockTransition'](){const _0xfbd19d=_0x216ec2;if(this[_0xfbd19d(0x53c)])throw new Error(_0xfbd19d(0x2fa));this[_0xfbd19d(0x53c)]=!0x0;}['_onLocalMutation'](_0x16a8f4){const _0x404849=_0x216ec2;this[_0x404849(0x3a9)](),this[_0x404849(0x45a)](this[_0x404849(0x221)]['appendMutation'](_0x16a8f4)),this[_0x404849(0x506)]();}[_0x216ec2(0x4df)](_0x357d83){const _0x1af44e=_0x216ec2;if(!(_0x357d83[_0x1af44e(0x40c)]<=this[_0x1af44e(0x317)][_0x1af44e(0x4c4)](this[_0x1af44e(0x281)]))){if(this[_0x1af44e(0x44d)]){this[_0x1af44e(0x34b)][_0x1af44e(0x2af)](_0x357d83);return;}this[_0x1af44e(0x4cd)](_0x357d83);}}[_0x216ec2(0x2c7)](){const _0x4b5b87=_0x216ec2;this[_0x4b5b87(0x34b)][_0x4b5b87(0x43f)](_0x58f843=>this[_0x4b5b87(0x4cd)](_0x58f843)),this[_0x4b5b87(0x34b)]=[];}[_0x216ec2(0x4cd)](_0x437980){const _0x155faa=_0x216ec2,_0x32ab94=this['_compressMutationService']['interceptor']['fetchThroughInterceptors'](this['_compressMutationService'][_0x155faa(0x578)][_0x155faa(0x210)]()[_0x155faa(0x512)])(_0x437980[_0x155faa(0x1cc)],null)||_0x437980[_0x155faa(0x1cc)],_0x14e6f6={..._0x437980,'mutations':_0x32ab94};this[_0x155faa(0x3a9)](),this[_0x155faa(0x45a)](this[_0x155faa(0x221)][_0x155faa(0x41a)](_0x14e6f6)),this['_unlockTransition']();}['_onRemoteACK'](_0x49a5b3){const _0x49a200=_0x216ec2;this[_0x49a200(0x3a9)](),this[_0x49a200(0x45a)](this['_state'][_0x49a200(0x561)](_0x49a5b3)),this[_0x49a200(0x506)]();}[_0x216ec2(0x464)](_0x18d8cc){const _0x4cee80=_0x216ec2;this['_lockTransition'](),this[_0x4cee80(0x45a)](this['_state'][_0x4cee80(0x2ad)](_0x18d8cc)),this[_0x4cee80(0x506)]();}['_onFetchMissResult'](_0x2781c3){const _0x2a3d79=_0x216ec2;if(!(this['_state']instanceof _0x33e1bf))throw new TypeError(_0x2a3d79(0x234));const _0x3ab451=_0x2781c3[_0x2a3d79(0x386)](_0x2fcfa5=>{const _0x49a67a=_0x2a3d79,_0x20ea25=this['_compressMutationService'][_0x49a67a(0x578)][_0x49a67a(0x53a)](this[_0x49a67a(0x3e7)][_0x49a67a(0x578)][_0x49a67a(0x210)]()[_0x49a67a(0x512)])(_0x2fcfa5[_0x49a67a(0x1cc)],null)||_0x2fcfa5[_0x49a67a(0x1cc)];return{..._0x2fcfa5,'mutations':_0x20ea25};});this[_0x2a3d79(0x3a9)](),this[_0x2a3d79(0x45a)](this[_0x2a3d79(0x221)][_0x2a3d79(0x384)](_0x3ab451)),this['_unlockTransition']();}[_0x216ec2(0x580)](){const _0x1d2ed7=_0x216ec2;this[_0x1d2ed7(0x3a9)](),this[_0x1d2ed7(0x45a)](this['_state'][_0x1d2ed7(0x1f7)]()),this[_0x1d2ed7(0x506)]();}[_0x216ec2(0x4f2)](){const _0x1e06d1=_0x216ec2;this[_0x1e06d1(0x3a9)](),this['_updateState'](this[_0x1e06d1(0x221)][_0x1e06d1(0x388)]()),this[_0x1e06d1(0x506)]();}async[_0x216ec2(0x44c)](){return new Promise(_0x53e6f1=>{const _0x502f49=_0x4438;this[_0x502f49(0x22f)][_0x502f49(0x2ef)][_0x502f49(0x2bb)](_0x9f6f32[_0x502f49(0x294)](0x1))[_0x502f49(0x314)](async _0x267622=>{_0x53e6f1(await this['_createInitialStateImpl'](_0x267622===_0x3f8a1a['ONLINE']));});});}[_0x216ec2(0x379)](){const _0x588abd=this['unitID'];return{'onStateChange':(_0x5a8fd3,_0x5b3ad3)=>{const _0x59f572=_0x4438;if(_0x5a8fd3!==this[_0x59f572(0x221)])throw new Error(_0x59f572(0x1d4)+_0x5a8fd3[_0x59f572(0x200)]+'\x0aAfter:\x20'+_0x5b3ad3[_0x59f572(0x200)]+'\x0aCurrent:\x20'+this[_0x59f572(0x221)][_0x59f572(0x200)]);this[_0x59f572(0x45a)](_0x5b3ad3);},'onSendChangeset':_0x257043=>{const _0x5cd972=_0x4438,_0x2c93c6={'eventID':_0x245d5b[_0x5cd972(0x46a)][_0x5cd972(0x41e)],'data':{'unitID':_0x257043[_0x5cd972(0x281)],'unitType':this[_0x5cd972(0x443)],'changeset':_0x257043,'memberID':this[_0x5cd972(0x22f)][_0x5cd972(0x2f8)]()}};this['_session'][_0x5cd972(0x204)](_0x2c93c6,this[_0x5cd972(0x281)]);},'onMissingChangesets':({from:_0x3bec96,to:_0x1dfc6b})=>{const _0x24ce8a=_0x4438;this[_0x24ce8a(0x352)][_0x24ce8a(0x339)]('[CollaborationEntity]','fetching\x20missing\x20changesets\x20from\x20'+_0x3bec96+_0x24ce8a(0x50b)+_0x1dfc6b);const _0x3b9470={'eventID':_0x245d5b[_0x24ce8a(0x46a)][_0x24ce8a(0x2f5)],'data':{'unitID':_0x588abd,'unitType':this[_0x24ce8a(0x443)],'from':_0x3bec96,'to':_0x1dfc6b}};this['_session']['send'](_0x3b9470,this[_0x24ce8a(0x281)]);}};}async[_0x216ec2(0x481)](_0x1ad2ae){const _0x3d08eb=_0x216ec2;var _0x339100,_0x293611;const _0x15b08c=await this[_0x3d08eb(0x503)][_0x3d08eb(0x416)](this[_0x3d08eb(0x281)]),_0x142358=(_0x339100=_0x15b08c==null?void 0x0:_0x15b08c[_0x3d08eb(0x1cc)])!=null?_0x339100:[],_0x3a81ec=(_0x293611=_0x15b08c==null?void 0x0:_0x15b08c[_0x3d08eb(0x59a)])!=null?_0x293611:null,_0x46792d=this[_0x3d08eb(0x281)];try{this['_replayCachedMutations'](_0x3a81ec,_0x142358);}catch(_0x415b23){this[_0x3d08eb(0x352)]['error'](_0x415b23);}const _0xf19885=this[_0x3d08eb(0x379)]();if(_0x1ad2ae){const _0x5be024=_0x57ef53(this['_injector'],_0x46792d,this[_0x3d08eb(0x443)],_0x3a81ec,_0x142358,_0xf19885);return _0x5be024 instanceof _0x1d3c19?_0x5be024['_schedule']():(_0x5be024 instanceof _0x467ffb||_0x5be024 instanceof _0x5e9373)&&_0x5be024[_0x3d08eb(0x3ec)](),_0x5be024;}return this[_0x3d08eb(0x400)]['createInstance'](_0x15e845,_0x46792d,this['_type'],_0x3a81ec,_0x142358,_0xf19885);}[_0x216ec2(0x368)](_0x9ff48b,_0x144b40){const _0x34835a=_0x216ec2;var _0x277fca,_0x85b748;const _0x12f147=this[_0x34835a(0x3e7)][_0x34835a(0x578)]['fetchThroughInterceptors'](this[_0x34835a(0x3e7)][_0x34835a(0x578)][_0x34835a(0x210)]()[_0x34835a(0x512)]);(_0x277fca=_0x12f147((_0x9ff48b==null?void 0x0:_0x9ff48b[_0x34835a(0x1cc)])||[],null))==null||_0x277fca['forEach'](_0x46c692=>this[_0x34835a(0x2e7)][_0x34835a(0x2d7)](_0x46c692['id'],_0x46c692[_0x34835a(0x31b)])),(_0x85b748=_0x12f147(_0x144b40||[],null))==null||_0x85b748['forEach'](_0x462337=>this[_0x34835a(0x2e7)]['executeCommand'](_0x462337['id'],_0x462337['params']));}};_0xbfd383=_0x176b7f([_0x54a956(0x3,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x236)])),_0x54a956(0x4,_0x207f05[_0x216ec2(0x511)](_0x11abd7[_0x216ec2(0x1d2)])),_0x54a956(0x5,_0x207f05[_0x216ec2(0x511)](_0x245d5b['CompressMutationService'])),_0x54a956(0x6,_0x207f05[_0x216ec2(0x511)](_0x207f05['LocaleService'])),_0x54a956(0x7,_0x207f05[_0x216ec2(0x511)](_0x245d5b[_0x216ec2(0x586)])),_0x54a956(0x8,_0x207f05[_0x216ec2(0x3ba)]),_0x54a956(0x9,_0x207f05['ICommandService']),_0x54a956(0xa,_0xd6a4eb['IMessageService']),_0x54a956(0xb,_0x207f05[_0x216ec2(0x30b)]),_0x54a956(0xc,_0x207f05[_0x216ec2(0x3d4)](_0x2d3969))],_0xbfd383);let _0x9bb660=class extends _0xbfd383{constructor(_0x345189,_0x15626c,_0x4dd8c9,_0x2b4e03,_0x59bdae,_0x4842b6,_0xd34b7f,_0x1f213a,_0x3d6030,_0x35954f,_0x4bcbe8,_0x1599b5,_0x26648c,_0x5c0929,_0x12ff77,_0x60c4fd,_0x471be7){const _0x312fda=_0x216ec2;super(_0x345189,_0x15626c,_0x4dd8c9,_0x2b4e03,_0x59bdae,_0x4842b6,_0xd34b7f,_0x1f213a,_0x26648c,_0x5c0929,_0x12ff77,_0x60c4fd,_0x471be7),this['unitID']=_0x345189,this[_0x312fda(0x42a)]=_0x15626c,this['session']=_0x4dd8c9,this['_docStateChangeManagerService']=_0x3d6030,this[_0x312fda(0x201)]=_0x35954f,this['_docTransformSelectionsService']=_0x4bcbe8,this[_0x312fda(0x3cc)]=_0x1599b5;}[_0x216ec2(0x379)](){const _0xd67901=_0x216ec2,_0x54e751=super['_createHandler']();return _0x54e751[_0xd67901(0x2e6)]=_0x3d8adf=>this[_0xd67901(0x201)][_0xd67901(0x57c)](_0x3d8adf),_0x54e751[_0xd67901(0x5b2)]=_0x1533b2=>this['_docTransformSelectionsService'][_0xd67901(0x1ec)](_0x1533b2),_0x54e751[_0xd67901(0x3c1)]=_0x6f3879=>this['_docSyncEditingCollabCursorService'][_0xd67901(0x5b6)](_0x6f3879),_0x54e751[_0xd67901(0x3f4)]=_0x4778ea=>this[_0xd67901(0x201)][_0xd67901(0x5aa)](_0x4778ea),_0x54e751;}async[_0x216ec2(0x299)](){const _0x1e94d5=_0x216ec2,_0xf4c64f=await super[_0x1e94d5(0x299)]();return this[_0x1e94d5(0x38d)](this['_commandService']['onCommandExecuted']((_0x559c1e,_0x48f309)=>{const _0x3abee5=_0x1e94d5;if(_0x559c1e[_0x3abee5(0x42a)]!==_0x207f05['CommandType']['MUTATION']||_0x48f309!=null&&_0x48f309[_0x3abee5(0x581)]||_0x48f309!=null&&_0x48f309['onlyLocal'])return;const _0x68f29d=_0x559c1e[_0x3abee5(0x31b)];if((_0x68f29d==null?void 0x0:_0x68f29d[_0x3abee5(0x432)])!==this[_0x3abee5(0x281)])return;let _0x155260=_0x559c1e;if(_0x155260['id']===_0x23e2c7['RichTextEditingMutation']['id']){const _0x621502=_0x155260['params'];_0x155260={'id':_0x23e2c7[_0x3abee5(0x437)]['id'],'type':_0x207f05[_0x3abee5(0x4c3)][_0x3abee5(0x53e)],'params':{'unitId':_0x621502[_0x3abee5(0x432)],'actions':_0x621502[_0x3abee5(0x3f2)],'textRanges':null}};}const _0x16e5bf=this[_0x3abee5(0x3e7)][_0x3abee5(0x578)][_0x3abee5(0x53a)](this[_0x3abee5(0x3e7)][_0x3abee5(0x578)]['getInterceptPoints']()['COMPRESS_MUTATION_SEND'])([_0x155260],null)||[_0x155260];this[_0x3abee5(0x33d)](_0x16e5bf[0x0]);})),_0xf4c64f;}};_0x9bb660=_0x176b7f([_0x54a956(0x3,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x236)])),_0x54a956(0x4,_0x207f05['Inject'](_0x11abd7[_0x216ec2(0x1d2)])),_0x54a956(0x5,_0x207f05[_0x216ec2(0x511)](_0x245d5b['CompressMutationService'])),_0x54a956(0x6,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x267)])),_0x54a956(0x7,_0x207f05['Inject'](_0x245d5b[_0x216ec2(0x586)])),_0x54a956(0x8,_0x207f05['Inject'](_0x23e2c7[_0x216ec2(0x419)])),_0x54a956(0x9,_0x207f05[_0x216ec2(0x511)](_0x36a396)),_0x54a956(0xa,_0x207f05[_0x216ec2(0x511)](_0x178dc5)),_0x54a956(0xb,_0x207f05[_0x216ec2(0x511)](_0x6344ed)),_0x54a956(0xc,_0x207f05['ILogService']),_0x54a956(0xd,_0x207f05['ICommandService']),_0x54a956(0xe,_0xd6a4eb[_0x216ec2(0x1f5)]),_0x54a956(0xf,_0x207f05[_0x216ec2(0x30b)]),_0x54a956(0x10,_0x207f05['Optional'](_0x2d3969))],_0x9bb660),_0x11abd7['SheetCollaborationEntity']=class extends _0xbfd383{constructor(_0x5a1c72,_0x57c567,_0x521747,_0x5d8324,_0x492b05,_0x8630e8,_0x35e608,_0x457fc6,_0x21bb28,_0x29a27d,_0x40743f,_0x318101,_0x1c0b30,_0x259d4b){const _0x2f4748=_0x216ec2;super(_0x5a1c72,_0x57c567,_0x521747,_0x5d8324,_0x492b05,_0x8630e8,_0x35e608,_0x457fc6,_0x29a27d,_0x40743f,_0x318101,_0x1c0b30,_0x259d4b),this[_0x2f4748(0x281)]=_0x5a1c72,this[_0x2f4748(0x42a)]=_0x57c567,this[_0x2f4748(0x4de)]=_0x521747,this[_0x2f4748(0x543)]=_0x21bb28;}[_0x216ec2(0x379)](){const _0x41ef88=_0x216ec2,_0x27ed93=super[_0x41ef88(0x379)]();return _0x27ed93['onTransformSelections']=_0x2934b4=>this[_0x41ef88(0x543)][_0x41ef88(0x1ec)](_0x2934b4),_0x27ed93;}async[_0x216ec2(0x299)](){const _0x26f948=_0x216ec2,_0x307969=await super['_init']();return this['disposeWithMe'](this[_0x26f948(0x2e7)][_0x26f948(0x577)]((_0x40207e,_0x5e394e)=>{const _0x521611=_0x26f948;if(_0x40207e[_0x521611(0x42a)]!==_0x207f05[_0x521611(0x4c3)][_0x521611(0x53e)]||_0x5e394e!=null&&_0x5e394e[_0x521611(0x581)]||_0x5e394e!=null&&_0x5e394e[_0x521611(0x4ad)])return;const _0x1c7a50=_0x40207e['params'];if((_0x1c7a50==null?void 0x0:_0x1c7a50[_0x521611(0x432)])!==this['unitID'])return;const _0x101873=_0x40207e,_0x10cb30=this['_compressMutationService'][_0x521611(0x578)]['fetchThroughInterceptors'](this[_0x521611(0x3e7)][_0x521611(0x578)][_0x521611(0x210)]()['COMPRESS_MUTATION_SEND'])([_0x101873],null)||[_0x101873];this[_0x521611(0x33d)](_0x10cb30[0x0]);})),_0x307969;}},_0x11abd7[_0x216ec2(0x32d)]=_0x176b7f([_0x54a956(0x3,_0x207f05[_0x216ec2(0x511)](_0x207f05['Injector'])),_0x54a956(0x4,_0x207f05[_0x216ec2(0x511)](_0x11abd7[_0x216ec2(0x1d2)])),_0x54a956(0x5,_0x207f05[_0x216ec2(0x511)](_0x245d5b['CompressMutationService'])),_0x54a956(0x6,_0x207f05['Inject'](_0x207f05['LocaleService'])),_0x54a956(0x7,_0x207f05[_0x216ec2(0x511)](_0x245d5b[_0x216ec2(0x586)])),_0x54a956(0x8,_0x207f05[_0x216ec2(0x511)](_0x53b567)),_0x54a956(0x9,_0x207f05[_0x216ec2(0x3ba)]),_0x54a956(0xa,_0x207f05[_0x216ec2(0x460)]),_0x54a956(0xb,_0xd6a4eb['IMessageService']),_0x54a956(0xc,_0x207f05[_0x216ec2(0x30b)]),_0x54a956(0xd,_0x207f05['Optional'](_0x2d3969))],_0x11abd7[_0x216ec2(0x32d)]);const _0x3f3a1c=[_0x216ec2(0x33b),'jiqing500',_0x216ec2(0x4cc),_0x216ec2(0x4ac),_0x216ec2(0x353),_0x216ec2(0x28b)];class _0x17ed63 extends _0x207f05[_0x216ec2(0x1c5)]{constructor(){const _0x5e6fbf=_0x216ec2;super(...arguments),_0x574c73(this,_0x5e6fbf(0x479),new Map()),_0x574c73(this,'_colorIndex',0x0);}[_0x216ec2(0x582)](_0x7ff067){const _0x4bd93d=_0x216ec2;if(this['_assignedColors'][_0x4bd93d(0x1dc)](_0x7ff067))return this[_0x4bd93d(0x479)][_0x4bd93d(0x458)](_0x7ff067);const _0x20cc7c=_0x3f3a1c[this[_0x4bd93d(0x48c)]];return this['_colorIndex']=(this[_0x4bd93d(0x48c)]+0x1)%_0x3f3a1c[_0x4bd93d(0x48b)],this[_0x4bd93d(0x479)][_0x4bd93d(0x252)](_0x7ff067,_0x20cc7c),_0x20cc7c;}}var _0x494823=Object[_0x216ec2(0x3d2)],_0x316244=Object['getOwnPropertyDescriptor'],_0x35881e=(_0x9ae5a9,_0x477c6c,_0x4b93bf,_0x1b5a32)=>{for(var _0x4890b5=_0x1b5a32>0x1?void 0x0:_0x1b5a32?_0x316244(_0x477c6c,_0x4b93bf):_0x477c6c,_0x1ce759=_0x9ae5a9['length']-0x1,_0x938a2d;_0x1ce759>=0x0;_0x1ce759--)(_0x938a2d=_0x9ae5a9[_0x1ce759])&&(_0x4890b5=(_0x1b5a32?_0x938a2d(_0x477c6c,_0x4b93bf,_0x4890b5):_0x938a2d(_0x4890b5))||_0x4890b5);return _0x1b5a32&&_0x4890b5&&_0x494823(_0x477c6c,_0x4b93bf,_0x4890b5),_0x4890b5;},_0x32b267=(_0x5de0a4,_0x23919a)=>(_0x5ee34d,_0x365844)=>_0x23919a(_0x5ee34d,_0x365844,_0x5de0a4);const _0x1f6451=0x12c,_0x6fdb6b=0x64,_0x4e6aac=()=>{let _0x49e563=[],_0x53e18a=!0x1;return _0x39616d=>{const _0x326d9c=_0x4438;_0x49e563[_0x326d9c(0x2af)](_0x39616d),_0x53e18a||(_0x53e18a=!0x0,setTimeout(()=>{const _0x3f3662=_0x326d9c;_0x49e563[_0x3f3662(0x43f)](_0x46be01=>_0x46be01()),_0x49e563=[],_0x53e18a=!0x1;}));};};let _0x30f485=class extends _0x207f05['RxDisposable']{constructor(_0x58917f,_0x3d8e29,_0x161310,_0x2a5b12,_0x4aa488,_0xbe8326,_0x10cd66,_0x19fa32){const _0x68656b=_0x216ec2;super(),_0x574c73(this,_0x68656b(0x553),!0x1),_0x574c73(this,'_init',!0x1),_0x574c73(this,_0x68656b(0x309),new _0xb87526[(_0x68656b(0x31f))](new Map())),_0x574c73(this,_0x68656b(0x457),this[_0x68656b(0x309)][_0x68656b(0x330)]()),_0x574c73(this,_0x68656b(0x50f),new _0xb87526[(_0x68656b(0x31f))]([])),_0x574c73(this,'roomMembers$',this[_0x68656b(0x50f)][_0x68656b(0x2bb)](_0xb87526[_0x68656b(0x3e3)](_0x1f6451))),_0x574c73(this,_0x68656b(0x2a0),_0x3426d0((_0xcd0353,_0x50c56d)=>{const _0x434508=_0x68656b,_0x3dc61e={'eventID':_0x245d5b[_0x434508(0x46a)]['UPDATE_CURSOR'],'data':{'unitID':this['unitID'],'memberID':this[_0x434508(0x22f)][_0x434508(0x2f8)](),'selection':_0x5337d8[_0x434508(0x534)](_0xcd0353,_0x50c56d['range'])}};this[_0x434508(0x22f)]['send'](_0x3dc61e,this['unitID']);},_0x6fdb6b)),(this[_0x68656b(0x281)]=_0x58917f,this[_0x68656b(0x22f)]=_0x3d8e29,this[_0x68656b(0x400)]=_0x161310,this[_0x68656b(0x501)]=_0x2a5b12,this['_memberService']=_0x4aa488,this[_0x68656b(0x255)]=_0xbe8326,this['_commandService']=_0x10cd66,this[_0x68656b(0x4f1)]=_0x19fa32);}get['cursorInfo'](){const _0x349f60=_0x216ec2;return this['_cursorInfo$'][_0x349f60(0x263)]();}get[_0x216ec2(0x2e9)](){const _0xf8e7d5=_0x216ec2;return this['_roomMembers$'][_0xf8e7d5(0x263)]();}[_0x216ec2(0x3a0)](){const _0x24c8c9=_0x216ec2;super[_0x24c8c9(0x3a0)](),this[_0x24c8c9(0x309)][_0x24c8c9(0x473)](new Map()),this['_cursorInfo$'][_0x24c8c9(0x39c)](),this[_0x24c8c9(0x50f)][_0x24c8c9(0x473)]([]),this[_0x24c8c9(0x50f)]['complete']();}[_0x216ec2(0x1eb)](){const _0xa72a3d=_0x216ec2;this[_0xa72a3d(0x299)]||(this[_0xa72a3d(0x299)]=!0x0,this['_session'][_0xa72a3d(0x2ef)][_0xa72a3d(0x2bb)](_0xb87526[_0xa72a3d(0x516)](this['dispose$']))[_0xa72a3d(0x314)](_0x57be7d=>{const _0x21bd93=_0xa72a3d;_0x57be7d===_0x3f8a1a[_0x21bd93(0x1f3)]?this[_0x21bd93(0x4f2)]():this[_0x21bd93(0x580)]();}),this[_0xa72a3d(0x22f)][_0xa72a3d(0x35f)][_0xa72a3d(0x2bb)](_0xb87526[_0xa72a3d(0x516)](this[_0xa72a3d(0x274)]))[_0xa72a3d(0x314)](_0x44b759=>{const _0x481e82=_0xa72a3d,_0xe91c8c=_0x44b759['eventID'];_0xe91c8c===_0x245d5b[_0x481e82(0x46a)][_0x481e82(0x29a)]&&this[_0x481e82(0x27e)](_0x44b759),_0xe91c8c===_0x245d5b[_0x481e82(0x46a)][_0x481e82(0x4e0)]&&this[_0x481e82(0x466)](_0x44b759);}),this[_0xa72a3d(0x537)](),this[_0xa72a3d(0x38d)](this[_0xa72a3d(0x2e7)]['onCommandExecuted'](_0x45b6b9=>{const _0x71a5ee=_0xa72a3d;if(this['_online']&&_0x45b6b9['id']===_0x4aca4a[_0x71a5ee(0x308)]['id']&&_0x45b6b9[_0x71a5ee(0x31b)][_0x71a5ee(0x432)]===this[_0x71a5ee(0x281)]){const _0x3b9653=_0x45b6b9[_0x71a5ee(0x31b)];this[_0x71a5ee(0x2a0)](_0x3b9653[_0x71a5ee(0x22d)],_0x3b9653[_0x71a5ee(0x502)][0x0]);}})));}[_0x216ec2(0x27e)](_0x2fa393){const _0x378d27=_0x216ec2;var _0x4c223f,_0x965246;const {memberID:_0x25a29e,selection:_0x5bbeef}=_0x2fa393[_0x378d27(0x2fd)],{sheetName:_0x30c1ab,range:_0x24a645}=_0x5337d8[_0x378d27(0x2b6)](_0x5bbeef),_0x35853e={'name':(_0x965246=(_0x4c223f=this[_0x378d27(0x250)]['getMember'](this[_0x378d27(0x281)],_0x25a29e))==null?void 0x0:_0x4c223f[_0x378d27(0x45c)])!=null?_0x965246:'Unknown\x20user','range':this[_0x378d27(0x1e6)](_0x30c1ab,_0x24a645),'sheetID':_0x30c1ab,'color':this['_colorAssignService'][_0x378d27(0x582)](_0x25a29e),'selection':_0x5bbeef},_0x40640a=this[_0x378d27(0x3e6)];_0x40640a[_0x378d27(0x252)](_0x25a29e,_0x35853e),this[_0x378d27(0x309)]['next'](_0x40640a);}[_0x216ec2(0x466)](_0x415b40){const _0x35e2a6=_0x216ec2,{memberID:_0x11822d}=_0x415b40[_0x35e2a6(0x2fd)],_0x2a0ddc=this['cursorInfo'];_0x2a0ddc[_0x35e2a6(0x3b1)](_0x11822d),this[_0x35e2a6(0x309)]['next'](_0x2a0ddc);}[_0x216ec2(0x1e6)](_0x29f9ef,_0x566e54){const _0x3dbd7d=_0x216ec2;var _0x33d2e3,_0x1b66c6;const _0x3b6c8c=(_0x1b66c6=(_0x33d2e3=this[_0x3dbd7d(0x255)][_0x3dbd7d(0x4ae)](this['unitID']))==null?void 0x0:_0x33d2e3[_0x3dbd7d(0x1e8)](_0x29f9ef))==null?void 0x0:_0x1b66c6[_0x3dbd7d(0x536)]();return(_0x3b6c8c==null?void 0x0:_0x3b6c8c[_0x3dbd7d(0x573)](_0x58d6fa=>_0x207f05[_0x3dbd7d(0x49b)][_0x3dbd7d(0x49a)](_0x58d6fa,_0x566e54)))||_0x566e54;}['_onRefRangeChange'](){const _0x425ee7=_0x216ec2,_0x1418aa=new _0x207f05[(_0x425ee7(0x497))](),_0x276d8f=_0x4e6aac(),_0x11f6f4=()=>{const _0x5f2de2=_0x425ee7;_0x1418aa[_0x5f2de2(0x3a0)]();const _0x42e13e=(_0x29d462,_0x44635d,_0x4b28a0,_0x154fb0)=>{const _0x24e09c=_0x5f2de2;let _0x122776=[];switch(_0x29d462['id']){case _0x4aca4a[_0x24e09c(0x451)][_0x24e09c(0x5a9)]:{_0x122776=_0x4aca4a[_0x24e09c(0x423)](_0x29d462,_0x154fb0);break;}case _0x4aca4a['EffectRefRangId'][_0x24e09c(0x36d)]:{_0x122776=_0x4aca4a[_0x24e09c(0x1d8)](_0x29d462,_0x154fb0);break;}case _0x4aca4a[_0x24e09c(0x451)][_0x24e09c(0x358)]:{_0x122776=_0x4aca4a[_0x24e09c(0x54b)](_0x29d462,_0x154fb0);break;}case _0x4aca4a[_0x24e09c(0x451)][_0x24e09c(0x2e2)]:{_0x122776=_0x4aca4a[_0x24e09c(0x268)](_0x29d462,_0x154fb0);break;}case _0x4aca4a['EffectRefRangId'][_0x24e09c(0x4db)]:{_0x122776=_0x4aca4a[_0x24e09c(0x1f9)](_0x29d462,_0x154fb0);break;}case _0x4aca4a['EffectRefRangId'][_0x24e09c(0x539)]:{_0x122776=_0x4aca4a[_0x24e09c(0x33e)](_0x29d462,_0x154fb0);break;}case _0x4aca4a[_0x24e09c(0x451)][_0x24e09c(0x4e2)]:{_0x122776=_0x4aca4a[_0x24e09c(0x5b9)](_0x29d462,_0x154fb0);break;}case _0x4aca4a[_0x24e09c(0x451)][_0x24e09c(0x48a)]:{_0x122776=_0x4aca4a[_0x24e09c(0x3b2)](_0x29d462,_0x154fb0);break;}case _0x4aca4a[_0x24e09c(0x451)][_0x24e09c(0x3c2)]:{_0x122776=_0x4aca4a[_0x24e09c(0x404)](_0x29d462,_0x154fb0);break;}}const _0x1aea86=_0x4aca4a[_0x24e09c(0x544)](_0x122776,_0x154fb0),_0xb76af2=this[_0x24e09c(0x3e6)][_0x24e09c(0x458)](_0x44635d);if(_0xb76af2&&_0x1aea86){const _0x28c400={..._0xb76af2,'range':_0x1aea86};this['cursorInfo']['set'](_0x44635d,_0x28c400),_0x276d8f(()=>{const _0x5b9ab0=_0x24e09c,_0x49a1ef=this[_0x5b9ab0(0x4f1)][_0x5b9ab0(0x3a7)](_0x1aea86,_0x6fe815=>(_0x49a1ef[_0x5b9ab0(0x3a0)](),_0x42e13e(_0x6fe815,_0x44635d,_0x4b28a0,_0x1aea86)));_0x1418aa['add'](_0x49a1ef);});}return{'redos':[],'undos':[]};};this[_0x5f2de2(0x3e6)][_0x5f2de2(0x43f)]((_0x53bd02,_0x1439ae)=>{const _0x29c846=_0x5f2de2,{range:_0xe7a68e,sheetID:_0x58d712}=_0x53bd02,_0x4c8a24=this[_0x29c846(0x4f1)]['registerRefRange'](_0xe7a68e,_0x845b99=>(_0x4c8a24[_0x29c846(0x3a0)](),_0x42e13e(_0x845b99,_0x1439ae,_0x58d712,_0xe7a68e)));_0x1418aa['add'](_0x4c8a24);});};this[_0x425ee7(0x38d)](_0x207f05[_0x425ee7(0x232)](this[_0x425ee7(0x309)][_0x425ee7(0x314)](()=>{_0x11f6f4();})));}[_0x216ec2(0x4f2)](){const _0x303ab2=_0x216ec2;var _0x281a0d,_0x52b1d3;if(this[_0x303ab2(0x553)]=!0x0,((_0x281a0d=this['_univerInstanceService'][_0x303ab2(0x53f)]())==null?void 0x0:_0x281a0d[_0x303ab2(0x559)]())!==this[_0x303ab2(0x281)])return;const _0x2ad97d=(_0x52b1d3=this['_injector'][_0x303ab2(0x458)](_0x4aca4a[_0x303ab2(0x264)])['getCurrentSelections']())==null?void 0x0:_0x52b1d3[0x0],_0x599ab8=this[_0x303ab2(0x255)][_0x303ab2(0x2b5)](_0x207f05['UniverInstanceType'][_0x303ab2(0x429)])[_0x303ab2(0x472)]();_0x2ad97d&&_0x599ab8&&this[_0x303ab2(0x2a0)](_0x599ab8[_0x303ab2(0x4c0)](),_0x2ad97d);}[_0x216ec2(0x580)](){this['_online']=!0x1;}};_0x30f485=_0x35881e([_0x32b267(0x2,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x236)])),_0x32b267(0x3,_0x207f05[_0x216ec2(0x511)](_0x17ed63)),_0x32b267(0x4,_0x207f05[_0x216ec2(0x511)](_0x35ecb0)),_0x32b267(0x5,_0x207f05[_0x216ec2(0x1f4)]),_0x32b267(0x6,_0x207f05[_0x216ec2(0x460)]),_0x32b267(0x7,_0x207f05[_0x216ec2(0x511)](_0x4aca4a['RefRangeService']))],_0x30f485);var _0x13fed8=Object[_0x216ec2(0x3d2)],_0x39d5d8=Object[_0x216ec2(0x498)],_0x486f65=(_0x412471,_0x504bf5,_0x30492a,_0x4a86ef)=>{const _0x57c9cd=_0x216ec2;for(var _0x447f61=_0x4a86ef>0x1?void 0x0:_0x4a86ef?_0x39d5d8(_0x504bf5,_0x30492a):_0x504bf5,_0x54c26a=_0x412471[_0x57c9cd(0x48b)]-0x1,_0x252d6a;_0x54c26a>=0x0;_0x54c26a--)(_0x252d6a=_0x412471[_0x54c26a])&&(_0x447f61=(_0x4a86ef?_0x252d6a(_0x504bf5,_0x30492a,_0x447f61):_0x252d6a(_0x447f61))||_0x447f61);return _0x4a86ef&&_0x447f61&&_0x13fed8(_0x504bf5,_0x30492a,_0x447f61),_0x447f61;},_0x3e3e1c=(_0x49bfe8,_0xc3473c)=>(_0x47408b,_0x3d260f)=>_0xc3473c(_0x47408b,_0x3d260f,_0x49bfe8);const _0x21dd89=0x12c,_0x57bc42=0x64;let _0xecab1b=class extends _0x207f05['RxDisposable']{constructor(_0x2af6f4,_0x556bad,_0x1ef9f7,_0x3e0b25,_0x59f611,_0x26708a,_0x8da8de,_0x1ae660,_0x38594e){const _0x560b28=_0x216ec2;super(),_0x574c73(this,_0x560b28(0x553),!0x1),_0x574c73(this,_0x560b28(0x299),!0x1),_0x574c73(this,'_cursorInfo$',new _0xb87526[(_0x560b28(0x31f))](new Map())),_0x574c73(this,'cursorInfo$',this[_0x560b28(0x309)]['asObservable']()),_0x574c73(this,_0x560b28(0x50f),new _0xb87526[(_0x560b28(0x31f))]([])),_0x574c73(this,_0x560b28(0x398),this['_roomMembers$'][_0x560b28(0x2bb)](_0xb87526[_0x560b28(0x3e3)](_0x21dd89))),_0x574c73(this,_0x560b28(0x2a0),_0x3426d0(_0x1bdec1=>{const _0x3a4957=_0x560b28,_0x16978b={'eventID':_0x245d5b[_0x3a4957(0x46a)][_0x3a4957(0x29a)],'data':{'unitID':this[_0x3a4957(0x281)],'memberID':this[_0x3a4957(0x22f)]['getMemberID'](),'selection':_0x30178f(_0x1bdec1)}};this[_0x3a4957(0x22f)][_0x3a4957(0x204)](_0x16978b,this[_0x3a4957(0x281)]);},_0x57bc42)),(this[_0x560b28(0x281)]=_0x2af6f4,this[_0x560b28(0x22f)]=_0x556bad,this[_0x560b28(0x400)]=_0x1ef9f7,this[_0x560b28(0x501)]=_0x3e0b25,this[_0x560b28(0x250)]=_0x59f611,this[_0x560b28(0x37c)]=_0x26708a,this[_0x560b28(0x2b7)]=_0x8da8de,this[_0x560b28(0x255)]=_0x1ae660,this['_commandService']=_0x38594e);}get[_0x216ec2(0x3e6)](){const _0xa2a38e=_0x216ec2;return this[_0xa2a38e(0x309)]['getValue']();}get['roomMembers'](){const _0x6c69f4=_0x216ec2;return this[_0x6c69f4(0x50f)]['getValue']();}['dispose'](){const _0x2e3b4c=_0x216ec2;super[_0x2e3b4c(0x3a0)](),this[_0x2e3b4c(0x309)][_0x2e3b4c(0x473)](new Map()),this[_0x2e3b4c(0x309)][_0x2e3b4c(0x39c)](),this['_roomMembers$'][_0x2e3b4c(0x473)]([]),this[_0x2e3b4c(0x50f)]['complete']();}[_0x216ec2(0x1eb)](){const _0x3583b4=_0x216ec2;this[_0x3583b4(0x299)]||(this['_init']=!0x0,this[_0x3583b4(0x22f)][_0x3583b4(0x2ef)][_0x3583b4(0x2bb)](_0xb87526[_0x3583b4(0x516)](this['dispose$']))[_0x3583b4(0x314)](_0x3e4ba8=>{const _0x4066ae=_0x3583b4;_0x3e4ba8===_0x3f8a1a[_0x4066ae(0x1f3)]?this['_toggleOnline']():this[_0x4066ae(0x580)]();}),this[_0x3583b4(0x22f)][_0x3583b4(0x35f)][_0x3583b4(0x2bb)](_0xb87526[_0x3583b4(0x516)](this[_0x3583b4(0x274)]))[_0x3583b4(0x314)](_0x1fc92a=>{const _0x266be7=_0x3583b4,_0x493560=_0x1fc92a[_0x266be7(0x5a3)];_0x493560===_0x245d5b['CollaborationEvent'][_0x266be7(0x29a)]&&this['_onCursorUpdate'](_0x1fc92a),_0x493560===_0x245d5b[_0x266be7(0x46a)][_0x266be7(0x4e0)]&&this['_onCursorDelete'](_0x1fc92a);}),this[_0x3583b4(0x38d)](this[_0x3583b4(0x2e7)]['onCommandExecuted'](_0x56b512=>{const _0x21803d=_0x3583b4,_0x3cb054=_0x56b512['params'];_0x3cb054!=null&&this[_0x21803d(0x553)]&&_0x56b512['id']===_0x23e2c7[_0x21803d(0x1ce)]['id']&&_0x3cb054[_0x21803d(0x432)]===this['unitID']&&_0x3cb054[_0x21803d(0x2a4)]===!0x1&&this[_0x21803d(0x2a0)](_0x3cb054[_0x21803d(0x3c7)]);})),this[_0x3583b4(0x37c)]['collabCursorState$'][_0x3583b4(0x2bb)](_0xb87526[_0x3583b4(0x516)](this['dispose$']))[_0x3583b4(0x314)](_0x17319b=>{const _0x47bcfc=_0x3583b4;if((_0x17319b==null?void 0x0:_0x17319b[_0x47bcfc(0x281)])!==this[_0x47bcfc(0x281)])return;const _0x2db021={'eventID':_0x245d5b['CollaborationEvent'][_0x47bcfc(0x29a)],'data':_0x17319b};this[_0x47bcfc(0x27e)](_0x2db021);}),this['disposeWithMe'](this[_0x3583b4(0x2e7)][_0x3583b4(0x577)](_0xc757d0=>{const _0x117535=_0x3583b4;if(_0xc757d0[_0x117535(0x31b)]==null)return;const _0x4293e9=_0xc757d0[_0x117535(0x31b)];if(_0xc757d0['id']!==_0x23e2c7[_0x117535(0x437)]['id']||_0x4293e9[_0x117535(0x432)]!==this[_0x117535(0x281)])return;const _0x5ba99d={'id':'doc.mutation.rich-text-editing','params':_0x4293e9},_0xe6e2f7=this['cursorInfo'];for(const [_0x43cfa1,_0x43beaa]of _0xe6e2f7){const _0x5526fb={'id':_0x117535(0x462),'params':{'unitId':this[_0x117535(0x281)],'actions':null,'textRanges':_0x43beaa[_0x117535(0x3c7)]}},_0x3a9586=this[_0x117535(0x2b7)]['transformMutation'](_0x5ba99d,_0x5526fb,!0x1);if(_0x245d5b[_0x117535(0x50c)](_0x3a9586))throw _0x3a9586[_0x117535(0x2ff)];_0xe6e2f7[_0x117535(0x252)](_0x43cfa1,{..._0x43beaa,'ranges':_0x3a9586['m2Prime'][_0x117535(0x31b)]['textRanges']});}queueMicrotask(()=>{const _0xa31059=_0x117535;this[_0xa31059(0x309)]['next'](_0xe6e2f7);});})));}[_0x216ec2(0x27e)](_0x4bc5f5){const _0x229e62=_0x216ec2;var _0x4e294a,_0x17d3b9;const {memberID:_0x1968db,selection:_0x35d040}=_0x4bc5f5[_0x229e62(0x2fd)],_0x37f81b=_0x7f9667(_0x35d040),_0x5a06f3=(_0x17d3b9=(_0x4e294a=this[_0x229e62(0x250)][_0x229e62(0x1f6)](this[_0x229e62(0x281)],_0x1968db))==null?void 0x0:_0x4e294a[_0x229e62(0x45c)])!=null?_0x17d3b9:_0x229e62(0x3ef),_0x418bdc={'color':this[_0x229e62(0x501)][_0x229e62(0x582)](_0x1968db),'name':_0x5a06f3,'ranges':_0x37f81b},_0x492296=this[_0x229e62(0x3e6)];_0x492296['set'](_0x1968db,_0x418bdc),this[_0x229e62(0x309)]['next'](_0x492296);}[_0x216ec2(0x466)](_0x1bd09d){const _0x304c4d=_0x216ec2,{memberID:_0x5b62ca}=_0x1bd09d[_0x304c4d(0x2fd)],_0x17b6ac=this[_0x304c4d(0x3e6)];_0x17b6ac['delete'](_0x5b62ca),this[_0x304c4d(0x309)][_0x304c4d(0x473)](_0x17b6ac);}[_0x216ec2(0x4f2)](){const _0x216e7e=_0x216ec2;var _0x245431;if(this[_0x216e7e(0x553)]=!0x0,((_0x245431=this[_0x216e7e(0x255)][_0x216e7e(0x53f)]())==null?void 0x0:_0x245431[_0x216e7e(0x559)]())!==this[_0x216e7e(0x281)])return;const _0x3fc51f=this[_0x216e7e(0x400)][_0x216e7e(0x458)](_0x23e2c7[_0x216e7e(0x2d4)])['getCurrentSelections'](),_0x3efa7e=_0x3fc51f==null?void 0x0:_0x3fc51f[_0x216e7e(0x386)](_0x23e2c7[_0x216e7e(0x2b4)]);Array['isArray'](_0x3efa7e)&&_0x3efa7e[_0x216e7e(0x48b)]>0x0&&this[_0x216e7e(0x2a0)](_0x3efa7e);}[_0x216ec2(0x580)](){const _0x391a71=_0x216ec2;this[_0x391a71(0x553)]=!0x1;}};_0xecab1b=_0x486f65([_0x3e3e1c(0x2,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x236)])),_0x3e3e1c(0x3,_0x207f05[_0x216ec2(0x511)](_0x17ed63)),_0x3e3e1c(0x4,_0x207f05[_0x216ec2(0x511)](_0x35ecb0)),_0x3e3e1c(0x5,_0x207f05[_0x216ec2(0x511)](_0x6344ed)),_0x3e3e1c(0x6,_0x245d5b[_0x216ec2(0x3e8)]),_0x3e3e1c(0x7,_0x207f05[_0x216ec2(0x1f4)]),_0x3e3e1c(0x8,_0x207f05['ICommandService'])],_0xecab1b);var _0x2f745a=Object[_0x216ec2(0x3d2)],_0x2a8153=Object[_0x216ec2(0x498)],_0x5ae898=(_0x380f42,_0x5415f4,_0x54b282,_0x276f90)=>{const _0x228ad7=_0x216ec2;for(var _0x13a894=_0x276f90>0x1?void 0x0:_0x276f90?_0x2a8153(_0x5415f4,_0x54b282):_0x5415f4,_0x2effb9=_0x380f42[_0x228ad7(0x48b)]-0x1,_0x3ef7ab;_0x2effb9>=0x0;_0x2effb9--)(_0x3ef7ab=_0x380f42[_0x2effb9])&&(_0x13a894=(_0x276f90?_0x3ef7ab(_0x5415f4,_0x54b282,_0x13a894):_0x3ef7ab(_0x13a894))||_0x13a894);return _0x276f90&&_0x13a894&&_0x2f745a(_0x5415f4,_0x54b282,_0x13a894),_0x13a894;},_0x246a65=(_0x4ea1ea,_0xf4c69d)=>(_0x504b90,_0x21cf93)=>_0xf4c69d(_0x504b90,_0x21cf93,_0x4ea1ea);let _0x57a077=class extends _0x207f05[_0x216ec2(0x48f)]{constructor(_0x458ad0,_0x256fba,_0x551680){const _0x566ef8=_0x216ec2;super(),_0x574c73(this,_0x566ef8(0x3b7),new Map()),_0x574c73(this,_0x566ef8(0x4ab),new _0xb87526[(_0x566ef8(0x29e))]()),(this[_0x566ef8(0x255)]=_0x458ad0,this['_injector']=_0x256fba,this[_0x566ef8(0x2fc)]=_0x551680,this['_init']());}[_0x216ec2(0x3a0)](){const _0xc215c2=_0x216ec2;super['dispose'](),this[_0xc215c2(0x4ab)][_0xc215c2(0x39c)](),this[_0xc215c2(0x3b7)][_0xc215c2(0x43f)](_0x3a6ed5=>_0x3a6ed5['dispose']());}[_0x216ec2(0x2e4)](_0x364330){const _0x38c58c=_0x216ec2;return this[_0x38c58c(0x3b7)][_0x38c58c(0x1dc)](_0x364330)?this[_0x38c58c(0x3b7)][_0x38c58c(0x458)](_0x364330)[_0x38c58c(0x457)]:this[_0x38c58c(0x4ab)][_0x38c58c(0x2bb)](_0xb87526[_0x38c58c(0x449)](_0x52cb64=>_0x52cb64[_0x38c58c(0x281)]===_0x364330),_0xb87526[_0x38c58c(0x285)](_0x5200c0=>_0x5200c0[_0x38c58c(0x457)]));}['_init'](){const _0x482176=_0x216ec2;this['_univerInstanceService'][_0x482176(0x334)](_0x207f05['UniverInstanceType'][_0x482176(0x429)])[_0x482176(0x2bb)](_0xb87526[_0x482176(0x516)](this[_0x482176(0x274)]))[_0x482176(0x314)](async _0x3b366d=>{const _0x520ab3=_0x482176,_0x53ca28=_0x3b366d[_0x520ab3(0x559)](),_0x3a9c17=await this['_startSheetCollabCursor'](_0x53ca28);this[_0x520ab3(0x4ab)][_0x520ab3(0x473)](_0x3a9c17),this[_0x520ab3(0x3b7)][_0x520ab3(0x252)](_0x53ca28,_0x3a9c17);}),this[_0x482176(0x255)][_0x482176(0x334)](_0x207f05[_0x482176(0x583)][_0x482176(0x27f)])[_0x482176(0x2bb)](_0xb87526[_0x482176(0x516)](this[_0x482176(0x274)]))['pipe'](_0xb87526[_0x482176(0x449)](_0x143edb=>!_0x143edb[_0x482176(0x559)]()[_0x482176(0x322)]('__')))[_0x482176(0x314)](async _0x2d9f95=>{const _0x316293=_0x482176,_0x5144bc=_0x2d9f95['getUnitId'](),_0xe8d955=await this[_0x316293(0x33f)](_0x5144bc);this[_0x316293(0x4ab)][_0x316293(0x473)](_0xe8d955),this['_entities']['set'](_0x5144bc,_0xe8d955);}),_0xb87526[_0x482176(0x427)](this[_0x482176(0x255)]['getTypeOfUnitDisposed$'](_0x207f05[_0x482176(0x583)][_0x482176(0x27f)]),this[_0x482176(0x255)][_0x482176(0x4fa)](_0x207f05[_0x482176(0x583)]['UNIVER_SHEET']))['pipe'](_0xb87526[_0x482176(0x516)](this[_0x482176(0x274)]))[_0x482176(0x314)](_0x46b623=>{const _0x42837e=_0x482176,_0x2977dc=_0x46b623['getUnitId'](),_0x1fe35b=this[_0x42837e(0x3b7)][_0x42837e(0x458)](_0x2977dc);_0x1fe35b&&(_0x1fe35b['dispose'](),this[_0x42837e(0x3b7)]['delete'](_0x2977dc));});}async[_0x216ec2(0x219)](_0xab204f){const _0x910408=_0x216ec2,_0x5a257c=await this[_0x910408(0x2fc)][_0x910408(0x2da)](_0xab204f),_0x5abe3e=this[_0x910408(0x400)][_0x910408(0x596)](_0x30f485,_0xab204f,_0x5a257c);return _0x5abe3e[_0x910408(0x1eb)](),_0x5abe3e;}async[_0x216ec2(0x33f)](_0x324c5e){const _0x210d7b=_0x216ec2,_0x5f3f14=await this[_0x210d7b(0x2fc)][_0x210d7b(0x2da)](_0x324c5e),_0x37bcac=this[_0x210d7b(0x400)][_0x210d7b(0x596)](_0xecab1b,_0x324c5e,_0x5f3f14);return _0x37bcac[_0x210d7b(0x1eb)](),_0x37bcac;}};_0x57a077=_0x5ae898([_0x207f05[_0x216ec2(0x26a)](_0x207f05[_0x216ec2(0x2fe)][_0x216ec2(0x2b8)],_0x57a077),_0x246a65(0x0,_0x207f05[_0x216ec2(0x1f4)]),_0x246a65(0x1,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x236)])),_0x246a65(0x2,_0x207f05[_0x216ec2(0x511)](_0x11abd7[_0x216ec2(0x3e1)]))],_0x57a077);const _0xbb8fdc=0x14,_0x77b023=0xc8,_0x48afea=0x4,_0x525273=0x5;function _0x11f5bf(_0x398f51,_0x28bf5d){const _0x5d4fc0=_0x216ec2;let {radius:_0x2b45ab,width:_0x365a39,height:_0x3ef576}=_0x28bf5d;_0x2b45ab=_0x2b45ab!=null?_0x2b45ab:0x0,_0x365a39=_0x365a39!=null?_0x365a39:0x1e,_0x3ef576=_0x3ef576!=null?_0x3ef576:0x1e;let _0xaf1ea8=0x0,_0x3b13be=0x0,_0x5f053c=0x0;_0xaf1ea8=_0x3b13be=_0x5f053c=Math[_0x5d4fc0(0x2df)](_0x2b45ab,_0x365a39/0x2,_0x3ef576/0x2),_0x398f51[_0x5d4fc0(0x531)](),_0x398f51[_0x5d4fc0(0x37b)](_0xaf1ea8,0x0),_0x398f51[_0x5d4fc0(0x2a9)](_0x365a39-_0x3b13be,0x0),_0x398f51['arc'](_0x365a39-_0x3b13be,_0x3b13be,_0x3b13be,Math['PI']*0x3/0x2,0x0,!0x1),_0x398f51[_0x5d4fc0(0x2a9)](_0x365a39,_0x3ef576-_0x5f053c),_0x398f51['arc'](_0x365a39-_0x5f053c,_0x3ef576-_0x5f053c,_0x5f053c,0x0,Math['PI']/0x2,!0x1),_0x398f51[_0x5d4fc0(0x2a9)](0x0,_0x3ef576),_0x398f51[_0x5d4fc0(0x2a9)](0x0,_0xaf1ea8),_0x398f51[_0x5d4fc0(0x4b9)](_0xaf1ea8,_0xaf1ea8,_0xaf1ea8,Math['PI'],Math['PI']*0x3/0x2,!0x1),_0x398f51[_0x5d4fc0(0x40a)](),_0x28bf5d[_0x5d4fc0(0x5a4)]&&(_0x398f51['save'](),_0x398f51['fillStyle']=_0x28bf5d['fill'],_0x28bf5d['fillRule']===_0x5d4fc0(0x44b)?_0x398f51['fill'](_0x5d4fc0(0x44b)):_0x398f51[_0x5d4fc0(0x5a4)](),_0x398f51[_0x5d4fc0(0x440)]());}class _0x14187d extends _0x1bdf92[_0x216ec2(0x284)]{constructor(_0x1acc9f,_0x3f3ea7){const _0x53749b=_0x216ec2;super(_0x1acc9f,_0x3f3ea7),_0x574c73(this,_0x53749b(0x463)),_0x574c73(this,_0x53749b(0x49c)),(this[_0x53749b(0x463)]=_0x3f3ea7==null?void 0x0:_0x3f3ea7['color'],this['text']=_0x3f3ea7==null?void 0x0:_0x3f3ea7['text']);}static[_0x216ec2(0x3e2)](_0x50ce13,_0x599b85){const _0x4cace2=_0x216ec2,{text:_0x59a26e,color:_0x419ffa}=_0x599b85;_0x50ce13[_0x4cace2(0x318)](),_0x50ce13[_0x4cace2(0x1fb)]=_0x4cace2(0x380);const _0x39b7df=_0x50ce13['measureText'](_0x59a26e)['width'],_0x46041b=Math[_0x4cace2(0x2df)](_0x39b7df+0x2*_0x48afea,_0x77b023);_0x11f5bf(_0x50ce13,{'height':_0xbb8fdc,'radius':0x4,'width':_0x46041b,'fill':_0x419ffa,'evented':!0x1}),_0x50ce13[_0x4cace2(0x27d)]=_0x4cace2(0x3ed);const _0x390798=_0x48afea,_0x23d667=_0xbb8fdc-_0x525273,_0x2b5d11=_0x77b023-0x2*_0x48afea;if(_0x39b7df>_0x2b5d11){let _0x3f84ea='',_0x488b67=0x0;for(const _0x4953a6 of _0x59a26e){const _0x58bc8c=_0x50ce13[_0x4cace2(0x20c)](_0x4953a6)[_0x4cace2(0x46d)];if(_0x488b67+_0x58bc8c<=_0x2b5d11-_0x50ce13[_0x4cace2(0x20c)]('...')[_0x4cace2(0x46d)])_0x3f84ea+=_0x4953a6,_0x488b67+=_0x58bc8c;else{_0x3f84ea+='...';break;}}_0x50ce13[_0x4cace2(0x2e3)](_0x3f84ea,_0x390798,_0x23d667);}else _0x50ce13[_0x4cace2(0x2e3)](_0x59a26e,_0x390798,_0x23d667);_0x50ce13[_0x4cace2(0x440)]();}[_0x216ec2(0x367)](_0x23716f){const _0x592c04=_0x216ec2;_0x14187d[_0x592c04(0x3e2)](_0x23716f,this);}}const _0x240c9c=0x1,_0xc2120c=1.5;class _0x55eaeb extends _0x1bdf92['Shape']{constructor(_0x399ef5,_0xe7df51){const _0x4dc49b=_0x216ec2;super(_0x399ef5,_0xe7df51),_0x574c73(this,_0x4dc49b(0x3b3)),_0x574c73(this,_0x4dc49b(0x4cf),!0x1),_0x574c73(this,'_range'),_0x574c73(this,_0x4dc49b(0x293),''),_0x574c73(this,_0x4dc49b(0x292),_0x4dc49b(0x56e)),_0x574c73(this,_0x4dc49b(0x56c)),(_0xe7df51&&this[_0x4dc49b(0x58f)](_0xe7df51),this[_0x4dc49b(0x2ea)][_0x4dc49b(0x5bb)](()=>this[_0x4dc49b(0x58f)]({'hovered':!0x0})),this[_0x4dc49b(0x5b5)][_0x4dc49b(0x5bb)](()=>this[_0x4dc49b(0x58f)]({'hovered':!0x1})));}[_0x216ec2(0x58f)](_0x2719d5){const _0x568ff7=_0x216ec2;var _0x100f00,_0x5088d3,_0x2a51f9,_0x5b7978,_0x4f3ad4,_0xf14b5;this[_0x568ff7(0x3b3)]=(_0x100f00=_0x2719d5[_0x568ff7(0x463)])!=null?_0x100f00:this[_0x568ff7(0x3b3)],this[_0x568ff7(0x4cf)]=(_0x5088d3=_0x2719d5['hovered'])!=null?_0x5088d3:this[_0x568ff7(0x4cf)],this[_0x568ff7(0x47d)]=(_0x2a51f9=_0x2719d5[_0x568ff7(0x496)])!=null?_0x2a51f9:this[_0x568ff7(0x47d)],this[_0x568ff7(0x293)]=(_0x5b7978=_0x2719d5[_0x568ff7(0x45c)])!=null?_0x5b7978:this[_0x568ff7(0x293)],this[_0x568ff7(0x292)]=(_0x4f3ad4=_0x2719d5[_0x568ff7(0x5b3)])!=null?_0x4f3ad4:this[_0x568ff7(0x292)],this[_0x568ff7(0x56c)]=(_0xf14b5=_0x2719d5[_0x568ff7(0x277)])!=null?_0xf14b5:this[_0x568ff7(0x56c)],this[_0x568ff7(0x218)]({'width':_0x2719d5['width'],'height':_0x2719d5[_0x568ff7(0x4d2)]});}[_0x216ec2(0x450)](_0x55993b){const _0x85dacf=_0x216ec2,{row:_0x4e015c,column:_0x490df5}=_0x55993b;if(_0x4e015c>=this[_0x85dacf(0x47d)][_0x85dacf(0x208)]&&_0x4e015c<=this[_0x85dacf(0x47d)][_0x85dacf(0x3df)]&&_0x490df5>=this['_range'][_0x85dacf(0x31d)]&&_0x490df5<=this[_0x85dacf(0x47d)][_0x85dacf(0x55c)]){this['setShapeProps']({'hovered':!0x0});return;}this[_0x85dacf(0x58f)]({'hovered':!0x1});}['triggerDblclick'](_0xfa9cdf){return!0x1;}[_0x216ec2(0x367)](_0x4df474){const _0x530168=_0x216ec2;_0x1bdf92[_0x530168(0x341)][_0x530168(0x3e2)](_0x4df474,{'width':this[_0x530168(0x46d)],'height':this[_0x530168(0x4d2)],'strokeWidth':_0xc2120c,'stroke':this['_color'],'evented':!0x1,'fill':this['_backgroundColor']}),this[_0x530168(0x4cf)]&&(_0x4df474[_0x530168(0x318)](),_0x4df474[_0x530168(0x4e6)](0x1,0x0,0x0,0x1,this[_0x530168(0x46d)],this[_0x530168(0x292)]==='bottom'?0x0:-_0xbb8fdc),_0x14187d['drawWith'](_0x4df474,{'text':this[_0x530168(0x293)],'color':this['_color']}),_0x4df474['restore']());}}var _0x65b7b9=Object[_0x216ec2(0x3d2)],_0x34c16c=Object[_0x216ec2(0x498)],_0x10d515=(_0x173511,_0x289bc4,_0x5c03d4,_0x4dcc41)=>{const _0x4ec425=_0x216ec2;for(var _0x1afe71=_0x4dcc41>0x1?void 0x0:_0x4dcc41?_0x34c16c(_0x289bc4,_0x5c03d4):_0x289bc4,_0x2fb644=_0x173511[_0x4ec425(0x48b)]-0x1,_0x274bfd;_0x2fb644>=0x0;_0x2fb644--)(_0x274bfd=_0x173511[_0x2fb644])&&(_0x1afe71=(_0x4dcc41?_0x274bfd(_0x289bc4,_0x5c03d4,_0x1afe71):_0x274bfd(_0x1afe71))||_0x1afe71);return _0x4dcc41&&_0x1afe71&&_0x65b7b9(_0x289bc4,_0x5c03d4,_0x1afe71),_0x1afe71;},_0x2ef327=(_0x4396dc,_0x15aa44)=>(_0xf678fc,_0x2a629a)=>_0x15aa44(_0xf678fc,_0x2a629a,_0x4396dc);const _0x2ede1b=0x1389;let _0x3aa35c=class extends _0x207f05['RxDisposable']{constructor(_0x409cb8,_0x3ec85f,_0x468b06,_0x49b59c){const _0x720688=_0x216ec2;super(),_0x574c73(this,_0x720688(0x4c5),new Set()),_0x574c73(this,_0x720688(0x2a8),null),(this['_context']=_0x409cb8,this['_sheetSkeletonManagerService']=_0x3ec85f,this['_collabCursorController']=_0x468b06,this[_0x720688(0x38f)]=_0x49b59c,this[_0x720688(0x299)]());}[_0x216ec2(0x299)](){const _0x1ecbcb=_0x216ec2;this['_sheetSkeletonManagerService'][_0x1ecbcb(0x2c9)][_0x1ecbcb(0x2bb)](_0x9f6f32['takeUntil'](this['dispose$']),_0x9f6f32['switchMap'](_0x1c237b=>{const _0x2a1f17=_0x1ecbcb;if(_0x1c237b){const _0x2d8fd8=_0x1c237b[_0x2a1f17(0x21a)];return _0xb87526[_0x2a1f17(0x1ca)](this[_0x2a1f17(0x5be)]['getCollabCursors$'](this[_0x2a1f17(0x4d4)][_0x2a1f17(0x432)]),this[_0x2a1f17(0x38f)][_0x2a1f17(0x359)])[_0x2a1f17(0x2bb)](_0x9f6f32[_0x2a1f17(0x386)](([_0x11fd3e,_0x9dfb21])=>{const _0x572827=new Map();return _0x11fd3e['forEach']((_0x37ab7b,_0x37c035)=>{const _0x2604b2=_0x4438;if(_0x37ab7b['sheetID']===_0x2d8fd8){const _0x4a6283={..._0x37ab7b};_0x4a6283['color']=_0x9dfb21[_0x37ab7b[_0x2604b2(0x463)]],_0x572827['set'](_0x37c035,_0x4a6283);}}),{'skeleton':_0x1c237b,'cursors':_0x572827};}));}return _0xb87526['of']({'skeleton':null,'cursors':new Map()});}))['subscribe'](({skeleton:_0x1bbf87,cursors:_0x44da6f})=>{this['_removeCollabCursors'](),_0x1bbf87&&this['_updateCollabCursors'](_0x1bbf87,_0x44da6f);}),this['_sheetSkeletonManagerService'][_0x1ecbcb(0x2c9)][_0x1ecbcb(0x314)](_0xdcadfb=>{const _0x304360=_0x1ecbcb;if(_0xdcadfb==null)return;const {skeleton:_0x242db7}=_0xdcadfb,{scene:_0x19d16c}=this[_0x304360(0x4d4)];_0x19d16c[_0x304360(0x52d)][_0x304360(0x5bb)](_0x3426d0(_0x4ae8cb=>{const _0x4d7893=_0x304360;var _0x9092a7,_0x51955f;const {offsetX:_0xc4361d,offsetY:_0x1cd750}=_0x4ae8cb,{x:_0x220b17,y:_0x3ae1a8}=_0x19d16c['getRelativeToViewportCoord'](_0x1bdf92[_0x4d7893(0x3cb)][_0x4d7893(0x55b)]([_0xc4361d,_0x1cd750])),{scaleX:_0x2e0513,scaleY:_0x505bbf}=_0x19d16c[_0x4d7893(0x39d)](),_0x2fd9da=_0x19d16c[_0x4d7893(0x23d)](_0x40f102[_0x4d7893(0x56b)][_0x4d7893(0x57f)]),_0x215709=_0x19d16c[_0x4d7893(0x271)](_0x1bdf92[_0x4d7893(0x3cb)][_0x4d7893(0x55b)]([_0x220b17,_0x3ae1a8]),_0x2fd9da),_0x8dee5d=_0x242db7[_0x4d7893(0x47e)](_0xc4361d,_0x1cd750,_0x2e0513,_0x505bbf,_0x215709);((_0x9092a7=this[_0x4d7893(0x2a8)])==null?void 0x0:_0x9092a7[_0x4d7893(0x550)])===_0x8dee5d[_0x4d7893(0x550)]&&((_0x51955f=this[_0x4d7893(0x2a8)])==null?void 0x0:_0x51955f[_0x4d7893(0x249)])===_0x8dee5d[_0x4d7893(0x249)]||this['_cursors'][_0x4d7893(0x43f)](_0x1bf9a1=>{const _0x3b6200=_0x4d7893;_0x1bf9a1[_0x3b6200(0x450)](_0x8dee5d);});},0x64));});}[_0x216ec2(0x1fd)](_0x30ddda,_0x32bcec){const _0x36da9c=_0x216ec2;var _0x1b1a1c;const _0x412882=(_0x1b1a1c=this[_0x36da9c(0x3fd)]['getCurrent']())==null?void 0x0:_0x1b1a1c[_0x36da9c(0x332)];if(!_0x412882)return;const _0x2d8d8a=this[_0x36da9c(0x517)]();if(!_0x2d8d8a)return;this[_0x36da9c(0x4c5)][_0x36da9c(0x43f)](_0x3cc74c=>{const _0xf5a69c=_0x36da9c;_0x3cc74c[_0xf5a69c(0x58e)]();});const {scene:_0x20593d}=_0x2d8d8a,_0x2eac90=_0x267d0d(Array[_0x36da9c(0x411)](_0x32bcec[_0x36da9c(0x3c9)]()))['map'](_0x509ae6=>{const _0x7d1c9a=_0x36da9c,{color:_0x1ec523,range:_0x5c7e15,name:_0x4e558e,selection:_0x54f528,sheetID:_0x42f3be}=_0x509ae6,{startColumn:_0x1b7149,startRow:_0x374dcd,endColumn:_0x40c678,endRow:_0x4ae84f}=_0x5c7e15,_0x3fc3fd=_0x40f102['getCoordByCell'](_0x374dcd,_0x1b7149,_0x20593d,_0x412882),_0x3ede44=_0x40f102[_0x7d1c9a(0x52e)](_0x4ae84f,_0x40c678,_0x20593d,_0x412882),{columnHeaderHeightAndMarginTop:_0x32161c}=_0x412882,{startX:_0x14286b,startY:_0x1f89e8}=_0x3fc3fd,{endX:_0x3009d6,endY:_0x3bf6c9}=_0x3ede44,_0x158a56=_0x3009d6-_0x14286b,_0x3bee9d=_0x3bf6c9-_0x1f89e8,_0x59d145={'labelPosition':_0x1f89e8-_0x32161c>=_0xbb8fdc?'top':_0x7d1c9a(0x269),'sheetID':_0x42f3be,'range':_0x5c7e15,'color':_0x1ec523,'name':_0x4e558e,'selection':_0x54f528,'left':_0x14286b,'top':_0x1f89e8,'width':_0x158a56,'height':_0x3bee9d,'evented':!0x1,'zIndex':_0x2ede1b};return new _0x55eaeb(_0x4e558e,_0x59d145);});_0x20593d[_0x36da9c(0x2e1)](_0x2eac90,_0x240c9c),this['_cursors']=new Set(_0x2eac90);}['_removeCollabCursors'](){const _0x1365d2=_0x216ec2;var _0x2c1163;(_0x2c1163=this[_0x1365d2(0x4c5)])==null||_0x2c1163[_0x1365d2(0x43f)](_0x5a60a7=>_0x5a60a7[_0x1365d2(0x3a0)]());}[_0x216ec2(0x517)](){const _0x502cce=_0x216ec2;return _0x40f102[_0x502cce(0x405)](this[_0x502cce(0x4d4)]['unit'],this[_0x502cce(0x4d4)]);}};_0x3aa35c=_0x10d515([_0x2ef327(0x1,_0x207f05[_0x216ec2(0x511)](_0x40f102[_0x216ec2(0x3eb)])),_0x2ef327(0x2,_0x207f05[_0x216ec2(0x511)](_0x57a077)),_0x2ef327(0x3,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x1e9)]))],_0x3aa35c);function _0x267d0d(_0x46d0f1){const _0x49062a=_0x216ec2,_0x2ba231=new Map();return _0x46d0f1[_0x49062a(0x43f)](_0x3c4e21=>{const _0xcb2707=_0x49062a;if(_0x2ba231['has'](_0x3c4e21[_0xcb2707(0x1ee)])){const _0x59483d=_0x2ba231[_0xcb2707(0x458)](_0x3c4e21[_0xcb2707(0x1ee)]);_0x59483d[_0xcb2707(0x45c)]+=',\x20'+_0x3c4e21[_0xcb2707(0x45c)];}else _0x2ba231[_0xcb2707(0x252)](_0x3c4e21[_0xcb2707(0x1ee)],_0x3c4e21);}),Array['from'](_0x2ba231[_0x49062a(0x3c9)]());}var _0x4b5fbf=function(){const _0x1b982a=_0x216ec2;return _0x4b5fbf=Object[_0x1b982a(0x233)]||function(_0x495297){const _0x212a8e=_0x1b982a;for(var _0x5c7325,_0x720a91=0x1,_0x33cbcc=arguments[_0x212a8e(0x48b)];_0x720a91<_0x33cbcc;_0x720a91++){_0x5c7325=arguments[_0x720a91];for(var _0x171f32 in _0x5c7325)Object[_0x212a8e(0x490)][_0x212a8e(0x262)][_0x212a8e(0x2cf)](_0x5c7325,_0x171f32)&&(_0x495297[_0x171f32]=_0x5c7325[_0x171f32]);}return _0x495297;},_0x4b5fbf[_0x1b982a(0x34f)](this,arguments);},_0x1b68ff=function(_0x110bd9,_0x63ccb5){const _0x14cc9f=_0x216ec2;var _0x429335={};for(var _0xd4a497 in _0x110bd9)Object[_0x14cc9f(0x490)][_0x14cc9f(0x262)][_0x14cc9f(0x2cf)](_0x110bd9,_0xd4a497)&&_0x63ccb5[_0x14cc9f(0x42e)](_0xd4a497)<0x0&&(_0x429335[_0xd4a497]=_0x110bd9[_0xd4a497]);if(_0x110bd9!=null&&typeof Object[_0x14cc9f(0x420)]==_0x14cc9f(0x2c0)){for(var _0x4a642c=0x0,_0xd4a497=Object[_0x14cc9f(0x420)](_0x110bd9);_0x4a642c<_0xd4a497[_0x14cc9f(0x48b)];_0x4a642c++)_0x63ccb5[_0x14cc9f(0x42e)](_0xd4a497[_0x4a642c])<0x0&&Object[_0x14cc9f(0x490)][_0x14cc9f(0x51b)]['call'](_0x110bd9,_0xd4a497[_0x4a642c])&&(_0x429335[_0xd4a497[_0x4a642c]]=_0x110bd9[_0xd4a497[_0x4a642c]]);}return _0x429335;},_0x5aba6a=_0x18e53c['forwardRef'](function(_0x12f8d0,_0x1f84b4){const _0x5928cd=_0x216ec2;var _0x32a3dd=_0x12f8d0[_0x5928cd(0x28d)],_0x377a99=_0x12f8d0['id'],_0x495113=_0x12f8d0[_0x5928cd(0x4f0)],_0x27d2bb=_0x12f8d0[_0x5928cd(0x2e0)],_0x120e57=_0x1b68ff(_0x12f8d0,['icon','id','className',_0x5928cd(0x2e0)]),_0x482fce=_0x5928cd(0x349)[_0x5928cd(0x576)](_0x377a99,'\x20')[_0x5928cd(0x576)](_0x495113||'')['trim'](),_0x3d132d=_0x18e53c[_0x5928cd(0x243)]('_'[_0x5928cd(0x576)](_0xad3f3()));return _0xc3b319(_0x32a3dd,''[_0x5928cd(0x576)](_0x377a99),{'defIds':_0x32a3dd[_0x5928cd(0x331)],'idSuffix':_0x3d132d[_0x5928cd(0x51e)]},_0x4b5fbf({'ref':_0x1f84b4,'className':_0x482fce},_0x120e57),_0x27d2bb);});function _0xc3b319(_0x324797,_0x4c6991,_0x2a0746,_0x156664,_0x23f963){const _0x50e27a=_0x216ec2;return _0x18e53c[_0x50e27a(0x28a)](_0x324797[_0x50e27a(0x4dc)],_0x4b5fbf(_0x4b5fbf({'key':_0x4c6991},_0x5021e3(_0x324797,_0x2a0746,_0x23f963)),_0x156664),(_0x21e02b(_0x324797,_0x2a0746)[_0x50e27a(0x591)]||[])[_0x50e27a(0x386)](function(_0x55190f,_0xa4a5db){const _0x1e7162=_0x50e27a;return _0xc3b319(_0x55190f,''[_0x1e7162(0x576)](_0x4c6991,'-')[_0x1e7162(0x576)](_0x324797[_0x1e7162(0x4dc)],'-')['concat'](_0xa4a5db),_0x2a0746,void 0x0,_0x23f963);}));}function _0x5021e3(_0x270f38,_0x41c587,_0xb5d950){const _0x41fdfb=_0x216ec2;var _0x4da25b=_0x4b5fbf({},_0x270f38[_0x41fdfb(0x3b5)]);_0xb5d950!=null&&_0xb5d950[_0x41fdfb(0x25e)]&&_0x4da25b[_0x41fdfb(0x5a4)]==='colorChannel1'&&(_0x4da25b[_0x41fdfb(0x5a4)]=_0xb5d950[_0x41fdfb(0x25e)]);var _0x29b621=_0x41c587[_0x41fdfb(0x331)];return!_0x29b621||_0x29b621[_0x41fdfb(0x48b)]===0x0||(_0x270f38[_0x41fdfb(0x4dc)]===_0x41fdfb(0x3b6)&&_0x4da25b[_0x41fdfb(0x20d)]&&(_0x4da25b['xlink:href']=_0x4da25b['xlink:href']+_0x41c587[_0x41fdfb(0x30e)]),Object['entries'](_0x4da25b)[_0x41fdfb(0x43f)](function(_0x2fcacf){const _0x231673=_0x41fdfb;var _0x3f8784=_0x2fcacf[0x0],_0x4a9973=_0x2fcacf[0x1];typeof _0x4a9973==_0x231673(0x371)&&(_0x4da25b[_0x3f8784]=_0x4a9973['replace'](/url\(#(.*)\)/,_0x231673(0x465)[_0x231673(0x576)](_0x41c587[_0x231673(0x30e)],')')));})),_0x4da25b;}function _0x21e02b(_0x12dba6,_0x51a39e){const _0x509ea4=_0x216ec2;var _0x511109,_0x27cb2a=_0x51a39e[_0x509ea4(0x331)];return!_0x27cb2a||_0x27cb2a[_0x509ea4(0x48b)]===0x0?_0x12dba6:_0x12dba6[_0x509ea4(0x4dc)]===_0x509ea4(0x1c8)&&(!((_0x511109=_0x12dba6[_0x509ea4(0x591)])===null||_0x511109===void 0x0)&&_0x511109[_0x509ea4(0x48b)])?_0x4b5fbf(_0x4b5fbf({},_0x12dba6),{'children':_0x12dba6['children']['map'](function(_0x50dbaa){const _0x37f0f7=_0x509ea4;return typeof _0x50dbaa[_0x37f0f7(0x3b5)]['id']==_0x37f0f7(0x371)&&_0x27cb2a&&_0x27cb2a['indexOf'](_0x50dbaa[_0x37f0f7(0x3b5)]['id'])>-0x1?_0x4b5fbf(_0x4b5fbf({},_0x50dbaa),{'attrs':_0x4b5fbf(_0x4b5fbf({},_0x50dbaa['attrs']),{'id':_0x50dbaa[_0x37f0f7(0x3b5)]['id']+_0x51a39e[_0x37f0f7(0x30e)]})}):_0x50dbaa;})}):_0x12dba6;}function _0xad3f3(){const _0x21ffc2=_0x216ec2;return Math[_0x21ffc2(0x1cb)]()['toString'](0x24)[_0x21ffc2(0x4e5)](0x2,0x8);}_0x5aba6a[_0x216ec2(0x4ea)]=_0x216ec2(0x1db);var _0x415e65={'tag':_0x216ec2(0x554),'attrs':{'fill':_0x216ec2(0x41f),'viewBox':_0x216ec2(0x316),'width':_0x216ec2(0x47b),'height':_0x216ec2(0x47b)},'children':[{'tag':'g','attrs':{'clipPath':'url(#off-line-single_clip0_910_343)'},'children':[{'tag':_0x216ec2(0x30d),'attrs':{'stroke':'currentColor','d':'M3.61971\x2011.6499C2.40304\x2011.6499\x200.699707\x2011.1024\x200.699707\x208.9124C0.699707\x206.3574\x203.25471\x205.8099\x203.98471\x205.8099C4.34971\x204.5324\x205.07971\x202.5249\x207.99971\x202.5249C10.5547\x202.5249\x2011.6497\x203.9849\x2012.0147\x205.2624C12.0147\x205.2624\x2015.2997\x205.6274\x2015.2997\x208.7299C15.2997\x2010.9199\x2013.8397\x2011.6499\x2012.3797\x2011.6499M9.82471\x209.82466L6.17471\x2013.4747M6.17471\x209.82466L9.82471\x2013.4747','strokeLinecap':_0x216ec2(0x33a),'strokeLinejoin':_0x216ec2(0x33a),'strokeWidth':1.2}}]},{'tag':_0x216ec2(0x1c8),'attrs':{},'children':[{'tag':_0x216ec2(0x478),'attrs':{'id':_0x216ec2(0x453)},'children':[{'tag':_0x216ec2(0x30d),'attrs':{'fill':_0x216ec2(0x370),'d':'M0\x200H16V16H0z'}}]}]}],'defIds':[_0x216ec2(0x453)]},_0x3de172=_0x18e53c[_0x216ec2(0x3f5)](function(_0x312997,_0xef3b2c){const _0x3c0e74=_0x216ec2;return _0x18e53c[_0x3c0e74(0x28a)](_0x5aba6a,Object[_0x3c0e74(0x233)]({},_0x312997,{'id':_0x3c0e74(0x509),'ref':_0xef3b2c,'icon':_0x415e65}));});_0x3de172[_0x216ec2(0x4ea)]=_0x216ec2(0x56d);var _0x2a066e={'tag':_0x216ec2(0x554),'attrs':{'fill':_0x216ec2(0x41f),'viewBox':_0x216ec2(0x55d),'width':'1em','height':_0x216ec2(0x47b)},'children':[{'tag':'g','attrs':{'clipPath':_0x216ec2(0x2c1)},'children':[{'tag':_0x216ec2(0x30d),'attrs':{'stroke':_0x216ec2(0x291),'d':_0x216ec2(0x2b3),'strokeLinecap':_0x216ec2(0x33a),'strokeLinejoin':_0x216ec2(0x33a),'strokeWidth':1.2}}]},{'tag':_0x216ec2(0x1c8),'attrs':{},'children':[{'tag':_0x216ec2(0x478),'attrs':{'id':'on-line-single_clip0_910_349'},'children':[{'tag':_0x216ec2(0x30d),'attrs':{'fill':_0x216ec2(0x370),'d':_0x216ec2(0x589),'transform':_0x216ec2(0x303)}}]}]}],'defIds':['on-line-single_clip0_910_349']},_0x30d312=_0x18e53c[_0x216ec2(0x3f5)](function(_0x282fcd,_0x4547dc){const _0x3d8a14=_0x216ec2;return _0x18e53c[_0x3d8a14(0x28a)](_0x5aba6a,Object[_0x3d8a14(0x233)]({},_0x282fcd,{'id':_0x3d8a14(0x35a),'ref':_0x4547dc,'icon':_0x2a066e}));});_0x30d312[_0x216ec2(0x4ea)]=_0x216ec2(0x2bf);const _0x375dc8={'onlineStatusIcon':_0x216ec2(0x378),'onlineStatusTitle':_0x216ec2(0x52a),'onlineStatus':_0x216ec2(0x574),'online':_0x216ec2(0x275),'offline':_0x216ec2(0x2a2)};function _0x336ab5(_0x53587b){const _0x5942ed=_0x216ec2;switch(_0x53587b){case _0x128ded[_0x5942ed(0x483)]:return'collabStatus.offline';case _0x128ded[_0x5942ed(0x448)]:return _0x5942ed(0x3fa);case _0x128ded[_0x5942ed(0x3ad)]:return _0x5942ed(0x4ed);case _0x128ded[_0x5942ed(0x3fe)]:return _0x5942ed(0x2a3);case _0x128ded[_0x5942ed(0x48e)]:case _0x128ded['AWAITING']:case _0x128ded[_0x5942ed(0x4fb)]:return _0x5942ed(0x39f);case _0x128ded[_0x5942ed(0x41b)]:return _0x5942ed(0x551);}}function _0x56c1b1(_0x9397cb){const _0x1c23b5=_0x216ec2,{status$:_0x5dac6e}=_0x9397cb,_0x40d496=_0xd6a4eb[_0x1c23b5(0x3bf)](_0x5dac6e,_0x128ded['NOT_COLLAB']),_0x67871c=_0x207f05[_0x1c23b5(0x4a1)](_0x207f05[_0x1c23b5(0x267)]),_0x588664=_0x40d496!==_0x128ded['OFFLINE'],_0x53ab69=_0x67871c['t'](_0x336ab5(_0x40d496)),_0xd6aad=_0x1fc32a(_0x375dc8[_0x1c23b5(0x4f3)],{[_0x375dc8[_0x1c23b5(0x373)]]:_0x588664,[_0x375dc8[_0x1c23b5(0x579)]]:!_0x588664}),_0x21f564=_0x588664?_0x18e53c[_0x1c23b5(0x28a)](_0x30d312,null):_0x18e53c[_0x1c23b5(0x28a)](_0x3de172,null);return _0x18e53c[_0x1c23b5(0x28a)](_0x1c23b5(0x4f9),{'className':_0xd6aad},_0x18e53c['createElement']('div',{'className':_0x375dc8['onlineStatusIcon']},_0x21f564),_0x18e53c[_0x1c23b5(0x28a)](_0x1c23b5(0x4f9),{'className':_0x375dc8[_0x1c23b5(0x565)]},_0x53ab69));}var _0x5f4c51=Object[_0x216ec2(0x3d2)],_0x2a9fec=Object[_0x216ec2(0x498)],_0x3e2110=(_0x5d81b6,_0x4455ba,_0x5bd228,_0x4522ee)=>{const _0x277d41=_0x216ec2;for(var _0xf562d9=_0x4522ee>0x1?void 0x0:_0x4522ee?_0x2a9fec(_0x4455ba,_0x5bd228):_0x4455ba,_0x5ef30d=_0x5d81b6[_0x277d41(0x48b)]-0x1,_0x2a9ee0;_0x5ef30d>=0x0;_0x5ef30d--)(_0x2a9ee0=_0x5d81b6[_0x5ef30d])&&(_0xf562d9=(_0x4522ee?_0x2a9ee0(_0x4455ba,_0x5bd228,_0xf562d9):_0x2a9ee0(_0xf562d9))||_0xf562d9);return _0x4522ee&&_0xf562d9&&_0x5f4c51(_0x4455ba,_0x5bd228,_0xf562d9),_0xf562d9;},_0x4f28d1=(_0x562491,_0x597c35)=>(_0x1c744e,_0x15805d)=>_0x597c35(_0x1c744e,_0x15805d,_0x562491);_0x11abd7['DesktopCollaborationStatusDisplayController']=class extends _0x207f05['Disposable']{constructor(_0xc4d037,_0x535a0c,_0x19e201,_0x4422c9){const _0x37546f=_0x216ec2;super(),_0x574c73(this,_0x37546f(0x413),new _0xb87526[(_0x37546f(0x31f))](_0x128ded['NOT_COLLAB'])),(this['_univerInstanceService']=_0xc4d037,this[_0x37546f(0x40e)]=_0x535a0c,this['_injector']=_0x19e201,this['_collaborationController']=_0x4422c9,this[_0x37546f(0x2a6)](),this[_0x37546f(0x31a)]());}[_0x216ec2(0x2a6)](){const _0x10eabd=_0x216ec2;this[_0x10eabd(0x38d)](this[_0x10eabd(0x40e)]['registerComponent'](_0xd6a4eb[_0x10eabd(0x588)]['HEADER_MENU'],()=>_0x207f05[_0x10eabd(0x222)](_0x30e0b6({'status$':this[_0x10eabd(0x413)]['asObservable']()}),this['_injector'])));}[_0x216ec2(0x31a)](){const _0x40edaf=_0x216ec2;this['disposeWithMe'](_0x207f05[_0x40edaf(0x232)](this[_0x40edaf(0x255)]['focused$'][_0x40edaf(0x2bb)](_0xb87526['switchMap'](()=>{const _0x2764fd=_0x40edaf,_0x5c6c30=this['_univerInstanceService'][_0x2764fd(0x53f)]();return _0x5c6c30?this[_0x2764fd(0x1e3)][_0x2764fd(0x486)](_0x5c6c30[_0x2764fd(0x559)]()):_0xb87526['of'](null);}),_0xb87526['switchMap'](_0xd2b49c=>_0xd2b49c?_0xd2b49c[_0x40edaf(0x381)]:_0xb87526['of'](_0x128ded[_0x40edaf(0x3fe)])))[_0x40edaf(0x314)](_0x5b4c1e=>{this['_status$']['next'](_0x5b4c1e);})));}},_0x11abd7[_0x216ec2(0x26b)]=_0x3e2110([_0x207f05['OnLifecycle'](_0x207f05[_0x216ec2(0x2fe)][_0x216ec2(0x2b8)],_0x11abd7[_0x216ec2(0x26b)]),_0x4f28d1(0x0,_0x207f05[_0x216ec2(0x1f4)]),_0x4f28d1(0x1,_0xd6a4eb[_0x216ec2(0x235)]),_0x4f28d1(0x2,_0x207f05['Inject'](_0x207f05[_0x216ec2(0x236)])),_0x4f28d1(0x3,_0x207f05[_0x216ec2(0x511)](_0x11abd7[_0x216ec2(0x4a8)]))],_0x11abd7[_0x216ec2(0x26b)]);function _0x30e0b6(_0x3f2acd){const {status$:_0x21024a}=_0x3f2acd;return function(){const _0x2bc47b=_0x4438;return _0x18e53c[_0x2bc47b(0x28a)](_0x56c1b1,{'status$':_0x21024a});};}const _0x401cef=_0x207f05[_0x216ec2(0x4c6)](_0x216ec2(0x3ea));var _0x44c45a=Object[_0x216ec2(0x3d2)],_0x43b4aa=Object[_0x216ec2(0x498)],_0x18bad0=(_0x425e95,_0x13391a,_0x5b6613,_0x225a6a)=>{const _0x50024b=_0x216ec2;for(var _0x55f4d6=_0x225a6a>0x1?void 0x0:_0x225a6a?_0x43b4aa(_0x13391a,_0x5b6613):_0x13391a,_0x42bf91=_0x425e95[_0x50024b(0x48b)]-0x1,_0x189814;_0x42bf91>=0x0;_0x42bf91--)(_0x189814=_0x425e95[_0x42bf91])&&(_0x55f4d6=(_0x225a6a?_0x189814(_0x13391a,_0x5b6613,_0x55f4d6):_0x189814(_0x55f4d6))||_0x55f4d6);return _0x225a6a&&_0x55f4d6&&_0x44c45a(_0x13391a,_0x5b6613,_0x55f4d6),_0x55f4d6;},_0x318999=(_0x5be1ae,_0x166df7)=>(_0x1fc049,_0xcfecc9)=>_0x166df7(_0x1fc049,_0xcfecc9,_0x5be1ae);_0x11abd7[_0x216ec2(0x568)]=class extends _0x207f05[_0x216ec2(0x48f)]{constructor(_0xd2955a,_0x4d7fc7,_0x5c5f08,_0x1f13de,_0x36cfd3,_0x4b6f1c){const _0x1f27d4=_0x216ec2;super(),this[_0x1f27d4(0x1de)]=_0xd2955a,this[_0x1f27d4(0x352)]=_0x4d7fc7,this[_0x1f27d4(0x2e7)]=_0x5c5f08,this[_0x1f27d4(0x503)]=_0x1f13de,this[_0x1f27d4(0x38a)]=_0x36cfd3,_0x4b6f1c?_0x4b6f1c==null||_0x4b6f1c[_0x1f27d4(0x32f)]()[_0x1f27d4(0x4bd)](()=>this[_0x1f27d4(0x299)]()):(this[_0x1f27d4(0x352)][_0x1f27d4(0x339)]('[DataLoaderController]',_0x1f27d4(0x4b2)),this[_0x1f27d4(0x299)]());}async[_0x216ec2(0x299)](){const _0x5af20b=_0x216ec2,_0x2fecc3=this[_0x5af20b(0x1de)][_0x5af20b(0x5b0)]('unit'),_0x4ef99d=this[_0x5af20b(0x1de)][_0x5af20b(0x5b0)](_0x5af20b(0x42a));if(_0x2fecc3){console[_0x5af20b(0x57e)](_0x5af20b(0x4c8),_0x2fecc3);return;}if(!_0x2fecc3||!_0x4ef99d){this['_logService'][_0x5af20b(0x339)](_0x5af20b(0x2f6),_0x5af20b(0x59c));return;}switch(Number(_0x4ef99d)){case _0x18cf2f[_0x5af20b(0x429)]:{const _0x2b8519=await this[_0x5af20b(0x22c)](_0x2fecc3);this[_0x5af20b(0x549)](_0x2b8519);break;}case _0x18cf2f['UNIVER_DOC']:{await this['_loadDoc'](_0x2fecc3);break;}default:{this[_0x5af20b(0x352)][_0x5af20b(0x2ff)](_0x5af20b(0x2f6),_0x5af20b(0x238));break;}}}async[_0x216ec2(0x549)](_0x353d32){const _0x5ea143=_0x216ec2;await this[_0x5ea143(0x297)](_0x353d32),_0x353d32[_0x5ea143(0x360)][_0x5ea143(0x2bb)](_0xb87526[_0x5ea143(0x516)](this[_0x5ea143(0x274)]))[_0x5ea143(0x314)](_0x230959=>{const _0x5a4117=_0x5ea143;_0x230959&&this[_0x5a4117(0x595)](_0x230959);}),this[_0x5ea143(0x1de)][_0x5ea143(0x3bb)][_0x5ea143(0x2bb)](_0xb87526[_0x5ea143(0x516)](this[_0x5ea143(0x274)]))['subscribe'](()=>this[_0x5ea143(0x297)](_0x353d32));}[_0x216ec2(0x595)](_0x43d9fd,_0x52e8bf=!0x1){const _0x40acd4=_0x216ec2,_0x2d0ba5=this[_0x40acd4(0x1de)][_0x40acd4(0x5b0)](_0x40acd4(0x38e));_0x43d9fd[_0x40acd4(0x4c0)]()!==_0x2d0ba5&&this[_0x40acd4(0x1de)][_0x40acd4(0x205)]('subunit',_0x43d9fd[_0x40acd4(0x4c0)](),_0x52e8bf);}async[_0x216ec2(0x297)](_0x13bc2a){const _0x3cbb3e=_0x216ec2;var _0x4da338;const _0x9624df=this['_urlService'][_0x3cbb3e(0x5b0)]('subunit');if(!_0x9624df||!_0x13bc2a['getSheetBySheetId'](_0x9624df)){const _0x26fcae=_0x13bc2a[_0x3cbb3e(0x1dd)]()[0x0],_0x68d571=_0x13bc2a[_0x3cbb3e(0x1e8)](_0x26fcae);if(!_0x68d571)return;this[_0x3cbb3e(0x595)](_0x68d571,!0x0),await this['_commandService'][_0x3cbb3e(0x2d7)](_0x4aca4a[_0x3cbb3e(0x421)]['id'],{'unitId':_0x13bc2a[_0x3cbb3e(0x559)](),'subUnitId':_0x26fcae});return;}((_0x4da338=_0x13bc2a[_0x3cbb3e(0x472)]())==null?void 0x0:_0x4da338['getSheetId']())!==_0x9624df&&await this['_commandService']['executeCommand'](_0x4aca4a[_0x3cbb3e(0x421)]['id'],{'unitId':_0x13bc2a[_0x3cbb3e(0x559)](),'subUnitId':_0x9624df});}async[_0x216ec2(0x22c)](_0x3f1e3e){const _0x3ec09c=_0x216ec2;let _0x5043f6=0x0;const _0x54e321=await this[_0x3ec09c(0x503)][_0x3ec09c(0x416)](_0x3f1e3e);return _0x54e321&&(_0x54e321[_0x3ec09c(0x59a)]||_0x54e321[_0x3ec09c(0x1cc)][_0x3ec09c(0x48b)]!==0x0)&&(_0x5043f6=_0x54e321[_0x3ec09c(0x454)]),_0x5043f6===0x0&&this[_0x3ec09c(0x352)]['debug']('[DataLoaderController]',_0x3ec09c(0x1d5)),this[_0x3ec09c(0x38a)][_0x3ec09c(0x599)](_0x3f1e3e,_0x5043f6);}async['_loadDoc'](_0x4164d1){const _0x508047=_0x216ec2;let _0x598ec7=0x0;const _0x32539c=await this[_0x508047(0x503)][_0x508047(0x416)](_0x4164d1);return _0x32539c&&(_0x32539c[_0x508047(0x59a)]||_0x32539c[_0x508047(0x1cc)]['length']!==0x0)&&(_0x598ec7=_0x32539c['rev']),_0x598ec7===0x0&&this[_0x508047(0x352)][_0x508047(0x339)]('[DataLoaderController]',_0x508047(0x1d5)),this[_0x508047(0x38a)][_0x508047(0x3b8)](_0x4164d1,_0x598ec7);}},_0x11abd7[_0x216ec2(0x568)]=_0x18bad0([_0x207f05['OnLifecycle'](_0x207f05[_0x216ec2(0x2fe)]['Starting'],_0x11abd7[_0x216ec2(0x568)]),_0x318999(0x0,_0x401cef),_0x318999(0x1,_0x207f05['ILogService']),_0x318999(0x2,_0x207f05[_0x216ec2(0x460)]),_0x318999(0x3,_0x207f05[_0x216ec2(0x511)](_0x11abd7['LocalCacheService'])),_0x318999(0x4,_0x207f05[_0x216ec2(0x511)](_0x245d5b['SnapshotService'])),_0x318999(0x5,_0x207f05['Optional'](_0x2bdf07[_0x216ec2(0x41c)]))],_0x11abd7['DataLoaderController']);var _0x5e476a=Object[_0x216ec2(0x3d2)],_0x23f914=Object[_0x216ec2(0x498)],_0x4093ff=(_0x31e639,_0x49a8ea,_0x4aab28,_0x43a869)=>{const _0x14090f=_0x216ec2;for(var _0x577902=_0x43a869>0x1?void 0x0:_0x43a869?_0x23f914(_0x49a8ea,_0x4aab28):_0x49a8ea,_0x275215=_0x31e639[_0x14090f(0x48b)]-0x1,_0x474fe8;_0x275215>=0x0;_0x275215--)(_0x474fe8=_0x31e639[_0x275215])&&(_0x577902=(_0x43a869?_0x474fe8(_0x49a8ea,_0x4aab28,_0x577902):_0x474fe8(_0x577902))||_0x577902);return _0x43a869&&_0x577902&&_0x5e476a(_0x49a8ea,_0x4aab28,_0x577902),_0x577902;},_0x290275=(_0x35e6c9,_0x16c7bf)=>(_0x1d7b83,_0x276acd)=>_0x16c7bf(_0x1d7b83,_0x276acd,_0x35e6c9);const _0x56c32a=_0x216ec2(0x35e),_0x162749=_0x216ec2(0x55e);let _0x23a135=class extends _0x207f05[_0x216ec2(0x1c5)]{constructor(_0xf3bcc,_0x2536c5){const _0x51e245=_0x216ec2;super(),this[_0x51e245(0x255)]=_0xf3bcc,this[_0x51e245(0x1e1)]=_0x2536c5,this[_0x51e245(0x299)]();}[_0x216ec2(0x299)](){const _0x55f892=_0x216ec2;this['disposeWithMe'](_0x207f05[_0x55f892(0x232)](this[_0x55f892(0x255)]['focused$']['subscribe'](()=>{const _0x1710ea=_0x55f892;var _0x23803f;const _0x2bac71=this[_0x1710ea(0x255)][_0x1710ea(0x53f)]();let _0x57c95b=(_0x23803f=this['_configService'][_0x1710ea(0x426)](_0x56c32a))!=null?_0x23803f:_0x162749;_0x2bac71 instanceof _0x207f05[_0x1710ea(0x540)]&&(_0x57c95b=_0x2bac71[_0x1710ea(0x45c)]),document[_0x1710ea(0x488)]=_0x57c95b;})));}};_0x23a135=_0x4093ff([_0x207f05[_0x216ec2(0x26a)](_0x207f05[_0x216ec2(0x2fe)]['Ready'],_0x23a135),_0x290275(0x0,_0x207f05[_0x216ec2(0x1f4)]),_0x290275(0x1,_0x207f05[_0x216ec2(0x244)])],_0x23a135);var _0x585f87=Object[_0x216ec2(0x3d2)],_0x4b5255=Object['getOwnPropertyDescriptor'],_0x26715d=(_0x5ad818,_0x3de178,_0x1c3be7,_0x204db0)=>{const _0x224d8b=_0x216ec2;for(var _0x417f16=_0x204db0>0x1?void 0x0:_0x204db0?_0x4b5255(_0x3de178,_0x1c3be7):_0x3de178,_0x33d306=_0x5ad818[_0x224d8b(0x48b)]-0x1,_0x3c4542;_0x33d306>=0x0;_0x33d306--)(_0x3c4542=_0x5ad818[_0x33d306])&&(_0x417f16=(_0x204db0?_0x3c4542(_0x3de178,_0x1c3be7,_0x417f16):_0x3c4542(_0x417f16))||_0x417f16);return _0x204db0&&_0x417f16&&_0x585f87(_0x3de178,_0x1c3be7,_0x417f16),_0x417f16;},_0xc529a3=(_0x566d68,_0x3aa24d)=>(_0x5b922c,_0xfd128)=>_0x3aa24d(_0x5b922c,_0xfd128,_0x566d68);_0x11abd7[_0x216ec2(0x430)]=class{constructor(_0x2871db,_0x2c07c8){const _0x190f39=_0x216ec2;this[_0x190f39(0x1e1)]=_0x2871db,this[_0x190f39(0x32e)]=_0x2c07c8;}async['getUnitOnRev'](_0x82633b,_0xa8aa03){const _0x112577=_0x216ec2;var _0x59fa42;const {unitID:_0x341acb,type:_0x42136a,revision:_0x2e93f4=0x0}=_0xa8aa03,_0x2d1a59=this[_0x112577(0x4eb)]()+'/'+_0x42136a+'/unit/'+_0x341acb+_0x112577(0x43e)+_0x2e93f4,_0x30d7a7=(await this[_0x112577(0x32e)][_0x112577(0x458)](_0x2d1a59))['body'],_0x3f0ea7=(_0x59fa42=_0x30d7a7['snapshot'])==null?void 0x0:_0x59fa42[_0x112577(0x28c)];if(_0x3f0ea7){const _0x3d0754=_0x3f0ea7==null?void 0x0:_0x3f0ea7[_0x112577(0x1c7)],_0xde52b3=_0x207f05[_0x112577(0x20b)][_0x112577(0x43a)](_0x207f05[_0x112577(0x547)](_0x3d0754));_0x3f0ea7[_0x112577(0x1c7)]=_0xde52b3,Object[_0x112577(0x519)](_0x3f0ea7['sheets'])[_0x112577(0x43f)](([,_0x227f06])=>{const _0x2666c5=_0x112577,_0x2de63d=_0x227f06[_0x2666c5(0x1c7)],_0x109e29=_0x207f05[_0x2666c5(0x20b)][_0x2666c5(0x43a)](_0x207f05[_0x2666c5(0x547)](_0x2de63d));_0x227f06[_0x2666c5(0x1c7)]=_0x109e29;});}return _0x30d7a7;}async[_0x216ec2(0x4d7)](_0x1dbcd0,_0x366ab3){const _0x3cc565=_0x216ec2,{unitID:_0x48959b,type:_0x5331e7,blockID:_0x3587e7}=_0x366ab3,_0x95d9d6=this[_0x3cc565(0x538)]()+'/'+_0x5331e7+_0x3cc565(0x3ce)+_0x48959b+_0x3cc565(0x5bd)+_0x3587e7;return(await this['_httpService'][_0x3cc565(0x458)](_0x95d9d6))[_0x3cc565(0x585)];}async[_0x216ec2(0x374)](_0x11c7bd,_0x562234){const _0x3dfa43=_0x216ec2,{unitID:_0x4ba560,type:_0x1d1cf5,from:_0x3025c0,to:_0x1be553}=_0x562234,_0x2800f5=this['_getAPIPrefix']()+'/'+_0x1d1cf5+_0x3dfa43(0x3ce)+_0x4ba560+_0x3dfa43(0x567)+_0x3025c0+'&to='+_0x1be553;return(await this[_0x3dfa43(0x32e)][_0x3dfa43(0x458)](_0x2800f5))[_0x3dfa43(0x585)];}[_0x216ec2(0x4eb)](){const _0x20f0bb=_0x216ec2;var _0x1f1785;return(_0x1f1785=this[_0x20f0bb(0x1e1)][_0x20f0bb(0x426)](_0x26db56))!=null?_0x1f1785:this[_0x20f0bb(0x538)]();}[_0x216ec2(0x538)](){const _0x19cf1c=_0x216ec2;var _0xa705c6;return(_0xa705c6=this[_0x19cf1c(0x1e1)][_0x19cf1c(0x426)](_0x2a71a9))!=null?_0xa705c6:_0x5be84a;}async['getResourcesRequest'](_0x2658ee,_0x5d919c){const _0x59e98c=_0x216ec2,_0x558597=_0x59e98c(0x2c8)+_0x5d919c[_0x59e98c(0x42a)]+_0x59e98c(0x3ce)+_0x5d919c[_0x59e98c(0x281)]+_0x59e98c(0x5a5);return(await this[_0x59e98c(0x32e)]['get'](_0x558597,{'params':{'resourceId':JSON['stringify'](_0x5d919c[_0x59e98c(0x31e)])}}))['body'];}[_0x216ec2(0x29b)](){throw new Error('This\x20method\x20should\x20not\x20be\x20called\x20on\x20the\x20client\x20side!');}['saveSheetBlock'](){const _0x46f4d6=_0x216ec2;throw new Error(_0x46f4d6(0x333));}[_0x216ec2(0x344)](){throw new Error('This\x20method\x20should\x20not\x20be\x20called\x20on\x20the\x20client\x20side!');}},_0x11abd7[_0x216ec2(0x430)]=_0x26715d([_0xc529a3(0x0,_0x207f05[_0x216ec2(0x244)]),_0xc529a3(0x1,_0x207f05['Inject'](_0x516ade['HTTPService']))],_0x11abd7[_0x216ec2(0x430)]);var _0x482b69=Object['defineProperty'],_0x265194=Object[_0x216ec2(0x498)],_0xa92535=(_0x3e4b3a,_0xc2c9ad,_0xf9342c,_0xdc0b4d)=>{const _0x1dff5e=_0x216ec2;for(var _0x4a913b=_0xdc0b4d>0x1?void 0x0:_0xdc0b4d?_0x265194(_0xc2c9ad,_0xf9342c):_0xc2c9ad,_0x11326a=_0x3e4b3a[_0x1dff5e(0x48b)]-0x1,_0x13b641;_0x11326a>=0x0;_0x11326a--)(_0x13b641=_0x3e4b3a[_0x11326a])&&(_0x4a913b=(_0xdc0b4d?_0x13b641(_0xc2c9ad,_0xf9342c,_0x4a913b):_0x13b641(_0x4a913b))||_0x4a913b);return _0xdc0b4d&&_0x4a913b&&_0x482b69(_0xc2c9ad,_0xf9342c,_0x4a913b),_0x4a913b;},_0x2119d3=(_0x50b639,_0x47f9d1)=>(_0x529b4f,_0x37cd34)=>_0x47f9d1(_0x529b4f,_0x37cd34,_0x50b639);let _0x250814=class extends _0x207f05[_0x216ec2(0x325)]{constructor(_0x5e91c5,_0x12477c,_0xc2b1f3,_0x388b85,_0x42cf30){const _0x627e48=_0x216ec2;super(_0x5e91c5,_0x12477c,_0xc2b1f3),this[_0x627e48(0x2b7)]=_0x388b85,this[_0x627e48(0x352)]=_0x42cf30;}[_0x216ec2(0x3de)](_0x465896,_0x3734b1){const _0x175ba3=_0x216ec2,_0x547863=this[_0x175ba3(0x530)](_0x465896);if(_0x547863)try{const _0x2f1a47=this[_0x175ba3(0x3f9)](_0x547863,_0x3734b1);this[_0x175ba3(0x253)](_0x465896,_0x2f1a47);}catch(_0x4644e0){this['_logService'][_0x175ba3(0x2ff)](_0x175ba3(0x49f),_0x4644e0),this[_0x175ba3(0x273)](_0x465896);}const _0x35910e=this[_0x175ba3(0x4b0)](_0x465896);if(_0x35910e)try{const _0x4d2da0=this['_transformStack'](_0x35910e,_0x3734b1);this['_substituteRedoStack'](_0x465896,_0x4d2da0);}catch(_0x562b35){this['_logService']['error'](_0x562b35),this['_clearRedo'](_0x465896);}}['_clearUndo'](_0x2449d1){const _0x41ceb7=_0x216ec2,_0x2c42a1=this[_0x41ceb7(0x530)](_0x2449d1);_0x2c42a1&&(_0x2c42a1['length']=0x0,this[_0x41ceb7(0x452)]());}[_0x216ec2(0x231)](_0x4fbd2b){const _0x30a5e3=_0x216ec2,_0x325c67=this[_0x30a5e3(0x4b0)](_0x4fbd2b);_0x325c67&&(_0x325c67[_0x30a5e3(0x48b)]=0x0,this['_updateStatus']());}['_substituteUndoStack'](_0x3b6b27,_0x21b13d){const _0x4075a0=_0x216ec2;this[_0x4075a0(0x43d)][_0x4075a0(0x252)](_0x3b6b27,_0x21b13d),this[_0x4075a0(0x452)]();}[_0x216ec2(0x58b)](_0x5e16c8,_0x3a634a){const _0x2f0b4f=_0x216ec2;this[_0x2f0b4f(0x3e0)][_0x2f0b4f(0x252)](_0x5e16c8,_0x3a634a),this[_0x2f0b4f(0x452)]();}['_transformStack'](_0x4d8b8a,_0x2cab27){const _0xb9b707=_0x216ec2,_0x2ca42b=[];let _0x235faf=_0x2cab27,_0x13a332=_0x2cab27;for(let _0x221605=_0x4d8b8a[_0xb9b707(0x48b)]-0x1;_0x221605>=0x0;_0x221605--){const {unitID:_0x1f57fb,undoMutations:_0x297365,redoMutations:_0x3138e9}=_0x4d8b8a[_0x221605],_0x5cbda4=this[_0xb9b707(0x2b7)][_0xb9b707(0x342)](_0x235faf,_0x297365),_0x1ce8af=this[_0xb9b707(0x2b7)]['transformMutationsWithChangeset'](_0x13a332,_0x3138e9);if(_0x245d5b[_0xb9b707(0x207)](_0x5cbda4)||_0x245d5b[_0xb9b707(0x207)](_0x1ce8af)){this[_0xb9b707(0x352)][_0xb9b707(0x2ff)](_0xb9b707(0x49f),_0xb9b707(0x2cd),_0x5cbda4,_0x1ce8af);break;}_0x235faf=_0x5cbda4[_0xb9b707(0x25d)],_0x13a332=_0x1ce8af[_0xb9b707(0x25d)],_0x2ca42b[_0xb9b707(0x2af)]({'unitID':_0x1f57fb,'undoMutations':_0x5cbda4[_0xb9b707(0x49e)],'redoMutations':_0x1ce8af[_0xb9b707(0x49e)]});}return _0x2ca42b[_0xb9b707(0x34a)]();}};_0x250814=_0xa92535([_0x2119d3(0x0,_0x207f05[_0x216ec2(0x1f4)]),_0x2119d3(0x1,_0x207f05[_0x216ec2(0x460)]),_0x2119d3(0x2,_0x207f05['IContextService']),_0x2119d3(0x3,_0x245d5b['ITransformService']),_0x2119d3(0x4,_0x207f05[_0x216ec2(0x3ba)])],_0x250814);class _0x272163 extends _0x207f05[_0x216ec2(0x48f)]{constructor(){const _0x21ce17=_0x216ec2;super(),_0x574c73(this,_0x21ce17(0x3bb)),this['urlChange$']=_0xb87526[_0x21ce17(0x4d9)](window,_0x21ce17(0x5ab))[_0x21ce17(0x2bb)](_0xb87526[_0x21ce17(0x516)](this[_0x21ce17(0x274)]),_0xb87526[_0x21ce17(0x1f2)](0x1),_0xb87526['mapTo'](void 0x0));}['setParam'](_0x447924,_0x2854e2,_0x46a17d=!0x1){const _0x22225e=_0x216ec2,_0x25bd38=new URL(window['location'][_0x22225e(0x48d)]);_0x25bd38[_0x22225e(0x3c0)][_0x22225e(0x252)](_0x447924,_0x2854e2),_0x46a17d?window['history'][_0x22225e(0x23f)]('','',_0x25bd38[_0x22225e(0x475)]()):window[_0x22225e(0x216)][_0x22225e(0x3c3)]('','',_0x25bd38[_0x22225e(0x475)]());}[_0x216ec2(0x3f7)](_0x113e5a,_0x406ab7=!0x1){const _0x48d764=_0x216ec2,_0x5f28cf=new URL(window['location'][_0x48d764(0x48d)]);_0x5f28cf[_0x48d764(0x3c0)][_0x48d764(0x3b1)](_0x113e5a),_0x406ab7?window[_0x48d764(0x216)]['replaceState']('','',_0x5f28cf[_0x48d764(0x475)]()):window[_0x48d764(0x216)][_0x48d764(0x3c3)]('','',_0x5f28cf[_0x48d764(0x475)]());}[_0x216ec2(0x5b0)](_0x581c1f){const _0x3ef8b9=_0x216ec2;var _0x5a8d08;return(_0x5a8d08=new URL(window[_0x3ef8b9(0x476)][_0x3ef8b9(0x48d)])[_0x3ef8b9(0x3c0)][_0x3ef8b9(0x458)](_0x581c1f))!=null?_0x5a8d08:void 0x0;}}const _0x56bf89='collab-text-anchor-',_0x2731af=_0x216ec2(0x575),_0x4ef8c4=0x6,_0x3e9085=1.5,_0x33aafc=0x4,_0x3e4b83=1.5,_0x233b76='rgba(255,\x20255,\x20255,\x200.01)';class _0x3f91c2{constructor(_0x3413a9,_0x380bf7,_0x3296b7,_0x575fd4){const _0x2656a6=_0x216ec2;_0x574c73(this,_0x2656a6(0x2ec),[]),_0x574c73(this,_0x2656a6(0x307),null),_0x574c73(this,_0x2656a6(0x3f8),null),_0x574c73(this,_0x2656a6(0x4fd),null),_0x574c73(this,'_hideTimer',null),_0x574c73(this,_0x2656a6(0x21b),null),(this[_0x2656a6(0x409)]=_0x3413a9,this[_0x2656a6(0x35d)]=_0x380bf7,this[_0x2656a6(0x336)]=_0x3296b7,this[_0x2656a6(0x2ab)]=_0x575fd4,this[_0x2656a6(0x53b)]());}set['_hover'](_0x2713cc){const _0x161c8a=_0x216ec2;_0x2713cc?(this[_0x161c8a(0x4fd)]&&this[_0x161c8a(0x4fd)][_0x161c8a(0x319)](),this[_0x161c8a(0x3f8)]&&this[_0x161c8a(0x3f8)][_0x161c8a(0x4ec)]()):(this[_0x161c8a(0x4fd)]&&this['_anchorDot'][_0x161c8a(0x4ec)](),this[_0x161c8a(0x3f8)]&&this['_textBubble'][_0x161c8a(0x319)]());}[_0x216ec2(0x3a0)](){const _0x3bc204=_0x216ec2;for(const _0x243bf5 of this[_0x3bc204(0x2ec)])_0x243bf5[_0x3bc204(0x3a0)]();this[_0x3bc204(0x3f8)]&&this[_0x3bc204(0x3f8)][_0x3bc204(0x3a0)](),this['_anchorDot']&&this[_0x3bc204(0x4fd)]['dispose'](),this['_anchor']&&this['_anchor'][_0x3bc204(0x3a0)](),this[_0x3bc204(0x21b)]&&this[_0x3bc204(0x21b)]();}[_0x216ec2(0x53b)](){const _0x3a80a2=_0x216ec2,{_docSkeleton:_0x59e06d,_document:_0x4ce5aa}=this,{color:_0x210785,name:_0x13bb5b,ranges:_0x29c029}=this[_0x3a80a2(0x409)],_0x4a12e4=_0x4ce5aa[_0x3a80a2(0x2cb)](),{docsLeft:_0x254b58,docsTop:_0x16cb98}=_0x4a12e4,_0x1aaf5b=new _0x1bdf92[(_0x3a80a2(0x20f))](_0x4a12e4,_0x59e06d);for(const {startOffset:_0x577957,endOffset:_0x1ec3a8,collapsed:_0x55c532,isActive:_0x1e396f}of _0x29c029){const _0x1c6cdf=_0x59e06d[_0x3a80a2(0x363)](_0x577957),_0x1fae50=_0x59e06d[_0x3a80a2(0x363)](_0x1ec3a8);if(_0x1e396f){const {contentBoxPointGroup:_0x39b5f8}=_0x1aaf5b['getRangePointData'](_0x1fae50,_0x1fae50);if(_0x39b5f8[_0x3a80a2(0x48b)]===0x0)continue;this['_drawAnchor'](_0x210785,_0x39b5f8,_0x254b58,_0x16cb98,_0x13bb5b),this[_0x3a80a2(0x21b)]=this[_0x3a80a2(0x557)]();}if(!_0x55c532){const {contentBoxPointGroup:_0xe2532b}=_0x1aaf5b[_0x3a80a2(0x2b9)](_0x1c6cdf,_0x1fae50);if(_0xe2532b['length']===0x0)continue;this['_drawRange'](_0x210785,_0xe2532b,_0x254b58,_0x16cb98);}}}[_0x216ec2(0x3dd)](_0x2fb51f,_0x129347,_0x4d0a0c,_0x5a0349,_0x42ce69){const _0x1b71cf=_0x216ec2,_0xd88a33=this[_0x1b71cf(0x407)](_0x129347),{left:_0x3ad2f8,top:_0x55d9c1,height:_0x263b39}=_0xd88a33,_0x55b5c0=this[_0x1b71cf(0x2f2)](),_0x285c42=_0x3e4b83/_0x55b5c0,_0x26be93=new _0x1bdf92['Rect'](_0x56bf89+_0x207f05[_0x1b71cf(0x46e)]['generateRandomId'](_0x4ef8c4),{'left':_0x3ad2f8+_0x4d0a0c-_0x285c42,'top':_0x55d9c1+_0x5a0349,'height':_0x263b39,'width':_0x3e9085,'fill':_0x2fb51f||_0x1bdf92[_0x1b71cf(0x445)](_0x207f05[_0x1b71cf(0x402)][_0x1b71cf(0x571)],0x0),'strokeWidth':_0x285c42,'stroke':_0x233b76,'evented':!0x0});this[_0x1b71cf(0x307)]=_0x26be93,this[_0x1b71cf(0x35d)][_0x1b71cf(0x289)](_0x26be93,_0x1bdf92[_0x1b71cf(0x4a2)]);const _0x444756=new _0x1bdf92[(_0x1b71cf(0x341))](_0x56bf89+_0x207f05['Tools'][_0x1b71cf(0x304)](_0x4ef8c4),{'left':_0x3ad2f8+_0x4d0a0c-_0x285c42,'top':_0x55d9c1+_0x5a0349-_0x33aafc/0x2,'height':_0x33aafc,'width':_0x33aafc,'fill':_0x2fb51f||_0x1bdf92[_0x1b71cf(0x445)](_0x207f05[_0x1b71cf(0x402)][_0x1b71cf(0x571)],0x0),'strokeWidth':0x0,'stroke':_0x2fb51f||_0x1bdf92['getColor'](_0x207f05[_0x1b71cf(0x402)]['black'],0x0),'evented':!0x1});this[_0x1b71cf(0x4fd)]=_0x444756,this[_0x1b71cf(0x35d)][_0x1b71cf(0x289)](_0x444756,_0x1bdf92[_0x1b71cf(0x4a2)]);const _0x315612=new _0x14187d(_0x56bf89+_0x207f05[_0x1b71cf(0x46e)][_0x1b71cf(0x304)](_0x4ef8c4),{'left':_0x3ad2f8+_0x4d0a0c-_0x285c42,'top':_0x55d9c1+_0x5a0349-_0xbb8fdc,'text':_0x42ce69,'color':_0x2fb51f});this[_0x1b71cf(0x3f8)]=_0x315612,this[_0x1b71cf(0x35d)][_0x1b71cf(0x289)](_0x315612,_0x1bdf92[_0x1b71cf(0x4a2)]),this[_0x1b71cf(0x338)]=!0x1;}['_handleHover'](){const _0x245e24=_0x216ec2,_0x3e49e8=this[_0x245e24(0x307)]['onPointerEnter$'][_0x245e24(0x5bb)](()=>{const _0x481153=_0x245e24;this[_0x481153(0x338)]=!0x0;}),_0x1c09b1=this['_anchor']['onPointerLeave$'][_0x245e24(0x5bb)](()=>{const _0x51a616=_0x245e24;this[_0x51a616(0x37f)]&&clearTimeout(this[_0x51a616(0x37f)]),this[_0x51a616(0x37f)]=setTimeout(()=>{const _0x365867=_0x51a616;this[_0x365867(0x338)]=!0x1;},0x7d0);});return()=>{const _0x87b42d=_0x245e24;_0x3e49e8[_0x87b42d(0x518)](),_0x1c09b1[_0x87b42d(0x518)]();};}['_drawRange'](_0x6495de,_0x4fdce7,_0x5bab8e,_0x42f72a){const _0xc5fa83=_0x216ec2,_0x325b6e=new _0x207f05[(_0xc5fa83(0x36a))](_0x6495de)['setAlpha'](0.2)['toRgbString'](),_0x23fa8a=new _0x1bdf92[(_0xc5fa83(0x3e4))](_0x2731af+_0x207f05[_0xc5fa83(0x46e)][_0xc5fa83(0x304)](_0x4ef8c4),{'pointsGroup':_0x4fdce7,'fill':_0x325b6e||_0x1bdf92[_0xc5fa83(0x445)](_0x207f05[_0xc5fa83(0x402)][_0xc5fa83(0x571)],0.2),'left':_0x5bab8e,'top':_0x42f72a,'evented':!0x1,'debounceParentDirty':!0x1});this[_0xc5fa83(0x2ec)][_0xc5fa83(0x2af)](_0x23fa8a),this[_0xc5fa83(0x35d)][_0xc5fa83(0x289)](_0x23fa8a,_0x1bdf92[_0xc5fa83(0x4a2)]);}[_0x216ec2(0x407)](_0x4067c1){const _0x44903c=_0x4067c1[0x0],_0x17b607=_0x44903c[0x0],_0x3b28f0=_0x44903c[0x2],{x:_0x2bec0e,y:_0x5c5718}=_0x17b607,{x:_0x5687da,y:_0x25484e}=_0x3b28f0;return{'left':_0x2bec0e,'top':_0x5c5718,'width':_0x5687da-_0x2bec0e,'height':_0x25484e-_0x5c5718};}['_getScale'](){const _0x1096ee=_0x216ec2,{scaleX:_0x528e27,scaleY:_0x1ab920}=this[_0x1096ee(0x35d)]['getAncestorScale']();return Math[_0x1096ee(0x4b1)](_0x528e27,_0x1ab920);}}var _0x38d9e1=Object[_0x216ec2(0x3d2)],_0x1f9ff4=Object[_0x216ec2(0x498)],_0x2bf159=(_0xd4b14a,_0x3681fe,_0x147f2e,_0xa586b7)=>{const _0x3003c9=_0x216ec2;for(var _0x35ca9b=_0xa586b7>0x1?void 0x0:_0xa586b7?_0x1f9ff4(_0x3681fe,_0x147f2e):_0x3681fe,_0x4c5635=_0xd4b14a[_0x3003c9(0x48b)]-0x1,_0x47dbf3;_0x4c5635>=0x0;_0x4c5635--)(_0x47dbf3=_0xd4b14a[_0x4c5635])&&(_0x35ca9b=(_0xa586b7?_0x47dbf3(_0x3681fe,_0x147f2e,_0x35ca9b):_0x47dbf3(_0x35ca9b))||_0x35ca9b);return _0xa586b7&&_0x35ca9b&&_0x38d9e1(_0x3681fe,_0x147f2e,_0x35ca9b),_0x35ca9b;},_0x5a85c6=(_0x2634ca,_0x35974a)=>(_0xc5262e,_0x4b5ed5)=>_0x35974a(_0xc5262e,_0x4b5ed5,_0x2634ca);let _0x23ddab=class extends _0x207f05[_0x216ec2(0x48f)]{constructor(_0x27aaa7,_0x4b00f9,_0xe30c20,_0x5b8308,_0x4c351a){const _0x23082b=_0x216ec2;super(),_0x574c73(this,_0x23082b(0x4c5),[]),(this[_0x23082b(0x4d4)]=_0x27aaa7,this[_0x23082b(0x38b)]=_0x4b00f9,this[_0x23082b(0x5be)]=_0xe30c20,this[_0x23082b(0x3f1)]=_0x5b8308,this[_0x23082b(0x38f)]=_0x4c351a,this[_0x23082b(0x299)]());}['_init'](){const _0x598c92=_0x216ec2,_0x4270d9=this[_0x598c92(0x4d4)][_0x598c92(0x432)],_0x4d0d21=this['_docSkeletonManagerService'];this[_0x598c92(0x38d)](_0xb87526[_0x598c92(0x1ca)]([this[_0x598c92(0x5be)][_0x598c92(0x2e4)](_0x4270d9),this[_0x598c92(0x38f)][_0x598c92(0x359)]])['pipe'](_0x9f6f32['map'](([_0xa0dd8a,_0x33ec3f])=>({'skeleton':_0x4d0d21[_0x598c92(0x206)](),'cursors':[..._0xa0dd8a[_0x598c92(0x3c9)]()][_0x598c92(0x4ca)](_0x1e1b32=>({..._0x1e1b32,'color':_0x33ec3f[_0x1e1b32['color']]}))})))[_0x598c92(0x314)](_0x2c3351=>{const _0x47b47a=_0x598c92;if(this['_removeCollabCursors'](),_0x2c3351){const {skeleton:_0x4ce74d,cursors:_0x23609f}=_0x2c3351;this[_0x47b47a(0x1fd)](_0x4ce74d,_0x23609f);}}));}[_0x216ec2(0x1fd)](_0x46b46b,_0x3c85b8){const _0x3e216e=_0x216ec2,{scene:_0x103569,mainComponent:_0x349932}=this['_context'],_0x245646=_0x3c85b8[_0x3e216e(0x386)](_0x1c3615=>new _0x3f91c2(_0x1c3615,_0x103569,_0x46b46b,_0x349932));this['_cursors']=_0x245646;}['_removeCollabCursors'](){const _0x369f50=_0x216ec2;this[_0x369f50(0x4c5)]['forEach'](_0x2c0dd2=>_0x2c0dd2[_0x369f50(0x3a0)]()),this[_0x369f50(0x4c5)]=[];}};_0x23ddab=_0x2bf159([_0x207f05[_0x216ec2(0x26a)](_0x207f05['LifecycleStages'][_0x216ec2(0x282)],_0x23ddab),_0x5a85c6(0x1,_0x207f05[_0x216ec2(0x511)](_0x23e2c7[_0x216ec2(0x485)])),_0x5a85c6(0x2,_0x207f05[_0x216ec2(0x511)](_0x57a077)),_0x5a85c6(0x3,_0x1bdf92[_0x216ec2(0x321)]),_0x5a85c6(0x4,_0x207f05['Inject'](_0x207f05[_0x216ec2(0x1e9)]))],_0x23ddab);const _0x270088='',_0x31c623='/universer-api/anonymous',_0x4a933c=_0x216ec2(0x57a);function _0xefcf38(){const _0x445afb=_0x216ec2;function _0x400602(_0x29712d){const _0x371d9b=_0x4438;let _0x54a934,_0x248899,_0x49f234,_0x5043e5='';for(_0x29712d+='',_0x54a934=0x0,_0x248899=_0x29712d[_0x371d9b(0x48b)];_0x54a934<_0x248899;_0x54a934++)_0x49f234=_0x29712d[_0x371d9b(0x3ae)](_0x54a934)[_0x371d9b(0x475)](0x10),_0x5043e5+=_0x49f234['length']<0x2?'0'+_0x49f234:_0x49f234;return _0x5043e5;}const _0x5472ed=window[_0x445afb(0x3a2)][_0x445afb(0x28a)](_0x445afb(0x4aa)),_0x2c5a3c=_0x5472ed[_0x445afb(0x1d3)]('2d'),_0x53d6dc=window[_0x445afb(0x476)][_0x445afb(0x324)];_0x2c5a3c&&(_0x2c5a3c['textBaseline']=_0x445afb(0x56e),_0x2c5a3c['font']=_0x445afb(0x2b0),_0x2c5a3c[_0x445afb(0x2c4)]=_0x445afb(0x1f1),_0x2c5a3c['fillStyle']=_0x445afb(0x213),_0x2c5a3c['fillRect'](0x7d,0x1,0x3e,0x14),_0x2c5a3c[_0x445afb(0x27d)]=_0x445afb(0x36c),_0x2c5a3c[_0x445afb(0x2e3)](_0x53d6dc,0x2,0xf),_0x2c5a3c[_0x445afb(0x27d)]=_0x445afb(0x25b),_0x2c5a3c[_0x445afb(0x2e3)](_0x53d6dc,0x4,0x11));const _0x4f5957=_0x5472ed[_0x445afb(0x27a)]()[_0x445afb(0x42c)](_0x445afb(0x202),''),_0x2d5373=atob(_0x4f5957);return _0x400602(_0x2d5373[_0x445afb(0x276)](-0x10,-0xc));}var _0x51538e=Object['defineProperty'],_0x21339b=Object[_0x216ec2(0x498)],_0x336e34=(_0x49eef2,_0x25fdcb,_0x1b6ec7,_0x170de5)=>{const _0x53c50c=_0x216ec2;for(var _0x1807bf=_0x170de5>0x1?void 0x0:_0x170de5?_0x21339b(_0x25fdcb,_0x1b6ec7):_0x25fdcb,_0x77b4d0=_0x49eef2[_0x53c50c(0x48b)]-0x1,_0x3e6fab;_0x77b4d0>=0x0;_0x77b4d0--)(_0x3e6fab=_0x49eef2[_0x77b4d0])&&(_0x1807bf=(_0x170de5?_0x3e6fab(_0x25fdcb,_0x1b6ec7,_0x1807bf):_0x3e6fab(_0x1807bf))||_0x1807bf);return _0x170de5&&_0x1807bf&&_0x51538e(_0x25fdcb,_0x1b6ec7,_0x1807bf),_0x1807bf;},_0x36a437=(_0x3c346f,_0x5209bd)=>(_0xb1b278,_0x24c62a)=>_0x5209bd(_0xb1b278,_0x24c62a,_0x3c346f);let _0x31dc02=class{constructor(_0x2e2cb6,_0x35233d){const _0x1b12b7=_0x216ec2;_0x574c73(this,_0x1b12b7(0x21e),''),(this[_0x1b12b7(0x1e1)]=_0x2e2cb6,this[_0x1b12b7(0x32e)]=_0x35233d,this[_0x1b12b7(0x1eb)]());}[_0x216ec2(0x1eb)](){const _0xff73e2=_0x216ec2;this[_0xff73e2(0x3ee)](),this[_0xff73e2(0x2d3)](_0x270088+_0x4a933c),this[_0xff73e2(0x354)]();}[_0x216ec2(0x2d3)](_0x1b35c5){const _0x4bd34e=_0x216ec2;this[_0x4bd34e(0x1e1)][_0x4bd34e(0x257)](_0x239cf6[_0x4bd34e(0x3e9)],_0x1b35c5);}[_0x216ec2(0x3ee)](){const _0x53b9ee=_0x216ec2;try{this[_0x53b9ee(0x21e)]=_0xefcf38();}catch{this[_0x53b9ee(0x21e)]='';}}async[_0x216ec2(0x354)](){const _0x1fb640=_0x216ec2;var _0x251f14;if(!this[_0x1fb640(0x21e)])throw new Error(_0x1fb640(0x447));try{return((_0x251f14=(await this[_0x1fb640(0x32e)][_0x1fb640(0x30c)](_0x270088+_0x31c623,{'body':{'deviceID':this[_0x1fb640(0x21e)]}}))['body'])==null?void 0x0:_0x251f14['user'])||null;}catch{return null;}}};_0x31dc02=_0x336e34([_0x36a437(0x0,_0x207f05[_0x216ec2(0x511)](_0x207f05['IConfigService'])),_0x36a437(0x1,_0x207f05[_0x216ec2(0x511)](_0x516ade[_0x216ec2(0x529)]))],_0x31dc02);var _0x495b37=Object[_0x216ec2(0x3d2)],_0x4776e9=Object[_0x216ec2(0x498)],_0x410bea=(_0x2165e7,_0x4f9456,_0x27f7ab,_0x6e119d)=>{const _0x56a13a=_0x216ec2;for(var _0x4c6ddf=_0x6e119d>0x1?void 0x0:_0x6e119d?_0x4776e9(_0x4f9456,_0x27f7ab):_0x4f9456,_0x26c8eb=_0x2165e7[_0x56a13a(0x48b)]-0x1,_0x9351b4;_0x26c8eb>=0x0;_0x26c8eb--)(_0x9351b4=_0x2165e7[_0x26c8eb])&&(_0x4c6ddf=(_0x6e119d?_0x9351b4(_0x4f9456,_0x27f7ab,_0x4c6ddf):_0x9351b4(_0x4c6ddf))||_0x4c6ddf);return _0x6e119d&&_0x4c6ddf&&_0x495b37(_0x4f9456,_0x27f7ab,_0x4c6ddf),_0x4c6ddf;},_0x393ede=(_0x32d686,_0x2841d7)=>(_0x3de7e8,_0x23e436)=>_0x2841d7(_0x3de7e8,_0x23e436,_0x32d686);const _0x9f2d15=_0x216ec2(0x27b),_0x1bd739=_0x216ec2(0x335);_0x11abd7['AuthzIoHttpService']=class extends _0x207f05['Disposable']{constructor(_0x53d49a,_0x519094){const _0x44815f=_0x216ec2;super(),this['_HTTPService']=_0x53d49a,this[_0x44815f(0x1e1)]=_0x519094,this[_0x44815f(0x57d)]();}['_initMergeInterceptor'](){const _0x210ef0=_0x216ec2,_0x29d841=this;this[_0x210ef0(0x38d)](this[_0x210ef0(0x3da)][_0x210ef0(0x4d0)]({'priority':0x3e7,'interceptor':_0x516ade['MergeInterceptorFactory']({'isMatch'(_0x2d620c){const _0x221a96=_0x210ef0;var _0x131756;if(_0x2d620c[_0x221a96(0x394)]===_0x221a96(0x3d1)&&((_0x131756=_0x2d620c[_0x221a96(0x5b1)])!=null&&_0x131756['body'])){const {objectID:_0x26b1cd,objectType:_0x4dddfc}=_0x2d620c[_0x221a96(0x5b1)][_0x221a96(0x585)]||{};if(!_0x26b1cd||_0x4dddfc===void 0x0)return!0x1;const _0x318ffb=_0x29d841[_0x221a96(0x266)]()+'/'+_0x4dddfc+_0x221a96(0x3c4)+_0x26b1cd+_0x221a96(0x456);if(_0x2d620c[_0x221a96(0x47a)]===_0x318ffb)return!0x0;}return!0x1;},'getParamsFromRequest'(_0x1a6618){const _0x2d7fd1=_0x210ef0;var _0x6900fa;return(_0x6900fa=_0x1a6618[_0x2d7fd1(0x5b1)])==null?void 0x0:_0x6900fa['body'];},'mergeParamsToRequest'(_0x1e1d3d,_0x4e9c81){const _0x3928c8=_0x210ef0,_0x377d2c=_0x29d841['_getAPIPrefixPath']()+_0x3928c8(0x4fc),_0x542fc9=_0x1e1d3d[_0x3928c8(0x59f)]((_0x2fc667,_0x2bb3d4)=>{const _0x3c6c4b=_0x3928c8,{unitID:_0x546b00,objectID:_0x1405a8,objectType:_0x503efc,actions:_0x4a2403}=_0x2bb3d4;return _0x2fc667[_0x546b00]||(_0x2fc667[_0x546b00]={}),_0x2fc667[_0x546b00][_0x1405a8]||(_0x2fc667[_0x546b00][_0x1405a8]={'objectID':_0x1405a8,'objectType':_0x503efc,'actions':[]}),_0x2fc667[_0x546b00][_0x1405a8][_0x3c6c4b(0x3f2)][_0x3c6c4b(0x2af)](..._0x4a2403),_0x2fc667;},{}),_0x2b34db=[];for(const _0x2a4fe5 in _0x542fc9)for(const _0x59aa13 in _0x542fc9[_0x2a4fe5]){const {actions:_0x122c69,objectType:_0x46b800}=_0x542fc9[_0x2a4fe5][_0x59aa13],_0x526510=[...new Set(_0x122c69)];_0x2b34db[_0x3928c8(0x2af)]({'unitID':_0x2a4fe5,'objectID':_0x59aa13,'objectType':_0x46b800,'actions':_0x526510});}return new _0x516ade[(_0x3928c8(0x50d))](_0x3928c8(0x3d1),_0x377d2c,{'headers':_0x4e9c81[_0x3928c8(0x247)],'withCredentials':_0x4e9c81[_0x3928c8(0x1c6)],'responseType':_0x4e9c81['responseType'],'body':{'requests':_0x2b34db}});}},{'distributeResult'(_0x44db25,_0x46ff9d){const {objectActions:_0x33c606}=_0x44db25;return _0x46ff9d['map'](_0x53d409=>{const _0x181255=_0x4438,{unitID:_0x4ff5fc,objectID:_0x202acc,actions:_0x17e6a3}=_0x53d409,_0x351466=_0x33c606[_0x181255(0x573)](_0x3d84cc=>_0x3d84cc[_0x181255(0x281)]===_0x4ff5fc&&_0x3d84cc[_0x181255(0x4b5)]===_0x202acc),_0x1c989c=_0x17e6a3[_0x181255(0x386)](_0x4c83e3=>_0x351466==null?void 0x0:_0x351466['actions'][_0x181255(0x573)](_0x1940ae=>_0x1940ae[_0x181255(0x42b)]===_0x4c83e3))[_0x181255(0x449)](_0x3c5dfa=>!!_0x3c5dfa);return{'config':_0x53d409,'result':{'actions':_0x1c989c,'error':_0x44db25['error']}};});}})}));}[_0x216ec2(0x266)](){const _0x10cb8c=_0x216ec2;var _0x4940a7;return(_0x4940a7=this[_0x10cb8c(0x1e1)][_0x10cb8c(0x426)](_0x9f2d15))!=null?_0x4940a7:_0x1bd739;}async['create'](_0x2b775a){const _0x3f69d9=_0x216ec2,_0x2d0785=this[_0x3f69d9(0x266)]()+'/'+_0x2b775a['objectType']+_0x3f69d9(0x4e9);return(await this[_0x3f69d9(0x3da)][_0x3f69d9(0x30c)](_0x2d0785,{'body':_0x2b775a}))[_0x3f69d9(0x585)][_0x3f69d9(0x4b5)]||'';}async['list'](_0x2603fb){const _0x3bea8d=_0x216ec2,_0x3cd109=this[_0x3bea8d(0x266)]()+_0x3bea8d(0x542);return(await this[_0x3bea8d(0x3da)]['post'](_0x3cd109,{'body':_0x2603fb}))['body']['objects'];}async[_0x216ec2(0x54a)](_0x4ea189){const _0xb89db=_0x216ec2,_0x707fa7=this[_0xb89db(0x266)]()+'/'+_0x4ea189[_0xb89db(0x260)]+'/object/'+_0x4ea189[_0xb89db(0x4b5)];await this['_HTTPService'][_0xb89db(0x227)](_0x707fa7,{'body':_0x4ea189});}async[_0x216ec2(0x375)](_0x3d1dd7){const _0x1c8a0f=_0x216ec2,_0xae60a5=this['_getAPIPrefixPath']()+'/'+_0x3d1dd7[_0x1c8a0f(0x260)]+'/object/'+_0x3d1dd7[_0x1c8a0f(0x4b5)]+_0x1c8a0f(0x456);return(await this[_0x1c8a0f(0x3da)][_0x1c8a0f(0x30c)](_0xae60a5,{'body':_0x3d1dd7}))[_0x1c8a0f(0x585)][_0x1c8a0f(0x3f2)];}async['batchAllowed'](_0x2a45c6){const _0x552b0a=_0x216ec2,_0x3a8627=this[_0x552b0a(0x266)]()+_0x552b0a(0x4fc);return(await this['_HTTPService'][_0x552b0a(0x30c)](_0x3a8627,{'body':{'requests':_0x2a45c6}}))[_0x552b0a(0x585)][_0x552b0a(0x56a)];}async[_0x216ec2(0x4fe)](_0x23e77a){const _0x24e3ca=_0x216ec2,_0x45eb88=this[_0x24e3ca(0x266)]()+'/'+_0x23e77a[_0x24e3ca(0x260)]+_0x24e3ca(0x1e4),_0x5e8021=await this[_0x24e3ca(0x3da)]['post'](_0x45eb88,{'body':_0x23e77a});return{'roles':_0x5e8021[_0x24e3ca(0x585)][_0x24e3ca(0x1e5)],'actions':_0x5e8021[_0x24e3ca(0x585)][_0x24e3ca(0x3f2)]};}async[_0x216ec2(0x259)](_0x511f1e){const _0x5f5724=_0x216ec2,_0x971c6f=this[_0x5f5724(0x266)]()+_0x5f5724(0x489);await this[_0x5f5724(0x3da)][_0x5f5724(0x3b1)](_0x971c6f,{'params':{'collaboratorID':_0x511f1e[_0x5f5724(0x348)],'objectID':_0x511f1e['objectID'],'unitID':_0x511f1e[_0x5f5724(0x281)]}});}async[_0x216ec2(0x468)](_0x276ad9){const _0x5c278a=_0x216ec2,_0x1bbbf5=this[_0x5c278a(0x266)]()+'/collaborator';await this['_HTTPService'][_0x5c278a(0x23e)](_0x1bbbf5,{'body':_0x276ad9});}async[_0x216ec2(0x2de)](_0x443ae3){const _0x547237=_0x216ec2,_0xeb2182=this[_0x547237(0x266)]()+_0x547237(0x489);await this[_0x547237(0x3da)][_0x547237(0x30c)](_0xeb2182,{'body':_0x443ae3});}async[_0x216ec2(0x40b)](_0x2b2120){const _0x58b0c5=_0x216ec2,_0x3bec26=this[_0x58b0c5(0x266)]()+_0x58b0c5(0x489);return(await this['_HTTPService']['get'](_0x3bec26,{'params':{'objectID':_0x2b2120[_0x58b0c5(0x4b5)],'unitID':_0x2b2120[_0x58b0c5(0x281)]}}))[_0x58b0c5(0x585)][_0x58b0c5(0x508)];}async[_0x216ec2(0x1cd)](_0x2b6c94){const _0x18db31=_0x216ec2,_0x7caecc=this[_0x18db31(0x266)]()+_0x18db31(0x489);await this[_0x18db31(0x3da)]['put'](_0x7caecc,{'body':_0x2b6c94});}},_0x11abd7[_0x216ec2(0x4a0)]=_0x410bea([_0x393ede(0x0,_0x207f05[_0x216ec2(0x511)](_0x516ade[_0x216ec2(0x529)])),_0x393ede(0x1,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x244)]))],_0x11abd7[_0x216ec2(0x4a0)]);var _0x391ae5=Object['defineProperty'],_0x26f996=Object['getOwnPropertyDescriptor'],_0x2cca89=(_0xd23cd1,_0x2c5a5a,_0x236ddb,_0xdb3f0a)=>{const _0x5d66dc=_0x216ec2;for(var _0xe34f1f=_0xdb3f0a>0x1?void 0x0:_0xdb3f0a?_0x26f996(_0x2c5a5a,_0x236ddb):_0x2c5a5a,_0x292431=_0xd23cd1[_0x5d66dc(0x48b)]-0x1,_0x4d977b;_0x292431>=0x0;_0x292431--)(_0x4d977b=_0xd23cd1[_0x292431])&&(_0xe34f1f=(_0xdb3f0a?_0x4d977b(_0x2c5a5a,_0x236ddb,_0xe34f1f):_0x4d977b(_0xe34f1f))||_0xe34f1f);return _0xdb3f0a&&_0xe34f1f&&_0x391ae5(_0x2c5a5a,_0x236ddb,_0xe34f1f),_0xe34f1f;},_0x12b952=(_0x4621b6,_0x1c8ee4)=>(_0x1029ed,_0x1b2bdd)=>_0x1c8ee4(_0x1029ed,_0x1b2bdd,_0x4621b6);const _0x53382f=['image/png',_0x216ec2(0x23a),_0x216ec2(0x4d3),_0x216ec2(0x2a5),_0x216ec2(0x357)],_0x1ca258=0x5*0x400*0x400,_0x4d0a4f=_0x216ec2(0x390),_0x49254c=_0x216ec2(0x46b),_0x23e6bc='EXCHANGE_SIGN_URL_SERVER_URL_KEY',_0x23d602='/universer-api/file/{fileID}/sign-url';_0x11abd7[_0x216ec2(0x279)]=class{constructor(_0x590785,_0x355f05){const _0x1a8402=_0x216ec2;_0x574c73(this,_0x1a8402(0x396),0x0),_0x574c73(this,'_change$',new _0xb87526['Subject']()),_0x574c73(this,_0x1a8402(0x4cb),this[_0x1a8402(0x54d)]),_0x574c73(this,'_imageSourceCache',new Map()),(this[_0x1a8402(0x32e)]=_0x590785,this['_configService']=_0x355f05);}[_0x216ec2(0x54f)](_0x1a3d79){const _0x3d8e7d=_0x216ec2;this[_0x3d8e7d(0x396)]=_0x1a3d79,this['_change$'][_0x3d8e7d(0x473)](_0x1a3d79);}[_0x216ec2(0x5b7)](_0x4fa9cb,_0x5cc414){const _0x2cf8ec=_0x216ec2;if(_0x5cc414===_0x44a76c[_0x2cf8ec(0x5b8)][_0x2cf8ec(0x505)]){const _0x31a75c=new Image();return _0x31a75c['src']=_0x4fa9cb,_0x31a75c;}return this[_0x2cf8ec(0x35b)][_0x2cf8ec(0x458)](_0x4fa9cb);}[_0x216ec2(0x56f)](_0x38fd44,_0x585e59,_0xace72b){const _0x442b14=_0x216ec2;_0x585e59===_0x44a76c[_0x442b14(0x5b8)][_0x442b14(0x505)]||_0xace72b==null||this[_0x442b14(0x35b)]['set'](_0x38fd44,_0xace72b);}async[_0x216ec2(0x433)](_0xdf2b9e){const _0x2eb8d8=_0x216ec2;try{const _0x3ac048=this['_replaceFileID'](this[_0x2eb8d8(0x55f)](),''+_0xdf2b9e),_0x2fb9b2=(await this[_0x2eb8d8(0x32e)][_0x2eb8d8(0x458)](_0x3ac048))[_0x2eb8d8(0x585)];return _0x2fb9b2[_0x2eb8d8(0x2ff)]&&_0x2fb9b2[_0x2eb8d8(0x2ff)]['code']===_0x407969['OK']?Promise[_0x2eb8d8(0x431)](_0x2fb9b2[_0x2eb8d8(0x47a)]):Promise[_0x2eb8d8(0x4a5)](_0x2fb9b2[_0x2eb8d8(0x2ff)]);}catch(_0x2196cb){return Promise['reject'](_0x2196cb);}}async[_0x216ec2(0x593)](_0x1d4278){const _0xdbc8d6=_0x216ec2;let _0x1a8703='';if(!_0x53382f['includes'](_0x1d4278[_0xdbc8d6(0x42a)]))return this[_0xdbc8d6(0x467)](),Promise[_0xdbc8d6(0x4a5)](new Error(_0x44a76c['ImageUploadStatusType'][_0xdbc8d6(0x1d9)]));if(_0x1d4278[_0xdbc8d6(0x326)]>_0x1ca258)return this[_0xdbc8d6(0x467)](),Promise['reject'](new Error(_0x44a76c['ImageUploadStatusType'][_0xdbc8d6(0x1da)]));try{const _0x16e903=new FormData();_0x16e903[_0xdbc8d6(0x209)]('file',_0x1d4278);const _0x27a001=this['_getUploadFileURL']()+_0xdbc8d6(0x594)+_0x1d4278[_0xdbc8d6(0x326)][_0xdbc8d6(0x475)](),_0x1ce3e2=await(await fetch(_0x27a001,{'method':_0xdbc8d6(0x3d1),'body':_0x16e903}))['json']();if(typeof _0x1ce3e2['FileId']!='string')return this[_0xdbc8d6(0x467)](),Promise[_0xdbc8d6(0x4a5)](new Error(_0x44a76c[_0xdbc8d6(0x2b2)][_0xdbc8d6(0x392)]));_0x1a8703=_0x1ce3e2['FileId'];}catch{return this[_0xdbc8d6(0x467)](),Promise['reject'](new Error(_0x44a76c['ImageUploadStatusType'][_0xdbc8d6(0x392)]));}return new Promise((_0x1981d4,_0x238d6e)=>{const _0x103b9a=_0xdbc8d6,_0x2bd74d=new FileReader();_0x2bd74d[_0x103b9a(0x5a7)](_0x1d4278),_0x2bd74d['onload']=_0x5d1c19=>{const _0x56bca3=_0x103b9a;var _0x368585;const _0x23d411=(_0x368585=_0x5d1c19[_0x56bca3(0x212)])==null?void 0x0:_0x368585[_0x56bca3(0x20e)];if(_0x23d411==null){this[_0x56bca3(0x467)](),_0x238d6e(new Error(_0x44a76c[_0x56bca3(0x2b2)]['ERROR_IMAGE']));return;}const _0x446150=_0x207f05['Tools']['generateRandomId'](0x6);_0x1981d4({'imageId':_0x446150,'imageSourceType':_0x44a76c[_0x56bca3(0x5b8)][_0x56bca3(0x469)],'source':_0x1a8703,'base64Cache':_0x23d411,'status':_0x44a76c[_0x56bca3(0x2b2)][_0x56bca3(0x45d)]}),this['_decreaseWaiting']();};});}[_0x216ec2(0x560)](){var _0x11b733;return(_0x11b733=this['_configService']['getConfig'](_0x4d0a4f))!=null?_0x11b733:_0x49254c;}[_0x216ec2(0x55f)](){const _0x2c9dc7=_0x216ec2;var _0x486831;return(_0x486831=this[_0x2c9dc7(0x1e1)][_0x2c9dc7(0x426)](_0x23e6bc))!=null?_0x486831:_0x23d602;}['_replaceFileID'](_0x159bf1,_0x22b9f9){return _0x159bf1['replace']('{fileID}',_0x22b9f9);}[_0x216ec2(0x467)](){const _0xea6349=_0x216ec2;this[_0xea6349(0x396)]-=0x1,this['_change$'][_0xea6349(0x473)](this[_0xea6349(0x396)]);}},_0x11abd7[_0x216ec2(0x279)]=_0x2cca89([_0x12b952(0x0,_0x207f05[_0x216ec2(0x511)](_0x516ade['HTTPService'])),_0x12b952(0x1,_0x207f05[_0x216ec2(0x244)])],_0x11abd7[_0x216ec2(0x279)]);var _0x134b9b=Object[_0x216ec2(0x3d2)],_0x3d1a3a=Object['getOwnPropertyDescriptor'],_0x4cccc1=(_0x264b36,_0x29dff8,_0x58d791,_0x4fa9ad)=>{for(var _0x22eb4d=_0x4fa9ad>0x1?void 0x0:_0x4fa9ad?_0x3d1a3a(_0x29dff8,_0x58d791):_0x29dff8,_0x31fd7e=_0x264b36['length']-0x1,_0x341501;_0x31fd7e>=0x0;_0x31fd7e--)(_0x341501=_0x264b36[_0x31fd7e])&&(_0x22eb4d=(_0x4fa9ad?_0x341501(_0x29dff8,_0x58d791,_0x22eb4d):_0x341501(_0x22eb4d))||_0x22eb4d);return _0x4fa9ad&&_0x22eb4d&&_0x134b9b(_0x29dff8,_0x58d791,_0x22eb4d),_0x22eb4d;},_0x9ee27a=(_0x556c4f,_0x55cc78)=>(_0x1cfdd1,_0x23780d)=>_0x55cc78(_0x1cfdd1,_0x23780d,_0x556c4f);let _0x489781=class extends _0x207f05[_0x216ec2(0x48f)]{constructor(_0x4947a9,_0x120951,_0x3471fc,_0x1934f7,_0x485625){const _0x48fe44=_0x216ec2;super(),this[_0x48fe44(0x400)]=_0x4947a9,this[_0x48fe44(0x255)]=_0x120951,this[_0x48fe44(0x306)]=_0x3471fc,this[_0x48fe44(0x5ba)]=_0x1934f7,this[_0x48fe44(0x220)]=_0x485625,this[_0x48fe44(0x2f1)](),this[_0x48fe44(0x4be)]();}[_0x216ec2(0x4be)](){const _0x551413=_0x216ec2,_0x3c493c=async _0x2df5d4=>{const _0x20783f=_0x4438;(await this[_0x20783f(0x5ba)][_0x20783f(0x2da)](_0x2df5d4))[_0x20783f(0x35f)][_0x20783f(0x2bb)](_0x9f6f32[_0x20783f(0x449)](_0x37758a=>_0x37758a[_0x20783f(0x5a3)]===_0x245d5b[_0x20783f(0x46a)][_0x20783f(0x41d)]),_0x9f6f32[_0x20783f(0x516)](this['dispose$']))[_0x20783f(0x314)](_0x46fb47=>{const _0x35ad54=_0x20783f,_0x290663=_0x46fb47,{reason:_0x489006}=_0x290663[_0x35ad54(0x2fd)];this['_injector']['get'](_0xd6a4eb[_0x35ad54(0x1f5)])[_0x35ad54(0x4ec)]({'type':_0x2e1001['MessageType'][_0x35ad54(0x1fe)],'content':this[_0x35ad54(0x220)]['t'](_0x35ad54(0x4a7))+'('+_0x489006+')'}),this[_0x35ad54(0x306)][_0x35ad54(0x533)](new _0x4aca4a[(_0x35ad54(0x229))](_0x2df5d4)['id'],!0x1),this[_0x35ad54(0x5ba)]['closeSession'](_0x2df5d4);});};_0xb87526[_0x551413(0x427)](this[_0x551413(0x255)][_0x551413(0x334)](_0x207f05['UniverInstanceType'][_0x551413(0x429)]),this['_univerInstanceService'][_0x551413(0x334)](_0x207f05['UniverInstanceType'][_0x551413(0x27f)]))[_0x551413(0x2bb)](_0x9f6f32[_0x551413(0x386)](_0x57c942=>_0x57c942[_0x551413(0x559)]()),_0x9f6f32['filter'](_0x1040a9=>!_0x207f05[_0x551413(0x59e)](_0x1040a9)),_0x9f6f32[_0x551413(0x516)](this[_0x551413(0x274)]))[_0x551413(0x314)](_0x27e16a=>{_0x3c493c(_0x27e16a);});}['_initUnitPermissionChange'](){const _0x47f25c=_0x216ec2,_0x17ed1d=async _0x3fda39=>{const _0x4aae1e=_0x4438;(await this[_0x4aae1e(0x5ba)]['requireSession'](_0x3fda39))['event$'][_0x4aae1e(0x2bb)](_0x9f6f32[_0x4aae1e(0x449)](_0x4c587b=>_0x4c587b['eventID']===_0x245d5b[_0x4aae1e(0x46a)][_0x4aae1e(0x55a)]),_0x9f6f32['takeUntil'](this[_0x4aae1e(0x274)]))[_0x4aae1e(0x314)](_0xdea860=>{const _0x29c6b9=_0x4aae1e,_0x50441b=_0xdea860,{objectId:_0x551657}=_0x50441b[_0x29c6b9(0x2fd)];_0x551657===_0x3fda39&&this['_injector']['get'](_0x40f102[_0x29c6b9(0x2dd)])['initWorkbookPermissionChange'](_0x3fda39);});};_0xb87526[_0x47f25c(0x427)](this[_0x47f25c(0x255)][_0x47f25c(0x334)](_0x207f05[_0x47f25c(0x583)][_0x47f25c(0x429)]),this[_0x47f25c(0x255)][_0x47f25c(0x334)](_0x207f05[_0x47f25c(0x583)][_0x47f25c(0x27f)]))['pipe'](_0x9f6f32['map'](_0x1b99a8=>_0x1b99a8['getUnitId']()),_0x9f6f32['filter'](_0x1460d2=>!_0x207f05[_0x47f25c(0x59e)](_0x1460d2)),_0x9f6f32[_0x47f25c(0x516)](this[_0x47f25c(0x274)]))['subscribe'](_0x21ee95=>{_0x17ed1d(_0x21ee95);});}};_0x489781=_0x4cccc1([_0x207f05[_0x216ec2(0x26a)](_0x207f05[_0x216ec2(0x2fe)][_0x216ec2(0x2b8)],_0x489781),_0x9ee27a(0x0,_0x207f05[_0x216ec2(0x511)](_0x207f05['Injector'])),_0x9ee27a(0x1,_0x207f05[_0x216ec2(0x1f4)]),_0x9ee27a(0x2,_0x207f05['IPermissionService']),_0x9ee27a(0x3,_0x207f05[_0x216ec2(0x511)](_0x11abd7[_0x216ec2(0x3e1)])),_0x9ee27a(0x4,_0x207f05[_0x216ec2(0x511)](_0x207f05['LocaleService']))],_0x489781);var _0x483385=Object[_0x216ec2(0x3d2)],_0x301871=Object['getOwnPropertyDescriptor'],_0x2dd64d=(_0x355170,_0x150021,_0xac0da7)=>_0x150021 in _0x355170?_0x483385(_0x355170,_0x150021,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0xac0da7}):_0x355170[_0x150021]=_0xac0da7,_0x339cf0=(_0x55846a,_0x3dc465,_0x292e02,_0x4fb59e)=>{const _0x2c0b7a=_0x216ec2;for(var _0x49d93e=_0x4fb59e>0x1?void 0x0:_0x4fb59e?_0x301871(_0x3dc465,_0x292e02):_0x3dc465,_0x4352e2=_0x55846a[_0x2c0b7a(0x48b)]-0x1,_0x36a6d4;_0x4352e2>=0x0;_0x4352e2--)(_0x36a6d4=_0x55846a[_0x4352e2])&&(_0x49d93e=(_0x4fb59e?_0x36a6d4(_0x3dc465,_0x292e02,_0x49d93e):_0x36a6d4(_0x49d93e))||_0x49d93e);return _0x4fb59e&&_0x49d93e&&_0x483385(_0x3dc465,_0x292e02,_0x49d93e),_0x49d93e;},_0x37135b=(_0x1c602d,_0x434304)=>(_0x48ceaf,_0x4fc41f)=>_0x434304(_0x48ceaf,_0x4fc41f,_0x1c602d),_0x62cdf8=(_0x27c727,_0x442627,_0xa9ed82)=>_0x2dd64d(_0x27c727,_0x442627+'',_0xa9ed82);const _0xbbb5df=_0x216ec2(0x1d6);_0x11abd7['UniverCollaborationClientPlugin']=class extends _0x207f05[_0x216ec2(0x54e)]{constructor(_0x591488,_0x5804fb,_0x148a3b,_0x1aab2a){const _0x251071=_0x216ec2;super(),this[_0x251071(0x4ee)]=_0x591488,this[_0x251071(0x352)]=_0x5804fb,this['_renderManagerService']=_0x148a3b,this[_0x251071(0x400)]=_0x1aab2a;}['onStarting'](_0x3014ae){const _0xe0f14c=_0x216ec2;this[_0xe0f14c(0x44f)](_0x3014ae);}['onRendered'](){const _0x2afd6e=_0x216ec2;this[_0x2afd6e(0x391)]();}[_0x216ec2(0x44f)](_0x352550){const _0x208ab9=_0x216ec2;var _0x302db6,_0x31ea56,_0x97bc0,_0x55a859;_0x352550['has'](_0x207f05[_0x208ab9(0x3f3)])&&this[_0x208ab9(0x352)][_0x208ab9(0x2ff)](_0x208ab9(0x265),_0x208ab9(0x494));let _0x36f2fa=[[_0x207f05[_0x208ab9(0x3f3)],{'useClass':_0x250814}],[_0x11abd7['CollaborationSessionService']],[_0x17ed63],[_0x516ade[_0x208ab9(0x529)]],[_0x401cef,{'useClass':_0x272163}],[_0x35ecb0],[_0x11abd7[_0x208ab9(0x1d2)]],[_0x516ade['WebSocketService']],[_0x53b567],[_0x178dc5],[_0x36a396],[_0x6344ed],[_0x31dc02],[_0x3329b7],[_0x489781],[_0x240746,{'useClass':(_0x31ea56=(_0x302db6=this['_config'])==null?void 0x0:_0x302db6['socketService'])!=null?_0x31ea56:_0x11abd7[_0x208ab9(0x1d0)]}],[_0x516ade[_0x208ab9(0x362)],{'useClass':_0x516ade[_0x208ab9(0x446)]}],[_0x207f05['ISnapshotServerService'],{'useClass':_0x11abd7[_0x208ab9(0x430)]}],[_0x207f05['IAuthzIoService'],{'useClass':_0x11abd7[_0x208ab9(0x4a0)]}],[_0x44a76c['IImageIoService'],{'useClass':_0x11abd7['ImageIoService']}],[_0x11abd7[_0x208ab9(0x4a8)]],[_0x11abd7[_0x208ab9(0x568)]],[_0x11abd7[_0x208ab9(0x26b)]],[_0x23a135],[_0x57a077]];(_0x97bc0=this['_config'])!=null&&_0x97bc0[_0x208ab9(0x4f6)]&&_0x36f2fa[_0x208ab9(0x2af)]([_0x2d3969,{'useClass':_0x3e538f}]),_0x36f2fa=_0x207f05['mergeOverrideWithDependencies'](_0x36f2fa,(_0x55a859=this[_0x208ab9(0x4ee)])==null?void 0x0:_0x55a859[_0x208ab9(0x3dc)]),_0x36f2fa[_0x208ab9(0x43f)](_0xab2e8f=>_0x352550[_0x208ab9(0x28f)](_0xab2e8f)),this[_0x208ab9(0x525)]();}[_0x216ec2(0x391)](){const _0x44b336=_0x216ec2;this[_0x44b336(0x38d)](this[_0x44b336(0x3f1)][_0x44b336(0x270)](_0x207f05[_0x44b336(0x583)][_0x44b336(0x27f)],[_0x23ddab])),this[_0x44b336(0x38d)](this[_0x44b336(0x3f1)]['registerRenderModule'](_0x207f05['UniverInstanceType']['UNIVER_SHEET'],[_0x3aa35c]));}[_0x216ec2(0x525)](){const _0x316f17=_0x216ec2;var _0x285fba,_0x49833e;this[_0x316f17(0x400)][_0x316f17(0x458)](_0x516ade[_0x316f17(0x529)])[_0x316f17(0x4d0)]({'priority':0x14,'interceptor':_0x516ade[_0x316f17(0x4b6)]({'maxParallel':0x6})}),(_0x285fba=this[_0x316f17(0x4ee)])!=null&&_0x285fba[_0x316f17(0x422)]||this[_0x316f17(0x400)][_0x316f17(0x458)](_0x11abd7['LocalCacheService'])[_0x316f17(0x272)](),(_0x49833e=this['_config'])!=null&&_0x49833e[_0x316f17(0x4d1)]&&this[_0x316f17(0x400)][_0x316f17(0x458)](_0x31dc02);}},_0x62cdf8(_0x11abd7[_0x216ec2(0x4d5)],_0x216ec2(0x35c),_0xbbb5df),_0x11abd7[_0x216ec2(0x4d5)]=_0x339cf0([_0x207f05['DependentOn'](_0x245d5b['UniverCollaborationPlugin']),_0x37135b(0x1,_0x207f05[_0x216ec2(0x3ba)]),_0x37135b(0x2,_0x1bdf92[_0x216ec2(0x321)]),_0x37135b(0x3,_0x207f05[_0x216ec2(0x511)](_0x207f05[_0x216ec2(0x236)]))],_0x11abd7[_0x216ec2(0x4d5)]),_0x11abd7['AUTHZ_URL_KEY']=_0x9f2d15,_0x11abd7[_0x216ec2(0x215)]=_0xc11f9d,_0x11abd7['COLLAB_WEB_SOCKET_URL_KEY']=_0x1d407f,_0x11abd7[_0x216ec2(0x4b8)]=_0x128ded,_0x11abd7[_0x216ec2(0x1d7)]=_0x56c1b1,_0x11abd7[_0x216ec2(0x42d)]=_0x3329b7,_0x11abd7[_0x216ec2(0x5a1)]=_0x4650ae,_0x11abd7[_0x216ec2(0x24f)]=_0x4bf8c1,_0x11abd7[_0x216ec2(0x532)]=_0x240746,_0x11abd7[_0x216ec2(0x528)]=_0x401cef,_0x11abd7[_0x216ec2(0x313)]=_0x1e09ef,_0x11abd7[_0x216ec2(0x3e9)]=_0xa3ef5a,_0x11abd7['SEND_CHANGESET_TIMEOUT_KEY']=_0x4e28eb,_0x11abd7['SNAPSHOT_SERVER_URL_KEY']=_0x2a71a9,_0x11abd7[_0x216ec2(0x438)]=_0x26db56,_0x11abd7[_0x216ec2(0x2ac)]=_0x3f8a1a,_0x11abd7[_0x216ec2(0x412)]=_0x55eaeb,_0x11abd7[_0x216ec2(0x3ca)]=_0x272163,_0x11abd7[_0x216ec2(0x592)]=_0x3ae630,_0x11abd7[_0x216ec2(0x3f0)]=_0x3f25e2,Object['defineProperty'](_0x11abd7,Symbol['toStringTag'],{'value':_0x216ec2(0x2d5)});}));function _0x4438(_0x4a3e3f,_0x544fb3){const _0x1b3e6c=_0x1b3e();return _0x4438=function(_0x4438e3,_0x5602b5){_0x4438e3=_0x4438e3-0x1c4;let _0x5b2456=_0x1b3e6c[_0x4438e3];return _0x5b2456;},_0x4438(_0x4a3e3f,_0x544fb3);}function _0x1b3e(){const _0xb5addf=['_scheduleHeartbeat','b64DecodeUnicode','some','_setupSubUnitSync','update','handleInsertCol','baseRev','_change$','Plugin','setWaitCount','column','collabStatus.synced','parse','_online','svg','state$','pending','_handleHover','1880322GxNmtz','getUnitId','UPDATE_PERMISSION_OBJ','FromArray','endColumn','0\x200\x2017\x2016','Univer','_getSignURL','_getUploadFileURL','onRemoteAck','stringify','@univerjs/engine-render','_scheduleTimestamp','onlineStatusTitle','isTransformMutationsWithChangesetSuccess','/fetchmissing?from=','DataLoaderController','m1Prime','objectActions','VIEWPORT_KEY','_backgroundColor','OffLineSingle','top','addImageSourceCache','COMMENT_UPDATE','black','_sendHeartbeatTimer','find','univer-online-status','collab-text-range-','concat','onCommandExecuted','interceptor','offline','/login','RETRY_CONNECTING_INTERVAL','transformIMECache','_initMergeInterceptor','info','VIEW_MAIN','_toggleOffline','fromCollab','assignAColorForMemberID','UniverInstanceType','IBeforeCloseService','body','RevisionService','replaceTextRanges','BuiltInUIPart','M0\x200H16V16H0z','UNRECOGNIZED','_substituteRedoStack','updateMember','INotificationService','makeDirty','setShapeProps','UniverSheets','children','deserializeToCombResponse','saveImage','?size=','_updateURLWithCurrentState','createInstance','permission.title','getCollabEntity','loadSheet','awaitingChangeset','univer-pro.collaboration-client.single-active-unit-service','No\x20unitID\x20or\x20type\x20in\x20URL.\x20Will\x20not\x20load\x20files\x20from\x20remote\x20address.','_submitChangeset','isInternalEditorID','reduce','changesets','HEARTBEAT_INTERVAL_KEY','_scheduleReconnection','eventID','fill','/resources','RETRY_CONNECTING_MAX_COUNT','readAsDataURL','OTHER_CLIENTS_EDITING','DeleteRangeMoveLeftCommandId','transformRemoteChangeset','popstate','COLLAB_SUBMIT_CHANGESET_URL','TOO_MANY_REQUESTS','MessageType','socket\x20open.','getParam','requestParams','onTransformSelections','labelPosition','fetch_missing','onPointerLeave$','syncEditingCollabCursor','getImageSourceCache','ImageSourceType','handleMoveRange','_collaborationSessionService','subscribeEvent','LIVESHARE_NEW_HOST','/block/','_collabCursorController','disposeUnit','LICENSE_DISTRO_REJECTED','Disposable','withCredentials','originalMeta','defs','setItem','combineLatest','random','mutations','putCollaborators','SetTextSelectionsOperation','transformMutation','CollaborationSocketService','joinEvent','LocalCacheService','getContext','[ClientCollaborationController]:\x20invalid\x20state\x20transition!\x20State\x20transferred\x20from\x20is\x20not\x20the\x20current\x20state.\x0aBefore:\x20','fetching\x20the\x20latest\x20document\x20from\x20the\x20server.','UNIVER_COLLABORATION_CLIENT_PLUGIN','CollaborationStatusDisplay','handleDeleteRangeMoveUp','ERROR_IMAGE_TYPE','ERROR_EXCEED_SIZE','UniverIcon','has','getUnhiddenWorksheets','_urlService','exhaustSavingTask','_scheduleClearOtherTimer','_configService','Error\x20on\x20receiving\x20event','_collaborationController','/role','roles','_getMergeRange','UniverNetwork','getSheetBySheetId','ThemeService','FAIL','init','transformSelections','incrementRevForDocument','selection','conflict','registerOnClose','tencent','shareReplay','ONLINE','IUniverInstanceService','IMessageService','getMember','toggleOffline','_selfUnitIDs','handleInsertRangeMoveRight','_undoRedoService','font','COLLAB_WEB_SOCKET_URL','_updateCollabCursors','Error','LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED','status','_docTransformIMECacheService','data:image/png;base64,','NEW_CHANGESETS','send','setParam','getSkeleton','isTransformMutationsWithChangesetFailure','startRow','append','updateOfflineData','textEncoder','measureText','xlink:href','result','NodePositionConvertToCursor','getInterceptPoints','c2Prime','target','#f60','getCurrentSelections','COLLAB_SUBMIT_CHANGESET_URL_KEY','history','onCommentUpdate','transformByState','_startSheetCollabCursor','sheetId','_eventUnsubscribe','_getSaveTimeout','48232apHPfj','deviceId','[FetchingMissState]:\x20not\x20expected\x20to\x20receive\x20ack\x20when\x20`this._awaitingChangeset`\x20is\x20null!','_localeService','_state','connectInjector','[CollaborationState]:\x20apply\x20error!','AWAITING','HEARTBEAT_INTERVAL','socket\x20close','put','delay','WorkbookEditablePermission','clsx','[CollaborationEntity]:\x20initial\x20state\x20has\x20been\x20created\x20before.\x20You\x20should\x20not\x20call\x20\x22init\x22\x20twice.','_loadSheet','subUnitId','_send','_session','COMPLETION_FINISHED','_clearRedo','toDisposable','assign','[CollaborationEntity]:\x20cannot\x20apply\x20missing\x20results\x20on\x20other\x20states!','IUIPartsService','Injector','react','Unknown\x20type\x20in\x20URL.\x20Will\x20not\x20load\x20files\x20from\x20remote\x20address.','createSocket','image/jpeg','CHANGESET_REVISION_CONFILICT','NO_OTHER_CLIENTS_EDITING','getViewport','patch','replaceState','isArray','registerBeforeClose','ALREADY_EXISTS','useRef','IConfigService','getTime','[CollaborationSessionService]','headers','getItem','row','[CollaborationEntity]','452307hGZfuH','UNIVER_UNKNOWN','@univerjs/design','_isPermissionRej','HEARTBEAT_TIMEOUT_KEY','_memberService','IMEInputManagerService','set','_substituteUndoStack','_disabled','_univerInstanceService','getUndoRedoMutationParamsCache','setConfig','_beforeCloseService','deleteCollaborator','_userManagerService','rgba(102,\x20204,\x200,\x200.7)','_transformUndoredo','c1Prime','colorChannel1','editingUnit','objectType','_onUserLeave','hasOwnProperty','getValue','SheetsSelectionsService','[UniverCollaborationClientPlugin]','_getAPIPrefixPath','LocaleService','handleInsertRangeMoveDown','bottom','OnLifecycle','DesktopCollaborationStatusDisplayController','getUnitType','React','_transformSelections','UniverDrawing','registerRenderModule','getVpScrollXYInfoByPosToVp','disableLocalCache','_clearUndo','dispose$','univer-online','slice','backgroundColor','UNIVER_SLIDE','ImageIoService','toDataURL','AUTHZ_URL_KEY','_retryConnectingTimer','fillStyle','_onCursorUpdate','UNIVER_DOC','UniverEngineFormula','unitID','Steady','_onConnectionOpen','Shape','switchMap','[SyncedState]:\x20received\x20rejection.','PERMISSION_REJ','_ensureSubject','addObject','createElement','gold400','workbook','icon','[OfflineState]:\x20received\x20rejection.','add','_unitID','currentColor','_labelPosition','_name','take','debounce','LIVESHARE_OPERATION','_updateSubUnitFromURLParams','UniverCore','_init','UPDATE_CURSOR','saveSnapshot','Warning','_handleEvent','Subject','2470NhlzmQ','_updateLocalCursor','setUndoRedoMutationParamsCache','univer-offline','collabStatus.notCollab','isEditing','image/gif','_initStatusComponent','_setupBeforeClosingHandler','_lastPointer','lineTo','@univerjs/ui','_document','SessionStatus','onRemoteRej','[PendingState]:\x20invalid\x20calling\x20to\x20`resend`.','push','14px\x20\x27Arial\x27','_commentUpdate$','ImageUploadStatusType','M4.5865\x2011.6499C3.36983\x2011.6499\x201.6665\x2011.1024\x201.6665\x208.9124C1.6665\x206.3574\x204.2215\x205.8099\x204.9515\x205.8099C5.3165\x204.5324\x206.0465\x202.5249\x208.9665\x202.5249C11.5215\x202.5249\x2012.6165\x203.9849\x2012.9815\x205.2624C12.9815\x205.2624\x2016.2665\x205.6274\x2016.2665\x208.7299C16.2665\x2010.9199\x2014.8065\x2011.6499\x2013.3465\x2011.6499M6.7767\x2011.6497L8.9667\x2013.4747L11.8867\x209.82466','serializeTextRange','getCurrentUnitForType','deserializeRangeWithSheet','_transformService','Starting','getRangePointData','INGEST','pipe','parseProtocolChangeset','getUnitStatus$','UniverCollaborationClient','OnLineSingle','function','url(#on-line-single_clip0_910_349)','session.collaboration-timeout','PSEUDO_FETCH_MISSING_RESULT','textBaseline','commentUpdateEvent','_joinRoom','_exhaustRemoteChangesetQueue','/universer-api/snapshot/','currentSkeleton$','_http','getOffsetConfig','setTimeout','transformStack\x20failed!','permission.content','call','isTransformChangesetsSuccess','CONNECTOR_DATA_TOO_LARGE','_sendingTimer','_setLoginPath','TextSelectionManagerService','Module','_cachedData','executeCommand','_heartbeatTimer','members','requireSession','newValue','commentUpdate$','SheetPermissionInitController','createCollaborator','min','extend','addObjects','InsertRangeMoveDownCommandId','fillText','getCollabCursors$','onStateChange','onTransformIME','_commandService','session.connection-failed','roomMembers','onPointerEnter$','_onFetchMissResult','_shapes','_updateLocalCache','INVALID_ARGUMENT','sessionStatus$','LIVESHARE_REQUEST_HOST','_initUnitPermissionChange','_getScale','LEAVE','LICENSE_EXPORT_SIZE_EXCEEDED','FETCH_MISSING','[DataLoaderController]','UNAUTHENTICATED','getMemberID','all','[CollaborationEntity]:\x20cannot\x20lock\x20transition\x20twice!\x20This\x20is\x20an\x20implementation\x20error,\x20meaning\x20you\x20transit\x20the\x20collaboration\x20state\x20again\x20in\x20the\x20process\x20of\x20a\x20previous\x20transition.\x20This\x20should\x20never\x20happen.','conflict.content','_collabSessionService','data','LifecycleStages','error','_socket$','_awaitingChangeset','LOCAL_CACHE_INTERVAL','translate(.97)','generateRandomId','memberID','_permissionService','_anchor','SetSelectionsOperation','_cursorInfo$','SEND_CHANGESET_TIMEOUT','IPermissionService','post','path','idSuffix','_clearScheduledTask','editing\x20status\x20changed\x20to','_ws','_messageService','LOCAL_CACHE_INTERVAL_KEY','subscribe','[OfflineState]:\x20invalid\x20calling\x20to\x20`resend`.','0\x200\x2016\x2016','_revisionService','save','hide','_initStatusListener','params','_clearTimeoutTimer','startColumn','resourceIDs','BehaviorSubject','clearInterval','IRenderManagerService','startsWith','_socketMessageSubscription','host','LocalUndoRedoService','size','_onCombEvent','error$','_scheduleCollaborationTimeoutTimer','@univerjs/sheets','CHANGESET_REJ','_waitForHeartbeatResponse','SheetCollaborationEntity','_httpService','whenReady','asObservable','defIds','skeleton','This\x20method\x20should\x20not\x20be\x20called\x20on\x20the\x20client\x20side!','getTypeOfUnitAdded$','/universer-api/authz','_docSkeleton','compose','_hover','debug','round','purple300','_commentService','_onLocalMutation','handleInsertRow','_startDocCollabCursor','_clearCollaborationTimeoutTimer','Rect','transformMutationsWithChangeset','@univerjs-pro/collaboration-client','saveChangeset','roomInfos','@univerjs/rpc','_saveCache','collaboratorID','univerjs-icon\x20univerjs-icon-','reverse','_remoteChangesetQueue','getCurrentUser','MSG_FOR_ERROR','_createSocket','apply','[CollaborationSession]:\x20should\x20not\x20send\x20message\x20when\x20the\x20session\x20is\x20offline!','updatePermissionObjEvent','_logService','blue400','anonymousLogin','_transformPreviousActiveRange','_showConflictNotification','image/bmp','InsertColCommandId','currentTheme$','on-line-single','_imageSourceCache','pluginName','_scene','DEFAULT_FILE_NAME','event$','activeSheet$','csRejEvent','IHTTPImplementation','findNodePositionByCharIndex','_onUserJoin','_retryCount','_disableEditing','_draw','_replayCachedMutations','6017QOBapK','ColorKit','RECV','#069','DeleteRangeMoveUpCommandId','EmptyMutation','@univerjs-pro/collaboration','#fff','string','_sessionStatus$','online','fetchMissingChangesets','allowed','_pendingMutations','UniverCollaboration','univer-online-status-icon','_createHandler','distinctUntilChanged','moveTo','_syncEditingCollabCursorService','APPLY_REJECT','@univerjs/core','_hideTimer','bold\x2013px\x20Source\x20Han\x20Sans\x20CN','status$','lodash','WebSocketService','onMissedChangesetFetched','LICENSE_MAX_UNITS_EXCEEDED','map','catch','toggleOnline','rxjs/operators','_snapshotService','_docSkeletonManagerService','saveOfflineData','disposeWithMe','subunit','_themeService','EXCHANGE_UPLOAD_FILE_SERVER_URL_KEY','_registerRenderDependencies','ERROR_IMAGE','HEARTBEAT_TIMEOUT','method','updateCursorEvent','_waitCount','isPermissionRej','roomMembers$','SNAPSHOT_HAS_BEEN_REMOVED','_saveTaskMap','cmd','complete','getAncestorScale','_transformIMECache','collabStatus.syncing','dispose','HELLO','document','_getCurrentRevision','_syncEditingCollabCursor','_incrementRevisionNumber','setCurrentUser','registerRefRange','_transformUndoRedoStack','_lockTransition','CollaborationSession','_timeoutTimer','session.room-full','FETCH_MISS','charCodeAt','_onMessage','setActiveRange','delete','handleIRemoveCol','_color','_snapshotServerService','attrs','use','_entities','loadDoc','_state$','ILogService','urlChange$','parseChangesetToProtocol','_scheduleSaving','routeKey','useObservable','searchParams','onSyncEditingCollabCursor','RemoveRowCommandId','pushState','/object/','transformChangesets','collaboration.single-unit.warning','ranges','UNKNOWN_CMD','values','WebURLService','Vector2','_docSyncEditingCollabCursorService','[PendingState]:\x20received\x20acknowledgement.','/unit/','mapDocumentTypeToUniverType','_singleActiveUnitService','POST','defineProperty','_unitOnClients','Optional','InsertSheetMutation','state','_onRecvEvent','_removeClearOtherTimer','isActive','_HTTPService','symbol','override','_drawAnchor','transformUndoRedo','endRow','_redoStacks','CollaborationSessionService','drawWith','debounceTime','RegularPolygon','_handleHeartbeatEvent','cursorInfo','_compressMutationService','ITransformService','LOGIN_URL_KEY','uni.network.url-service','SheetSkeletonManagerService','resend','#FFF','_initDeviceId','Unknown\x20user','serializeCombRequest','_renderManagerService','actions','IUndoRedoService','onTransformRemoteChangesetByIMECache','forwardRef','save\x20fail\x20reason\x20is\x20','removeParam','_textBubble','_transformStack','collabStatus.conflict','_checkMissing','_handleLeaveEvent','_sheetSkeletonManagerService','NOT_COLLAB','open$','_injector','52umEHki','COLORS','[CollaborationController]:\x20invalid\x20univer\x20type:\x20','handleIRemoveRow','getSheetObject','_clearLocalCache','_getAnchorBounding','message$','_cursor','closePath','listCollaborators','revision','liveShareNewHost','_uiPartsService','[ConflictState]:\x20invalid\x20calling\x20to\x20`resend`.','_notificationService','from','SheetCollabCursorShape','_status$','userID','APPLY_REVISION_CONFILICT','loadOfflineData','onSendChangeset','_getSendChangesetTimeout','DocStateChangeManagerService','onRemoteChangeset','SYNCED','IRemoteInstanceService','SHOULD_CLOSE_CONN','SUBMIT_CHANGESET','none','getOwnPropertySymbols','SetWorksheetActivateCommand','enableOfflineEditing','handleDeleteRangeMoveLeft','ILocalStorageService','UniverEngineRender','getConfig','merge','_schedule','UNIVER_SHEET','type','action','replace','CommentService','indexOf','16IssFzs','SnapshotServerOverHTTPService','resolve','unitId','getImage','clear','JOIN','[CollaborationSessionService]:\x20socket\x20error','RichTextEditingMutation','SNAPSHOT_URL_KEY','session.will-retry','encode','_onRemoteACK','operators','_undoStacks','/rev/','forEach','restore','_id','deepClone','_type','addEventListener','getColor','XHRHTTPImplementation','deviceId\x20is\x20empty','CONFLICT','filter','@univerjs/drawing','evenodd','_createInitialState','_collaborationPaused','CHANGESET_ACK','_registerDependencies','onMouseMove','EffectRefRangId','_updateStatus','off-line-single_clip0_910_343','rev','getWorkbookSelections','/allowed','cursorInfo$','get','_removeRoom','_updateState','_onConnectionFailed','name','SUCCUSS','getRoom','_members','ICommandService','LIVESHARE_TERMINATE','doc.mutation.rich-text-editing','color','_onRemoteRejected','url(#$1','_onCursorDelete','_decreaseWaiting','updateCollaborator','UUID','CollaborationEvent','/universer-api/stream/file/upload','storage','width','Tools','enableLocalCache','INTERNAL_ERROR','unknown','getActiveSheet','next','@univerjs/docs','toString','location','LIVESHARE_FETCH_OPERATIONS','clipPath','_assignedColors','url','1em','close','_range','getCellPositionByOffset','PERMISSION_DENIED','YUUMI_UNABLE_LOAD_URL','_createInitialStateImpl','removeMember','OFFLINE','_rescheduleHeartbeatEvent','DocSkeletonManagerService','getCollabEntity$','[SyncedState]:\x20invalid\x20calling\x20to\x20`resend`.','title','/collaborator','RemoveColCommandId','length','_colorIndex','href','PENDING','RxDisposable','prototype','IDLE','7daOkmI','_event$','you\x20should\x20override\x20\x22IUndoRedoService\x22\x20provided\x20in\x20\x22core\x22\x20package!','connection\x20error','range','DisposableCollection','getOwnPropertyDescriptor','unshift','contains','Rectangle','text','awaiting_with_pending','m2Prime','[CollaborationUndoRedoService]','AuthzIoHttpService','useDependency','TEXT_RANGE_LAYER_INDEX','_getCtorByUniverType','lodash/debounce','reject','appendMutation','collaboration.closeRoom','CollaborationController','_socket','canvas','_entityInit$','red300','onlyLocal','getUniverSheetInstance','25722fzueOe','_getRedoStack','max','No\x20remote\x20instance\x20service\x20injected.\x20May\x20not\x20syncing\x20edits\x20to\x20the\x20web\x20worker.','APPLY_NON_SEQUENTIAL_REVISION','sessionStatus','objectID','ThresholdInterceptorFactory','ws://127.0.0.1:8000/universer-api/comb/connect','CollaborationStatus','arc','_socketReady','_handler','newCsEvent','then','_initCloseConn','clearTimeout','getSheetId','collaMsg','1027395KTdUIk','CommandType','getCurrentRevForDocument','_cursors','createIdentifier','_startCollaboration','unitID::::::','awaiting','flatMap','change$','verdancy600','_applyRemoteChangeset','[OfflineState]:\x20received\x20changeset.','_hovered','registerHTTPInterceptor','enableAuthServer','height','image/jpg','_context','UniverCollaborationClientPlugin','[CollaborationSession]','getSheetBlock','_sendHeartbeat','fromEvent','_unitStatus','InsertRangeMoveRightCommandId','tag','_clearHeartbeatTimer','session','_onRemoteChangeset','USERS_LEAVE','_tryEnsureSocket','MoveRangeCommandId','_sessions','_onConflict','substring','transform','exports','@univerjs/engine-formula','/object','displayName','_getSnapshotAPIPrefix','show','collabStatus.fetchMiss','_config','_acknowledgedAwaitingChangeset','className','_refRangeService','_toggleOnline','onlineStatus','_transformRemoteChangesetByIMECache','_queuedRemoteChangesets','enableSingleActiveInstanceLock','/new_changes','5113068COHtia','div','getTypeOfUnitDisposed$','AWAITING_WITH_PENDING','/-/object/-/batch_allowed','_anchorDot','listRoles','USERS_ENTER','ACTIVE_UNIT_EVENT_CHANNEL','_colorAssignService','selections','_localCacheService','close$','BASE64','_unlockTransition','_fetchMissChangesets','collaborators','off-line-single','_executeRemoteChangeset','\x20to\x20','isTransformMutationFailure','HTTPRequest','APPLY_PERMISSION_DENIED','_roomMembers$','LICENSE_IMPORT_SIZE_EXCEEDED','Inject','COMPRESS_MUTATION_APPLY','SNAPSHOT_SERVER_URL_KEY','amd','_collaborationTimeoutTimer','takeUntil','_getSheetObject','unsubscribe','entries','infoRsp','propertyIsEnumerable','1480vWZWgh','_collabCursorState$','current','not_collab','getActiveRange','_roomMembers','_localStorageService','10nFkVUY','NOT_FOUND','_initModules','/universer-api/comb','[PendingState]:\x20unhandled\x20univer\x20type:\x20','IURLService','HTTPService','univer-online-status-title','synced','JOINING','onPointerMove$','getCoordByCell','_clearOtherTimers','_getUndoStack','beginPath','ICollaborationSocketService','updatePermissionPoint','serializeRangeWithSheet','rxjs','getMergeData','_onRefRangeChange','_getAPIPrefix','InsertRowCommandId','fetchThroughInterceptors','_render','_transitionLocked','textRanges','MUTATION','getFocusedUnit','Workbook','HEARTBEAT','/-/object/list','_sheetTransformSelectionsService','runRefRangeMutations','leaveEvent'];_0x1b3e=function(){return _0xb5addf;};return _0x1b3e();}
