function _0x5b63(_0x1db76c,_0x5f40dc){const _0x1e112f=_0x1e11();return _0x5b63=function(_0x5b63b0,_0x3520a2){_0x5b63b0=_0x5b63b0-0xad;let _0x52d948=_0x1e112f[_0x5b63b0];return _0x52d948;},_0x5b63(_0x1db76c,_0x5f40dc);}(function(_0x46f7f8,_0x595243){const _0x545151=_0x5b63,_0x16fb27=_0x46f7f8();while(!![]){try{const _0x595c38=-parseInt(_0x545151(0x207))/0x1+-parseInt(_0x545151(0x361))/0x2+-parseInt(_0x545151(0x30f))/0x3+parseInt(_0x545151(0xae))/0x4*(-parseInt(_0x545151(0x401))/0x5)+parseInt(_0x545151(0x259))/0x6*(parseInt(_0x545151(0x495))/0x7)+parseInt(_0x545151(0x49d))/0x8+-parseInt(_0x545151(0x41d))/0x9*(-parseInt(_0x545151(0x1e9))/0xa);if(_0x595c38===_0x595243)break;else _0x16fb27['push'](_0x16fb27['shift']());}catch(_0x109758){_0x16fb27['push'](_0x16fb27['shift']());}}}(_0x1e11,0xb4013),function(_0x588a11,_0x3c520c){const _0x5664e5=_0x5b63;typeof exports==_0x5664e5(0x497)&&typeof module<'u'?_0x3c520c(exports,require(_0x5664e5(0x21f)),require(_0x5664e5(0x2c0)),require(_0x5664e5(0x1a6)),require(_0x5664e5(0x364)),require(_0x5664e5(0x21a)),require(_0x5664e5(0x282)),require(_0x5664e5(0x2a7)),require('@univerjs/docs'),require(_0x5664e5(0x2a0)),require(_0x5664e5(0x122)),require(_0x5664e5(0x278)),require(_0x5664e5(0x2c4)),require('lodash/debounce'),require('@univerjs/sheets-ui'),require(_0x5664e5(0x2b0)),require(_0x5664e5(0x275)),require(_0x5664e5(0x49f))):typeof define=='function'&&define[_0x5664e5(0x172)]?define([_0x5664e5(0x320),_0x5664e5(0x21f),'@univerjs/sheets','@univerjs/design',_0x5664e5(0x364),'@univerjs-pro/collaboration','rxjs','rxjs/operators',_0x5664e5(0x244),_0x5664e5(0x2a0),_0x5664e5(0x122),_0x5664e5(0x278),_0x5664e5(0x2c4),_0x5664e5(0x412),_0x5664e5(0x255),_0x5664e5(0x2b0),_0x5664e5(0x275),_0x5664e5(0x49f)],_0x3c520c):(_0x588a11=typeof globalThis<'u'?globalThis:_0x588a11||self,_0x3c520c(_0x588a11['UniverCollaborationClient']={},_0x588a11[_0x5664e5(0x3d0)],_0x588a11[_0x5664e5(0x17e)],_0x588a11[_0x5664e5(0x45e)],_0x588a11[_0x5664e5(0x419)],_0x588a11[_0x5664e5(0xb0)],_0x588a11[_0x5664e5(0x282)],_0x588a11[_0x5664e5(0x282)][_0x5664e5(0x14a)],_0x588a11[_0x5664e5(0x239)],_0x588a11[_0x5664e5(0x2b2)],_0x588a11[_0x5664e5(0x343)],_0x588a11[_0x5664e5(0x375)],_0x588a11[_0x5664e5(0x30a)],_0x588a11[_0x5664e5(0x47f)][_0x5664e5(0x189)],_0x588a11[_0x5664e5(0x23a)],_0x588a11[_0x5664e5(0x139)],_0x588a11[_0x5664e5(0x275)],_0x588a11['UniverRpc']));}(this,function(_0x481c9f,_0x24e1ed,_0x5e02d9,_0x49b15b,_0x279279,_0x3c4c3c,_0x5ba5b9,_0xb49021,_0x2c946a,_0x2df7e0,_0x35d26c,_0x15516e,_0x47c5bb,_0x5156bc,_0x5a7986,_0x539127,_0x251dff,_0x1392e7){'use strict';const _0x3ceef6=_0x5b63;var _0x2fd66a=Object[_0x3ceef6(0x2d1)],_0x113a41=(_0x599e87,_0x54b738,_0x13c53e)=>_0x54b738 in _0x599e87?_0x2fd66a(_0x599e87,_0x54b738,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x13c53e}):_0x599e87[_0x54b738]=_0x13c53e,_0x1b84ec=(_0x54666a,_0xdd2550,_0x357cb4)=>_0x113a41(_0x54666a,typeof _0xdd2550!=_0x3ceef6(0x32e)?_0xdd2550+'':_0xdd2550,_0x357cb4);const _0x6544dc='SNAPSHOT_SERVER_URL_KEY',_0x2d8cc4=_0x3ceef6(0x2e9),_0x53b238=_0x3ceef6(0x415),_0x274600=_0x3ceef6(0xd5),_0x4d2ef0=_0x3ceef6(0x21d),_0x51f828=_0x3ceef6(0x19c),_0x48841c=_0x3ceef6(0x16c),_0x9d9eaa=_0x3ceef6(0x411),_0x4723af=_0x3ceef6(0x384),_0x1006fb=_0x3ceef6(0x3b5),_0x4d3b79=_0x3ceef6(0x1a7),_0x40ed60='COLLAB_SUBMIT_CHANGESET_URL',_0x46be35=_0x3ceef6(0x399),_0x45de66=_0x3ceef6(0x404),_0x56de3f='/universer-api/oidc/authpage';var _0x2aa5e9=(_0x227cde=>(_0x227cde[_0x227cde[_0x3ceef6(0x395)]=0x0]=_0x3ceef6(0x395),_0x227cde[_0x227cde['OK']=0x1]='OK',_0x227cde[_0x227cde[_0x3ceef6(0x1f0)]=0x2]=_0x3ceef6(0x1f0),_0x227cde[_0x227cde[_0x3ceef6(0x3d3)]=0x3]='PERMISSION_DENIED',_0x227cde[_0x227cde['NOT_FOUND']=0x4]='NOT_FOUND',_0x227cde[_0x227cde[_0x3ceef6(0xf9)]=0x5]=_0x3ceef6(0xf9),_0x227cde[_0x227cde[_0x3ceef6(0x3d7)]=0x6]=_0x3ceef6(0x3d7),_0x227cde[_0x227cde[_0x3ceef6(0x134)]=0x7]='INVALID_ARGUMENT',_0x227cde[_0x227cde['TOO_MANY_REQUESTS']=0x8]=_0x3ceef6(0x2de),_0x227cde[_0x227cde[_0x3ceef6(0x3f1)]=0x9]=_0x3ceef6(0x3f1),_0x227cde[_0x227cde[_0x3ceef6(0xd6)]=0x1389]=_0x3ceef6(0xd6),_0x227cde[_0x227cde[_0x3ceef6(0x416)]=0x1771]=_0x3ceef6(0x416),_0x227cde[_0x227cde[_0x3ceef6(0x344)]=0x1772]='SNAPSHOT_HAS_BEEN_REMOVED',_0x227cde[_0x227cde[_0x3ceef6(0x3a9)]=0x1b59]=_0x3ceef6(0x3a9),_0x227cde[_0x227cde[_0x3ceef6(0x488)]=0x1b5a]=_0x3ceef6(0x488),_0x227cde[_0x227cde[_0x3ceef6(0x2d4)]=0x1b5b]=_0x3ceef6(0x2d4),_0x227cde[_0x227cde[_0x3ceef6(0x2ff)]=0x1b5c]=_0x3ceef6(0x2ff),_0x227cde[_0x227cde[_0x3ceef6(0x367)]=0x1f41]=_0x3ceef6(0x367),_0x227cde[_0x227cde['LICENSE_MAX_UNITS_EXCEEDED']=0x2329]='LICENSE_MAX_UNITS_EXCEEDED',_0x227cde[_0x227cde[_0x3ceef6(0xd9)]=0x232a]=_0x3ceef6(0xd9),_0x227cde[_0x227cde[_0x3ceef6(0x459)]=0x232b]='LICENSE_IMPORT_SIZE_EXCEEDED',_0x227cde[_0x227cde[_0x3ceef6(0x324)]=0x232c]=_0x3ceef6(0x324),_0x227cde[_0x227cde[_0x3ceef6(0x33b)]=0x232d]=_0x3ceef6(0x33b),_0x227cde[_0x227cde[_0x3ceef6(0x3fd)]=0x2711]=_0x3ceef6(0x3fd),_0x227cde[_0x227cde[_0x3ceef6(0x31d)]=0x2712]='YUUMI_URL_COL_OUT_OF_RANGE',_0x227cde[_0x227cde['UNRECOGNIZED']=-0x1]='UNRECOGNIZED',_0x227cde))(_0x2aa5e9||{}),_0x1a91ec=(_0x4b37f9=>(_0x4b37f9[_0x4b37f9['UNIVER_UNKNOWN']=0x0]=_0x3ceef6(0x2a4),_0x4b37f9[_0x4b37f9['UNIVER_DOC']=0x1]=_0x3ceef6(0x192),_0x4b37f9[_0x4b37f9['UNIVER_SHEET']=0x2]='UNIVER_SHEET',_0x4b37f9[_0x4b37f9[_0x3ceef6(0x39c)]=0x3]=_0x3ceef6(0x39c),_0x4b37f9[_0x4b37f9['UNRECOGNIZED']=-0x1]=_0x3ceef6(0x3a6),_0x4b37f9))(_0x1a91ec||{}),_0x3d863f=(_0xffece=>(_0xffece[_0xffece['UNKNOWN_CMD']=0x0]=_0x3ceef6(0x3d8),_0xffece[_0xffece[_0x3ceef6(0x2b6)]=0x1]=_0x3ceef6(0x2b6),_0xffece[_0xffece[_0x3ceef6(0x433)]=0x2]=_0x3ceef6(0x433),_0xffece[_0xffece[_0x3ceef6(0x417)]=0x3]=_0x3ceef6(0x417),_0xffece[_0xffece[_0x3ceef6(0x1bc)]=0x4]='INGEST',_0xffece[_0xffece[_0x3ceef6(0x39d)]=0x5]=_0x3ceef6(0x39d),_0xffece[_0xffece['RECV']=0x6]=_0x3ceef6(0x43d),_0xffece[_0xffece[_0x3ceef6(0x3a6)]=-0x1]=_0x3ceef6(0x3a6),_0xffece))(_0x3d863f||{}),_0x30d274=(_0x774dd2=>(_0x774dd2[_0x774dd2[_0x3ceef6(0x3d2)]=0x0]=_0x3ceef6(0x3d2),_0x774dd2[_0x774dd2['OK']=0x1]='OK',_0x774dd2[_0x774dd2['FAIL']=0x2]='FAIL',_0x774dd2[_0x774dd2[_0x3ceef6(0x3a6)]=-0x1]='UNRECOGNIZED',_0x774dd2))(_0x30d274||{}),_0xda665e=Object[_0x3ceef6(0x2d1)],_0x21252f=Object[_0x3ceef6(0x3fa)],_0x16c379=(_0x240775,_0x5b7bfa,_0x168635,_0x1b1997)=>{const _0x38f248=_0x3ceef6;for(var _0x3ecc17=_0x1b1997>0x1?void 0x0:_0x1b1997?_0x21252f(_0x5b7bfa,_0x168635):_0x5b7bfa,_0x16f864=_0x240775[_0x38f248(0x346)]-0x1,_0x18a584;_0x16f864>=0x0;_0x16f864--)(_0x18a584=_0x240775[_0x16f864])&&(_0x3ecc17=(_0x1b1997?_0x18a584(_0x5b7bfa,_0x168635,_0x3ecc17):_0x18a584(_0x3ecc17))||_0x3ecc17);return _0x1b1997&&_0x3ecc17&&_0xda665e(_0x5b7bfa,_0x168635,_0x3ecc17),_0x3ecc17;},_0xe3d2fc=(_0x559b6d,_0x38db97)=>(_0x3a03f8,_0x2cb0d2)=>_0x38db97(_0x3a03f8,_0x2cb0d2,_0x559b6d);let _0x29dad0=class extends _0x24e1ed['Disposable']{constructor(_0x4f95ee,_0x3ef8fa){const _0x35234b=_0x3ceef6;super(),_0x1b84ec(this,_0x35234b(0x123),new Map()),(this[_0x35234b(0x198)]=_0x4f95ee,this[_0x35234b(0x487)]=_0x3ef8fa,this[_0x35234b(0x184)](_0x24e1ed[_0x35234b(0x18f)](_0x5ba5b9[_0x35234b(0x36f)](this[_0x35234b(0x198)]['getTypeOfUnitDisposed$'](_0x24e1ed['UniverInstanceType'][_0x35234b(0x2b3)])[_0x35234b(0x30e)](_0xb49021[_0x35234b(0x315)](_0x9db28e=>_0x9db28e[_0x35234b(0x398)]())),this[_0x35234b(0x198)][_0x35234b(0x1fd)](_0x24e1ed[_0x35234b(0x1dd)]['UNIVER_DOC'])[_0x35234b(0x30e)](_0xb49021[_0x35234b(0x315)](_0x104f08=>_0x104f08['getUnitId']())),this[_0x35234b(0x198)][_0x35234b(0x1fd)](_0x24e1ed[_0x35234b(0x1dd)][_0x35234b(0x39c)])[_0x35234b(0x30e)](_0xb49021[_0x35234b(0x315)](_0x14893f=>_0x14893f[_0x35234b(0x398)]())))[_0x35234b(0x1b0)](_0x4edb29=>this['_removeRoom'](_0x4edb29)))));}[_0x3ceef6(0x3a1)](_0x18f759){this['_userManagerService']['setCurrentUser'](_0x18f759);}[_0x3ceef6(0x272)](){const _0x22f0e0=_0x3ceef6;return this[_0x22f0e0(0x487)]['getCurrentUser']();}[_0x3ceef6(0x13f)](_0x449c57,_0x4e6924){const _0x290e61=_0x3ceef6;let _0x2a6967=this[_0x290e61(0x123)][_0x290e61(0x414)](_0x449c57);_0x2a6967||(_0x2a6967=new _0x30b1ed(),this[_0x290e61(0x123)]['set'](_0x449c57,_0x2a6967)),_0x2a6967[_0x290e61(0x13f)](_0x4e6924);}[_0x3ceef6(0x356)](_0x4750bf,_0x26e07a){const _0x181516=_0x3ceef6,_0x33ed96=this[_0x181516(0x123)]['get'](_0x4750bf);_0x33ed96&&_0x33ed96[_0x181516(0x356)](_0x26e07a);}[_0x3ceef6(0x268)](_0x50f63a){const _0x20a17d=_0x3ceef6;return this[_0x20a17d(0x123)][_0x20a17d(0x414)](_0x50f63a);}[_0x3ceef6(0x468)](_0x519b92,_0x23f472){const _0x296834=_0x3ceef6,_0x28b1b2=this['_roomMembers']['get'](_0x519b92);if(_0x28b1b2)return _0x28b1b2[_0x296834(0x468)](_0x23f472);}[_0x3ceef6(0x2b5)](_0x384a9a){const _0x33baa0=_0x3ceef6,_0x374de7=this[_0x33baa0(0x123)][_0x33baa0(0x414)](_0x384a9a);_0x374de7&&(_0x374de7['dispose'](),this['_roomMembers'][_0x33baa0(0x15d)](_0x384a9a));}[_0x3ceef6(0x377)](){const _0x5b6c71=_0x3ceef6;this[_0x5b6c71(0x123)][_0x5b6c71(0x115)](_0x19b30d=>_0x19b30d[_0x5b6c71(0x377)]()),this['_roomMembers'][_0x5b6c71(0x3a5)]();}};_0x29dad0=_0x16c379([_0xe3d2fc(0x0,_0x24e1ed[_0x3ceef6(0x36c)]),_0xe3d2fc(0x1,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x448)]))],_0x29dad0);class _0x30b1ed extends _0x24e1ed['Disposable']{constructor(){const _0x362918=_0x3ceef6;super(...arguments),_0x1b84ec(this,_0x362918(0x118),new Map());}[_0x3ceef6(0x377)](){const _0x1aea20=_0x3ceef6;this[_0x1aea20(0x118)][_0x1aea20(0x3a5)]();}[_0x3ceef6(0x13f)](_0x3514f5){const _0x27759d=_0x3ceef6;this[_0x27759d(0x118)][_0x27759d(0xe7)](_0x3514f5[_0x27759d(0x2ae)],_0x3514f5);}['removeMember'](_0x30dbd4){const _0x3b286f=_0x3ceef6;this['_members'][_0x3b286f(0x15d)](_0x30dbd4);}[_0x3ceef6(0x468)](_0x1d7d4f){const _0x814977=_0x3ceef6;return this[_0x814977(0x118)][_0x814977(0x414)](_0x1d7d4f);}}function _0x1ada2b(_0x32fa1c){const _0x4532ca=_0x3ceef6;var _0x5b29d8,_0x357d67,_0x818319,_0x5a4f96;const _0x5a75c7=_0x32fa1c['data'],_0x1aeee2=JSON[_0x4532ca(0x27d)](_0x5a75c7);switch(_0x1aeee2[_0x4532ca(0x310)]){case _0x3d863f['HEARTBEAT']:case _0x3d863f['HELLO']:{const _0x5f4728=_0x1aeee2[_0x4532ca(0x423)];return{..._0x1aeee2,'data':_0x5f4728,'cmd':_0x1aeee2[_0x4532ca(0x310)]};}case _0x3d863f[_0x4532ca(0x433)]:{const _0x374279=_0x1aeee2[_0x4532ca(0x265)];return{..._0x1aeee2,'data':_0x374279,'cmd':_0x1aeee2[_0x4532ca(0x310)]};}case _0x3d863f[_0x4532ca(0x43d)]:{const _0x388a99=_0x1aeee2[_0x4532ca(0x3ea)];switch(_0x388a99[_0x4532ca(0x17c)]){case _0x3c4c3c[_0x4532ca(0x3ce)][_0x4532ca(0x2d0)]:return{..._0x1aeee2,'data':{..._0x388a99,'data':(_0x5b29d8=_0x388a99['permissionRejEvent'])==null?void 0x0:_0x5b29d8['cs']},'cmd':_0x1aeee2[_0x4532ca(0x310)]};case _0x3c4c3c[_0x4532ca(0x3ce)][_0x4532ca(0x1d5)]:return{..._0x1aeee2,'data':{..._0x388a99,'data':(_0x357d67=_0x388a99[_0x4532ca(0x345)])==null?void 0x0:_0x357d67['cs']},'cmd':_0x1aeee2[_0x4532ca(0x310)]};case _0x3c4c3c['CollaborationEvent'][_0x4532ca(0xfd)]:return{..._0x1aeee2,'data':{..._0x388a99,'data':(_0x818319=_0x388a99[_0x4532ca(0x2e2)])==null?void 0x0:_0x818319['cs']},'cmd':_0x1aeee2[_0x4532ca(0x310)]};case _0x3c4c3c[_0x4532ca(0x3ce)][_0x4532ca(0x29f)]:return{..._0x1aeee2,'data':{..._0x388a99,'data':(_0x5a4f96=_0x388a99['csRejEvent'])==null?void 0x0:_0x5a4f96['cs']},'cmd':_0x1aeee2[_0x4532ca(0x310)]};case _0x3c4c3c[_0x4532ca(0x3ce)][_0x4532ca(0x362)]:return{..._0x1aeee2,'data':{..._0x388a99,'data':_0x388a99[_0x4532ca(0x4a0)]},'cmd':_0x1aeee2[_0x4532ca(0x310)]};case _0x3c4c3c['CollaborationEvent'][_0x4532ca(0xc0)]:return{..._0x1aeee2,'data':{..._0x388a99,'data':_0x388a99[_0x4532ca(0xe9)]},'cmd':_0x1aeee2[_0x4532ca(0x310)]};case _0x3c4c3c[_0x4532ca(0x3ce)][_0x4532ca(0x45b)]:return{..._0x1aeee2,'data':{..._0x388a99,'data':_0x388a99[_0x4532ca(0x443)]},'cmd':_0x1aeee2['cmd']};case _0x3c4c3c['CollaborationEvent']['LIVESHARE_NEW_HOST']:return{..._0x1aeee2,'data':{..._0x388a99,'data':_0x388a99['liveShareNewHost']},'cmd':_0x1aeee2[_0x4532ca(0x310)]};case _0x3c4c3c['CollaborationEvent']['LIVESHARE_FETCH_OPERATIONS']:case _0x3c4c3c[_0x4532ca(0x3ce)][_0x4532ca(0x1f9)]:return{..._0x1aeee2,'data':{..._0x388a99,'data':_0x388a99[_0x4532ca(0x110)]},'cmd':_0x1aeee2[_0x4532ca(0x310)]};case _0x3c4c3c['CollaborationEvent']['LIVESHARE_TERMINATE']:return{..._0x1aeee2,'data':{..._0x388a99,'data':_0x388a99['liveShareNewHost']},'cmd':_0x1aeee2[_0x4532ca(0x310)]};case _0x3c4c3c[_0x4532ca(0x3ce)][_0x4532ca(0x44d)]:return{..._0x1aeee2,'data':_0x388a99,'cmd':_0x1aeee2[_0x4532ca(0x310)]};case _0x3c4c3c[_0x4532ca(0x3ce)][_0x4532ca(0x176)]:return{..._0x1aeee2,'data':{..._0x388a99,'data':_0x388a99[_0x4532ca(0x2cf)]},'cmd':_0x1aeee2[_0x4532ca(0x310)]};case _0x3c4c3c['CollaborationEvent']['UPDATE_PERMISSION_OBJ']:return{..._0x1aeee2,'data':{..._0x388a99,'data':_0x388a99[_0x4532ca(0x215)]},'cmd':_0x1aeee2[_0x4532ca(0x310)]};case _0x3c4c3c[_0x4532ca(0x3ce)][_0x4532ca(0x3c8)]:return{..._0x1aeee2,'data':{..._0x388a99,'data':_0x388a99[_0x4532ca(0x1ff)]},'cmd':_0x1aeee2[_0x4532ca(0x310)]};default:return _0x1aeee2;}}default:return _0x1aeee2;}}function _0x3a7309(_0x1a1756){const _0x193f00=_0x3ceef6;switch(_0x1a1756[_0x193f00(0x310)]){case _0x3d863f[_0x193f00(0x39d)]:case _0x3d863f['HELLO']:return JSON[_0x193f00(0x1b1)]({'cmd':_0x1a1756[_0x193f00(0x310)],'routeKey':_0x1a1756[_0x193f00(0x3e8)]});case _0x3d863f[_0x193f00(0x1bc)]:{let _0x14243a;switch(_0x1a1756[_0x193f00(0x2e4)]['eventID']){case _0x3c4c3c['CollaborationEvent'][_0x193f00(0x362)]:{_0x14243a={'eventID':_0x3c4c3c['CollaborationEvent'][_0x193f00(0x362)],'updateCursorEvent':_0x1a1756[_0x193f00(0x2e4)][_0x193f00(0x2e4)]};break;}case _0x3c4c3c[_0x193f00(0x3ce)]['USERS_LEAVE']:{_0x14243a={'eventID':_0x3c4c3c['CollaborationEvent'][_0x193f00(0x45b)],'leaveEvent':_0x1a1756[_0x193f00(0x2e4)][_0x193f00(0x2e4)]};break;}case _0x3c4c3c['CollaborationEvent']['USERS_ENTER']:{_0x14243a={'eventID':_0x3c4c3c[_0x193f00(0x3ce)][_0x193f00(0xc0)],'joinEvent':_0x1a1756[_0x193f00(0x2e4)][_0x193f00(0x2e4)]};break;}case _0x3c4c3c[_0x193f00(0x3ce)][_0x193f00(0x40c)]:{_0x14243a={'eventID':_0x3c4c3c[_0x193f00(0x3ce)][_0x193f00(0x40c)],'liveShareNewHost':_0x1a1756[_0x193f00(0x2e4)]['data']};break;}case _0x3c4c3c[_0x193f00(0x3ce)][_0x193f00(0x1f9)]:{_0x14243a={'eventID':_0x3c4c3c[_0x193f00(0x3ce)][_0x193f00(0x1f9)],'liveShareOperation':_0x1a1756[_0x193f00(0x2e4)][_0x193f00(0x2e4)]};break;}case _0x3c4c3c[_0x193f00(0x3ce)]['LIVESHARE_TERMINATE']:{_0x14243a={'eventID':_0x3c4c3c[_0x193f00(0x3ce)][_0x193f00(0x1c8)],'liveShareTerminate':_0x1a1756['data']['data']};break;}case _0x3c4c3c['CollaborationEvent'][_0x193f00(0x354)]:{_0x14243a={'eventID':_0x3c4c3c['CollaborationEvent'][_0x193f00(0x354)],'liveShareRequestHost':_0x1a1756[_0x193f00(0x2e4)][_0x193f00(0x2e4)]};break;}case _0x3c4c3c[_0x193f00(0x3ce)]['LIVESHARE_FETCH_OPERATIONS']:{_0x14243a={'eventID':_0x3c4c3c[_0x193f00(0x3ce)][_0x193f00(0x3ec)]};break;}default:_0x14243a={'eventID':_0x1a1756[_0x193f00(0x2e4)]['eventID']};}return JSON[_0x193f00(0x1b1)]({'cmd':_0x1a1756['cmd'],'routeKey':_0x1a1756[_0x193f00(0x3e8)],'collaMsg':_0x14243a});}case _0x3d863f[_0x193f00(0x433)]:return JSON[_0x193f00(0x1b1)]({'cmd':_0x1a1756[_0x193f00(0x310)],'routeKey':_0x1a1756['routeKey'],'joinReq':_0x1a1756[_0x193f00(0x2e4)]});case _0x3d863f[_0x193f00(0x417)]:return JSON[_0x193f00(0x1b1)]({'cmd':_0x1a1756[_0x193f00(0x310)],'routeKey':_0x1a1756['routeKey'],'leaveReq':_0x1a1756[_0x193f00(0x2e4)]});default:throw new Error('[serializeCombRequest]:\x20should\x20not\x20fall\x20into\x20default\x20branch!');}}var _0x34608a=Object[_0x3ceef6(0x2d1)],_0x4a922f=Object['getOwnPropertyDescriptor'],_0x2c4c90=(_0x438e82,_0x4c7152,_0x465902,_0x4f5683)=>{const _0x5c7866=_0x3ceef6;for(var _0x32adf2=_0x4f5683>0x1?void 0x0:_0x4f5683?_0x4a922f(_0x4c7152,_0x465902):_0x4c7152,_0x1dc411=_0x438e82[_0x5c7866(0x346)]-0x1,_0x34f1c7;_0x1dc411>=0x0;_0x1dc411--)(_0x34f1c7=_0x438e82[_0x1dc411])&&(_0x32adf2=(_0x4f5683?_0x34f1c7(_0x4c7152,_0x465902,_0x32adf2):_0x34f1c7(_0x32adf2))||_0x32adf2);return _0x4f5683&&_0x32adf2&&_0x34608a(_0x4c7152,_0x465902,_0x32adf2),_0x32adf2;},_0x47b2a9=(_0x4921db,_0x484bda)=>(_0x5101e3,_0x172500)=>_0x484bda(_0x5101e3,_0x172500,_0x4921db);const _0x21ae3a=_0x24e1ed[_0x3ceef6(0x381)]('univer-pro.collaboration-client-socket-service');function _0x491a82(_0x20d24f,_0x33d2f3,_0x918178){const _0x2672f0=_0x3ceef6;return _0x20d24f+'/'+_0x33d2f3+_0x2672f0(0xc2)+_0x918178+_0x2672f0(0x407);}_0x481c9f[_0x3ceef6(0x35b)]=class{constructor(_0x583276,_0x1a75e3,_0x2d0191,_0x1f10cf,_0x31e8d1){const _0x3bfa1b=_0x3ceef6;this[_0x3bfa1b(0x372)]=_0x583276,this[_0x3bfa1b(0x136)]=_0x1a75e3,this[_0x3bfa1b(0x421)]=_0x2d0191,this[_0x3bfa1b(0x256)]=_0x1f10cf,this[_0x3bfa1b(0x2bf)]=_0x31e8d1;}['createSocket'](_0x3bd8b2){const _0xd167f2=_0x3ceef6,_0x5e6d42=this[_0xd167f2(0x136)]['createSocket'](_0x3bd8b2);if(!_0x5e6d42)throw new Error(_0xd167f2(0x481));const _0x1a67bf=new _0x24e1ed[(_0xd167f2(0x47e))](),_0x576975=new _0x5ba5b9[(_0xd167f2(0x34f))]();_0x1a67bf[_0xd167f2(0x46d)](_0x24e1ed['toDisposable'](_0x5e6d42[_0xd167f2(0x280)][_0xd167f2(0x1b0)](_0x432480=>_0x576975[_0xd167f2(0x48b)](_0x432480)))),_0x1a67bf[_0xd167f2(0x46d)](_0x24e1ed[_0xd167f2(0x18f)](()=>_0x576975[_0xd167f2(0x22c)]()));const _0x260ea8=new _0x5ba5b9[(_0xd167f2(0x34f))]();_0x1a67bf[_0xd167f2(0x46d)](_0x24e1ed[_0xd167f2(0x18f)](_0x5e6d42[_0xd167f2(0x23f)][_0xd167f2(0x1b0)](_0x522da9=>_0x260ea8['next'](_0x522da9)))),_0x1a67bf[_0xd167f2(0x46d)](_0x24e1ed[_0xd167f2(0x18f)](()=>_0x260ea8[_0xd167f2(0x22c)]()));const _0x2fc062=new _0x5ba5b9[(_0xd167f2(0x34f))]();_0x1a67bf[_0xd167f2(0x46d)](_0x24e1ed['toDisposable'](_0x5e6d42[_0xd167f2(0x27b)][_0xd167f2(0x1b0)](_0x1669eb=>{const _0x316992=_0x1ada2b(_0x1669eb);_0x2fc062['next'](_0x316992);}))),_0x1a67bf[_0xd167f2(0x46d)](_0x24e1ed[_0xd167f2(0x18f)](()=>_0x2fc062[_0xd167f2(0x22c)]()));const _0x5ebca7=()=>{const _0x802d84=_0xd167f2;_0x260ea8[_0x802d84(0x48b)](new Event(_0x802d84(0x218))),_0x576975[_0x802d84(0x48b)](new CloseEvent('connection\x20error')),_0x570dc8['close']();},_0x570dc8={'memberID':'','close$':_0x576975['asObservable'](),'error$':_0x260ea8[_0xd167f2(0x2ce)](),'open$':_0x5e6d42['open$'],'message$':_0x2fc062['asObservable'](),'send':_0x314a40=>{const _0x5f2dbf=_0xd167f2;if(_0x314a40[_0x5f2dbf(0x310)]===_0x3d863f['INGEST']){if(_0x314a40[_0x5f2dbf(0x2e4)][_0x5f2dbf(0x17c)]===_0x3c4c3c[_0x5f2dbf(0x3ce)][_0x5f2dbf(0x426)]){this[_0x5f2dbf(0x125)](_0x570dc8,_0x314a40[_0x5f2dbf(0x2e4)])[_0x5f2dbf(0x153)](_0x37911e=>{const _0x3501a0=_0x5f2dbf;this[_0x3501a0(0x256)][_0x3501a0(0x457)](_0x37911e),_0x5ebca7();});return;}if(_0x314a40[_0x5f2dbf(0x2e4)]['eventID']===_0x3c4c3c[_0x5f2dbf(0x3ce)]['FETCH_MISSING']){const _0x13ae1a=_0x314a40['data'];this['_fetchMissChangesets'](_0x13ae1a)['then'](_0x400ea4=>{const _0x523ef1=_0x5f2dbf;_0x2fc062['next']({'cmd':_0x3d863f[_0x523ef1(0x43d)],'code':_0x30d274['OK'],'routeKey':_0x13ae1a['data'][_0x523ef1(0x208)],'routeType':'','data':{'eventID':_0x3c4c3c[_0x523ef1(0x3ce)]['PSEUDO_FETCH_MISSING_RESULT'],'data':{'changesets':_0x400ea4}}});})[_0x5f2dbf(0x153)](_0x1ed1ee=>{const _0x3a06bd=_0x5f2dbf;this[_0x3a06bd(0x256)][_0x3a06bd(0x457)](_0x1ed1ee),_0x5ebca7();});return;}}_0x5e6d42[_0x5f2dbf(0x42c)](_0x3a7309(_0x314a40));},'close':()=>{const _0x4c7480=_0xd167f2;_0x5e6d42[_0x4c7480(0x3bc)](),_0x1a67bf[_0x4c7480(0x377)]();}};return _0x570dc8;}async['_submitChangeset'](_0x5ebaf0,_0x38234e){const _0x4f1c11=_0x3ceef6;var _0x5b0829;const {unitType:_0x5b8004,unitID:_0x3c5f0e,changeset:_0x532259}=_0x38234e[_0x4f1c11(0x2e4)],_0x462108={'unitID':_0x3c5f0e,'memberID':_0x5ebaf0[_0x4f1c11(0x2ae)],'type':_0x5b8004,'changeset':_0x3c4c3c['parseChangesetToProtocol'](_0x532259)},_0x1569e3=_0x491a82((_0x5b0829=this[_0x4f1c11(0x421)][_0x4f1c11(0x10b)](_0x40ed60))!=null?_0x5b0829:_0x46be35,_0x5b8004,_0x3c5f0e);try{await this['_http'][_0x4f1c11(0x290)](_0x1569e3,{'body':_0x462108});}catch(_0x273a19){throw this['_logService'][_0x4f1c11(0x457)](_0x4f1c11(0x307),_0x4f1c11(0x439)),_0x273a19;}}async[_0x3ceef6(0x34e)](_0x5b3458){const _0x32cb1f=_0x3ceef6,{unitID:_0x48d9ad,from:_0x462bae,to:_0x2c30e5,unitType:_0x203998}=_0x5b3458[_0x32cb1f(0x2e4)];return(await this[_0x32cb1f(0x2bf)][_0x32cb1f(0x2e7)]({'metadata':void 0x0},{'unitID':_0x48d9ad,'type':_0x203998,'from':_0x462bae,'to':_0x2c30e5}))[_0x32cb1f(0x32b)];}},_0x481c9f[_0x3ceef6(0x35b)]=_0x2c4c90([_0x47b2a9(0x0,_0x24e1ed['Inject'](_0x2df7e0[_0x3ceef6(0x3ed)])),_0x47b2a9(0x1,_0x24e1ed[_0x3ceef6(0x48f)](_0x2df7e0[_0x3ceef6(0x16a)])),_0x47b2a9(0x2,_0x24e1ed[_0x3ceef6(0x476)]),_0x47b2a9(0x3,_0x24e1ed[_0x3ceef6(0x250)]),_0x47b2a9(0x4,_0x24e1ed['ISnapshotServerService'])],_0x481c9f[_0x3ceef6(0x35b)]);class _0x34d671{constructor(){const _0x4e5d22=_0x3ceef6;_0x1b84ec(this,'_commentUpdate$',new _0x5ba5b9[(_0x4e5d22(0x34f))]()),_0x1b84ec(this,_0x4e5d22(0x2e8),this[_0x4e5d22(0x403)]['asObservable']());}[_0x3ceef6(0x13d)](_0x1072b9){const _0x5c2280=_0x3ceef6;this['_commentUpdate$'][_0x5c2280(0x48b)](_0x1072b9);}}var _0x37bfee=Object[_0x3ceef6(0x2d1)],_0x831fd=Object[_0x3ceef6(0x3fa)],_0x12d331=(_0x144146,_0x182e0f,_0x5af569,_0x1b8569)=>{const _0x596ee4=_0x3ceef6;for(var _0x37ccfc=_0x1b8569>0x1?void 0x0:_0x1b8569?_0x831fd(_0x182e0f,_0x5af569):_0x182e0f,_0x1e7937=_0x144146[_0x596ee4(0x346)]-0x1,_0x57e178;_0x1e7937>=0x0;_0x1e7937--)(_0x57e178=_0x144146[_0x1e7937])&&(_0x37ccfc=(_0x1b8569?_0x57e178(_0x182e0f,_0x5af569,_0x37ccfc):_0x57e178(_0x37ccfc))||_0x37ccfc);return _0x1b8569&&_0x37ccfc&&_0x37bfee(_0x182e0f,_0x5af569,_0x37ccfc),_0x37ccfc;},_0x1de36e=(_0x5c69f2,_0x1217a0)=>(_0x4b2c81,_0x572f7b)=>_0x1217a0(_0x4b2c81,_0x572f7b,_0x5c69f2),_0x4ad0db=(_0xd93e8f=>(_0xd93e8f[_0xd93e8f[_0x3ceef6(0x43f)]=0x0]=_0x3ceef6(0x43f),_0xd93e8f[_0xd93e8f[_0x3ceef6(0x166)]=0x1]=_0x3ceef6(0x166),_0xd93e8f[_0xd93e8f[_0x3ceef6(0x27c)]=0x2]=_0x3ceef6(0x27c),_0xd93e8f[_0xd93e8f[_0x3ceef6(0x32a)]=0x3]='ONLINE',_0xd93e8f))(_0x4ad0db||{});_0x481c9f[_0x3ceef6(0xc1)]=class extends _0x24e1ed[_0x3ceef6(0x379)]{constructor(_0xdb3efc,_0x143327,_0x2e1550,_0x39bdb2,_0x4582a6,_0x2d8617,_0xca2bae,_0x1ba1d1,_0x2ebd1f){const _0x49dd9e=_0x3ceef6;super(),_0x1b84ec(this,_0x49dd9e(0x358),new _0x5ba5b9[(_0x49dd9e(0x43c))](0x0)),_0x1b84ec(this,_0x49dd9e(0x40a),this[_0x49dd9e(0x358)][_0x49dd9e(0x2ce)]()),_0x1b84ec(this,_0x49dd9e(0x351),new _0x5ba5b9[(_0x49dd9e(0x34f))]()),_0x1b84ec(this,'event$',this[_0x49dd9e(0x351)][_0x49dd9e(0x2ce)]()),_0x1b84ec(this,_0x49dd9e(0x3ac)),_0x1b84ec(this,'_socketMessageSubscription'),_0x1b84ec(this,'_collaborationTimeoutTimer'),(this[_0x49dd9e(0x441)]=_0xdb3efc,this['_logService']=_0x2e1550,this[_0x49dd9e(0x3e3)]=_0x39bdb2,this[_0x49dd9e(0x2f6)]=_0x4582a6,this[_0x49dd9e(0x421)]=_0x2d8617,this[_0x49dd9e(0x109)]=_0xca2bae,this[_0x49dd9e(0x1e0)]=_0x1ba1d1,this['_commentService']=_0x2ebd1f,_0x143327['pipe'](_0xb49021['takeUntil'](this[_0x49dd9e(0x318)]))['subscribe'](_0x2d56d9=>{const _0xd6396d=_0x49dd9e;var _0x4609d1;typeof _0x2d56d9>'u'||(this[_0xd6396d(0x3ac)]=_0x2d56d9,_0x2d56d9?(this[_0xd6396d(0x1be)](_0x2d56d9),this[_0xd6396d(0x2db)]=this[_0xd6396d(0x3ac)][_0xd6396d(0x27b)]['subscribe'](_0x1167b9=>{const _0x1064ed=_0xd6396d;_0x1167b9[_0x1064ed(0x3e8)]===this[_0x1064ed(0x441)]&&this[_0x1064ed(0x1b5)](_0x1167b9);})):(this[_0xd6396d(0x358)][_0xd6396d(0x48b)](0x2),(_0x4609d1=this[_0xd6396d(0x2db)])==null||_0x4609d1[_0xd6396d(0x291)](),this['_socketMessageSubscription']=null));}),this['disposeWithMe'](this['_beforeCloseService'][_0x49dd9e(0x20e)](()=>{const _0x50d947=_0x49dd9e;var _0x328a18;(_0x328a18=this[_0x50d947(0x3ac)])==null||_0x328a18[_0x50d947(0x42c)]({'cmd':_0x3d863f['LEAVE'],'data':{'roomID':this[_0x50d947(0x441)]}});})));}get['sessionStatus'](){const _0x2736c2=_0x3ceef6;return this[_0x2736c2(0x358)][_0x2736c2(0x151)]();}[_0x3ceef6(0x3e9)](){const _0x2eb5f1=_0x3ceef6;var _0x34c48f,_0x1c8217;return(_0x1c8217=(_0x34c48f=this[_0x2eb5f1(0x3ac)])==null?void 0x0:_0x34c48f[_0x2eb5f1(0x2ae)])!=null?_0x1c8217:null;}[_0x3ceef6(0x377)](){const _0x5c33e8=_0x3ceef6;super[_0x5c33e8(0x377)](),this[_0x5c33e8(0x318)]['next'](),this[_0x5c33e8(0x318)][_0x5c33e8(0x22c)]();}[_0x3ceef6(0x3bc)](){const _0x2143c0=_0x3ceef6;var _0x49b42c,_0x5a05f8;(_0x49b42c=this[_0x2143c0(0x3ac)])==null||_0x49b42c['send']({'cmd':_0x3d863f[_0x2143c0(0x417)],'data':{'roomID':this[_0x2143c0(0x441)]}}),this[_0x2143c0(0x351)][_0x2143c0(0x22c)](),this['_sessionStatus$'][_0x2143c0(0x22c)](),(_0x5a05f8=this[_0x2143c0(0x3ac)])==null||_0x5a05f8[_0x2143c0(0x3bc)](),this['dispose']();}['_onCombEvent'](_0x4f9dd7){const _0x4b2c2a=_0x3ceef6;_0x4f9dd7['cmd']===_0x3d863f[_0x4b2c2a(0x433)]?this['_onJoinRoomEvent'](_0x4f9dd7):_0x4f9dd7[_0x4b2c2a(0x310)]===_0x3d863f['RECV']&&this['_onRecvEvent'](_0x4f9dd7);}[_0x3ceef6(0x1be)](_0x11fbe6){const _0x42c6ba=_0x3ceef6;this[_0x42c6ba(0x358)]['next'](0x1),_0x11fbe6[_0x42c6ba(0x42c)]({'cmd':_0x3d863f[_0x42c6ba(0x433)],'routeKey':this[_0x42c6ba(0x441)],'routeType':'','data':{'rooms':[{'roomID':this[_0x42c6ba(0x441)]}]}});}[_0x3ceef6(0x135)](_0x283e0c){const _0x111ef5=_0x3ceef6;var _0x57712c;if(_0x283e0c[_0x111ef5(0x119)]===_0x30d274[_0x111ef5(0x18e)]){this['_messageService'][_0x111ef5(0x38a)]({'type':_0x49b15b[_0x111ef5(0x1b6)][_0x111ef5(0x3c9)],'content':this['_localeService']['t']('session.room-full')}),this['_sessionStatus$']['next'](0x2);return;}this[_0x111ef5(0x358)][_0x111ef5(0x48b)](0x3);const _0x3d8fee=(_0x57712c=_0x283e0c[_0x111ef5(0x2e4)][_0x111ef5(0x16e)][this[_0x111ef5(0x441)]])==null?void 0x0:_0x57712c[_0x111ef5(0x498)];_0x3d8fee&&_0x3d8fee[_0x111ef5(0x115)](_0x3fa0ca=>this[_0x111ef5(0x1e0)][_0x111ef5(0x13f)](this[_0x111ef5(0x441)],_0x3fa0ca));}[_0x3ceef6(0x482)](_0x1bd26d){const _0x43207a=_0x3ceef6;try{const _0x1e8979=_0x1bd26d['data'];switch(_0x1e8979['eventID']){case _0x3c4c3c[_0x43207a(0x3ce)][_0x43207a(0xc0)]:this['_onUserJoin'](_0x1e8979),this['_event$'][_0x43207a(0x48b)](_0x1e8979);break;case _0x3c4c3c[_0x43207a(0x3ce)][_0x43207a(0x45b)]:this[_0x43207a(0x3b8)](_0x1e8979),this['_event$'][_0x43207a(0x48b)](_0x1e8979);break;case _0x3c4c3c[_0x43207a(0x3ce)][_0x43207a(0x1d5)]:this[_0x43207a(0x1b7)](),this[_0x43207a(0x351)][_0x43207a(0x48b)](_0x1e8979);break;case _0x3c4c3c[_0x43207a(0x3ce)]['MSG_FOR_ERROR']:this['_logService'][_0x43207a(0x457)]('save\x20fail\x20reason\x20is\x20'+JSON[_0x43207a(0x1b1)](_0x1e8979)),this[_0x43207a(0x351)]['next'](_0x1e8979);break;case _0x3c4c3c['CollaborationEvent'][_0x43207a(0x176)]:this[_0x43207a(0x25f)][_0x43207a(0x13d)](_0x1e8979[_0x43207a(0x2e4)]),this[_0x43207a(0x351)][_0x43207a(0x48b)](_0x1e8979);break;default:this[_0x43207a(0x351)]['next'](_0x1e8979);}}catch(_0x5b85af){this[_0x43207a(0x256)][_0x43207a(0x457)](_0x5b85af,_0x1bd26d);}}['_onUserJoin'](_0x4a4ea1){const _0x36d0a4=_0x3ceef6;this[_0x36d0a4(0x1e0)][_0x36d0a4(0x13f)](this['_unitID'],_0x4a4ea1['data']);}[_0x3ceef6(0x3b8)](_0x40547d){const _0x3f9579=_0x3ceef6;this[_0x3f9579(0x1e0)]['removeMember'](this[_0x3f9579(0x441)],_0x40547d[_0x3f9579(0x2e4)][_0x3f9579(0x2ae)]);}async[_0x3ceef6(0x42c)](_0x1fc238,_0xa3f7cf){const _0x3bcbe2=_0x3ceef6;if(this['sessionStatus']!==0x3||!this[_0x3bcbe2(0x3ac)])throw new Error(_0x3bcbe2(0x2a3));try{_0x1fc238['eventID']===_0x3c4c3c[_0x3bcbe2(0x3ce)][_0x3bcbe2(0xfd)]&&this['_scheduleCollaborationTimeoutTimer'](),this['_socket'][_0x3bcbe2(0x42c)]({'cmd':_0x3d863f['INGEST'],'routeKey':_0xa3f7cf,'routeType':'','data':_0x1fc238});}catch(_0x5abe28){this[_0x3bcbe2(0x256)][_0x3bcbe2(0x457)](_0x5abe28);}}[_0x3ceef6(0x496)](){const _0x484eb6=_0x3ceef6;var _0x11686c;this[_0x484eb6(0xe1)]=window[_0x484eb6(0x2d3)](()=>{const _0x2001e0=_0x484eb6;this[_0x2001e0(0xe1)]=null,this['_messageService'][_0x2001e0(0x38a)]({'type':_0x49b15b['MessageType'][_0x2001e0(0x185)],'content':this['_localeService']['t']('session.collaboration-timeout')});},(_0x11686c=this[_0x484eb6(0x421)][_0x484eb6(0x10b)](_0x9d9eaa))!=null?_0x11686c:0x2710);}['_clearCollaborationTimeoutTimer'](){const _0x37024e=_0x3ceef6;this['_collaborationTimeoutTimer']&&(clearTimeout(this[_0x37024e(0xe1)]),this[_0x37024e(0xe1)]=null);}},_0x481c9f[_0x3ceef6(0xc1)]=_0x12d331([_0x1de36e(0x2,_0x24e1ed[_0x3ceef6(0x250)]),_0x1de36e(0x3,_0x279279['IBeforeCloseService']),_0x1de36e(0x4,_0x279279['IMessageService']),_0x1de36e(0x5,_0x24e1ed['IConfigService']),_0x1de36e(0x6,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x31c)])),_0x1de36e(0x7,_0x24e1ed[_0x3ceef6(0x48f)](_0x29dad0)),_0x1de36e(0x8,_0x24e1ed['Inject'](_0x34d671))],_0x481c9f[_0x3ceef6(0xc1)]),_0x481c9f['CollaborationSessionService']=class extends _0x24e1ed[_0x3ceef6(0x26d)]{constructor(_0x5f27b6,_0x5acc9e,_0x3c7acb,_0x369be5,_0x542a5b,_0x4f8b9c){const _0x2602d2=_0x3ceef6;super(),_0x1b84ec(this,_0x2602d2(0x25c),new _0x5ba5b9[(_0x2602d2(0x43c))](void 0x0)),_0x1b84ec(this,_0x2602d2(0x12d),new Map()),_0x1b84ec(this,_0x2602d2(0xdf),new _0x5ba5b9['BehaviorSubject'](0x0)),_0x1b84ec(this,'status$',this[_0x2602d2(0xdf)][_0x2602d2(0x2ce)]()),_0x1b84ec(this,_0x2602d2(0x246),!0x1),_0x1b84ec(this,_0x2602d2(0x126)),_0x1b84ec(this,'_timeoutTimer'),_0x1b84ec(this,_0x2602d2(0x2fa)),_0x1b84ec(this,_0x2602d2(0x13b),0x0),(this['_injector']=_0x5f27b6,this[_0x2602d2(0x109)]=_0x5acc9e,this['_messageService']=_0x3c7acb,this['_logService']=_0x369be5,this['_configService']=_0x542a5b,this['_socketService']=_0x4f8b9c);}get['_socket'](){const _0x4d0e97=_0x3ceef6;return this[_0x4d0e97(0x25c)][_0x4d0e97(0x151)]();}['dispose'](){const _0x5ad806=_0x3ceef6;super[_0x5ad806(0x377)](),this['_sessions'][_0x5ad806(0x115)](_0xb7c16b=>_0xb7c16b[_0x5ad806(0x377)]()),this[_0x5ad806(0x12d)][_0x5ad806(0x3a5)](),this['_status$'][_0x5ad806(0x22c)]();}async[_0x3ceef6(0x1b9)](_0x18490f){const _0x35cb70=_0x3ceef6;if(this[_0x35cb70(0x12d)][_0x35cb70(0x245)](_0x18490f))return this[_0x35cb70(0x12d)][_0x35cb70(0x414)](_0x18490f);this[_0x35cb70(0x267)]();const _0xee6759=this[_0x35cb70(0x376)][_0x35cb70(0x1c4)](_0x481c9f[_0x35cb70(0xc1)],_0x18490f,this['_socket$'][_0x35cb70(0x2ce)]());return this[_0x35cb70(0x12d)][_0x35cb70(0xe7)](_0x18490f,_0xee6759),_0xee6759;}[_0x3ceef6(0x335)](_0x1fd5d3){const _0xa6ccd9=_0x3ceef6;var _0x48c61e;const _0x21544f=this[_0xa6ccd9(0x12d)]['get'](_0x1fd5d3);_0x21544f&&(this['_sessions']['delete'](_0x1fd5d3),_0x21544f[_0xa6ccd9(0x3bc)]()),this[_0xa6ccd9(0x12d)][_0xa6ccd9(0x1bb)]||(_0x48c61e=this[_0xa6ccd9(0x3ac)])==null||_0x48c61e[_0xa6ccd9(0x3bc)]();}['_createSocket'](){const _0x3ccdf0=_0x3ceef6;var _0x144536;const _0x3178fb=(_0x144536=this[_0x3ccdf0(0x421)]['getConfig'](_0x4d2ef0))!=null?_0x144536:_0x51f828;return this[_0x3ccdf0(0x40d)][_0x3ccdf0(0x14c)](_0x3178fb);}[_0x3ceef6(0x267)](){const _0x4ec235=_0x3ceef6;try{const _0x175b1f=this[_0x4ec235(0x32d)]();if(_0x175b1f){const _0x19976c=_0x175b1f[_0x4ec235(0x42c)];_0x175b1f[_0x4ec235(0x42c)]=_0x34486d=>(this[_0x4ec235(0x11f)](),_0x19976c[_0x4ec235(0x3b7)](_0x175b1f,[_0x34486d])),_0x175b1f['message$'][_0x4ec235(0x1b0)](_0x37ab5a=>this['_onMessage'](_0x175b1f,_0x37ab5a)),_0x175b1f[_0x4ec235(0x23f)][_0x4ec235(0x30e)](_0xb49021[_0x4ec235(0xde)](0x1))[_0x4ec235(0x1b0)](_0x38240c=>this[_0x4ec235(0x256)][_0x4ec235(0x457)](_0x4ec235(0x46e),_0x38240c)),_0x175b1f['open$']['pipe'](_0xb49021[_0x4ec235(0xde)](0x1))[_0x4ec235(0x1b0)](()=>{const _0x4279b6=_0x4ec235;this[_0x4279b6(0x2a6)](_0x175b1f);}),_0x175b1f[_0x4ec235(0x280)][_0x4ec235(0x30e)](_0xb49021[_0x4ec235(0xde)](0x1))[_0x4ec235(0x1b0)](_0x41ff2c=>{const _0x523d0d=_0x4ec235;this[_0x523d0d(0x256)][_0x523d0d(0x1f3)](_0x523d0d(0x1f1),_0x523d0d(0x191),_0x41ff2c),this[_0x523d0d(0x309)]();});}}catch(_0x3b0e4c){this['_logService']['error'](_0x3b0e4c),this[_0x4ec235(0x309)]();}}[_0x3ceef6(0x2a6)](_0x1d0171){const _0x3c0af9=_0x3ceef6;this[_0x3c0af9(0x256)][_0x3c0af9(0x1f3)](_0x3c0af9(0x1f1),'socket\x20open.'),_0x1d0171[_0x3c0af9(0x42c)]({'cmd':_0x3d863f['HELLO']}),this[_0x3c0af9(0x11f)]();}[_0x3ceef6(0x309)](){const _0x37f625=_0x3ceef6;var _0x349dab;this[_0x37f625(0xdf)][_0x37f625(0x48b)](0x2),this[_0x37f625(0x25c)][_0x37f625(0x48b)](null),this[_0x37f625(0x3ef)](),this['_clearHeartbeatTimer'](),this[_0x37f625(0x246)]=!0x1,this[_0x37f625(0x13b)]<((_0x349dab=this[_0x37f625(0x421)]['getConfig'](_0x1006fb))!=null?_0x349dab:0x3)?(this[_0x37f625(0x340)](this[_0x37f625(0x13b)]),this[_0x37f625(0x13b)]+=0x1):this[_0x37f625(0x2f6)][_0x37f625(0x38a)]({'type':_0x49b15b[_0x37f625(0x1b6)][_0x37f625(0x185)],'content':this[_0x37f625(0x109)]['t']('session.connection-failed')});}['_scheduleReconnection'](_0x52ddef){const _0x3900cb=_0x3ceef6;var _0x1ed653;const _0x4c3766=((_0x1ed653=this[_0x3900cb(0x421)][_0x3900cb(0x10b)](_0x4723af))!=null?_0x1ed653:0x4e20)*0x2**_0x52ddef;this['_messageService'][_0x3900cb(0x38a)]({'type':_0x49b15b['MessageType'][_0x3900cb(0x3c9)],'content':this['_localeService']['t']('session.will-retry')}),this[_0x3900cb(0x2fa)]=setTimeout(()=>{const _0xfd242f=_0x3900cb;this[_0xfd242f(0x267)](),clearTimeout(this[_0xfd242f(0x2fa)]),this[_0xfd242f(0x2fa)]=null;},_0x4c3766);}[_0x3ceef6(0x11f)](){const _0x153b63=_0x3ceef6;var _0x3ba118;this[_0x153b63(0x10e)](),this['_sendHeartbeatTimer']=setTimeout(()=>this[_0x153b63(0x3ab)](),(_0x3ba118=this[_0x153b63(0x421)][_0x153b63(0x10b)](_0x48841c))!=null?_0x3ba118:0x7530);}[_0x3ceef6(0x3ab)](){const _0x1e3b5b=_0x3ceef6;this[_0x1e3b5b(0x3ac)][_0x1e3b5b(0x42c)]({'cmd':_0x3d863f[_0x1e3b5b(0x39d)]}),this[_0x1e3b5b(0x1f7)]();}['_waitForHeartbeatResponse'](){const _0x39276e=_0x3ceef6;var _0x398b11;this[_0x39276e(0x3d6)]=setTimeout(()=>this[_0x39276e(0x309)](),(_0x398b11=this[_0x39276e(0x421)]['getConfig'](_0x9d9eaa))!=null?_0x398b11:0x2710);}[_0x3ceef6(0x174)](_0x5db9ee,_0x51580b){const _0x4ed2c9=_0x3ceef6,{cmd:_0x44232f}=_0x51580b;_0x44232f===_0x3d863f[_0x4ed2c9(0x2b6)]&&!this['_socketReady']&&(_0x5db9ee[_0x4ed2c9(0x2ae)]=_0x51580b[_0x4ed2c9(0x2e4)][_0x4ed2c9(0x2ae)],this[_0x4ed2c9(0x25c)]['next'](_0x5db9ee),this['_status$'][_0x4ed2c9(0x48b)](0x3),this[_0x4ed2c9(0x246)]=!0x0),_0x44232f===_0x3d863f['HEARTBEAT']&&this[_0x4ed2c9(0x3ef)](),this['_rescheduleHeartbeatEvent']();}[_0x3ceef6(0x10e)](){const _0xf1753e=_0x3ceef6;this['_sendHeartbeatTimer']!=null&&(clearTimeout(this[_0xf1753e(0x126)]),this[_0xf1753e(0x126)]=null);}[_0x3ceef6(0x3ef)](){const _0x1d402b=_0x3ceef6;this[_0x1d402b(0x3d6)]!=null&&(clearTimeout(this['_timeoutTimer']),this['_timeoutTimer']=null);}},_0x481c9f[_0x3ceef6(0x2e6)]=_0x12d331([_0x1de36e(0x0,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed['Injector'])),_0x1de36e(0x1,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed['LocaleService'])),_0x1de36e(0x2,_0x279279[_0x3ceef6(0x3a7)]),_0x1de36e(0x3,_0x24e1ed[_0x3ceef6(0x250)]),_0x1de36e(0x4,_0x24e1ed[_0x3ceef6(0x476)]),_0x1de36e(0x5,_0x21ae3a)],_0x481c9f['CollaborationSessionService']);var _0x1e0101=Object[_0x3ceef6(0x2d1)],_0x35b4f0=Object[_0x3ceef6(0x3fa)],_0x338771=(_0x283e0f,_0x364b53,_0x52ce0f,_0x930f9)=>{for(var _0x3965a9=_0x930f9>0x1?void 0x0:_0x930f9?_0x35b4f0(_0x364b53,_0x52ce0f):_0x364b53,_0x75165f=_0x283e0f['length']-0x1,_0x56bce0;_0x75165f>=0x0;_0x75165f--)(_0x56bce0=_0x283e0f[_0x75165f])&&(_0x3965a9=(_0x930f9?_0x56bce0(_0x364b53,_0x52ce0f,_0x3965a9):_0x56bce0(_0x3965a9))||_0x3965a9);return _0x930f9&&_0x3965a9&&_0x1e0101(_0x364b53,_0x52ce0f,_0x3965a9),_0x3965a9;},_0x1bbc7e=(_0x27bd46,_0x509805)=>(_0x5a6988,_0x440ae3)=>_0x509805(_0x5a6988,_0x440ae3,_0x27bd46);_0x481c9f['LocalCacheService']=class extends _0x24e1ed[_0x3ceef6(0x26d)]{constructor(_0x2e09ec,_0x12fdeb,_0x4e0eed,_0x569a8b,_0x89a4f0){const _0x3c4144=_0x3ceef6;super(),_0x1b84ec(this,'_cachedData',new Map()),_0x1b84ec(this,_0x3c4144(0x3b9),new Map()),_0x1b84ec(this,_0x3c4144(0x2d2),!0x1),(this[_0x3c4144(0x421)]=_0x2e09ec,this[_0x3c4144(0x21e)]=_0x12fdeb,this[_0x3c4144(0x3e3)]=_0x4e0eed,this['_localeService']=_0x569a8b,this['_revisionService']=_0x89a4f0,this[_0x3c4144(0x36d)]());}[_0x3ceef6(0x3aa)](){this['_disabled']=!0x0;}['enableLocalCache'](){const _0x423450=_0x3ceef6;this[_0x423450(0x2d2)]=!0x1;}[_0x3ceef6(0x377)](){const _0x1ec9cc=_0x3ceef6;this[_0x1ec9cc(0x187)]()['then'](()=>super[_0x1ec9cc(0x377)]());}async[_0x3ceef6(0x1bf)](_0xab82f6){const _0xf836e=_0x3ceef6;return this['_disabled']?null:this[_0xf836e(0x21e)][_0xf836e(0x2da)](_0x98ff01(_0xab82f6));}async[_0x3ceef6(0x1fa)](_0x3bb723,_0x1c4476){const _0x4ae6e9=_0x3ceef6;return!!this[_0x4ae6e9(0x21e)][_0x4ae6e9(0x3f7)](_0x3bb723,_0x1c4476);}[_0x3ceef6(0x37a)](_0x5a9618,_0x1facac,_0x332d49,_0x288500){const _0x4d7eb8=_0x3ceef6,_0x42e2c6=this[_0x4d7eb8(0x181)][_0x4d7eb8(0x2cb)](_0x5a9618);this[_0x4d7eb8(0x3c7)]['set'](_0x5a9618,{'unitID':_0x5a9618,'type':_0x1facac,'awaitingChangeset':_0x332d49,'mutations':_0x288500,'rev':_0x42e2c6}),this[_0x4d7eb8(0x3b9)][_0x4d7eb8(0x245)](_0x5a9618)||this[_0x4d7eb8(0x243)](_0x5a9618);}[_0x3ceef6(0x243)](_0x5a867a){const _0x24e482=_0x3ceef6,_0x214053=this['_getSaveTimeout']();_0x214053===0x0?this[_0x24e482(0x277)](_0x5a867a):this[_0x24e482(0x3b9)][_0x24e482(0xe7)](_0x5a867a,setTimeout(()=>this[_0x24e482(0x277)](_0x5a867a),_0x214053));}[_0x3ceef6(0x489)](){const _0x978544=_0x3ceef6;var _0x1cc707;return(_0x1cc707=this[_0x978544(0x421)]['getConfig'](_0x4d3b79))!=null?_0x1cc707:0x3e8;}[_0x3ceef6(0x277)](_0x2fe54e){const _0x1ba07e=_0x3ceef6,_0x2b9423=this[_0x1ba07e(0x3b9)][_0x1ba07e(0x414)](_0x2fe54e);return _0x2b9423!==void 0x0&&window[_0x1ba07e(0xc3)](_0x2b9423),this['_localStorageService']['setItem'](_0x98ff01(_0x2fe54e),this[_0x1ba07e(0x3c7)][_0x1ba07e(0x414)](_0x2fe54e))[_0x1ba07e(0x1df)](()=>this[_0x1ba07e(0x3b9)]['delete'](_0x2fe54e));}async[_0x3ceef6(0x187)](){const _0x1d456a=_0x3ceef6,_0x43e159=[];this[_0x1d456a(0x3b9)][_0x1d456a(0x115)]((_0xdae60a,_0x286232)=>{const _0x137b9e=_0x1d456a;window[_0x137b9e(0xc3)](_0xdae60a),_0x43e159[_0x137b9e(0x279)](this[_0x137b9e(0x277)](_0x286232)['then'](()=>{const _0x3efb7c=_0x137b9e;this[_0x3efb7c(0x3b9)][_0x3efb7c(0x15d)](_0x286232);}));}),await Promise[_0x1d456a(0x359)](_0x43e159);}[_0x3ceef6(0x36d)](){const _0x2af7a0=_0x3ceef6;this[_0x2af7a0(0x184)](this[_0x2af7a0(0x3e3)][_0x2af7a0(0x438)](()=>{const _0x5595bb=_0x2af7a0;if(this[_0x5595bb(0x3b9)]['size'])return this['_localeService']['t'](_0x5595bb(0x12b));}));}},_0x481c9f[_0x3ceef6(0x271)]=_0x338771([_0x1bbc7e(0x0,_0x24e1ed[_0x3ceef6(0x476)]),_0x1bbc7e(0x1,_0x24e1ed[_0x3ceef6(0x133)]),_0x1bbc7e(0x2,_0x279279[_0x3ceef6(0x161)]),_0x1bbc7e(0x3,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed['LocaleService'])),_0x1bbc7e(0x4,_0x24e1ed[_0x3ceef6(0x48f)](_0x3c4c3c['RevisionService']))],_0x481c9f[_0x3ceef6(0x271)]);function _0x98ff01(_0x533c01){const _0x1457f9=_0x3ceef6;return _0x1457f9(0x3e5)+_0x533c01;}const _0x45c59f=_0x24e1ed[_0x3ceef6(0x381)](_0x3ceef6(0x337));var _0x46ede2=(_0xcc7fb1=>(_0xcc7fb1[_0xcc7fb1[_0x3ceef6(0x1d2)]=0x0]=_0x3ceef6(0x1d2),_0xcc7fb1[_0xcc7fb1[_0x3ceef6(0x2a8)]=0x1]=_0x3ceef6(0x2a8),_0xcc7fb1))(_0x46ede2||{});const _0xeae30=0x7530,_0x1a2a86=_0x3ceef6(0x35d);class _0x1d3fc2 extends _0x24e1ed[_0x3ceef6(0x26d)]{constructor(){const _0x501edf=_0x3ceef6;super(),_0x1b84ec(this,_0x501edf(0x301),_0x24e1ed[_0x501edf(0x11e)][_0x501edf(0x20b)]()),_0x1b84ec(this,_0x501edf(0xd2),new Set()),_0x1b84ec(this,_0x501edf(0x1ea),new Map()),_0x1b84ec(this,_0x501edf(0xbb),null),_0x1b84ec(this,_0x501edf(0x225),new Map()),_0x1b84ec(this,'_unitStatus',new Map()),this[_0x501edf(0x13c)]();}[_0x3ceef6(0x377)](){const _0x155892=_0x3ceef6;super['dispose'](),this['_clearOtherTimers']['forEach']((_0x31a875,_0x1c1725)=>this[_0x155892(0x141)](_0x1c1725)),this[_0x155892(0xbb)]&&window[_0x155892(0x2dd)](this[_0x155892(0xbb)]);}['getUnitStatus$'](_0x20a2f0){const _0x2e81ef=_0x3ceef6;return this[_0x2e81ef(0x325)](_0x20a2f0)['pipe'](_0x5ba5b9[_0x2e81ef(0x3b1)]());}['editingUnit'](_0x2a476f){const _0x4d6bc3=_0x3ceef6;this[_0x4d6bc3(0xd2)][_0x4d6bc3(0x1bb)]===0x0&&this['_scheduleHeartbeat'](),this[_0x4d6bc3(0xd2)][_0x4d6bc3(0x46d)](_0x2a476f),this[_0x4d6bc3(0x101)]({'type':0x0,'memberID':this[_0x4d6bc3(0x301)],'unitIDs':[_0x2a476f],'isForwarded':!0x1});}[_0x3ceef6(0x1cf)](_0x5bf785){const _0x1982c5=_0x3ceef6;this[_0x1982c5(0xd2)][_0x1982c5(0x15d)](_0x5bf785),this['_selfUnitIDs']['size']===0x0&&this[_0x1982c5(0xbb)]&&window['clearInterval'](this['_heartbeatTimer']);}['_init'](){const _0x31789b=_0x3ceef6;this['disposeWithMe'](_0x24e1ed[_0x31789b(0x18f)](_0x5ba5b9[_0x31789b(0x49b)](window,'storage')[_0x31789b(0x1b0)](_0x2509d8=>{const _0x3adca9=_0x31789b;if(_0x2509d8[_0x3adca9(0x456)]!==_0x1a2a86||!_0x2509d8[_0x3adca9(0x3fc)])return;const _0x1c0fee=JSON[_0x3adca9(0x27d)](_0x2509d8[_0x3adca9(0x3fc)]);this[_0x3adca9(0x150)](_0x1c0fee);}))),window['addEventListener'](_0x31789b(0x36a),()=>this[_0x31789b(0x101)]({'type':0x1,'memberID':this[_0x31789b(0x301)],'unitIDs':Array[_0x31789b(0x2bb)](this['_selfUnitIDs'])}));}[_0x3ceef6(0x150)](_0x2174b5){const _0x40d6bb=_0x3ceef6;switch(_0x2174b5[_0x40d6bb(0x223)]){case 0x0:this['_handleJoinEvent'](_0x2174b5);break;case 0x1:this[_0x40d6bb(0x406)](_0x2174b5);break;case 0x2:this[_0x40d6bb(0x18c)](_0x2174b5);break;}}[_0x3ceef6(0x25d)](_0x2cf0e3){const _0x18c8e9=_0x3ceef6,{unitIDs:_0x4cc748,memberID:_0x4fbfa7,isForwarded:_0x5549aa}=_0x2cf0e3;_0x4cc748[_0x18c8e9(0x115)](_0x330f9d=>{const _0xb5283e=_0x18c8e9;if(!_0x5549aa&&this[_0xb5283e(0x1ea)][_0xb5283e(0x245)](_0x330f9d)&&this[_0xb5283e(0x325)](_0x330f9d)[_0xb5283e(0x48b)](0x1),!this[_0xb5283e(0x1ea)]['has'](_0x330f9d)||!this[_0xb5283e(0x1ea)][_0xb5283e(0x414)](_0x330f9d)['has'](_0x4fbfa7)){const _0x4b4f25=this['_unitOnClients'][_0xb5283e(0x414)](_0x330f9d)||new Set();_0x4b4f25[_0xb5283e(0x46d)](_0x4fbfa7),this['_unitOnClients']['set'](_0x330f9d,_0x4b4f25),this[_0xb5283e(0x22d)](_0x4fbfa7);}}),_0x5549aa||this['_send']({'type':0x0,'memberID':this['_id'],'unitIDs':[...this[_0x18c8e9(0xd2)]],'isForwarded':!0x0});}[_0x3ceef6(0x22d)](_0x5c1d00){const _0x4ff116=_0x3ceef6;this[_0x4ff116(0x141)](_0x5c1d00);const _0x29cda0=window[_0x4ff116(0x2d3)](()=>{const _0x102daa=_0x4ff116;this[_0x102daa(0x1ea)]['forEach'](_0x3b62e3=>{const _0x272a1c=_0x102daa;_0x3b62e3[_0x272a1c(0x15d)](_0x5c1d00);});},_0xeae30*0x2);this[_0x4ff116(0x225)]['set'](_0x5c1d00,_0x29cda0);}[_0x3ceef6(0x141)](_0x1c57e1){const _0x36874a=_0x3ceef6;if(this['_clearOtherTimers'][_0x36874a(0x245)](_0x1c57e1)){const _0xc24885=this[_0x36874a(0x225)]['get'](_0x1c57e1);_0xc24885&&window[_0x36874a(0xc3)](_0xc24885),this['_clearOtherTimers'][_0x36874a(0xe7)](_0x1c57e1,null);}}['_handleLeaveEvent'](_0x4bcedd){const _0xf9fc5c=_0x3ceef6,{memberID:_0x56bed4,unitIDs:_0x1a02d5}=_0x4bcedd;_0x1a02d5[_0xf9fc5c(0x115)](_0x2883c3=>{const _0x49ab4c=_0xf9fc5c;var _0x41026f;const _0x3e2334=this[_0x49ab4c(0x1ea)][_0x49ab4c(0x414)](_0x2883c3);_0x3e2334&&(_0x3e2334[_0x49ab4c(0x15d)](_0x56bed4),(_0x41026f=this['_ensureSubject'](_0x2883c3))==null||_0x41026f[_0x49ab4c(0x48b)](_0x3e2334[_0x49ab4c(0x1bb)]===0x0?0x0:0x1));}),this[_0xf9fc5c(0x141)](_0x56bed4);}[_0x3ceef6(0x18c)](_0x3ec4aa){const _0x2a4b2a=_0x3ceef6;this['_scheduleClearOtherTimer'](_0x3ec4aa[_0x2a4b2a(0x2ae)]);}[_0x3ceef6(0x101)](_0x278daa){const _0x502ee7=_0x3ceef6;localStorage[_0x502ee7(0x3f7)](_0x1a2a86,JSON[_0x502ee7(0x1b1)](_0x278daa));}[_0x3ceef6(0x160)](){const _0x3e6f84=_0x3ceef6;this[_0x3e6f84(0xbb)]=window[_0x3e6f84(0xdb)](()=>{const _0x4f944b=_0x3e6f84;this[_0x4f944b(0x101)]({'type':0x2,'memberID':this[_0x4f944b(0x301)]});},_0xeae30);}['_ensureSubject'](_0xeb7696){const _0xc4213c=_0x3ceef6;return this['_unitStatus'][_0xc4213c(0x245)](_0xeb7696)||this[_0xc4213c(0x1b3)][_0xc4213c(0xe7)](_0xeb7696,new _0x5ba5b9[(_0xc4213c(0x43c))](0x0)),this[_0xc4213c(0x1b3)][_0xc4213c(0x414)](_0xeb7696);}}var _0x49c4ac=Object[_0x3ceef6(0x2d1)],_0x46a02a=Object[_0x3ceef6(0x3fa)],_0x4c9f2d=(_0xe2a96f,_0x4be294,_0x222c92,_0x5a2551)=>{const _0x1eb390=_0x3ceef6;for(var _0x4c2939=_0x5a2551>0x1?void 0x0:_0x5a2551?_0x46a02a(_0x4be294,_0x222c92):_0x4be294,_0x48a5b0=_0xe2a96f[_0x1eb390(0x346)]-0x1,_0x29b3ca;_0x48a5b0>=0x0;_0x48a5b0--)(_0x29b3ca=_0xe2a96f[_0x48a5b0])&&(_0x4c2939=(_0x5a2551?_0x29b3ca(_0x4be294,_0x222c92,_0x4c2939):_0x29b3ca(_0x4c2939))||_0x4c2939);return _0x5a2551&&_0x4c2939&&_0x49c4ac(_0x4be294,_0x222c92,_0x4c2939),_0x4c2939;},_0x4e69a8=(_0x565249,_0x22772e)=>(_0x529162,_0xe18c36)=>_0x22772e(_0x529162,_0xe18c36,_0x565249);let _0x2884fa=class{constructor(_0x1ed35d,_0x5276b8){this['_injector']=_0x1ed35d,this['_transformService']=_0x5276b8;}[_0x3ceef6(0x3b0)](_0x54073a){const _0x10f8d5=_0x3ceef6;this[_0x10f8d5(0x298)](_0x54073a),this['_transformPreviousActiveRange'](_0x54073a);}[_0x3ceef6(0x311)](_0x53643c){const _0x1444a0=_0x3ceef6,_0x715897=this[_0x1444a0(0x376)][_0x1444a0(0x414)](_0x2c946a[_0x1444a0(0x43b)]),{redoCache:_0x303f1c}=_0x715897[_0x1444a0(0x1ac)]();if(_0x303f1c[_0x1444a0(0x346)]===0x0)return _0x53643c;let _0x131f2b=_0x24e1ed['Tools'][_0x1444a0(0x251)](_0x53643c[_0x1444a0(0x34a)][0x0]);for(let _0x10e854=0x0;_0x10e854<_0x303f1c['length'];_0x10e854++){const _0x8a199b={'id':'doc.mutation.rich-text-editing','params':{..._0x303f1c[_0x10e854]}},_0x2a8f1c=this[_0x1444a0(0x428)][_0x1444a0(0x29d)](_0x131f2b,_0x8a199b,!0x1);if(_0x3c4c3c[_0x1444a0(0x29c)](_0x2a8f1c))throw _0x2a8f1c['error'];_0x131f2b=_0x2a8f1c[_0x1444a0(0x454)];}return{..._0x24e1ed[_0x1444a0(0x11e)]['deepClone'](_0x53643c),'mutations':[_0x131f2b]};}[_0x3ceef6(0x298)](_0x2602cf){const _0x3ef70d=_0x3ceef6,_0x1950f5=this[_0x3ef70d(0x376)]['get'](_0x2c946a[_0x3ef70d(0x43b)]),{undoCache:_0x1cd044,redoCache:_0x3f0240}=_0x1950f5['getUndoRedoMutationParamsCache']();if(_0x1cd044[_0x3ef70d(0x346)]===0x0||_0x3f0240[_0x3ef70d(0x346)]===0x0)return;const _0x301ee0=[],_0x51cdcb=[];let _0x51a9ca=_0x24e1ed[_0x3ef70d(0x11e)]['deepClone'](_0x2602cf[_0x3ef70d(0x34a)][0x0]),_0x3f41c8=_0x24e1ed[_0x3ef70d(0x11e)][_0x3ef70d(0x251)](_0x2602cf[_0x3ef70d(0x34a)][0x0]);for(let _0x547726=_0x1cd044[_0x3ef70d(0x346)]-0x1;_0x547726>=0x0;_0x547726--){const _0x389395={'id':_0x3ef70d(0x3ff),'params':{..._0x1cd044[_0x547726]}},_0x3c608f={'id':_0x3ef70d(0x3ff),'params':{..._0x3f0240[_0x547726]}},_0x54c846=this[_0x3ef70d(0x428)][_0x3ef70d(0x29d)](_0x51a9ca,_0x389395,!0x1),_0x346f36=this[_0x3ef70d(0x428)][_0x3ef70d(0x29d)](_0x3f41c8,_0x3c608f,!0x1);if(_0x3c4c3c['isTransformMutationFailure'](_0x54c846))throw _0x54c846[_0x3ef70d(0x457)];if(_0x3c4c3c['isTransformMutationFailure'](_0x346f36))throw _0x346f36['error'];_0x301ee0[_0x3ef70d(0x23c)](_0x54c846['m2Prime'][_0x3ef70d(0xbe)]),_0x51cdcb[_0x3ef70d(0x23c)](_0x346f36['m2Prime'][_0x3ef70d(0xbe)]),_0x51a9ca=_0x54c846[_0x3ef70d(0x454)],_0x3f41c8=_0x346f36[_0x3ef70d(0x454)];}_0x1950f5[_0x3ef70d(0x477)]({'undoCache':_0x301ee0,'redoCache':_0x51cdcb});}[_0x3ceef6(0xb2)](_0x5df5dd){const _0x514292=_0x3ceef6,_0x53bbca=this[_0x514292(0x376)][_0x514292(0x414)](_0x2c946a[_0x514292(0x43b)]),_0xbad96d=_0x53bbca[_0x514292(0xd7)]();if(_0xbad96d==null)return;const _0xb1dc36=[{'id':_0x514292(0x3ff),'params':{'unitId':_0x5df5dd['unitID'],'actions':null,'textRanges':[_0xbad96d]}}],_0x6bf02=this[_0x514292(0x428)][_0x514292(0x38c)](_0x5df5dd,_0xb1dc36);if(!_0x3c4c3c[_0x514292(0x447)](_0x6bf02))throw _0x6bf02[_0x514292(0x457)];const _0x33a332=_0x6bf02['m2Prime'][0x0]['params'][_0x514292(0x410)];Array[_0x514292(0xc7)](_0x33a332)&&_0x33a332[_0x514292(0x346)]&&_0x53bbca['setActiveRange'](_0x33a332[0x0]);}};_0x2884fa=_0x4c9f2d([_0x4e69a8(0x0,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x405)])),_0x4e69a8(0x1,_0x3c4c3c[_0x3ceef6(0x2cd)])],_0x2884fa);var _0x85687c=Object[_0x3ceef6(0x2d1)],_0x30fae3=Object[_0x3ceef6(0x3fa)],_0x59bed7=(_0x21b82c,_0x259d8e,_0x1a7a40,_0x274ad9)=>{for(var _0x486084=_0x274ad9>0x1?void 0x0:_0x274ad9?_0x30fae3(_0x259d8e,_0x1a7a40):_0x259d8e,_0x5a26c9=_0x21b82c['length']-0x1,_0x2a8a2f;_0x5a26c9>=0x0;_0x5a26c9--)(_0x2a8a2f=_0x21b82c[_0x5a26c9])&&(_0x486084=(_0x274ad9?_0x2a8a2f(_0x259d8e,_0x1a7a40,_0x486084):_0x2a8a2f(_0x486084))||_0x486084);return _0x274ad9&&_0x486084&&_0x85687c(_0x259d8e,_0x1a7a40,_0x486084),_0x486084;},_0x1fc5ab=(_0x529b47,_0x456ce5)=>(_0x5058cb,_0x360380)=>_0x456ce5(_0x5058cb,_0x360380,_0x529b47);let _0x72a7c8=class{constructor(_0x355894,_0x5160b3){const _0x414ace=_0x3ceef6;this[_0x414ace(0x376)]=_0x355894,this[_0x414ace(0x428)]=_0x5160b3;}[_0x3ceef6(0x238)](_0x196a92){const _0xac3195=_0x3ceef6;var _0x4040ec;const _0x4b1ebf=this[_0xac3195(0x376)][_0xac3195(0x414)](_0x2c946a[_0xac3195(0x177)]),_0x2ebb90=(_0x4040ec=_0x4b1ebf[_0xac3195(0x21c)]())!=null?_0x4040ec:[],_0x804323=_0x2ebb90==null?void 0x0:_0x2ebb90['map'](_0x2c946a[_0xac3195(0x2d9)]);if(_0x804323[_0xac3195(0x346)]===0x0)return;const _0x3d9635=[{'id':'doc.mutation.rich-text-editing','params':{'unitId':_0x196a92['unitID'],'actions':null,'textRanges':_0x804323}}],_0x6459fd=this[_0xac3195(0x428)][_0xac3195(0x38c)](_0x196a92,_0x3d9635);if(!_0x3c4c3c['isTransformMutationsWithChangesetSuccess'](_0x6459fd))throw _0x6459fd[_0xac3195(0x457)];const _0xeae0c2=_0x6459fd[_0xac3195(0x49c)][0x0][_0xac3195(0xbe)]['textRanges'];Array['isArray'](_0xeae0c2)&&_0xeae0c2['length']&&_0x4b1ebf[_0xac3195(0x470)](_0xeae0c2,!0x1);}};_0x72a7c8=_0x59bed7([_0x1fc5ab(0x0,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x405)])),_0x1fc5ab(0x1,_0x3c4c3c['ITransformService'])],_0x72a7c8);function _0x574176(_0x475a8b){const _0x37de8c=_0x3ceef6;let _0x155bce='';for(const _0x4ba059 of _0x475a8b){const {startOffset:_0x341e76,endOffset:_0x477303,isActive:_0x37dcde}=_0x4ba059;_0x155bce[_0x37de8c(0x346)]&&(_0x155bce+=','),_0x155bce+=_0x341e76+':'+_0x477303+':'+(_0x37dcde?'1':'0');}return _0x155bce;}function _0xd09446(_0x57353e){const _0xd67aff=_0x3ceef6,_0x58af56=_0x57353e['split'](','),_0x547322=[];for(const _0x562857 of _0x58af56){const [_0x367d01,_0xd63a1a,_0x10f56a]=_0x562857[_0xd67aff(0x15a)](':');_0x547322[_0xd67aff(0x279)]({'startOffset':Number(_0x367d01),'endOffset':Number(_0xd63a1a),'collapsed':_0x367d01===_0xd63a1a,'isActive':_0x10f56a==='1'});}return _0x547322[_0xd67aff(0x453)](_0x21dd71=>_0x21dd71[_0xd67aff(0xbc)])||(_0x547322[0x0][_0xd67aff(0xbc)]=!0x0),_0x547322;}class _0x5a4f60 extends _0x24e1ed[_0x3ceef6(0x379)]{constructor(){const _0x52448a=_0x3ceef6;super(...arguments),_0x1b84ec(this,_0x52448a(0x48e),new _0x5ba5b9[(_0x52448a(0x43c))](null)),_0x1b84ec(this,_0x52448a(0x188),this['_collabCursorState$'][_0x52448a(0x2ce)]());}[_0x3ceef6(0xf5)](_0xbe838){const _0x3cbf33=_0x3ceef6,{unitID:_0x3708f8,memberID:_0xbf0ccf,textRanges:_0x495dd0}=_0xbe838,_0x47d522=_0x574176(_0x495dd0),_0x42d022={'unitID':_0x3708f8,'memberID':_0xbf0ccf,'selection':_0x47d522};this['_collabCursorState$'][_0x3cbf33(0x48b)](_0x42d022);}}var _0x17ac2f=Object[_0x3ceef6(0x2d1)],_0x1575e2=Object[_0x3ceef6(0x3fa)],_0x119142=(_0x15fcb0,_0x275da3,_0x10a0c3,_0x37f335)=>{const _0x4e00cc=_0x3ceef6;for(var _0x37b4ad=_0x37f335>0x1?void 0x0:_0x37f335?_0x1575e2(_0x275da3,_0x10a0c3):_0x275da3,_0x1be000=_0x15fcb0[_0x4e00cc(0x346)]-0x1,_0x2f9a9e;_0x1be000>=0x0;_0x1be000--)(_0x2f9a9e=_0x15fcb0[_0x1be000])&&(_0x37b4ad=(_0x37f335?_0x2f9a9e(_0x275da3,_0x10a0c3,_0x37b4ad):_0x2f9a9e(_0x37b4ad))||_0x37b4ad);return _0x37f335&&_0x37b4ad&&_0x17ac2f(_0x275da3,_0x10a0c3,_0x37b4ad),_0x37b4ad;},_0xbae555=(_0x12c3de,_0x436fd2)=>(_0x4dc405,_0x4a08f4)=>_0x436fd2(_0x4dc405,_0x4a08f4,_0x12c3de);function _0x28e891(_0x132c42){const _0x2eabd1=_0x3ceef6,{unitID:_0x19c99f,mutations:_0x2a9674}=_0x132c42;return{'unitId':_0x19c99f,'subUnitId':_0x2a9674[0x0][_0x2eabd1(0xbe)]['subUnitId']};}let _0x1170ae=class{constructor(_0x189f60,_0x5582ad){const _0x4a2f98=_0x3ceef6;this[_0x4a2f98(0x376)]=_0x189f60,this[_0x4a2f98(0x428)]=_0x5582ad;}[_0x3ceef6(0x238)](_0x378062){const _0x6d8056=_0x3ceef6;var _0x95d691,_0xb0c699,_0x4cabaa;const _0x4c0411=this[_0x6d8056(0x376)][_0x6d8056(0x414)](_0x5e02d9[_0x6d8056(0x28f)]),{unitId:_0x37054e,subUnitId:_0x3d72dd}=_0x28e891(_0x378062),_0x523e27=_0x4c0411[_0x6d8056(0x436)](_0x37054e)[_0x6d8056(0x21c)]();if(_0x523e27[_0x6d8056(0x346)]===0x0||!_0x37054e||!_0x3d72dd)return;const _0x5d3052=[{'id':_0x5e02d9['SetSelectionsOperation']['id'],'params':{'unitId':_0x37054e,'subUnitId':_0x3d72dd,'selections':_0x24e1ed[_0x6d8056(0x11e)][_0x6d8056(0x251)](_0x523e27)}}],_0x2cee48=this[_0x6d8056(0x428)][_0x6d8056(0x38c)](_0x378062,_0x5d3052);if(!_0x3c4c3c[_0x6d8056(0x447)](_0x2cee48))throw _0x2cee48['error'];const _0x407f8c=(_0x4cabaa=(_0xb0c699=(_0x95d691=_0x2cee48[_0x6d8056(0x49c)][0x0])==null?void 0x0:_0x95d691[_0x6d8056(0xbe)])==null?void 0x0:_0xb0c699[_0x6d8056(0x170)])!=null?_0x4cabaa:_0x523e27;Array[_0x6d8056(0xc7)](_0x407f8c)&&_0x407f8c[_0x6d8056(0x346)]&&this[_0x6d8056(0x376)]['get'](_0x24e1ed['ICommandService'])[_0x6d8056(0x2ef)](_0x5e02d9[_0x6d8056(0x221)]['id'],{'unitId':_0x37054e,'subUnitId':_0x3d72dd,'selections':_0x407f8c});}};_0x1170ae=_0x119142([_0xbae555(0x0,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed['Injector'])),_0xbae555(0x1,_0x3c4c3c['ITransformService'])],_0x1170ae);const _0x473ac2=new Set([_0x5e02d9[_0x3ceef6(0x241)]['id']]);function _0x1bbe64(_0xc4706b,_0x1184d1,_0x68ba86,_0x3e9b45,_0x2b356a){const _0x590d5e=_0x3ceef6;var _0x1fa985,_0x30e6a4,_0x1bac50,_0x3a63b1;const _0x5c2d13=[];for(const _0x280ede of _0xc4706b)if(_0x473ac2[_0x590d5e(0x245)](_0x280ede['id'])){if(_0x5c2d13[_0x590d5e(0x346)]>0x0)break;_0x5c2d13['push'](_0x280ede);break;}else _0x5c2d13[_0x590d5e(0x279)](_0x280ede);const _0x8b08bf=(_0x30e6a4=(_0x1fa985=_0x2b356a[_0x590d5e(0x272)]())==null?void 0x0:_0x1fa985[_0x590d5e(0x2b7)])!=null?_0x30e6a4:_0x590d5e(0x276),_0x4461b3=(_0x3a63b1=(_0x1bac50=_0x2b356a[_0x590d5e(0x272)]())==null?void 0x0:_0x1bac50[_0x590d5e(0x2ae)])!=null?_0x3a63b1:'unknown';return{'changeset':{'unitID':_0x1184d1,'type':_0x3c4c3c['mapDocumentTypeToUniverType'](_0x68ba86['getUnitType'](_0x1184d1)),'baseRev':_0x3e9b45[_0x590d5e(0x2cb)](_0x1184d1),'revision':0x0,'userID':_0x8b08bf,'memberID':_0x4461b3,'mutations':_0x5c2d13},'pendingMutations':_0xc4706b[_0x590d5e(0x201)](_0x5c2d13[_0x590d5e(0x346)])};}function _0xf75d58(_0x8924cf,_0x6bff4c,_0x58b8e6,_0x256383,_0x2ff1b9){const _0x190506=_0x3ceef6;var _0x2e004b,_0x6b1519,_0x17a7be,_0x231cfd;const _0x3668ce=[_0x8924cf[_0x190506(0x171)]((_0x458f18,_0x37e649)=>{const _0x6a8d27=_0x190506;var _0x45c9ec;const {id:_0x803924}=_0x458f18,{id:_0x2dbd06,type:_0x357ee4}=_0x37e649,_0x1e7700=(_0x45c9ec=_0x458f18['params'])!=null?_0x45c9ec:{'actions':null},_0x3f5c8e=_0x37e649[_0x6a8d27(0xbe)];if(_0x803924&&_0x803924!==_0x2dbd06)throw new Error(_0x6a8d27(0x284)+_0x803924+_0x6a8d27(0x289)+_0x2dbd06+'.');return{..._0x458f18,'id':_0x2dbd06,'type':_0x357ee4,'params':{'unitId':_0x3f5c8e[_0x6a8d27(0x167)],'textRanges':_0x3f5c8e[_0x6a8d27(0x410)],'actions':_0x24e1ed[_0x6a8d27(0x435)][_0x6a8d27(0x409)](_0x1e7700[_0x6a8d27(0x1d0)],_0x3f5c8e['actions'])}};},{})],_0xa2e473=(_0x6b1519=(_0x2e004b=_0x2ff1b9[_0x190506(0x272)]())==null?void 0x0:_0x2e004b[_0x190506(0x2b7)])!=null?_0x6b1519:_0x190506(0x276),_0x59e250=(_0x231cfd=(_0x17a7be=_0x2ff1b9[_0x190506(0x272)]())==null?void 0x0:_0x17a7be[_0x190506(0x2ae)])!=null?_0x231cfd:_0x190506(0x276);return{'changeset':{'unitID':_0x6bff4c,'type':_0x3c4c3c['mapDocumentTypeToUniverType'](_0x58b8e6[_0x190506(0x42a)](_0x6bff4c)),'baseRev':_0x256383[_0x190506(0x2cb)](_0x6bff4c),'revision':0x0,'userID':_0xa2e473,'memberID':_0x59e250,'mutations':_0x3668ce},'pendingMutations':[]};}const _0x1b94e5={'id':_0x5e02d9[_0x3ceef6(0x28b)]['id'],'type':_0x24e1ed[_0x3ceef6(0x24a)][_0x3ceef6(0x38e)],'params':{}};var _0x24021d=Object['defineProperty'],_0x103f14=Object[_0x3ceef6(0x3fa)],_0x3adde2=(_0xf5c342,_0x3634a4,_0x170d67,_0x29ea15)=>{for(var _0x3a2425=_0x29ea15>0x1?void 0x0:_0x29ea15?_0x103f14(_0x3634a4,_0x170d67):_0x3634a4,_0x18fd48=_0xf5c342['length']-0x1,_0xf4cca3;_0x18fd48>=0x0;_0x18fd48--)(_0xf4cca3=_0xf5c342[_0x18fd48])&&(_0x3a2425=(_0x29ea15?_0xf4cca3(_0x3634a4,_0x170d67,_0x3a2425):_0xf4cca3(_0x3a2425))||_0x3a2425);return _0x29ea15&&_0x3a2425&&_0x24021d(_0x3634a4,_0x170d67,_0x3a2425),_0x3a2425;},_0x241f3d=(_0x30727b,_0x592587)=>(_0x38d7a8,_0x4b5f31)=>_0x592587(_0x38d7a8,_0x4b5f31,_0x30727b),_0x5a1c45=(_0x44b7ce=>(_0x44b7ce[_0x3ceef6(0x339)]=_0x3ceef6(0x3eb),_0x44b7ce[_0x3ceef6(0x25a)]='synced',_0x44b7ce[_0x3ceef6(0x3e7)]=_0x3ceef6(0x394),_0x44b7ce[_0x3ceef6(0xeb)]=_0x3ceef6(0x31a),_0x44b7ce['AWAITING_WITH_PENDING']='awaiting_with_pending',_0x44b7ce['FETCH_MISS']=_0x3ceef6(0x132),_0x44b7ce['CONFLICT']=_0x3ceef6(0x162),_0x44b7ce[_0x3ceef6(0x27c)]=_0x3ceef6(0x352),_0x44b7ce))(_0x5a1c45||{});class _0x2b77b0{constructor(_0x5a2f1c,_0x4776f5,_0x54a821,_0xdc64ca,_0xd65662,_0x95623,_0x3c0a80,_0x226164,_0x3040cc){const _0x334966=_0x3ceef6;_0x1b84ec(this,_0x334966(0x117),null),_0x1b84ec(this,'_pendingMutations',[]),(this['unitID']=_0x5a2f1c,this['type']=_0x4776f5,this[_0x334966(0x393)]=_0xd65662,this[_0x334966(0x285)]=_0x95623,this[_0x334966(0x44b)]=_0x3c0a80,this[_0x334966(0x181)]=_0x226164,this[_0x334966(0x140)]=_0x3040cc,this[_0x334966(0x117)]=_0x54a821,this[_0x334966(0x16d)]=_0xdc64ca);}['_checkMissing'](_0x183efb){const _0x1e3416=_0x3ceef6,_0x2a9807=this[_0x1e3416(0x181)]['getCurrentRevForDocument'](this[_0x1e3416(0x208)]);return _0x183efb[_0x1e3416(0x1d1)]>_0x2a9807+0x1?(this[_0x1e3416(0x393)][_0x1e3416(0x390)]({'from':_0x2a9807,'to':_0x183efb[_0x1e3416(0x1d1)]-0x1}),!0x0):!0x1;}[_0x3ceef6(0x2f8)](_0x1d85f3){const _0x1a629c=_0x3ceef6;this[_0x1a629c(0x44b)][_0x1a629c(0x269)](this['unitID'],_0x1d85f3);}[_0x3ceef6(0x2bd)](_0x935416){const _0x2700e3=_0x3ceef6;var _0x436220,_0x40c7e8;(_0x40c7e8=(_0x436220=this[_0x2700e3(0x393)])[_0x2700e3(0xb7)])==null||_0x40c7e8[_0x2700e3(0x2b8)](_0x436220,_0x935416);}['_transformIMECache'](_0x3dbef8){const _0x1970bf=_0x3ceef6;var _0x58ff42,_0x5e018d;return(_0x5e018d=(_0x58ff42=this[_0x1970bf(0x393)])['onTransformIME'])==null?void 0x0:_0x5e018d['call'](_0x58ff42,_0x3dbef8);}['_transformRemoteChangesetByIMECache'](_0x595d68){const _0xf6da77=_0x3ceef6;var _0x18b1ae,_0x13fba2,_0x703983;return(_0x703983=(_0x13fba2=(_0x18b1ae=this['_handler'])[_0xf6da77(0x3a3)])==null?void 0x0:_0x13fba2[_0xf6da77(0x2b8)](_0x18b1ae,_0x595d68))!=null?_0x703983:_0x595d68;}[_0x3ceef6(0x46f)](_0x2a1829){const _0x23cdbc=_0x3ceef6;var _0x26f311,_0x5ebb0d;if(this[_0x23cdbc(0x223)]===_0x1a91ec[_0x23cdbc(0x192)]){const {unitID:_0x45f662,mutations:_0x43b3a9,memberID:_0x2185a6}=_0x2a1829,_0x5358b8=_0x43b3a9[0x0][_0x23cdbc(0xbe)][_0x23cdbc(0x410)];Array[_0x23cdbc(0xc7)](_0x5358b8)&&_0x5358b8['length']>0x0&&((_0x5ebb0d=(_0x26f311=this[_0x23cdbc(0x393)])['onSyncEditingCollabCursor'])==null||_0x5ebb0d[_0x23cdbc(0x2b8)](_0x26f311,{'unitID':_0x45f662,'memberID':_0x2185a6,'textRanges':_0x5358b8}));}}[_0x3ceef6(0x2c1)](){const _0x5cc161=_0x3ceef6;this[_0x5cc161(0x140)][_0x5cc161(0x37a)](this[_0x5cc161(0x208)],this['type'],this['_awaitingChangeset'],this['_pendingMutations']);}['_getCurrentRevision'](){const _0x4f2222=_0x3ceef6;return this['_revisionService'][_0x4f2222(0x2cb)](this['unitID']);}['_incrementRevisionNumber'](){this['_revisionService']['incrementRevForDocument'](this['unitID']);}[_0x3ceef6(0x19e)](_0x5a578a){const _0x4de2a6=_0x3ceef6;var _0x267a81;const _0x5ae47f=this[_0x4de2a6(0xd4)](_0x5a578a),_0x45fb61=_0x24e1ed[_0x4de2a6(0x1ec)](_0x5ae47f[_0x4de2a6(0x34a)],this[_0x4de2a6(0x285)],{'fromCollab':!0x0});if(!_0x45fb61[_0x4de2a6(0x26a)])throw _0x45fb61[_0x4de2a6(0x457)]instanceof Error?_0x45fb61[_0x4de2a6(0x457)]:new Error((_0x267a81=_0x45fb61[_0x4de2a6(0x457)])!=null?_0x267a81:_0x4de2a6(0x297));this[_0x4de2a6(0x28c)](_0x5ae47f),this[_0x4de2a6(0x2f8)](_0x5a578a),this[_0x4de2a6(0x2bd)](_0x5ae47f),this[_0x4de2a6(0x46f)](_0x5ae47f),this[_0x4de2a6(0x103)]();}}let _0x47affd=class extends _0x2b77b0{constructor(_0x178c2b,_0x4ef177,_0x14095b,_0x5588c7,_0x1fdff3,_0x4ad999,_0x55baf1,_0x3ec7da,_0x357bfb,_0x40eb4a){const _0xaf3eaf=_0x3ceef6;super(_0x178c2b,_0x4ef177,null,[],_0x14095b,_0x3ec7da,_0x55baf1,_0x5588c7,_0x1fdff3),_0x1b84ec(this,_0xaf3eaf(0x355),'synced'),(this['_injector']=_0x4ad999,this[_0xaf3eaf(0x256)]=_0x357bfb,this[_0xaf3eaf(0x428)]=_0x40eb4a);}[_0x3ceef6(0xbf)](_0x48c73f){const _0x53fd76=_0x3ceef6,_0x4655f8=this[_0x53fd76(0x376)][_0x53fd76(0x1c4)](_0x3e48b5,this[_0x53fd76(0x208)],this['type'],[_0x48c73f],this['_handler']);return _0x4655f8[_0x53fd76(0x39b)](),_0x4655f8[_0x53fd76(0x2c1)](),_0x4655f8;}[_0x3ceef6(0x169)](_0x33279b){const _0x546d52=_0x3ceef6;if(this[_0x546d52(0x24c)](_0x33279b))return this['_injector'][_0x546d52(0x1c4)](_0x4841b6,this['unitID'],this[_0x546d52(0x223)],null,[],null,[_0x33279b],this[_0x546d52(0x393)]);try{const _0x34484a=this[_0x546d52(0x428)][_0x546d52(0x38c)](_0x33279b,[_0x1b94e5]);if(_0x3c4c3c[_0x546d52(0x447)](_0x34484a)){const {c1Prime:_0x429583}=_0x34484a;return this['_executeRemoteChangeset'](_0x429583),this;}throw _0x34484a['error'];}catch(_0x52701f){return this[_0x546d52(0x256)][_0x546d52(0x457)](_0x52701f),this[_0x546d52(0x2e0)](!0x1);}}[_0x3ceef6(0x2e0)](_0x32a8ce){const _0x395156=_0x3ceef6;return this['_injector'][_0x395156(0x1c4)](_0x41bb20,this[_0x395156(0x208)],this[_0x395156(0x223)],null,[],this[_0x395156(0x393)],_0x32a8ce);}['onRemoteAck'](){const _0xd527ec=_0x3ceef6;throw new Error(_0xd527ec(0x3ad));}[_0x3ceef6(0x165)](){const _0x4427a2=_0x3ceef6;throw new Error(_0x4427a2(0x18d));}[_0x3ceef6(0xef)](){const _0xa38caa=_0x3ceef6;return this[_0xa38caa(0x376)][_0xa38caa(0x1c4)](_0x29cdda,this[_0xa38caa(0x208)],this[_0xa38caa(0x223)],null,[],this[_0xa38caa(0x393)]);}[_0x3ceef6(0x486)](){return this;}['resend'](){const _0x54860e=_0x3ceef6;throw new Error(_0x54860e(0x388));}};_0x47affd=_0x3adde2([_0x241f3d(0x3,_0x24e1ed[_0x3ceef6(0x48f)](_0x3c4c3c['RevisionService'])),_0x241f3d(0x4,_0x24e1ed[_0x3ceef6(0x48f)](_0x481c9f[_0x3ceef6(0x271)])),_0x241f3d(0x5,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x405)])),_0x241f3d(0x6,_0x24e1ed[_0x3ceef6(0x1f4)]),_0x241f3d(0x7,_0x24e1ed[_0x3ceef6(0x28e)]),_0x241f3d(0x8,_0x24e1ed[_0x3ceef6(0x250)]),_0x241f3d(0x9,_0x3c4c3c[_0x3ceef6(0x2cd)])],_0x47affd);let _0x3e48b5=class extends _0x2b77b0{constructor(_0x2582f4,_0x17b7d7,_0x1ee3e9,_0x9e7908,_0x202a0c,_0xac3d27,_0x20bd55,_0xde471,_0x3de165,_0x21d2be,_0x1a1d6b,_0xd5199b,_0x57d3a0,_0x37836a){const _0x48e200=_0x3ceef6;super(_0x2582f4,_0x17b7d7,null,_0x1ee3e9,_0x9e7908,_0x21d2be,_0x37836a,_0xac3d27,_0x20bd55),_0x1b84ec(this,_0x48e200(0x355),_0x48e200(0x394)),_0x1b84ec(this,_0x48e200(0x370),null),_0x1b84ec(this,_0x48e200(0x3cf),null),(this['_injector']=_0x202a0c,this[_0x48e200(0x1e0)]=_0xde471,this[_0x48e200(0x256)]=_0x3de165,this[_0x48e200(0x421)]=_0x1a1d6b,this[_0x48e200(0x428)]=_0xd5199b,this[_0x48e200(0x198)]=_0x57d3a0);}[_0x3ceef6(0xbf)](_0x4f4d30){const _0x5c2940=_0x3ceef6;return this[_0x5c2940(0x16d)][_0x5c2940(0x279)](_0x4f4d30),this[_0x5c2940(0x2c1)](),this;}[_0x3ceef6(0x169)](_0x4420ac){const _0x653c96=_0x3ceef6;if(this[_0x653c96(0x24c)](_0x4420ac))return this[_0x653c96(0x3a0)](),this[_0x653c96(0x376)][_0x653c96(0x1c4)](_0x4841b6,this[_0x653c96(0x208)],this['type'],null,this[_0x653c96(0x16d)],null,[_0x4420ac],this['_handler']);try{const _0x5df885=this[_0x653c96(0x428)]['transformMutationsWithChangeset'](_0x4420ac,this['_pendingMutations']);if(_0x3c4c3c[_0x653c96(0x447)](_0x5df885)){const {c1Prime:_0x59b788,m2Prime:_0x256ec3}=_0x5df885;this['_executeRemoteChangeset'](_0x59b788);const _0x36e9e1=this['_injector'][_0x653c96(0x1c4)](_0x3e48b5,this[_0x653c96(0x208)],this[_0x653c96(0x223)],_0x256ec3,this[_0x653c96(0x393)]);return this['_clearScheduledTask'](),_0x36e9e1[_0x653c96(0x39b)](this[_0x653c96(0x370)]?Math[_0x653c96(0x474)](0x0,new Date()[_0x653c96(0x3f6)]()-this[_0x653c96(0x370)]):this[_0x653c96(0x322)]()),_0x36e9e1;}throw _0x5df885[_0x653c96(0x457)];}catch(_0x25d615){return this[_0x653c96(0x256)][_0x653c96(0x457)](_0x25d615),this['_onConflict'](!0x1);}}[_0x3ceef6(0x1d7)](){const _0x2ee9d7=_0x3ceef6;throw new Error(_0x2ee9d7(0x1fb));}[_0x3ceef6(0x165)](){const _0xc7d945=_0x3ceef6;throw new Error(_0xc7d945(0x466));}['toggleOffline'](){const _0x2ff3f3=_0x3ceef6;return this['_clearScheduledTask'](),this[_0x2ff3f3(0x376)][_0x2ff3f3(0x1c4)](_0x29cdda,this[_0x2ff3f3(0x208)],this[_0x2ff3f3(0x223)],null,this[_0x2ff3f3(0x16d)],this[_0x2ff3f3(0x393)]);}[_0x3ceef6(0x486)](){return this;}[_0x3ceef6(0x39b)](_0x5b960a){const _0x40ed47=_0x3ceef6;_0x5b960a=_0x5b960a!=null?_0x5b960a:this[_0x40ed47(0x322)](),this['_scheduleTimestamp']=new Date()[_0x40ed47(0x3f6)](),this[_0x40ed47(0x3cf)]=setTimeout(()=>{const _0x296f9d=_0x40ed47;this[_0x296f9d(0x3a0)]();let _0x4ce278=null;switch(this[_0x296f9d(0x223)]){case _0x1a91ec[_0x296f9d(0x2b3)]:{_0x4ce278=_0x1bbe64(this[_0x296f9d(0x16d)],this[_0x296f9d(0x208)],this[_0x296f9d(0x198)],this[_0x296f9d(0x181)],this['_memberService']);break;}case _0x1a91ec['UNIVER_DOC']:{this[_0x296f9d(0x16d)][_0x296f9d(0x3e0)](_0x17e284=>_0x17e284['id']===_0x2c946a[_0x296f9d(0x3f8)]['id'])?_0x4ce278=_0xf75d58(this['_pendingMutations'],this['unitID'],this[_0x296f9d(0x198)],this['_revisionService'],this[_0x296f9d(0x1e0)]):_0x4ce278=_0x1bbe64(this[_0x296f9d(0x16d)],this[_0x296f9d(0x208)],this[_0x296f9d(0x198)],this[_0x296f9d(0x181)],this[_0x296f9d(0x1e0)]);break;}default:throw new Error(_0x296f9d(0x3dc)+this[_0x296f9d(0x223)]+_0x296f9d(0x2cc));}const {changeset:_0x4a22eb,pendingMutations:_0x4ae9f5}=_0x4ce278;this[_0x296f9d(0x393)][_0x296f9d(0x37d)](_0x4a22eb);const _0x19ccdd=_0x4ae9f5['length']?this[_0x296f9d(0x376)][_0x296f9d(0x1c4)](_0xde0597,this['unitID'],this['type'],_0x4a22eb,_0x4ae9f5,this[_0x296f9d(0x393)]):this[_0x296f9d(0x376)]['createInstance'](_0x3dff93,this[_0x296f9d(0x208)],this[_0x296f9d(0x223)],_0x4a22eb,this['_handler']);_0x19ccdd[_0x296f9d(0x2c1)](),this['_handler'][_0x296f9d(0x11b)](this,_0x19ccdd);},_0x5b960a);}['_getSendChangesetTimeout'](){const _0x2f42ee=_0x3ceef6;var _0x26fbb5;return(_0x26fbb5=this[_0x2f42ee(0x421)][_0x2f42ee(0x10b)](_0x274600))!=null?_0x26fbb5:0x7d0;}[_0x3ceef6(0x182)](){const _0x27d0db=_0x3ceef6;throw new Error(_0x27d0db(0xc9));}[_0x3ceef6(0x3a0)](){const _0x57236c=_0x3ceef6;this[_0x57236c(0x3cf)]!=null&&(clearTimeout(this[_0x57236c(0x3cf)]),this[_0x57236c(0x3cf)]=null);}['_onConflict'](_0x14b68d){const _0x43dee2=_0x3ceef6;return this['_clearScheduledTask'](),this[_0x43dee2(0x376)][_0x43dee2(0x1c4)](_0x41bb20,this[_0x43dee2(0x208)],this['type'],null,this['_pendingMutations'],this['_handler'],_0x14b68d);}};_0x3e48b5=_0x3adde2([_0x241f3d(0x4,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x405)])),_0x241f3d(0x5,_0x24e1ed[_0x3ceef6(0x48f)](_0x3c4c3c[_0x3ceef6(0x3dd)])),_0x241f3d(0x6,_0x24e1ed[_0x3ceef6(0x48f)](_0x481c9f['LocalCacheService'])),_0x241f3d(0x7,_0x24e1ed[_0x3ceef6(0x48f)](_0x29dad0)),_0x241f3d(0x8,_0x24e1ed['ILogService']),_0x241f3d(0x9,_0x24e1ed['ICommandService']),_0x241f3d(0xa,_0x24e1ed[_0x3ceef6(0x476)]),_0x241f3d(0xb,_0x3c4c3c['ITransformService']),_0x241f3d(0xc,_0x24e1ed['IUniverInstanceService']),_0x241f3d(0xd,_0x24e1ed[_0x3ceef6(0x1f4)])],_0x3e48b5);let _0x3dff93=class extends _0x2b77b0{constructor(_0x3e146f,_0x2b38ee,_0x1a16e5,_0x1a4ed2,_0x454fe3,_0x251655,_0x346e3c,_0x3ebf23,_0x3e9d34,_0x376a2e,_0x10a326){const _0x603e6c=_0x3ceef6;super(_0x3e146f,_0x2b38ee,_0x1a16e5,[],_0x1a4ed2,_0x3ebf23,_0x10a326,_0x251655,_0x346e3c),_0x1b84ec(this,_0x603e6c(0x355),_0x603e6c(0x31a)),(this[_0x603e6c(0x376)]=_0x454fe3,this['_logService']=_0x3e9d34,this['_transformService']=_0x376a2e);}['appendMutation'](_0x1ab4f2){const _0x5a6ec8=_0x3ceef6,_0x468946=this[_0x5a6ec8(0x376)][_0x5a6ec8(0x1c4)](_0xde0597,this[_0x5a6ec8(0x208)],this['type'],this['_awaitingChangeset'],[_0x1ab4f2],this[_0x5a6ec8(0x393)]);return _0x468946[_0x5a6ec8(0x2c1)](),_0x468946;}[_0x3ceef6(0x169)](_0x277e78){const _0xb92545=_0x3ceef6;if(this[_0xb92545(0x24c)](_0x277e78))return this[_0xb92545(0x376)][_0xb92545(0x1c4)](_0x4841b6,this[_0xb92545(0x208)],this[_0xb92545(0x223)],this['_awaitingChangeset'],[],null,[_0x277e78],this[_0xb92545(0x393)]);try{const _0x56846f=this[_0xb92545(0x428)]['transformChangesets']([_0x277e78],[this[_0xb92545(0x117)]],!0x1);if(_0x3c4c3c[_0xb92545(0x31b)](_0x56846f)){const {c1Prime:_0x24bd6c,c2Prime:_0x52e7ab}=_0x56846f;this['_executeRemoteChangeset'](_0x24bd6c[0x0]),_0x52e7ab[0x0][_0xb92545(0x3ae)]=this[_0xb92545(0x237)]();const _0x22c9b6=this[_0xb92545(0x376)]['createInstance'](_0x3dff93,this['unitID'],this[_0xb92545(0x223)],_0x52e7ab[0x0],this[_0xb92545(0x393)]);return _0x22c9b6[_0xb92545(0x2c1)](),_0x22c9b6;}return this[_0xb92545(0x2e0)](!0x1);}catch(_0x432978){return this[_0xb92545(0x256)][_0xb92545(0x457)](_0x432978),this[_0xb92545(0x2e0)](!0x1);}}[_0x3ceef6(0x1d7)](_0x431e05){const _0x1fa983=_0x3ceef6,_0x2b36ec=this[_0x1fa983(0x181)][_0x1fa983(0x2cb)](this['unitID']);if(_0x431e05[_0x1fa983(0x1d1)]<_0x2b36ec-0x1)return this;if(this[_0x1fa983(0x24c)](_0x431e05))return this[_0x1fa983(0x376)][_0x1fa983(0x1c4)](_0x4841b6,this[_0x1fa983(0x208)],this[_0x1fa983(0x223)],null,[],this[_0x1fa983(0x117)],[],this[_0x1fa983(0x393)]);this[_0x1fa983(0x103)]();const _0x1b74cb=this[_0x1fa983(0x376)][_0x1fa983(0x1c4)](_0x47affd,this['unitID'],this['type'],this[_0x1fa983(0x393)]);return _0x1b74cb[_0x1fa983(0x2c1)](),_0x1b74cb;}[_0x3ceef6(0x165)](_0xf34379){const _0x14e397=_0x3ceef6;return this[_0x14e397(0x2e0)](!!(_0xf34379!=null&&_0xf34379[_0x14e397(0x1ce)]));}[_0x3ceef6(0xef)](){const _0x372abc=_0x3ceef6;return this[_0x372abc(0x376)]['createInstance'](_0x29cdda,this[_0x372abc(0x208)],this[_0x372abc(0x223)],this[_0x372abc(0x117)],[],this['_handler']);}[_0x3ceef6(0x486)](){return this;}['resend'](){const _0x3f6a9b=_0x3ceef6;this[_0x3f6a9b(0x393)][_0x3f6a9b(0x37d)](this['_awaitingChangeset']);}[_0x3ceef6(0x2e0)](_0x47d8a0){const _0x148edd=_0x3ceef6;return this[_0x148edd(0x376)]['createInstance'](_0x41bb20,this[_0x148edd(0x208)],this[_0x148edd(0x223)],this['_awaitingChangeset'],[],this[_0x148edd(0x393)],_0x47d8a0);}};_0x3dff93=_0x3adde2([_0x241f3d(0x4,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x405)])),_0x241f3d(0x5,_0x24e1ed[_0x3ceef6(0x48f)](_0x3c4c3c['RevisionService'])),_0x241f3d(0x6,_0x24e1ed[_0x3ceef6(0x48f)](_0x481c9f[_0x3ceef6(0x271)])),_0x241f3d(0x7,_0x24e1ed['ICommandService']),_0x241f3d(0x8,_0x24e1ed[_0x3ceef6(0x250)]),_0x241f3d(0x9,_0x3c4c3c[_0x3ceef6(0x2cd)]),_0x241f3d(0xa,_0x24e1ed[_0x3ceef6(0x1f4)])],_0x3dff93);let _0xde0597=class extends _0x2b77b0{constructor(_0x5c140a,_0x4a461b,_0x137be3,_0x1dbab1,_0x11dfcb,_0x261d33,_0x43cc00,_0x373ef5,_0x354065,_0x488025,_0x32f898,_0x53bca9){const _0x109825=_0x3ceef6;super(_0x5c140a,_0x4a461b,_0x137be3,_0x1dbab1,_0x11dfcb,_0x354065,_0x53bca9,_0x43cc00,_0x373ef5),_0x1b84ec(this,_0x109825(0x355),_0x109825(0x149)),(this['_injector']=_0x261d33,this['_logService']=_0x488025,this[_0x109825(0x428)]=_0x32f898);}['appendMutation'](_0x31a408){const _0x166cb9=_0x3ceef6;return this[_0x166cb9(0x16d)]['push'](_0x31a408),this;}[_0x3ceef6(0x169)](_0x48ca1e){const _0x74571c=_0x3ceef6;if(this[_0x74571c(0x24c)](_0x48ca1e))return this['_injector'][_0x74571c(0x1c4)](_0x4841b6,this[_0x74571c(0x208)],this[_0x74571c(0x223)],this[_0x74571c(0x117)],this[_0x74571c(0x16d)],null,[_0x48ca1e],this[_0x74571c(0x393)]);try{const _0x3f9f90=this[_0x74571c(0x428)][_0x74571c(0x353)]([_0x48ca1e],[this[_0x74571c(0x117)]],!0x1);if(_0x3c4c3c['isTransformChangesetsSuccess'](_0x3f9f90)){const {c1Prime:_0x25dc1c,c2Prime:_0x5f06cd}=_0x3f9f90,_0x4d923c=this[_0x74571c(0x428)][_0x74571c(0x38c)](_0x25dc1c[0x0],this[_0x74571c(0x16d)]);if(_0x3c4c3c[_0x74571c(0x447)](_0x4d923c)){const {c1Prime:_0x1a705a,m2Prime:_0x1e8e35}=_0x4d923c;return this[_0x74571c(0x19e)](_0x1a705a),_0x5f06cd[0x0][_0x74571c(0x3ae)]=this['_getCurrentRevision'](),this[_0x74571c(0x376)][_0x74571c(0x1c4)](_0xde0597,this[_0x74571c(0x208)],this[_0x74571c(0x223)],_0x5f06cd[0x0],_0x1e8e35,this[_0x74571c(0x393)]);}throw _0x4d923c[_0x74571c(0x457)];}throw _0x3f9f90[_0x74571c(0x457)];}catch(_0x5e210a){return this['_logService'][_0x74571c(0x457)](_0x5e210a),this[_0x74571c(0x2e0)](!0x1);}}[_0x3ceef6(0x1d7)](_0x2793f4){const _0x271f65=_0x3ceef6;if(this['_checkMissing'](_0x2793f4))return this['_injector'][_0x271f65(0x1c4)](_0x4841b6,this['unitID'],this['type'],null,this['_pendingMutations'],this[_0x271f65(0x117)],[],this[_0x271f65(0x393)]);this[_0x271f65(0x103)]();const _0x300660=this['_injector'][_0x271f65(0x1c4)](_0x3e48b5,this[_0x271f65(0x208)],this[_0x271f65(0x223)],this['_pendingMutations'],this['_handler']);return _0x300660[_0x271f65(0x39b)](),_0x300660[_0x271f65(0x2c1)](),_0x300660;}[_0x3ceef6(0x165)](_0x37bc8d){const _0x2bf4fc=_0x3ceef6;return this[_0x2bf4fc(0x2e0)](!!(_0x37bc8d!=null&&_0x37bc8d['isPermissionRej']));}[_0x3ceef6(0xef)](){const _0x15a624=_0x3ceef6;return this[_0x15a624(0x376)]['createInstance'](_0x29cdda,this[_0x15a624(0x208)],this[_0x15a624(0x223)],this['_awaitingChangeset'],this[_0x15a624(0x16d)],this[_0x15a624(0x393)]);}[_0x3ceef6(0x486)](){return this;}[_0x3ceef6(0x182)](){const _0x2e65e8=_0x3ceef6;this[_0x2e65e8(0x393)]['onSendChangeset'](this[_0x2e65e8(0x117)]);}[_0x3ceef6(0x2e0)](_0x2b2463){const _0x283494=_0x3ceef6;return this[_0x283494(0x376)][_0x283494(0x1c4)](_0x41bb20,this[_0x283494(0x208)],this[_0x283494(0x223)],null,this[_0x283494(0x16d)],this['_handler'],_0x2b2463);}};_0xde0597=_0x3adde2([_0x241f3d(0x5,_0x24e1ed['Inject'](_0x24e1ed[_0x3ceef6(0x405)])),_0x241f3d(0x6,_0x24e1ed['Inject'](_0x3c4c3c['RevisionService'])),_0x241f3d(0x7,_0x24e1ed[_0x3ceef6(0x48f)](_0x481c9f[_0x3ceef6(0x271)])),_0x241f3d(0x8,_0x24e1ed[_0x3ceef6(0x28e)]),_0x241f3d(0x9,_0x24e1ed[_0x3ceef6(0x250)]),_0x241f3d(0xa,_0x3c4c3c[_0x3ceef6(0x2cd)]),_0x241f3d(0xb,_0x24e1ed[_0x3ceef6(0x1f4)])],_0xde0597);let _0x41bb20=class extends _0x2b77b0{constructor(_0x281a93,_0x350a2f,_0x2876fe,_0x5ed835,_0x55f279,_0x1a9968=!0x1,_0x382f85,_0x25236f,_0x249010,_0x12247f,_0xc3e5e6,_0x4c2c22,_0x18570b){const _0x36cd70=_0x3ceef6;super(_0x281a93,_0x350a2f,_0x2876fe,_0x5ed835,_0x55f279,_0x25236f,_0x249010,_0xc3e5e6,_0x12247f),_0x1b84ec(this,_0x36cd70(0x355),'conflict'),(this['_isPermissionRej']=_0x1a9968,this[_0x36cd70(0x4a2)]=_0x382f85,this[_0x36cd70(0x109)]=_0x4c2c22,this['_notificationService']=_0x18570b,this[_0x36cd70(0x186)](),this[_0x36cd70(0x105)](),this[_0x36cd70(0x102)]());}[_0x3ceef6(0xbf)](){return this;}[_0x3ceef6(0x169)](){return this;}[_0x3ceef6(0x1d7)](){return this;}['onRemoteRej'](){return this;}[_0x3ceef6(0xef)](){return this;}[_0x3ceef6(0x486)](){return this;}['resend'](){throw new Error('[ConflictState]:\x20invalid\x20calling\x20to\x20`resend`.');}[_0x3ceef6(0x105)](){const _0x2ead0c=_0x3ceef6;this['_localCacheService'][_0x2ead0c(0x37a)](this[_0x2ead0c(0x208)],this[_0x2ead0c(0x223)],null,[]);}[_0x3ceef6(0x186)](){const _0x588c1a=_0x3ceef6;this[_0x588c1a(0x3f9)]?this[_0x588c1a(0x328)][_0x588c1a(0x38a)]({'title':this[_0x588c1a(0x109)]['t'](_0x588c1a(0xec)),'content':this[_0x588c1a(0x109)]['t'](_0x588c1a(0x1e2)),'type':'error','duration':0x0}):this['_notificationService'][_0x588c1a(0x38a)]({'title':this['_localeService']['t'](_0x588c1a(0x431)),'content':this[_0x588c1a(0x109)]['t'](_0x588c1a(0x1f5)),'type':_0x588c1a(0x457),'duration':0x0});}[_0x3ceef6(0x102)](){const _0x4e4340=_0x3ceef6;this['_permissionService'][_0x4e4340(0x323)](new _0x5e02d9['WorkbookEditablePermission'](this[_0x4e4340(0x208)])['id'],!0x1);}};_0x41bb20=_0x3adde2([_0x241f3d(0x6,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x16f)])),_0x241f3d(0x7,_0x24e1ed['ICommandService']),_0x241f3d(0x8,_0x24e1ed[_0x3ceef6(0x1f4)]),_0x241f3d(0x9,_0x24e1ed['Inject'](_0x481c9f[_0x3ceef6(0x271)])),_0x241f3d(0xa,_0x24e1ed[_0x3ceef6(0x48f)](_0x3c4c3c['RevisionService'])),_0x241f3d(0xb,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed['LocaleService'])),_0x241f3d(0xc,_0x279279[_0x3ceef6(0x24d)])],_0x41bb20);let _0x29cdda=class extends _0x2b77b0{constructor(_0x412e52,_0x3d7622,_0x39c260,_0x26700f,_0x453b92,_0x23765b,_0x339d07,_0x2e4eb5,_0xb93377,_0x210d98){const _0x185351=_0x3ceef6;super(_0x412e52,_0x3d7622,_0x39c260,_0x26700f,_0x453b92,_0xb93377,_0x210d98,_0x339d07,_0x2e4eb5),_0x1b84ec(this,_0x185351(0x355),_0x185351(0x352)),this[_0x185351(0x376)]=_0x23765b;}[_0x3ceef6(0xbf)](_0x2bb6cf){const _0x2e030d=_0x3ceef6;return this[_0x2e030d(0x16d)]['push'](_0x2bb6cf),this[_0x2e030d(0x2c1)](),this;}[_0x3ceef6(0x169)](_0x16ac96){const _0x4dbc45=_0x3ceef6;throw new Error(_0x4dbc45(0x3f4));}[_0x3ceef6(0x1d7)](){const _0x517689=_0x3ceef6;throw new Error(_0x517689(0x26b));}[_0x3ceef6(0x165)](){throw new Error('[OfflineState]:\x20received\x20rejection.');}[_0x3ceef6(0xef)](){return this;}[_0x3ceef6(0x486)](){const _0x5fa55c=_0x3ceef6,{_injector:_0x4d667f,_pendingMutations:_0x2d9152,_awaitingChangeset:_0x178f70,unitID:_0xd07f1b,_handler:_0x485140,type:_0x5cf707}=this,_0x395059=_0x83489(_0x4d667f,_0xd07f1b,_0x5cf707,_0x178f70,_0x2d9152,_0x485140);return _0x395059 instanceof _0x3e48b5?_0x395059[_0x5fa55c(0x39b)]():(_0x395059 instanceof _0xde0597||_0x395059 instanceof _0x3dff93)&&_0x395059[_0x5fa55c(0x182)](),_0x395059;}['resend'](){const _0xa08e39=_0x3ceef6;throw new Error(_0xa08e39(0x100));}};_0x29cdda=_0x3adde2([_0x241f3d(0x5,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x405)])),_0x241f3d(0x6,_0x24e1ed[_0x3ceef6(0x48f)](_0x3c4c3c[_0x3ceef6(0x3dd)])),_0x241f3d(0x7,_0x24e1ed[_0x3ceef6(0x48f)](_0x481c9f[_0x3ceef6(0x271)])),_0x241f3d(0x8,_0x24e1ed[_0x3ceef6(0x28e)]),_0x241f3d(0x9,_0x24e1ed['IUndoRedoService'])],_0x29cdda);let _0x4841b6=class extends _0x2b77b0{constructor(_0x4d6ac3,_0x3e2dd4,_0xabd117,_0xa81ed7,_0x405eb7,_0x2f5a09,_0x10192e,_0x365537,_0x12d4e3,_0xbc3897,_0x4e0507,_0x4c8638,_0x33d6f3,_0x138322){const _0x434d92=_0x3ceef6;super(_0x4d6ac3,_0x3e2dd4,_0xabd117,_0xa81ed7,_0x10192e,_0x4c8638,_0x33d6f3,_0x12d4e3,_0xbc3897),_0x1b84ec(this,_0x434d92(0x355),_0x434d92(0x132)),(this[_0x434d92(0x3d1)]=_0x405eb7,this[_0x434d92(0x120)]=_0x2f5a09,this[_0x434d92(0x376)]=_0x365537,this[_0x434d92(0x256)]=_0x4e0507,this[_0x434d92(0x428)]=_0x138322);}[_0x3ceef6(0xfc)](_0x17b4c5){const _0x15defb=_0x3ceef6;try{const _0x3aa677=[..._0x17b4c5,...this[_0x15defb(0x120)]],_0x1a344b=[this[_0x15defb(0x117)]||this[_0x15defb(0x3d1)]]['filter'](_0x3b11d7=>!!_0x3b11d7);let _0x9e356f,_0x4e66f1;if(_0x1a344b['length']){const _0x538092=this[_0x15defb(0x428)][_0x15defb(0x353)](_0x3aa677,_0x1a344b,!0x1);if(!_0x3c4c3c[_0x15defb(0x31b)](_0x538092))throw _0x538092[_0x15defb(0x457)];_0x9e356f=_0x538092[_0x15defb(0x467)],_0x4e66f1=_0x538092[_0x15defb(0x24b)];}else _0x9e356f=_0x3aa677,_0x4e66f1=[];let _0x540daa=this[_0x15defb(0x16d)];_0x9e356f[_0x15defb(0x115)](_0x3b2215=>{const _0x10b961=_0x15defb;let _0x54b6c4;if(_0x540daa[_0x10b961(0x346)]){const _0xec2a98=this[_0x10b961(0x428)]['transformMutationsWithChangeset'](_0x3b2215,_0x540daa);if(!_0x3c4c3c[_0x10b961(0x447)](_0xec2a98))throw _0xec2a98[_0x10b961(0x457)];_0x54b6c4=_0xec2a98[_0x10b961(0x467)],_0x540daa=_0xec2a98[_0x10b961(0x49c)];}else _0x54b6c4=_0x3b2215;this[_0x10b961(0x19e)](_0x54b6c4);}),this[_0x15defb(0x3d1)]&&this[_0x15defb(0x103)](),this[_0x15defb(0x117)]&&_0x4e66f1['length']&&(_0x4e66f1[0x0][_0x15defb(0x3ae)]=this[_0x15defb(0x237)]());let _0x2c45f;if(this['_awaitingChangeset']&&_0x540daa['length']!==0x0)_0x2c45f=this[_0x15defb(0x376)][_0x15defb(0x1c4)](_0xde0597,this[_0x15defb(0x208)],this[_0x15defb(0x223)],_0x4e66f1[0x0],_0x540daa,this[_0x15defb(0x393)]);else{if(this[_0x15defb(0x117)]&&_0x540daa[_0x15defb(0x346)]===0x0)_0x4e66f1[0x0][_0x15defb(0x3ae)]=this['_getCurrentRevision'](),_0x2c45f=this[_0x15defb(0x376)]['createInstance'](_0x3dff93,this[_0x15defb(0x208)],this[_0x15defb(0x223)],_0x4e66f1[0x0],this[_0x15defb(0x393)]);else{if(_0x540daa['length']!==0x0){const _0x3ff009=this[_0x15defb(0x376)][_0x15defb(0x1c4)](_0x3e48b5,this['unitID'],this['type'],_0x540daa,this[_0x15defb(0x393)]);_0x3ff009[_0x15defb(0x39b)](),_0x2c45f=_0x3ff009;}else _0x2c45f=this['_injector']['createInstance'](_0x47affd,this[_0x15defb(0x208)],this[_0x15defb(0x223)],this['_handler']);}}return _0x2c45f[_0x15defb(0x2c1)](),_0x2c45f;}catch(_0x51518f){return this[_0x15defb(0x256)][_0x15defb(0x457)]('[FetchMissState]',_0x15defb(0x11d),_0x51518f),this[_0x15defb(0x376)]['createInstance'](_0x41bb20,this[_0x15defb(0x208)],this['type'],this[_0x15defb(0x117)],this['_pendingMutations'],this['_handler'],!0x1);}}[_0x3ceef6(0x182)](){const _0x4eb6fb=_0x3ceef6;throw new Error(_0x4eb6fb(0x1c0));}['appendMutation'](_0xc5fe52){const _0x4565e1=_0x3ceef6;return this['_pendingMutations'][_0x4565e1(0x279)](_0xc5fe52),this;}['onRemoteChangeset'](_0x57abd4){const _0x3901dd=_0x3ceef6;return this[_0x3901dd(0x120)][_0x3901dd(0x279)](_0x57abd4),this;}[_0x3ceef6(0x1d7)](_0x4e5611){const _0x5ee634=_0x3ceef6;if(this[_0x5ee634(0x117)])return this['_acknowledgedAwaitingChangeset']=this[_0x5ee634(0x117)],this['_awaitingChangeset']=null,this;throw new Error(_0x5ee634(0xe2));}[_0x3ceef6(0x165)](_0x5b8f89){const _0x550953=_0x3ceef6;return this['_onConflict'](!!(_0x5b8f89!=null&&_0x5b8f89[_0x550953(0x1ce)]));}[_0x3ceef6(0xef)](){const _0x29923a=_0x3ceef6;return this[_0x29923a(0x376)][_0x29923a(0x1c4)](_0x29cdda,this[_0x29923a(0x208)],this['type'],this[_0x29923a(0x117)],this[_0x29923a(0x16d)],this[_0x29923a(0x393)]);}[_0x3ceef6(0x486)](){return this;}[_0x3ceef6(0x2e0)](_0x25f23d){const _0x1f1030=_0x3ceef6;return this[_0x1f1030(0x376)][_0x1f1030(0x1c4)](_0x41bb20,this[_0x1f1030(0x208)],this[_0x1f1030(0x223)],this[_0x1f1030(0x117)],this[_0x1f1030(0x16d)],this['_handler'],_0x25f23d);}};_0x4841b6=_0x3adde2([_0x241f3d(0x7,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed['Injector'])),_0x241f3d(0x8,_0x24e1ed[_0x3ceef6(0x48f)](_0x3c4c3c[_0x3ceef6(0x3dd)])),_0x241f3d(0x9,_0x24e1ed[_0x3ceef6(0x48f)](_0x481c9f[_0x3ceef6(0x271)])),_0x241f3d(0xa,_0x24e1ed[_0x3ceef6(0x250)]),_0x241f3d(0xb,_0x24e1ed[_0x3ceef6(0x28e)]),_0x241f3d(0xc,_0x24e1ed['IUndoRedoService']),_0x241f3d(0xd,_0x3c4c3c[_0x3ceef6(0x2cd)])],_0x4841b6);function _0x83489(_0x8f9049,_0x3668a7,_0x49a276,_0x3c59b8,_0xb59dc8,_0x1015b7){const _0x363e0c=_0x3ceef6;return _0x3c59b8&&_0xb59dc8[_0x363e0c(0x346)]?_0x8f9049[_0x363e0c(0x1c4)](_0xde0597,_0x3668a7,_0x49a276,_0x3c59b8,_0xb59dc8,_0x1015b7):_0x3c59b8?_0x8f9049['createInstance'](_0x3dff93,_0x3668a7,_0x49a276,_0x3c59b8,_0x1015b7):_0xb59dc8[_0x363e0c(0x346)]?_0x8f9049[_0x363e0c(0x1c4)](_0x3e48b5,_0x3668a7,_0x49a276,_0xb59dc8,_0x1015b7):_0x8f9049[_0x363e0c(0x1c4)](_0x47affd,_0x3668a7,_0x49a276,_0x1015b7);}var _0x10bb3d=Object[_0x3ceef6(0x2d1)],_0x4e3a31=Object[_0x3ceef6(0x3fa)],_0x37a4eb=(_0x3a47fa,_0x2a16af,_0x31eeb0,_0x209fd1)=>{for(var _0x49d5c9=_0x209fd1>0x1?void 0x0:_0x209fd1?_0x4e3a31(_0x2a16af,_0x31eeb0):_0x2a16af,_0x4f2dd6=_0x3a47fa['length']-0x1,_0xe798a3;_0x4f2dd6>=0x0;_0x4f2dd6--)(_0xe798a3=_0x3a47fa[_0x4f2dd6])&&(_0x49d5c9=(_0x209fd1?_0xe798a3(_0x2a16af,_0x31eeb0,_0x49d5c9):_0xe798a3(_0x49d5c9))||_0x49d5c9);return _0x209fd1&&_0x49d5c9&&_0x10bb3d(_0x2a16af,_0x31eeb0,_0x49d5c9),_0x49d5c9;},_0x2ecc88=(_0x2386e6,_0x270967)=>(_0x4b4855,_0x5f354c)=>_0x270967(_0x4b4855,_0x5f354c,_0x2386e6);_0x481c9f['CollaborationController']=class extends _0x24e1ed[_0x3ceef6(0x379)]{constructor(_0x3859e6,_0x1e6544,_0x129c12){const _0xcdc4e3=_0x3ceef6;super(),_0x1b84ec(this,_0xcdc4e3(0x31f),new Map()),_0x1b84ec(this,_0xcdc4e3(0xb8),new _0x5ba5b9['Subject']()),(this[_0xcdc4e3(0x376)]=_0x3859e6,this[_0xcdc4e3(0x349)]=_0x1e6544,this[_0xcdc4e3(0x198)]=_0x129c12,this[_0xcdc4e3(0x13c)]());}[_0x3ceef6(0x377)](){const _0x253d4f=_0x3ceef6;super[_0x253d4f(0x377)](),this['_entities'][_0x253d4f(0x115)](_0x937443=>_0x937443[_0x253d4f(0x377)]()),this[_0x253d4f(0x31f)][_0x253d4f(0x3a5)]();}[_0x3ceef6(0x199)](_0x39f8cc){const _0x106cd4=_0x3ceef6;var _0x3867f6;return(_0x3867f6=this[_0x106cd4(0x31f)]['get'](_0x39f8cc))!=null?_0x3867f6:null;}[_0x3ceef6(0x408)](_0x5d5e19){const _0x198477=_0x3ceef6,_0x1ca363=this[_0x198477(0x199)](_0x5d5e19);return _0x1ca363?_0x5ba5b9['of'](_0x1ca363):this['_entityInit$'][_0x198477(0x30e)](_0xb49021[_0x198477(0xd0)](_0x24f208=>_0x24f208['unitID']===_0x5d5e19));}[_0x3ceef6(0x13c)](){const _0x2c924e=_0x3ceef6;this['_univerInstanceService'][_0x2c924e(0x1e5)](_0x24e1ed[_0x2c924e(0x1dd)][_0x2c924e(0x2b3)])[_0x2c924e(0x30e)](_0x5ba5b9['takeUntil'](this[_0x2c924e(0x318)]),_0xb49021['delay'](0x10))[_0x2c924e(0x1b0)](async _0x5d3fef=>{const _0x250119=_0x2c924e,_0x2d3cb1=_0x5d3fef[_0x250119(0x398)](),_0x3b116b=await this[_0x250119(0x274)](_0x2d3cb1,_0x1a91ec[_0x250119(0x2b3)]);this['_entities'][_0x250119(0xe7)](_0x2d3cb1,_0x3b116b);}),this[_0x2c924e(0x198)][_0x2c924e(0x1e5)](_0x24e1ed['UniverInstanceType'][_0x2c924e(0x192)])['pipe'](_0x5ba5b9[_0x2c924e(0x2c3)](this[_0x2c924e(0x318)]),_0xb49021[_0x2c924e(0x3de)](0x10))[_0x2c924e(0x30e)](_0xb49021['filter'](_0x1e31f2=>!_0x1e31f2[_0x2c924e(0x398)]()['startsWith']('__')))[_0x2c924e(0x1b0)](async _0x1dd168=>{const _0x304eef=_0x2c924e,_0x4b69b7=_0x1dd168[_0x304eef(0x398)](),_0x5d6361=await this['_startCollaboration'](_0x4b69b7,_0x1a91ec[_0x304eef(0x192)]);this[_0x304eef(0x31f)][_0x304eef(0xe7)](_0x4b69b7,_0x5d6361);}),_0x5ba5b9[_0x2c924e(0x36f)](this[_0x2c924e(0x198)][_0x2c924e(0x1fd)](_0x24e1ed[_0x2c924e(0x1dd)][_0x2c924e(0x2b3)]),this[_0x2c924e(0x198)][_0x2c924e(0x1fd)](_0x24e1ed['UniverInstanceType']['UNIVER_DOC']))['pipe'](_0x5ba5b9[_0x2c924e(0x2c3)](this['dispose$']))[_0x2c924e(0x1b0)](_0x4074e6=>{const _0x2e8e00=_0x2c924e,_0x332131=_0x4074e6['getUnitId'](),_0x3b85c1=this[_0x2e8e00(0x31f)][_0x2e8e00(0x414)](_0x332131);_0x3b85c1&&(_0x3b85c1[_0x2e8e00(0x377)](),this['_entities'][_0x2e8e00(0x15d)](_0x332131));});}async[_0x3ceef6(0x274)](_0x504a88,_0x34565e){const _0x4cb719=_0x3ceef6,_0x243819=await this['_collabSessionService'][_0x4cb719(0x1b9)](_0x504a88),_0x57beff=this['_injector'][_0x4cb719(0x1c4)](this['_getCtorByUniverType'](_0x34565e),_0x504a88,_0x34565e,_0x243819);return await _0x57beff[_0x4cb719(0x143)](),this[_0x4cb719(0xb8)][_0x4cb719(0x48b)](_0x57beff),_0x57beff;}['_getCtorByUniverType'](_0x38d3da){const _0x5b0408=_0x3ceef6;switch(_0x38d3da){case _0x1a91ec[_0x5b0408(0x192)]:return _0x510f00;case _0x1a91ec[_0x5b0408(0x2b3)]:return _0x481c9f['SheetCollaborationEntity'];default:throw new Error('[CollaborationController]:\x20invalid\x20univer\x20type:\x20'+_0x38d3da);}}},_0x481c9f[_0x3ceef6(0x3b2)]=_0x37a4eb([_0x24e1ed[_0x3ceef6(0x25e)](_0x24e1ed[_0x3ceef6(0xf7)][_0x3ceef6(0x1a3)],_0x481c9f['CollaborationController']),_0x2ecc88(0x0,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed['Injector'])),_0x2ecc88(0x1,_0x24e1ed['Inject'](_0x481c9f[_0x3ceef6(0x2e6)])),_0x2ecc88(0x2,_0x24e1ed[_0x3ceef6(0x36c)])],_0x481c9f[_0x3ceef6(0x3b2)]);let _0x4320d8=class extends _0x24e1ed[_0x3ceef6(0x379)]{constructor(_0x5352b7,_0x50121c,_0x5aaa34,_0x2d32a2,_0x14c92e,_0x51362a,_0x52ce67,_0x237896,_0x20953e,_0x27650d,_0x3c37db,_0x3c9b7a,_0x34e8e3){const _0x5ecca5=_0x3ceef6;super(),_0x1b84ec(this,_0x5ecca5(0x39a),new _0x5ba5b9[(_0x5ecca5(0x43c))](null)),_0x1b84ec(this,_0x5ecca5(0x451),this['_state$'][_0x5ecca5(0x2ce)]()),_0x1b84ec(this,_0x5ecca5(0x32f)),_0x1b84ec(this,_0x5ecca5(0x2c8),!0x1),_0x1b84ec(this,_0x5ecca5(0x17f),this[_0x5ecca5(0x451)][_0x5ecca5(0x30e)](_0xb49021['map'](_0x507ec6=>_0x507ec6?_0x507ec6[_0x5ecca5(0x355)]:_0x5a1c45[_0x5ecca5(0x27c)]),_0xb49021['shareReplay'](0x1))),_0x1b84ec(this,'_transitionLocked',!0x1),_0x1b84ec(this,_0x5ecca5(0x3f0),[]),(this[_0x5ecca5(0x208)]=_0x5352b7,this[_0x5ecca5(0x3df)]=_0x50121c,this['_session']=_0x5aaa34,this[_0x5ecca5(0x376)]=_0x2d32a2,this[_0x5ecca5(0x140)]=_0x14c92e,this['_compressMutationService']=_0x51362a,this[_0x5ecca5(0x109)]=_0x52ce67,this[_0x5ecca5(0x181)]=_0x237896,this[_0x5ecca5(0x256)]=_0x20953e,this[_0x5ecca5(0x285)]=_0x27650d,this['_messageService']=_0x3c37db,this[_0x5ecca5(0x4a2)]=_0x3c9b7a,this[_0x5ecca5(0x138)]=_0x34e8e3);}get['state'](){const _0x1c4478=_0x3ceef6;return this[_0x1c4478(0x32f)];}async['init'](){const _0x473559=_0x3ceef6;if(this['state'])throw new Error('[CollaborationEntity]:\x20initial\x20state\x20has\x20been\x20created\x20before.\x20You\x20should\x20not\x20call\x20\x22init\x22\x20twice.');await this[_0x473559(0x13c)]();}[_0x3ceef6(0x234)](){const _0x35e283=_0x3ceef6;return this['_collaborationPaused']=!0x0,_0x24e1ed[_0x35e283(0x18f)](()=>{const _0x6085b6=_0x35e283;this[_0x6085b6(0x2c8)]=!0x1,this[_0x6085b6(0x305)]();});}['_updateState'](_0x860f20){const _0x5e635f=_0x3ceef6;this['_state']=_0x860f20,this[_0x5e635f(0x39a)]['next'](_0x860f20);}async[_0x3ceef6(0x13c)](){const _0x428126=_0x3ceef6;var _0x4981a0;return this[_0x428126(0x1de)](await this[_0x428126(0x111)]()),this[_0x428126(0x138)]&&((_0x4981a0=this['_singleActiveUnitService'])==null||_0x4981a0[_0x428126(0x1e7)](this[_0x428126(0x208)]),this[_0x428126(0x184)](_0x24e1ed[_0x428126(0x18f)](this[_0x428126(0x138)][_0x428126(0x334)](this[_0x428126(0x208)])['subscribe'](_0x15a69b=>{const _0x42002b=_0x428126;this[_0x42002b(0x256)][_0x42002b(0x1f3)](_0x42002b(0x3e4),_0x42002b(0x200),_0x15a69b),_0x15a69b===_0x46ede2[_0x42002b(0x2a8)]?(this[_0x42002b(0x2f6)][_0x42002b(0x38a)]({'content':this[_0x42002b(0x109)]['t'](_0x42002b(0x303)),'type':_0x49b15b[_0x42002b(0x1b6)][_0x42002b(0x3c9)]}),this[_0x42002b(0x4a2)][_0x42002b(0x323)](new _0x5e02d9[(_0x42002b(0x232))](this['unitID'])['id'],!0x1)):this[_0x42002b(0x4a2)][_0x42002b(0x323)](new _0x5e02d9[(_0x42002b(0x232))](this[_0x42002b(0x208)])['id'],!0x0);})))),this[_0x428126(0x184)](_0x24e1ed[_0x428126(0x18f)](this['_session']['sessionStatus$'][_0x428126(0x1b0)](_0xcecda5=>{const _0x19dffa=_0x428126;_0xcecda5===_0x4ad0db[_0x19dffa(0x32a)]?this[_0x19dffa(0x1a8)]():_0xcecda5===_0x4ad0db['OFFLINE']&&this[_0x19dffa(0x46a)]();}))),this['disposeWithMe'](_0x24e1ed[_0x428126(0x18f)](this[_0x428126(0x385)][_0x428126(0x247)][_0x428126(0x1b0)](_0xbde74a=>{const _0x5ba32f=_0x428126;try{switch(_0xbde74a[_0x5ba32f(0x17c)]){case _0x3c4c3c[_0x5ba32f(0x3ce)]['NEW_CHANGESETS']:{this[_0x5ba32f(0x330)](_0x3c4c3c[_0x5ba32f(0x219)](_0xbde74a[_0x5ba32f(0x2e4)]));break;}case _0x3c4c3c[_0x5ba32f(0x3ce)][_0x5ba32f(0x1d5)]:{this['_onRemoteACK'](_0xbde74a[_0x5ba32f(0x2e4)]);break;}case _0x3c4c3c[_0x5ba32f(0x3ce)][_0x5ba32f(0x29f)]:{this[_0x5ba32f(0x1c5)]();break;}case _0x3c4c3c['CollaborationEvent']['PSEUDO_FETCH_MISSING_RESULT']:{this['_onFetchMissResult'](_0xbde74a['data'][_0x5ba32f(0x32b)][_0x5ba32f(0x315)](_0x283c16=>_0x3c4c3c[_0x5ba32f(0x219)](_0x283c16)));break;}case _0x3c4c3c[_0x5ba32f(0x3ce)]['PERMISSION_REJ']:this['_onRemoteRejected']({'isPermissionRej':!0x0});}}catch(_0x193b80){throw console[_0x5ba32f(0x457)](_0x5ba32f(0x1b2),_0x193b80),_0x193b80;}}))),this['_state'];}[_0x3ceef6(0x402)](){this['_transitionLocked']=!0x1;}[_0x3ceef6(0x22e)](){const _0x7908ec=_0x3ceef6;if(this[_0x7908ec(0x2a5)])throw new Error(_0x7908ec(0x17a));this[_0x7908ec(0x2a5)]=!0x0;}[_0x3ceef6(0x3f5)](_0x41aa8a){const _0x3964c4=_0x3ceef6;this[_0x3964c4(0x22e)](),this[_0x3964c4(0x1de)](this['_state'][_0x3964c4(0xbf)](_0x41aa8a)),this[_0x3964c4(0x402)]();}[_0x3ceef6(0x330)](_0x2d519c){const _0x3d6280=_0x3ceef6;if(!(_0x2d519c['revision']<=this[_0x3d6280(0x181)][_0x3d6280(0x2cb)](this[_0x3d6280(0x208)]))){if(this[_0x3d6280(0x2c8)]){this[_0x3d6280(0x3f0)]['push'](_0x2d519c);return;}this[_0x3d6280(0x10f)](_0x2d519c);}}[_0x3ceef6(0x305)](){const _0x6d1e09=_0x3ceef6;this[_0x6d1e09(0x3f0)][_0x6d1e09(0x115)](_0x2bc52f=>this[_0x6d1e09(0x10f)](_0x2bc52f)),this[_0x6d1e09(0x3f0)]=[];}['_applyRemoteChangeset'](_0x75e550){const _0x479230=_0x3ceef6,_0x2b2b51=this[_0x479230(0x3ca)][_0x479230(0xf8)]['fetchThroughInterceptors'](this[_0x479230(0x3ca)]['interceptor'][_0x479230(0x2b9)]()[_0x479230(0x3d9)])(_0x75e550['mutations'],null)||_0x75e550['mutations'],_0x815ef4={..._0x75e550,'mutations':_0x2b2b51};this[_0x479230(0x22e)](),this['_updateState'](this[_0x479230(0x32f)]['onRemoteChangeset'](_0x815ef4)),this[_0x479230(0x402)]();}['_onRemoteACK'](_0x4db50f){const _0x2d25fe=_0x3ceef6;this[_0x2d25fe(0x22e)](),this[_0x2d25fe(0x1de)](this['_state'][_0x2d25fe(0x1d7)](_0x4db50f)),this[_0x2d25fe(0x402)]();}['_onRemoteRejected'](_0x38d8e8){const _0x23be2c=_0x3ceef6;this[_0x23be2c(0x22e)](),this['_updateState'](this[_0x23be2c(0x32f)]['onRemoteRej'](_0x38d8e8)),this[_0x23be2c(0x402)]();}[_0x3ceef6(0x478)](_0x3668a2){const _0x98fa2=_0x3ceef6;if(!(this[_0x98fa2(0x32f)]instanceof _0x4841b6))throw new TypeError(_0x98fa2(0x104));const _0x199be6=_0x3668a2[_0x98fa2(0x315)](_0x1b7fce=>{const _0x9c07a=_0x98fa2,_0x1ed452=this[_0x9c07a(0x3ca)][_0x9c07a(0xf8)][_0x9c07a(0xf0)](this[_0x9c07a(0x3ca)][_0x9c07a(0xf8)]['getInterceptPoints']()[_0x9c07a(0x3d9)])(_0x1b7fce[_0x9c07a(0x34a)],null)||_0x1b7fce[_0x9c07a(0x34a)];return{..._0x1b7fce,'mutations':_0x1ed452};});this[_0x98fa2(0x22e)](),this[_0x98fa2(0x1de)](this[_0x98fa2(0x32f)][_0x98fa2(0xfc)](_0x199be6)),this[_0x98fa2(0x402)]();}[_0x3ceef6(0x46a)](){const _0x6183e0=_0x3ceef6;this[_0x6183e0(0x22e)](),this[_0x6183e0(0x1de)](this[_0x6183e0(0x32f)][_0x6183e0(0xef)]()),this['_unlockTransition']();}[_0x3ceef6(0x1a8)](){const _0x1e64ab=_0x3ceef6;this[_0x1e64ab(0x22e)](),this['_updateState'](this['_state'][_0x1e64ab(0x486)]()),this['_unlockTransition']();}async[_0x3ceef6(0x111)](){return new Promise(_0x95e16f=>{const _0x3180cc=_0x5b63;this[_0x3180cc(0x385)][_0x3180cc(0x40a)][_0x3180cc(0x30e)](_0xb49021[_0x3180cc(0xde)](0x1))[_0x3180cc(0x1b0)](async _0x337a5d=>{const _0x3adc59=_0x3180cc;_0x95e16f(await this['_createInitialStateImpl'](_0x337a5d===_0x4ad0db[_0x3adc59(0x32a)]));});});}[_0x3ceef6(0x264)](){const _0x3bb491=_0x3ceef6,_0x53ce99=this[_0x3bb491(0x208)];return{'onStateChange':(_0x59fa34,_0x530718)=>{const _0x5cbb50=_0x3bb491;if(_0x59fa34!==this['_state'])throw new Error(_0x5cbb50(0xf3)+_0x59fa34[_0x5cbb50(0x355)]+'\x0aAfter:\x20'+_0x530718['status']+_0x5cbb50(0x113)+this[_0x5cbb50(0x32f)]['status']);this[_0x5cbb50(0x1de)](_0x530718);},'onSendChangeset':_0x24e3eb=>{const _0x5d4cd6=_0x3bb491,_0x1d51aa={'eventID':_0x3c4c3c['CollaborationEvent'][_0x5d4cd6(0x426)],'data':{'unitID':_0x24e3eb[_0x5d4cd6(0x208)],'unitType':this[_0x5d4cd6(0x3df)],'changeset':_0x24e3eb,'memberID':this['_session'][_0x5d4cd6(0x3e9)]()}};this[_0x5d4cd6(0x385)]['send'](_0x1d51aa,this[_0x5d4cd6(0x208)]);},'onMissingChangesets':({from:_0xba5956,to:_0x3812dd})=>{const _0x6200c5=_0x3bb491;this[_0x6200c5(0x256)][_0x6200c5(0x1f3)](_0x6200c5(0x3e4),_0x6200c5(0x26c)+_0xba5956+_0x6200c5(0x2be)+_0x3812dd);const _0x2469a9={'eventID':_0x3c4c3c['CollaborationEvent'][_0x6200c5(0x205)],'data':{'unitID':_0x53ce99,'unitType':this[_0x6200c5(0x3df)],'from':_0xba5956,'to':_0x3812dd}};this['_session'][_0x6200c5(0x42c)](_0x2469a9,this[_0x6200c5(0x208)]);}};}async[_0x3ceef6(0x391)](_0x183929){const _0x241796=_0x3ceef6;var _0x3cd787,_0x447b91;const _0x381493=await this[_0x241796(0x140)]['loadOfflineData'](this[_0x241796(0x208)]),_0x2e8b9e=(_0x3cd787=_0x381493==null?void 0x0:_0x381493[_0x241796(0x34a)])!=null?_0x3cd787:[],_0x26b5f5=(_0x447b91=_0x381493==null?void 0x0:_0x381493['awaitingChangeset'])!=null?_0x447b91:null,_0x4126aa=this[_0x241796(0x208)];try{this[_0x241796(0x373)](_0x26b5f5,_0x2e8b9e);}catch(_0x1bfa0f){this['_logService'][_0x241796(0x457)](_0x1bfa0f);}const _0x3ee20e=this['_createHandler']();if(_0x183929){const _0x45d9d9=_0x83489(this[_0x241796(0x376)],_0x4126aa,this[_0x241796(0x3df)],_0x26b5f5,_0x2e8b9e,_0x3ee20e);return _0x45d9d9 instanceof _0x3e48b5?_0x45d9d9[_0x241796(0x39b)]():(_0x45d9d9 instanceof _0xde0597||_0x45d9d9 instanceof _0x3dff93)&&_0x45d9d9['resend'](),_0x45d9d9;}return this[_0x241796(0x376)][_0x241796(0x1c4)](_0x29cdda,_0x4126aa,this[_0x241796(0x3df)],_0x26b5f5,_0x2e8b9e,_0x3ee20e);}[_0x3ceef6(0x373)](_0x49e71c,_0x2ca376){const _0x20d8be=_0x3ceef6;var _0x35ffdb,_0x2c74d2;const _0x492375=this[_0x20d8be(0x3ca)]['interceptor'][_0x20d8be(0xf0)](this[_0x20d8be(0x3ca)][_0x20d8be(0xf8)]['getInterceptPoints']()['COMPRESS_MUTATION_APPLY']);(_0x35ffdb=_0x492375((_0x49e71c==null?void 0x0:_0x49e71c[_0x20d8be(0x34a)])||[],null))==null||_0x35ffdb[_0x20d8be(0x115)](_0x279fdd=>this[_0x20d8be(0x285)][_0x20d8be(0x2ef)](_0x279fdd['id'],_0x279fdd[_0x20d8be(0xbe)])),(_0x2c74d2=_0x492375(_0x2ca376||[],null))==null||_0x2c74d2[_0x20d8be(0x115)](_0x369ef=>this[_0x20d8be(0x285)][_0x20d8be(0x2ef)](_0x369ef['id'],_0x369ef[_0x20d8be(0xbe)]));}};_0x4320d8=_0x37a4eb([_0x2ecc88(0x3,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x405)])),_0x2ecc88(0x4,_0x24e1ed[_0x3ceef6(0x48f)](_0x481c9f[_0x3ceef6(0x271)])),_0x2ecc88(0x5,_0x24e1ed['Inject'](_0x3c4c3c[_0x3ceef6(0x295)])),_0x2ecc88(0x6,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x31c)])),_0x2ecc88(0x7,_0x24e1ed['Inject'](_0x3c4c3c['RevisionService'])),_0x2ecc88(0x8,_0x24e1ed[_0x3ceef6(0x250)]),_0x2ecc88(0x9,_0x24e1ed['ICommandService']),_0x2ecc88(0xa,_0x279279[_0x3ceef6(0x3a7)]),_0x2ecc88(0xb,_0x24e1ed[_0x3ceef6(0x16f)]),_0x2ecc88(0xc,_0x24e1ed[_0x3ceef6(0xcf)](_0x45c59f))],_0x4320d8);let _0x510f00=class extends _0x4320d8{constructor(_0x22f3e,_0x2d122f,_0x4d32bb,_0xe5cb12,_0x1f263f,_0x2f9b12,_0x16b5de,_0x5db9dd,_0x1084de,_0x9e9518,_0x390cb3,_0x4547fb,_0x278458,_0x145a83,_0x2e5871,_0x11e557,_0x2826a5){const _0x46777c=_0x3ceef6;super(_0x22f3e,_0x2d122f,_0x4d32bb,_0xe5cb12,_0x1f263f,_0x2f9b12,_0x16b5de,_0x5db9dd,_0x278458,_0x145a83,_0x2e5871,_0x11e557,_0x2826a5),this['unitID']=_0x22f3e,this[_0x46777c(0x223)]=_0x2d122f,this[_0x46777c(0x41b)]=_0x4d32bb,this['_docStateChangeManagerService']=_0x1084de,this[_0x46777c(0x483)]=_0x9e9518,this[_0x46777c(0x40b)]=_0x390cb3,this[_0x46777c(0x3fe)]=_0x4547fb;}['_createHandler'](){const _0x1cdde7=_0x3ceef6,_0x1343f6=super[_0x1cdde7(0x264)]();return _0x1343f6[_0x1cdde7(0x193)]=_0x282368=>this[_0x1cdde7(0x483)]['transformIMECache'](_0x282368),_0x1343f6[_0x1cdde7(0xb7)]=_0x25294a=>this['_docTransformSelectionsService'][_0x1cdde7(0x238)](_0x25294a),_0x1343f6[_0x1cdde7(0x209)]=_0x5c2e1d=>this[_0x1cdde7(0x3fe)][_0x1cdde7(0xf5)](_0x5c2e1d),_0x1343f6[_0x1cdde7(0x3a3)]=_0xa8e66e=>this['_docTransformIMECacheService'][_0x1cdde7(0x311)](_0xa8e66e),_0x1343f6;}async[_0x3ceef6(0x13c)](){const _0x33581e=_0x3ceef6,_0x31ec71=await super[_0x33581e(0x13c)]();return this[_0x33581e(0x184)](this['_commandService']['onCommandExecuted']((_0x2108ba,_0xfd58e4)=>{const _0x4b57f9=_0x33581e;if(_0x2108ba[_0x4b57f9(0x223)]!==_0x24e1ed['CommandType'][_0x4b57f9(0x38e)]||_0xfd58e4!=null&&_0xfd58e4['fromCollab']||_0xfd58e4!=null&&_0xfd58e4[_0x4b57f9(0x48d)])return;const _0x3dc60b=_0x2108ba[_0x4b57f9(0xbe)];if((_0x3dc60b==null?void 0x0:_0x3dc60b[_0x4b57f9(0x167)])!==this[_0x4b57f9(0x208)])return;let _0x5be4fe=_0x2108ba;if(_0x5be4fe['id']===_0x2c946a[_0x4b57f9(0x3f8)]['id']){const _0x117dc4=_0x5be4fe['params'];_0x5be4fe={'id':_0x2c946a[_0x4b57f9(0x3f8)]['id'],'type':_0x24e1ed[_0x4b57f9(0x24a)][_0x4b57f9(0x38e)],'params':{'unitId':_0x117dc4[_0x4b57f9(0x167)],'actions':_0x117dc4[_0x4b57f9(0x1d0)],'textRanges':null}};}const _0x229508=this[_0x4b57f9(0x3ca)]['interceptor'][_0x4b57f9(0xf0)](this[_0x4b57f9(0x3ca)][_0x4b57f9(0xf8)][_0x4b57f9(0x2b9)]()[_0x4b57f9(0x2f3)])([_0x5be4fe],null)||[_0x5be4fe];this[_0x4b57f9(0x3f5)](_0x229508[0x0]);})),_0x31ec71;}};_0x510f00=_0x37a4eb([_0x2ecc88(0x3,_0x24e1ed['Inject'](_0x24e1ed[_0x3ceef6(0x405)])),_0x2ecc88(0x4,_0x24e1ed[_0x3ceef6(0x48f)](_0x481c9f[_0x3ceef6(0x271)])),_0x2ecc88(0x5,_0x24e1ed[_0x3ceef6(0x48f)](_0x3c4c3c[_0x3ceef6(0x295)])),_0x2ecc88(0x6,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x31c)])),_0x2ecc88(0x7,_0x24e1ed[_0x3ceef6(0x48f)](_0x3c4c3c[_0x3ceef6(0x3dd)])),_0x2ecc88(0x8,_0x24e1ed[_0x3ceef6(0x48f)](_0x2c946a[_0x3ceef6(0x15e)])),_0x2ecc88(0x9,_0x24e1ed[_0x3ceef6(0x48f)](_0x2884fa)),_0x2ecc88(0xa,_0x24e1ed[_0x3ceef6(0x48f)](_0x72a7c8)),_0x2ecc88(0xb,_0x24e1ed[_0x3ceef6(0x48f)](_0x5a4f60)),_0x2ecc88(0xc,_0x24e1ed['ILogService']),_0x2ecc88(0xd,_0x24e1ed[_0x3ceef6(0x28e)]),_0x2ecc88(0xe,_0x279279['IMessageService']),_0x2ecc88(0xf,_0x24e1ed[_0x3ceef6(0x16f)]),_0x2ecc88(0x10,_0x24e1ed['Optional'](_0x45c59f))],_0x510f00),_0x481c9f[_0x3ceef6(0x41e)]=class extends _0x4320d8{constructor(_0x2438a3,_0x56c32b,_0x51b1ab,_0x3fbfdc,_0x550fd5,_0x2776fd,_0x503aba,_0x4fe751,_0x16debd,_0x95b8d1,_0x2f038d,_0x91f052,_0x4253fd,_0x5e7618){const _0x407e45=_0x3ceef6;super(_0x2438a3,_0x56c32b,_0x51b1ab,_0x3fbfdc,_0x550fd5,_0x2776fd,_0x503aba,_0x4fe751,_0x95b8d1,_0x2f038d,_0x91f052,_0x4253fd,_0x5e7618),this[_0x407e45(0x208)]=_0x2438a3,this['type']=_0x56c32b,this[_0x407e45(0x41b)]=_0x51b1ab,this[_0x407e45(0x38b)]=_0x16debd;}[_0x3ceef6(0x264)](){const _0x5b25e7=_0x3ceef6,_0x1a1c2c=super[_0x5b25e7(0x264)]();return _0x1a1c2c[_0x5b25e7(0xb7)]=_0xf0075e=>this[_0x5b25e7(0x38b)][_0x5b25e7(0x238)](_0xf0075e),_0x1a1c2c;}async['_init'](){const _0xa2cab4=_0x3ceef6,_0xa53f4b=await super[_0xa2cab4(0x13c)]();return this['disposeWithMe'](this[_0xa2cab4(0x285)][_0xa2cab4(0xb9)]((_0x2147d5,_0x194b8a)=>{const _0x15bfde=_0xa2cab4;if(_0x2147d5[_0x15bfde(0x223)]!==_0x24e1ed[_0x15bfde(0x24a)]['MUTATION']||_0x194b8a!=null&&_0x194b8a[_0x15bfde(0xed)]||_0x194b8a!=null&&_0x194b8a[_0x15bfde(0x48d)])return;const _0x366616=_0x2147d5[_0x15bfde(0xbe)];if((_0x366616==null?void 0x0:_0x366616[_0x15bfde(0x167)])!==this[_0x15bfde(0x208)])return;const _0x4a7c44=_0x2147d5,_0x35d803=this[_0x15bfde(0x3ca)][_0x15bfde(0xf8)]['fetchThroughInterceptors'](this[_0x15bfde(0x3ca)]['interceptor'][_0x15bfde(0x2b9)]()[_0x15bfde(0x2f3)])([_0x4a7c44],null)||[_0x4a7c44];this[_0x15bfde(0x3f5)](_0x35d803[0x0]);})),_0xa53f4b;}},_0x481c9f[_0x3ceef6(0x41e)]=_0x37a4eb([_0x2ecc88(0x3,_0x24e1ed['Inject'](_0x24e1ed['Injector'])),_0x2ecc88(0x4,_0x24e1ed[_0x3ceef6(0x48f)](_0x481c9f[_0x3ceef6(0x271)])),_0x2ecc88(0x5,_0x24e1ed[_0x3ceef6(0x48f)](_0x3c4c3c[_0x3ceef6(0x295)])),_0x2ecc88(0x6,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x31c)])),_0x2ecc88(0x7,_0x24e1ed[_0x3ceef6(0x48f)](_0x3c4c3c[_0x3ceef6(0x3dd)])),_0x2ecc88(0x8,_0x24e1ed['Inject'](_0x1170ae)),_0x2ecc88(0x9,_0x24e1ed[_0x3ceef6(0x250)]),_0x2ecc88(0xa,_0x24e1ed['ICommandService']),_0x2ecc88(0xb,_0x279279[_0x3ceef6(0x3a7)]),_0x2ecc88(0xc,_0x24e1ed['IPermissionService']),_0x2ecc88(0xd,_0x24e1ed[_0x3ceef6(0xcf)](_0x45c59f))],_0x481c9f[_0x3ceef6(0x41e)]);const _0x4ebfed=[_0x3ceef6(0x2fb),_0x3ceef6(0x228),'verdancy600',_0x3ceef6(0x2a1),_0x3ceef6(0x300),_0x3ceef6(0x296)];class _0x43bf67 extends _0x24e1ed[_0x3ceef6(0x26d)]{constructor(){const _0x5987e9=_0x3ceef6;super(...arguments),_0x1b84ec(this,_0x5987e9(0x229),new Map()),_0x1b84ec(this,'_colorIndex',0x0);}[_0x3ceef6(0x460)](_0x31b72f){const _0x59c9dc=_0x3ceef6;if(this[_0x59c9dc(0x229)][_0x59c9dc(0x245)](_0x31b72f))return this['_assignedColors'][_0x59c9dc(0x414)](_0x31b72f);const _0x1b8b9e=_0x4ebfed[this[_0x59c9dc(0x3c6)]];return this[_0x59c9dc(0x3c6)]=(this[_0x59c9dc(0x3c6)]+0x1)%_0x4ebfed[_0x59c9dc(0x346)],this[_0x59c9dc(0x229)][_0x59c9dc(0xe7)](_0x31b72f,_0x1b8b9e),_0x1b8b9e;}}var _0x19c1fd=Object[_0x3ceef6(0x2d1)],_0xa9f50b=Object[_0x3ceef6(0x3fa)],_0x3ac02c=(_0x201fab,_0xbca201,_0x3683d7,_0x697e13)=>{const _0xcaf81b=_0x3ceef6;for(var _0x2de483=_0x697e13>0x1?void 0x0:_0x697e13?_0xa9f50b(_0xbca201,_0x3683d7):_0xbca201,_0x4bd8be=_0x201fab[_0xcaf81b(0x346)]-0x1,_0x52786c;_0x4bd8be>=0x0;_0x4bd8be--)(_0x52786c=_0x201fab[_0x4bd8be])&&(_0x2de483=(_0x697e13?_0x52786c(_0xbca201,_0x3683d7,_0x2de483):_0x52786c(_0x2de483))||_0x2de483);return _0x697e13&&_0x2de483&&_0x19c1fd(_0xbca201,_0x3683d7,_0x2de483),_0x2de483;},_0x3fa56d=(_0x17ed6e,_0x4feda2)=>(_0x229d94,_0x174c5b)=>_0x4feda2(_0x229d94,_0x174c5b,_0x17ed6e);const _0x1a3c3c=0x12c,_0x56acd7=0x64,_0x11348f=()=>{let _0x1a7b99=[],_0x3d47ec=!0x1;return _0x491f6b=>{_0x1a7b99['push'](_0x491f6b),_0x3d47ec||(_0x3d47ec=!0x0,setTimeout(()=>{const _0x443a8d=_0x5b63;_0x1a7b99[_0x443a8d(0x115)](_0x5872ce=>_0x5872ce()),_0x1a7b99=[],_0x3d47ec=!0x1;}));};};let _0x1de4ab=class extends _0x24e1ed['RxDisposable']{constructor(_0x37aff4,_0x3ba7cd,_0x316c99,_0x24ec4e,_0x32499b,_0x166706,_0x4b464f,_0x1263c2){const _0x12a1f9=_0x3ceef6;super(),_0x1b84ec(this,'_online',!0x1),_0x1b84ec(this,'_init',!0x1),_0x1b84ec(this,_0x12a1f9(0x1c9),new _0x5ba5b9['BehaviorSubject'](new Map())),_0x1b84ec(this,_0x12a1f9(0x374),this[_0x12a1f9(0x1c9)][_0x12a1f9(0x2ce)]()),_0x1b84ec(this,_0x12a1f9(0x1c6),new _0x5ba5b9['BehaviorSubject']([])),_0x1b84ec(this,_0x12a1f9(0x44e),this[_0x12a1f9(0x1c6)]['pipe'](_0x5ba5b9['debounceTime'](_0x1a3c3c))),_0x1b84ec(this,_0x12a1f9(0x230),_0x5156bc((_0x3e7d85,_0x3ead9e)=>{const _0xa413d4=_0x12a1f9,_0x309a7b={'eventID':_0x3c4c3c['CollaborationEvent'][_0xa413d4(0x362)],'data':{'unitID':this[_0xa413d4(0x208)],'memberID':this['_session']['getMemberID'](),'selection':_0x47c5bb[_0xa413d4(0x29a)](_0x3e7d85,_0x3ead9e['range'])}};this['_session'][_0xa413d4(0x42c)](_0x309a7b,this[_0xa413d4(0x208)]);},_0x56acd7)),(this['unitID']=_0x37aff4,this[_0x12a1f9(0x385)]=_0x3ba7cd,this[_0x12a1f9(0x376)]=_0x316c99,this[_0x12a1f9(0xc6)]=_0x24ec4e,this[_0x12a1f9(0x1e0)]=_0x32499b,this[_0x12a1f9(0x198)]=_0x166706,this[_0x12a1f9(0x285)]=_0x4b464f,this[_0x12a1f9(0x2dc)]=_0x1263c2);}get[_0x3ceef6(0x2ea)](){const _0xe66546=_0x3ceef6;return this[_0xe66546(0x1c9)][_0xe66546(0x151)]();}get['roomMembers'](){const _0x3a51ab=_0x3ceef6;return this[_0x3a51ab(0x1c6)][_0x3a51ab(0x151)]();}[_0x3ceef6(0x377)](){const _0x1fd70c=_0x3ceef6;super[_0x1fd70c(0x377)](),this['_cursorInfo$'][_0x1fd70c(0x48b)](new Map()),this[_0x1fd70c(0x1c9)][_0x1fd70c(0x22c)](),this[_0x1fd70c(0x1c6)][_0x1fd70c(0x48b)]([]),this[_0x1fd70c(0x1c6)][_0x1fd70c(0x22c)]();}[_0x3ceef6(0x143)](){const _0x4c9eff=_0x3ceef6;this[_0x4c9eff(0x13c)]||(this['_init']=!0x0,this[_0x4c9eff(0x385)]['sessionStatus$'][_0x4c9eff(0x30e)](_0x5ba5b9[_0x4c9eff(0x2c3)](this[_0x4c9eff(0x318)]))[_0x4c9eff(0x1b0)](_0x2c9bd3=>{const _0x566aa2=_0x4c9eff;_0x2c9bd3===_0x4ad0db[_0x566aa2(0x32a)]?this[_0x566aa2(0x1a8)]():this[_0x566aa2(0x46a)]();}),this[_0x4c9eff(0x385)][_0x4c9eff(0x247)][_0x4c9eff(0x30e)](_0x5ba5b9['takeUntil'](this['dispose$']))[_0x4c9eff(0x1b0)](_0x2ffb06=>{const _0x4b54ba=_0x4c9eff,_0x18b0eb=_0x2ffb06[_0x4b54ba(0x17c)];_0x18b0eb===_0x3c4c3c[_0x4b54ba(0x3ce)][_0x4b54ba(0x362)]&&this[_0x4b54ba(0x3e2)](_0x2ffb06),_0x18b0eb===_0x3c4c3c['CollaborationEvent'][_0x4b54ba(0x45b)]&&this[_0x4b54ba(0x213)](_0x2ffb06);}),this['_onRefRangeChange'](),this[_0x4c9eff(0x184)](this[_0x4c9eff(0x285)][_0x4c9eff(0xb9)](_0xce6b16=>{const _0x32e97a=_0x4c9eff;if(this['_online']&&_0xce6b16['id']===_0x5e02d9[_0x32e97a(0x221)]['id']&&_0xce6b16[_0x32e97a(0xbe)][_0x32e97a(0x167)]===this[_0x32e97a(0x208)]){const _0x514823=_0xce6b16[_0x32e97a(0xbe)];this[_0x32e97a(0x230)](_0x514823[_0x32e97a(0x3cb)],_0x514823[_0x32e97a(0x170)][0x0]);}})));}['_onCursorUpdate'](_0x5a9b74){const _0x55f886=_0x3ceef6;var _0x3e1df9,_0x24b662;const {memberID:_0x45990f,selection:_0x3c766a}=_0x5a9b74[_0x55f886(0x2e4)],{sheetName:_0x642a34,range:_0x42d366}=_0x47c5bb[_0x55f886(0x39f)](_0x3c766a),_0x2ac2e0={'name':(_0x24b662=(_0x3e1df9=this[_0x55f886(0x1e0)]['getMember'](this[_0x55f886(0x208)],_0x45990f))==null?void 0x0:_0x3e1df9[_0x55f886(0x329)])!=null?_0x24b662:_0x55f886(0x13a),'range':this[_0x55f886(0x35a)](_0x642a34,_0x42d366),'sheetID':_0x642a34,'color':this[_0x55f886(0xc6)][_0x55f886(0x460)](_0x45990f),'selection':_0x3c766a},_0x401b32=this['cursorInfo'];_0x401b32[_0x55f886(0xe7)](_0x45990f,_0x2ac2e0),this[_0x55f886(0x1c9)]['next'](_0x401b32);}[_0x3ceef6(0x213)](_0x329a33){const _0x139a1d=_0x3ceef6,{memberID:_0x5c677d}=_0x329a33[_0x139a1d(0x2e4)],_0x4582ba=this[_0x139a1d(0x2ea)];_0x4582ba[_0x139a1d(0x15d)](_0x5c677d),this['_cursorInfo$'][_0x139a1d(0x48b)](_0x4582ba);}[_0x3ceef6(0x35a)](_0xbae57f,_0x390c41){const _0x15b58b=_0x3ceef6;var _0x31e904,_0x24299e;const _0x422d6d=(_0x24299e=(_0x31e904=this[_0x15b58b(0x198)][_0x15b58b(0x14d)](this[_0x15b58b(0x208)]))==null?void 0x0:_0x31e904[_0x15b58b(0xba)](_0xbae57f))==null?void 0x0:_0x24299e[_0x15b58b(0x3d4)]();return(_0x422d6d==null?void 0x0:_0x422d6d[_0x15b58b(0x336)](_0x1f9a9e=>_0x24e1ed[_0x15b58b(0x424)]['contains'](_0x1f9a9e,_0x390c41)))||_0x390c41;}[_0x3ceef6(0x195)](){const _0x10e631=_0x3ceef6,_0x537cf9=new _0x24e1ed[(_0x10e631(0x47e))](),_0x2e7446=_0x11348f(),_0x1e8586=()=>{const _0x2a2582=_0x10e631;_0x537cf9[_0x2a2582(0x377)]();const _0x12709b=(_0x427174,_0x29f058,_0xa4f984,_0x3d2940)=>{const _0x26d21e=_0x2a2582;let _0x1433b6=[];switch(_0x427174['id']){case _0x5e02d9[_0x26d21e(0x43a)]['DeleteRangeMoveLeftCommandId']:{_0x1433b6=_0x5e02d9[_0x26d21e(0x18b)](_0x427174,_0x3d2940);break;}case _0x5e02d9['EffectRefRangId'][_0x26d21e(0x341)]:{_0x1433b6=_0x5e02d9[_0x26d21e(0x2e5)](_0x427174,_0x3d2940);break;}case _0x5e02d9[_0x26d21e(0x43a)][_0x26d21e(0x2f2)]:{_0x1433b6=_0x5e02d9[_0x26d21e(0x36b)](_0x427174,_0x3d2940);break;}case _0x5e02d9[_0x26d21e(0x43a)][_0x26d21e(0x2f7)]:{_0x1433b6=_0x5e02d9[_0x26d21e(0x2f4)](_0x427174,_0x3d2940);break;}case _0x5e02d9[_0x26d21e(0x43a)][_0x26d21e(0x450)]:{_0x1433b6=_0x5e02d9['handleInsertRangeMoveRight'](_0x427174,_0x3d2940);break;}case _0x5e02d9[_0x26d21e(0x43a)][_0x26d21e(0x33d)]:{_0x1433b6=_0x5e02d9[_0x26d21e(0x2fc)](_0x427174,_0x3d2940);break;}case _0x5e02d9[_0x26d21e(0x43a)][_0x26d21e(0xf4)]:{_0x1433b6=_0x5e02d9[_0x26d21e(0x429)](_0x427174,_0x3d2940);break;}case _0x5e02d9[_0x26d21e(0x43a)][_0x26d21e(0x304)]:{_0x1433b6=_0x5e02d9[_0x26d21e(0x154)](_0x427174,_0x3d2940);break;}case _0x5e02d9[_0x26d21e(0x43a)][_0x26d21e(0x129)]:{_0x1433b6=_0x5e02d9[_0x26d21e(0x16b)](_0x427174,_0x3d2940);break;}}const _0x4643f0=_0x5e02d9[_0x26d21e(0x11a)](_0x1433b6,_0x3d2940),_0x56e21c=this[_0x26d21e(0x2ea)][_0x26d21e(0x414)](_0x29f058);if(_0x56e21c&&_0x4643f0){const _0x945bc9={..._0x56e21c,'range':_0x4643f0};this[_0x26d21e(0x2ea)][_0x26d21e(0xe7)](_0x29f058,_0x945bc9),_0x2e7446(()=>{const _0xe42495=_0x26d21e,_0x4433de=this['_refRangeService']['registerRefRange'](_0x4643f0,_0x37dbf5=>(_0x4433de['dispose'](),_0x12709b(_0x37dbf5,_0x29f058,_0xa4f984,_0x4643f0)));_0x537cf9[_0xe42495(0x46d)](_0x4433de);});}return{'redos':[],'undos':[]};};this['cursorInfo'][_0x2a2582(0x115)]((_0x1ebc5e,_0x550e7c)=>{const _0x709ec9=_0x2a2582,{range:_0x4ae6b1,sheetID:_0xb8f90e}=_0x1ebc5e,_0x12ed88=this[_0x709ec9(0x2dc)]['registerRefRange'](_0x4ae6b1,_0x536588=>(_0x12ed88[_0x709ec9(0x377)](),_0x12709b(_0x536588,_0x550e7c,_0xb8f90e,_0x4ae6b1)));_0x537cf9[_0x709ec9(0x46d)](_0x12ed88);});};this[_0x10e631(0x184)](_0x24e1ed['toDisposable'](this['_cursorInfo$'][_0x10e631(0x1b0)](()=>{_0x1e8586();})));}['_toggleOnline'](){const _0x2abd3b=_0x3ceef6;var _0x336974,_0x3c17f1;if(this[_0x2abd3b(0x144)]=!0x0,((_0x336974=this[_0x2abd3b(0x198)]['getFocusedUnit']())==null?void 0x0:_0x336974[_0x2abd3b(0x398)]())!==this[_0x2abd3b(0x208)])return;const _0x2a6a9b=(_0x3c17f1=this[_0x2abd3b(0x376)][_0x2abd3b(0x414)](_0x5e02d9[_0x2abd3b(0x28f)])['getCurrentSelections']())==null?void 0x0:_0x3c17f1[0x0],_0x588b60=this[_0x2abd3b(0x198)][_0x2abd3b(0x371)](_0x24e1ed[_0x2abd3b(0x1dd)][_0x2abd3b(0x2b3)])[_0x2abd3b(0x491)]();_0x2a6a9b&&_0x588b60&&this[_0x2abd3b(0x230)](_0x588b60['getSheetId'](),_0x2a6a9b);}[_0x3ceef6(0x46a)](){const _0x17aa3f=_0x3ceef6;this[_0x17aa3f(0x144)]=!0x1;}};_0x1de4ab=_0x3ac02c([_0x3fa56d(0x2,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x405)])),_0x3fa56d(0x3,_0x24e1ed[_0x3ceef6(0x48f)](_0x43bf67)),_0x3fa56d(0x4,_0x24e1ed['Inject'](_0x29dad0)),_0x3fa56d(0x5,_0x24e1ed[_0x3ceef6(0x36c)]),_0x3fa56d(0x6,_0x24e1ed[_0x3ceef6(0x28e)]),_0x3fa56d(0x7,_0x24e1ed[_0x3ceef6(0x48f)](_0x5e02d9[_0x3ceef6(0x45f)]))],_0x1de4ab);var _0x38e2b1=Object['defineProperty'],_0x3a81eb=Object[_0x3ceef6(0x3fa)],_0x26b8ec=(_0x2a2b95,_0x5a9432,_0x4eba23,_0x4d43c2)=>{const _0x7857ca=_0x3ceef6;for(var _0x1e1306=_0x4d43c2>0x1?void 0x0:_0x4d43c2?_0x3a81eb(_0x5a9432,_0x4eba23):_0x5a9432,_0x20e1ef=_0x2a2b95[_0x7857ca(0x346)]-0x1,_0x55514d;_0x20e1ef>=0x0;_0x20e1ef--)(_0x55514d=_0x2a2b95[_0x20e1ef])&&(_0x1e1306=(_0x4d43c2?_0x55514d(_0x5a9432,_0x4eba23,_0x1e1306):_0x55514d(_0x1e1306))||_0x1e1306);return _0x4d43c2&&_0x1e1306&&_0x38e2b1(_0x5a9432,_0x4eba23,_0x1e1306),_0x1e1306;},_0x49da3e=(_0x38c673,_0x22bc22)=>(_0x5027ab,_0x5b8f7a)=>_0x22bc22(_0x5027ab,_0x5b8f7a,_0x38c673);const _0x2a87ac=0x12c,_0x2052e1=0x64;let _0x201737=class extends _0x24e1ed['RxDisposable']{constructor(_0x1368d0,_0x35ebfd,_0x290258,_0x377fea,_0x18c591,_0x26ceb6,_0x486137,_0x601ba5,_0xf9ef4f){const _0x5dfbd4=_0x3ceef6;super(),_0x1b84ec(this,_0x5dfbd4(0x144),!0x1),_0x1b84ec(this,'_init',!0x1),_0x1b84ec(this,_0x5dfbd4(0x1c9),new _0x5ba5b9['BehaviorSubject'](new Map())),_0x1b84ec(this,_0x5dfbd4(0x374),this[_0x5dfbd4(0x1c9)][_0x5dfbd4(0x2ce)]()),_0x1b84ec(this,'_roomMembers$',new _0x5ba5b9['BehaviorSubject']([])),_0x1b84ec(this,_0x5dfbd4(0x44e),this[_0x5dfbd4(0x1c6)]['pipe'](_0x5ba5b9[_0x5dfbd4(0x368)](_0x2a87ac))),_0x1b84ec(this,_0x5dfbd4(0x230),_0x5156bc(_0x5e42cd=>{const _0x25cc4b=_0x5dfbd4,_0x1cb783={'eventID':_0x3c4c3c['CollaborationEvent'][_0x25cc4b(0x362)],'data':{'unitID':this[_0x25cc4b(0x208)],'memberID':this[_0x25cc4b(0x385)][_0x25cc4b(0x3e9)](),'selection':_0x574176(_0x5e42cd)}};this['_session'][_0x25cc4b(0x42c)](_0x1cb783,this['unitID']);},_0x2052e1)),(this[_0x5dfbd4(0x208)]=_0x1368d0,this[_0x5dfbd4(0x385)]=_0x35ebfd,this[_0x5dfbd4(0x376)]=_0x290258,this[_0x5dfbd4(0xc6)]=_0x377fea,this['_memberService']=_0x18c591,this['_syncEditingCollabCursorService']=_0x26ceb6,this[_0x5dfbd4(0x428)]=_0x486137,this[_0x5dfbd4(0x198)]=_0x601ba5,this[_0x5dfbd4(0x285)]=_0xf9ef4f);}get[_0x3ceef6(0x2ea)](){return this['_cursorInfo$']['getValue']();}get[_0x3ceef6(0x19f)](){const _0x51bf54=_0x3ceef6;return this['_roomMembers$'][_0x51bf54(0x151)]();}[_0x3ceef6(0x377)](){const _0x14b1c6=_0x3ceef6;super[_0x14b1c6(0x377)](),this[_0x14b1c6(0x1c9)][_0x14b1c6(0x48b)](new Map()),this[_0x14b1c6(0x1c9)][_0x14b1c6(0x22c)](),this['_roomMembers$']['next']([]),this[_0x14b1c6(0x1c6)][_0x14b1c6(0x22c)]();}['init'](){const _0x278870=_0x3ceef6;this[_0x278870(0x13c)]||(this['_init']=!0x0,this[_0x278870(0x385)][_0x278870(0x40a)][_0x278870(0x30e)](_0x5ba5b9['takeUntil'](this[_0x278870(0x318)]))[_0x278870(0x1b0)](_0x3934f3=>{const _0x16b96f=_0x278870;_0x3934f3===_0x4ad0db[_0x16b96f(0x32a)]?this[_0x16b96f(0x1a8)]():this[_0x16b96f(0x46a)]();}),this[_0x278870(0x385)][_0x278870(0x247)][_0x278870(0x30e)](_0x5ba5b9[_0x278870(0x2c3)](this[_0x278870(0x318)]))['subscribe'](_0x3dcb07=>{const _0x20d29a=_0x278870,_0x46b1cf=_0x3dcb07['eventID'];_0x46b1cf===_0x3c4c3c[_0x20d29a(0x3ce)][_0x20d29a(0x362)]&&this[_0x20d29a(0x3e2)](_0x3dcb07),_0x46b1cf===_0x3c4c3c[_0x20d29a(0x3ce)][_0x20d29a(0x45b)]&&this[_0x20d29a(0x213)](_0x3dcb07);}),this[_0x278870(0x184)](this[_0x278870(0x285)][_0x278870(0xb9)](_0x1bbb73=>{const _0x710806=_0x278870,_0x432d1a=_0x1bbb73[_0x710806(0xbe)];_0x432d1a!=null&&this[_0x710806(0x144)]&&_0x1bbb73['id']===_0x2c946a[_0x710806(0x206)]['id']&&_0x432d1a[_0x710806(0x167)]===this['unitID']&&_0x432d1a[_0x710806(0x3af)]===!0x1&&this['_updateLocalCursor'](_0x432d1a['ranges']);})),this[_0x278870(0x2ac)][_0x278870(0x188)][_0x278870(0x30e)](_0x5ba5b9['takeUntil'](this['dispose$']))[_0x278870(0x1b0)](_0x41816e=>{const _0x3ba7a6=_0x278870;if((_0x41816e==null?void 0x0:_0x41816e['unitID'])!==this[_0x3ba7a6(0x208)])return;const _0x2a384d={'eventID':_0x3c4c3c[_0x3ba7a6(0x3ce)][_0x3ba7a6(0x362)],'data':_0x41816e};this['_onCursorUpdate'](_0x2a384d);}),this[_0x278870(0x184)](this[_0x278870(0x285)][_0x278870(0xb9)](_0x42826c=>{const _0x4dab77=_0x278870;if(_0x42826c[_0x4dab77(0xbe)]==null)return;const _0x1f75a4=_0x42826c[_0x4dab77(0xbe)];if(_0x42826c['id']!==_0x2c946a[_0x4dab77(0x3f8)]['id']||_0x1f75a4[_0x4dab77(0x167)]!==this[_0x4dab77(0x208)])return;const _0x37ee85={'id':'doc.mutation.rich-text-editing','params':_0x1f75a4},_0x26aad7=this[_0x4dab77(0x2ea)];for(const [_0x472d33,_0xe91fe1]of _0x26aad7){const _0x1dccaa={'id':'doc.mutation.rich-text-editing','params':{'unitId':this[_0x4dab77(0x208)],'actions':null,'textRanges':_0xe91fe1[_0x4dab77(0x46b)]}},_0x51e5fc=this[_0x4dab77(0x428)][_0x4dab77(0x29d)](_0x37ee85,_0x1dccaa,!0x1);if(_0x3c4c3c[_0x4dab77(0x29c)](_0x51e5fc))throw _0x51e5fc[_0x4dab77(0x457)];_0x26aad7['set'](_0x472d33,{..._0xe91fe1,'ranges':_0x51e5fc[_0x4dab77(0x49c)][_0x4dab77(0xbe)][_0x4dab77(0x410)]});}queueMicrotask(()=>{const _0x2558af=_0x4dab77;this[_0x2558af(0x1c9)]['next'](_0x26aad7);});})));}[_0x3ceef6(0x3e2)](_0x5d6b7e){const _0x2ea93e=_0x3ceef6;var _0x560aaa,_0xde19cc;const {memberID:_0x39a514,selection:_0xfe0774}=_0x5d6b7e[_0x2ea93e(0x2e4)],_0x4f5cfe=_0xd09446(_0xfe0774),_0x216a72=(_0xde19cc=(_0x560aaa=this[_0x2ea93e(0x1e0)][_0x2ea93e(0x468)](this['unitID'],_0x39a514))==null?void 0x0:_0x560aaa[_0x2ea93e(0x329)])!=null?_0xde19cc:_0x2ea93e(0x13a),_0x22b05c={'color':this[_0x2ea93e(0xc6)][_0x2ea93e(0x460)](_0x39a514),'name':_0x216a72,'ranges':_0x4f5cfe},_0x58eebb=this[_0x2ea93e(0x2ea)];_0x58eebb[_0x2ea93e(0xe7)](_0x39a514,_0x22b05c),this[_0x2ea93e(0x1c9)][_0x2ea93e(0x48b)](_0x58eebb);}[_0x3ceef6(0x213)](_0x33bae6){const _0x3a5a02=_0x3ceef6,{memberID:_0x35c213}=_0x33bae6[_0x3a5a02(0x2e4)],_0x5640f3=this[_0x3a5a02(0x2ea)];_0x5640f3['delete'](_0x35c213),this[_0x3a5a02(0x1c9)][_0x3a5a02(0x48b)](_0x5640f3);}[_0x3ceef6(0x1a8)](){const _0x46f12f=_0x3ceef6;var _0x322c67;if(this[_0x46f12f(0x144)]=!0x0,((_0x322c67=this[_0x46f12f(0x198)]['getFocusedUnit']())==null?void 0x0:_0x322c67[_0x46f12f(0x398)]())!==this[_0x46f12f(0x208)])return;const _0x425fd9=this[_0x46f12f(0x376)][_0x46f12f(0x414)](_0x2c946a[_0x46f12f(0x177)])[_0x46f12f(0x21c)](),_0x2d36a1=_0x425fd9==null?void 0x0:_0x425fd9[_0x46f12f(0x315)](_0x2c946a[_0x46f12f(0x2d9)]);Array[_0x46f12f(0xc7)](_0x2d36a1)&&_0x2d36a1[_0x46f12f(0x346)]>0x0&&this['_updateLocalCursor'](_0x2d36a1);}[_0x3ceef6(0x46a)](){this['_online']=!0x1;}};_0x201737=_0x26b8ec([_0x49da3e(0x2,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x405)])),_0x49da3e(0x3,_0x24e1ed[_0x3ceef6(0x48f)](_0x43bf67)),_0x49da3e(0x4,_0x24e1ed[_0x3ceef6(0x48f)](_0x29dad0)),_0x49da3e(0x5,_0x24e1ed[_0x3ceef6(0x48f)](_0x5a4f60)),_0x49da3e(0x6,_0x3c4c3c[_0x3ceef6(0x2cd)]),_0x49da3e(0x7,_0x24e1ed['IUniverInstanceService']),_0x49da3e(0x8,_0x24e1ed['ICommandService'])],_0x201737);var _0x43c8b3=Object[_0x3ceef6(0x2d1)],_0x2879cf=Object[_0x3ceef6(0x3fa)],_0x539c77=(_0x43110b,_0x5bd05a,_0x2c0224,_0x31fe2a)=>{const _0x507c65=_0x3ceef6;for(var _0x512626=_0x31fe2a>0x1?void 0x0:_0x31fe2a?_0x2879cf(_0x5bd05a,_0x2c0224):_0x5bd05a,_0x55963c=_0x43110b[_0x507c65(0x346)]-0x1,_0x204ab9;_0x55963c>=0x0;_0x55963c--)(_0x204ab9=_0x43110b[_0x55963c])&&(_0x512626=(_0x31fe2a?_0x204ab9(_0x5bd05a,_0x2c0224,_0x512626):_0x204ab9(_0x512626))||_0x512626);return _0x31fe2a&&_0x512626&&_0x43c8b3(_0x5bd05a,_0x2c0224,_0x512626),_0x512626;},_0x14c91b=(_0x4ccc9c,_0x507018)=>(_0x27143e,_0x147363)=>_0x507018(_0x27143e,_0x147363,_0x4ccc9c);let _0x1c89c8=class extends _0x24e1ed['RxDisposable']{constructor(_0x11a4a5,_0x502813,_0x5639aa){const _0x140d0d=_0x3ceef6;super(),_0x1b84ec(this,_0x140d0d(0x31f),new Map()),_0x1b84ec(this,_0x140d0d(0xb8),new _0x5ba5b9['Subject']()),(this['_univerInstanceService']=_0x11a4a5,this[_0x140d0d(0x376)]=_0x502813,this[_0x140d0d(0x349)]=_0x5639aa,this[_0x140d0d(0x13c)]());}[_0x3ceef6(0x377)](){const _0x127891=_0x3ceef6;super['dispose'](),this[_0x127891(0xb8)][_0x127891(0x22c)](),this['_entities'][_0x127891(0x115)](_0x156c4b=>_0x156c4b[_0x127891(0x377)]());}['getCollabCursors$'](_0x38ee40){const _0x1d2648=_0x3ceef6;return this[_0x1d2648(0x31f)]['has'](_0x38ee40)?this[_0x1d2648(0x31f)][_0x1d2648(0x414)](_0x38ee40)[_0x1d2648(0x374)]:this['_entityInit$']['pipe'](_0x5ba5b9['filter'](_0x2225d6=>_0x2225d6[_0x1d2648(0x208)]===_0x38ee40),_0x5ba5b9['switchMap'](_0x4a8988=>_0x4a8988['cursorInfo$']));}[_0x3ceef6(0x13c)](){const _0x189863=_0x3ceef6;this[_0x189863(0x198)][_0x189863(0x1e5)](_0x24e1ed[_0x189863(0x1dd)][_0x189863(0x2b3)])[_0x189863(0x30e)](_0x5ba5b9[_0x189863(0x2c3)](this[_0x189863(0x318)]))[_0x189863(0x1b0)](async _0x4fedd4=>{const _0x168d55=_0x189863,_0x448f2d=_0x4fedd4[_0x168d55(0x398)](),_0x4b0990=await this[_0x168d55(0x444)](_0x448f2d);this[_0x168d55(0xb8)][_0x168d55(0x48b)](_0x4b0990),this['_entities'][_0x168d55(0xe7)](_0x448f2d,_0x4b0990);}),this[_0x189863(0x198)][_0x189863(0x1e5)](_0x24e1ed['UniverInstanceType'][_0x189863(0x192)])['pipe'](_0x5ba5b9[_0x189863(0x2c3)](this[_0x189863(0x318)]))[_0x189863(0x30e)](_0x5ba5b9[_0x189863(0xd0)](_0x23c27d=>!_0x23c27d[_0x189863(0x398)]()['startsWith']('__')))[_0x189863(0x1b0)](async _0x557633=>{const _0x134d75=_0x189863,_0x4807dd=_0x557633[_0x134d75(0x398)](),_0x11e468=await this[_0x134d75(0x3e1)](_0x4807dd);this['_entityInit$'][_0x134d75(0x48b)](_0x11e468),this[_0x134d75(0x31f)][_0x134d75(0xe7)](_0x4807dd,_0x11e468);}),_0x5ba5b9['merge'](this[_0x189863(0x198)][_0x189863(0x1fd)](_0x24e1ed[_0x189863(0x1dd)][_0x189863(0x192)]),this[_0x189863(0x198)]['getTypeOfUnitDisposed$'](_0x24e1ed[_0x189863(0x1dd)][_0x189863(0x2b3)]))[_0x189863(0x30e)](_0x5ba5b9[_0x189863(0x2c3)](this[_0x189863(0x318)]))['subscribe'](_0x30e894=>{const _0x542bc0=_0x189863,_0x49e1e7=_0x30e894['getUnitId'](),_0x2b3387=this['_entities'][_0x542bc0(0x414)](_0x49e1e7);_0x2b3387&&(_0x2b3387[_0x542bc0(0x377)](),this['_entities'][_0x542bc0(0x15d)](_0x49e1e7));});}async[_0x3ceef6(0x444)](_0x423b1f){const _0x35bc58=_0x3ceef6,_0x379b1c=await this['_collabSessionService']['requireSession'](_0x423b1f),_0x5c390f=this[_0x35bc58(0x376)][_0x35bc58(0x1c4)](_0x1de4ab,_0x423b1f,_0x379b1c);return _0x5c390f['init'](),_0x5c390f;}async[_0x3ceef6(0x3e1)](_0x1da144){const _0x33fe8c=_0x3ceef6,_0x19c316=await this[_0x33fe8c(0x349)][_0x33fe8c(0x1b9)](_0x1da144),_0x5038a4=this['_injector'][_0x33fe8c(0x1c4)](_0x201737,_0x1da144,_0x19c316);return _0x5038a4[_0x33fe8c(0x143)](),_0x5038a4;}};_0x1c89c8=_0x539c77([_0x24e1ed['OnLifecycle'](_0x24e1ed[_0x3ceef6(0xf7)][_0x3ceef6(0x1a3)],_0x1c89c8),_0x14c91b(0x0,_0x24e1ed[_0x3ceef6(0x36c)]),_0x14c91b(0x1,_0x24e1ed['Inject'](_0x24e1ed[_0x3ceef6(0x405)])),_0x14c91b(0x2,_0x24e1ed[_0x3ceef6(0x48f)](_0x481c9f[_0x3ceef6(0x2e6)]))],_0x1c89c8);const _0x1b216a=0x14,_0x209c56=0xc8,_0x20eb4d=0x4,_0x1f7460=0x5;function _0x22a645(_0x43bb79,_0x492a8e){const _0x48b207=_0x3ceef6;let {radius:_0x487535,width:_0x4989c7,height:_0x4ba284}=_0x492a8e;_0x487535=_0x487535!=null?_0x487535:0x0,_0x4989c7=_0x4989c7!=null?_0x4989c7:0x1e,_0x4ba284=_0x4ba284!=null?_0x4ba284:0x1e;let _0x4528cd=0x0,_0x12c1f5=0x0,_0x2d1219=0x0;_0x4528cd=_0x12c1f5=_0x2d1219=Math[_0x48b207(0x386)](_0x487535,_0x4989c7/0x2,_0x4ba284/0x2),_0x43bb79[_0x48b207(0x3f2)](),_0x43bb79[_0x48b207(0x242)](_0x4528cd,0x0),_0x43bb79['lineTo'](_0x4989c7-_0x12c1f5,0x0),_0x43bb79[_0x48b207(0x12a)](_0x4989c7-_0x12c1f5,_0x12c1f5,_0x12c1f5,Math['PI']*0x3/0x2,0x0,!0x1),_0x43bb79[_0x48b207(0x1cd)](_0x4989c7,_0x4ba284-_0x2d1219),_0x43bb79[_0x48b207(0x12a)](_0x4989c7-_0x2d1219,_0x4ba284-_0x2d1219,_0x2d1219,0x0,Math['PI']/0x2,!0x1),_0x43bb79['lineTo'](0x0,_0x4ba284),_0x43bb79[_0x48b207(0x1cd)](0x0,_0x4528cd),_0x43bb79[_0x48b207(0x12a)](_0x4528cd,_0x4528cd,_0x4528cd,Math['PI'],Math['PI']*0x3/0x2,!0x1),_0x43bb79[_0x48b207(0x22f)](),_0x492a8e[_0x48b207(0x168)]&&(_0x43bb79[_0x48b207(0xdd)](),_0x43bb79[_0x48b207(0x145)]=_0x492a8e['fill'],_0x492a8e[_0x48b207(0x42b)]==='evenodd'?_0x43bb79['fill'](_0x48b207(0x40f)):_0x43bb79['fill'](),_0x43bb79['restore']());}class _0x4ec885 extends _0x15516e['Shape']{constructor(_0x165a65,_0x1167f9){const _0x2be3fd=_0x3ceef6;super(_0x165a65,_0x1167f9),_0x1b84ec(this,_0x2be3fd(0x462)),_0x1b84ec(this,_0x2be3fd(0x30c)),(this[_0x2be3fd(0x462)]=_0x1167f9==null?void 0x0:_0x1167f9['color'],this[_0x2be3fd(0x30c)]=_0x1167f9==null?void 0x0:_0x1167f9['text']);}static['drawWith'](_0x435186,_0x3ff283){const _0x288a00=_0x3ceef6,{text:_0x5c30a9,color:_0x4bc4ac}=_0x3ff283;_0x435186['save'](),_0x435186[_0x288a00(0x338)]=_0x288a00(0x148);const _0x2d3c2f=_0x435186['measureText'](_0x5c30a9)['width'],_0xed5042=Math[_0x288a00(0x386)](_0x2d3c2f+0x2*_0x20eb4d,_0x209c56);_0x22a645(_0x435186,{'height':_0x1b216a,'radius':0x4,'width':_0xed5042,'fill':_0x4bc4ac,'evented':!0x1}),_0x435186[_0x288a00(0x145)]=_0x288a00(0x48a);const _0xb9f7c=_0x20eb4d,_0x693be7=_0x1b216a-_0x1f7460,_0x2a33a6=_0x209c56-0x2*_0x20eb4d;if(_0x2d3c2f>_0x2a33a6){let _0x53883c='',_0x22832f=0x0;for(const _0x373bfc of _0x5c30a9){const _0x122062=_0x435186[_0x288a00(0x227)](_0x373bfc)[_0x288a00(0x369)];if(_0x22832f+_0x122062<=_0x2a33a6-_0x435186['measureText'](_0x288a00(0xc8))[_0x288a00(0x369)])_0x53883c+=_0x373bfc,_0x22832f+=_0x122062;else{_0x53883c+=_0x288a00(0xc8);break;}}_0x435186['fillText'](_0x53883c,_0xb9f7c,_0x693be7);}else _0x435186[_0x288a00(0x1a5)](_0x5c30a9,_0xb9f7c,_0x693be7);_0x435186[_0x288a00(0x2ba)]();}[_0x3ceef6(0x3da)](_0x5b6529){const _0x4b5f7f=_0x3ceef6;_0x4ec885[_0x4b5f7f(0x452)](_0x5b6529,this);}}const _0x2eb63b=0x1,_0x1ffc53=1.5;class _0x9909c4 extends _0x15516e[_0x3ceef6(0x1ba)]{constructor(_0x5266fc,_0x342b3c){const _0x131755=_0x3ceef6;super(_0x5266fc,_0x342b3c),_0x1b84ec(this,'_color'),_0x1b84ec(this,_0x131755(0x397),!0x1),_0x1b84ec(this,_0x131755(0x258)),_0x1b84ec(this,'_name',''),_0x1b84ec(this,_0x131755(0x3fb),_0x131755(0x178)),_0x1b84ec(this,'_backgroundColor'),(_0x342b3c&&this[_0x131755(0x1e4)](_0x342b3c),this[_0x131755(0xb4)][_0x131755(0x211)](()=>this[_0x131755(0x1e4)]({'hovered':!0x0})),this[_0x131755(0x422)][_0x131755(0x211)](()=>this[_0x131755(0x1e4)]({'hovered':!0x1})));}[_0x3ceef6(0x1e4)](_0x645594){const _0x56eec3=_0x3ceef6;var _0x535efb,_0x103f39,_0x465321,_0x156d70,_0xdef4e1,_0x283f57;this[_0x56eec3(0x23e)]=(_0x535efb=_0x645594[_0x56eec3(0x462)])!=null?_0x535efb:this['_color'],this[_0x56eec3(0x397)]=(_0x103f39=_0x645594[_0x56eec3(0x3a2)])!=null?_0x103f39:this[_0x56eec3(0x397)],this['_range']=(_0x465321=_0x645594['range'])!=null?_0x465321:this[_0x56eec3(0x258)],this[_0x56eec3(0x20c)]=(_0x156d70=_0x645594[_0x56eec3(0x329)])!=null?_0x156d70:this[_0x56eec3(0x20c)],this[_0x56eec3(0x3fb)]=(_0xdef4e1=_0x645594['labelPosition'])!=null?_0xdef4e1:this[_0x56eec3(0x3fb)],this[_0x56eec3(0x302)]=(_0x283f57=_0x645594[_0x56eec3(0x2ee)])!=null?_0x283f57:this[_0x56eec3(0x302)],this[_0x56eec3(0x425)]({'width':_0x645594[_0x56eec3(0x369)],'height':_0x645594[_0x56eec3(0x490)]});}[_0x3ceef6(0x427)](_0x4b9104){const _0x4278f1=_0x3ceef6,{row:_0x39387f,column:_0x540cee}=_0x4b9104;if(_0x39387f>=this[_0x4278f1(0x258)]['startRow']&&_0x39387f<=this[_0x4278f1(0x258)][_0x4278f1(0x14e)]&&_0x540cee>=this[_0x4278f1(0x258)][_0x4278f1(0x35f)]&&_0x540cee<=this[_0x4278f1(0x258)]['endColumn']){this[_0x4278f1(0x1e4)]({'hovered':!0x0});return;}this[_0x4278f1(0x1e4)]({'hovered':!0x1});}['triggerDblclick'](_0x1096ff){return!0x1;}['_draw'](_0x172355){const _0x473d3b=_0x3ceef6;_0x15516e[_0x473d3b(0x306)][_0x473d3b(0x452)](_0x172355,{'width':this[_0x473d3b(0x369)],'height':this[_0x473d3b(0x490)],'strokeWidth':_0x1ffc53,'stroke':this[_0x473d3b(0x23e)],'evented':!0x1,'fill':this[_0x473d3b(0x302)]}),this[_0x473d3b(0x397)]&&(_0x172355['save'](),_0x172355[_0x473d3b(0x248)](0x1,0x0,0x0,0x1,this[_0x473d3b(0x369)],this['_labelPosition']===_0x473d3b(0x35e)?0x0:-_0x1b216a),_0x4ec885['drawWith'](_0x172355,{'text':this[_0x473d3b(0x20c)],'color':this[_0x473d3b(0x23e)]}),_0x172355[_0x473d3b(0x2ba)]());}}var _0x21c9a8=Object[_0x3ceef6(0x2d1)],_0x34a43a=Object[_0x3ceef6(0x3fa)],_0x1a230d=(_0x255150,_0x5e6447,_0x106ae1,_0x195785)=>{const _0x36a20b=_0x3ceef6;for(var _0x18b1b9=_0x195785>0x1?void 0x0:_0x195785?_0x34a43a(_0x5e6447,_0x106ae1):_0x5e6447,_0x437a1f=_0x255150[_0x36a20b(0x346)]-0x1,_0x5700d1;_0x437a1f>=0x0;_0x437a1f--)(_0x5700d1=_0x255150[_0x437a1f])&&(_0x18b1b9=(_0x195785?_0x5700d1(_0x5e6447,_0x106ae1,_0x18b1b9):_0x5700d1(_0x18b1b9))||_0x18b1b9);return _0x195785&&_0x18b1b9&&_0x21c9a8(_0x5e6447,_0x106ae1,_0x18b1b9),_0x18b1b9;},_0x420f0d=(_0x1ac312,_0x1c7e5a)=>(_0x223a70,_0x3fb4d6)=>_0x1c7e5a(_0x223a70,_0x3fb4d6,_0x1ac312);const _0xe6f330=0x1389;let _0x2998bc=class extends _0x24e1ed[_0x3ceef6(0x379)]{constructor(_0xcf97ac,_0x1452f9,_0x4f10d6,_0x19ed6a){const _0x53048f=_0x3ceef6;super(),_0x1b84ec(this,_0x53048f(0x2a9),new Set()),_0x1b84ec(this,_0x53048f(0x1ef),null),(this['_context']=_0xcf97ac,this['_sheetSkeletonManagerService']=_0x1452f9,this[_0x53048f(0x42f)]=_0x4f10d6,this['_themeService']=_0x19ed6a,this[_0x53048f(0x13c)]());}['_init'](){const _0x3a80de=_0x3ceef6;this[_0x3a80de(0x413)]['currentSkeleton$'][_0x3a80de(0x30e)](_0xb49021[_0x3a80de(0x2c3)](this[_0x3a80de(0x318)]),_0xb49021[_0x3a80de(0x360)](_0x39ce3f=>{const _0x107a60=_0x3a80de;if(_0x39ce3f){const _0x1fa05b=_0x39ce3f['sheetId'];return _0x5ba5b9[_0x107a60(0x15c)](this['_collabCursorController'][_0x107a60(0x1f8)](this['_context'][_0x107a60(0x167)]),this['_themeService'][_0x107a60(0x14f)])[_0x107a60(0x30e)](_0xb49021[_0x107a60(0x315)](([_0x3096a4,_0x4a9156])=>{const _0x21679a=_0x107a60,_0x389418=new Map();return _0x3096a4[_0x21679a(0x115)]((_0x2c55a6,_0xa1a570)=>{const _0x47430c=_0x21679a;if(_0x2c55a6[_0x47430c(0x183)]===_0x1fa05b){const _0x22d65c={..._0x2c55a6};_0x22d65c[_0x47430c(0x462)]=_0x4a9156[_0x2c55a6[_0x47430c(0x462)]],_0x389418[_0x47430c(0xe7)](_0xa1a570,_0x22d65c);}}),{'skeleton':_0x39ce3f,'cursors':_0x389418};}));}return _0x5ba5b9['of']({'skeleton':null,'cursors':new Map()});}))[_0x3a80de(0x1b0)](({skeleton:_0xc449a8,cursors:_0x26b5ef})=>{const _0x263339=_0x3a80de;this[_0x263339(0x1dc)](),_0xc449a8&&this[_0x263339(0x312)](_0xc449a8,_0x26b5ef);}),this['_sheetSkeletonManagerService']['currentSkeleton$'][_0x3a80de(0x1b0)](_0x3650bc=>{const _0x496fbe=_0x3a80de;if(_0x3650bc==null)return;const {skeleton:_0x20e7de}=_0x3650bc,{scene:_0x1225af}=this[_0x496fbe(0x396)];_0x1225af[_0x496fbe(0x420)][_0x496fbe(0x211)](_0x5156bc(_0x5ec06f=>{const _0x5da2fd=_0x496fbe;var _0x13a07d,_0x4f7295;const {offsetX:_0x44a4b3,offsetY:_0x5a8f4d}=_0x5ec06f,{x:_0x419130,y:_0x17392b}=_0x1225af[_0x5da2fd(0x3ba)](_0x15516e['Vector2'][_0x5da2fd(0x1bd)]([_0x44a4b3,_0x5a8f4d])),{scaleX:_0x2da98e,scaleY:_0x4f83ab}=_0x1225af[_0x5da2fd(0x363)](),_0x357888=_0x1225af['getViewport'](_0x5a7986[_0x5da2fd(0x366)][_0x5da2fd(0x202)]),_0x54888d=_0x1225af[_0x5da2fd(0x308)](_0x15516e['Vector2'][_0x5da2fd(0x1bd)]([_0x419130,_0x17392b]),_0x357888),_0x3933f3=_0x20e7de[_0x5da2fd(0x33e)](_0x44a4b3,_0x5a8f4d,_0x2da98e,_0x4f83ab,_0x54888d);((_0x13a07d=this['_lastPointer'])==null?void 0x0:_0x13a07d[_0x5da2fd(0x44f)])===_0x3933f3[_0x5da2fd(0x44f)]&&((_0x4f7295=this[_0x5da2fd(0x1ef)])==null?void 0x0:_0x4f7295['row'])===_0x3933f3[_0x5da2fd(0x2eb)]||this[_0x5da2fd(0x2a9)][_0x5da2fd(0x115)](_0x19fc41=>{_0x19fc41['onMouseMove'](_0x3933f3);});},0x64));});}[_0x3ceef6(0x312)](_0x10899b,_0x3c66c5){const _0x4b99ee=_0x3ceef6;var _0x3f54e5;const _0x1d83ca=(_0x3f54e5=this[_0x4b99ee(0x413)]['getCurrent']())==null?void 0x0:_0x3f54e5[_0x4b99ee(0x3bf)];if(!_0x1d83ca)return;const _0x46512f=this[_0x4b99ee(0x2f5)]();if(!_0x46512f)return;this[_0x4b99ee(0x2a9)]['forEach'](_0x169e31=>{const _0x5b8654=_0x4b99ee;_0x169e31[_0x5b8654(0x15f)]();});const {scene:_0x3a616f}=_0x46512f,_0x95d55f=_0x5bf479(Array[_0x4b99ee(0x2bb)](_0x3c66c5['values']()))[_0x4b99ee(0x315)](_0x391ee7=>{const _0x38d5e0=_0x4b99ee,{color:_0x3b0152,range:_0x5c9f4c,name:_0x350068,selection:_0x24eae1,sheetID:_0x56a0f5}=_0x391ee7,{startColumn:_0x4a0344,startRow:_0x324c03,endColumn:_0x3f9674,endRow:_0x1ab653}=_0x5c9f4c,_0x244ff0=_0x5a7986['getCoordByCell'](_0x324c03,_0x4a0344,_0x3a616f,_0x1d83ca),_0x44e5e6=_0x5a7986[_0x38d5e0(0x194)](_0x1ab653,_0x3f9674,_0x3a616f,_0x1d83ca),{columnHeaderHeightAndMarginTop:_0x3ffceb}=_0x1d83ca,{startX:_0x9151fb,startY:_0x39457b}=_0x244ff0,{endX:_0x207e9b,endY:_0x2565f0}=_0x44e5e6,_0x2061f5=_0x207e9b-_0x9151fb,_0x1d8939=_0x2565f0-_0x39457b,_0x54adde={'labelPosition':_0x39457b-_0x3ffceb>=_0x1b216a?_0x38d5e0(0x178):_0x38d5e0(0x35e),'sheetID':_0x56a0f5,'range':_0x5c9f4c,'color':_0x3b0152,'name':_0x350068,'selection':_0x24eae1,'left':_0x9151fb,'top':_0x39457b,'width':_0x2061f5,'height':_0x1d8939,'evented':!0x1,'zIndex':_0xe6f330};return new _0x9909c4(_0x350068,_0x54adde);});_0x3a616f['addObjects'](_0x95d55f,_0x2eb63b),this[_0x4b99ee(0x2a9)]=new Set(_0x95d55f);}[_0x3ceef6(0x1dc)](){const _0x469680=_0x3ceef6;var _0x5b429f;(_0x5b429f=this[_0x469680(0x2a9)])==null||_0x5b429f[_0x469680(0x115)](_0x256502=>_0x256502[_0x469680(0x377)]());}[_0x3ceef6(0x2f5)](){const _0x495191=_0x3ceef6;return _0x5a7986[_0x495191(0x2f9)](this[_0x495191(0x396)][_0x495191(0x46c)],this[_0x495191(0x396)]);}};_0x2998bc=_0x1a230d([_0x420f0d(0x1,_0x24e1ed['Inject'](_0x5a7986[_0x3ceef6(0x317)])),_0x420f0d(0x2,_0x24e1ed[_0x3ceef6(0x48f)](_0x1c89c8)),_0x420f0d(0x3,_0x24e1ed['Inject'](_0x24e1ed[_0x3ceef6(0x327)]))],_0x2998bc);function _0x5bf479(_0x25fe73){const _0x33f0f3=_0x3ceef6,_0x506f57=new Map();return _0x25fe73[_0x33f0f3(0x115)](_0x3b13c4=>{const _0x87557a=_0x33f0f3;if(_0x506f57[_0x87557a(0x245)](_0x3b13c4[_0x87557a(0x212)])){const _0x2d8eca=_0x506f57[_0x87557a(0x414)](_0x3b13c4[_0x87557a(0x212)]);_0x2d8eca['name']+=',\x20'+_0x3b13c4['name'];}else _0x506f57[_0x87557a(0xe7)](_0x3b13c4[_0x87557a(0x212)],_0x3b13c4);}),Array['from'](_0x506f57['values']());}var _0x306acd=function(){const _0x123d36=_0x3ceef6;return _0x306acd=Object[_0x123d36(0x45c)]||function(_0x431a49){const _0x243fa2=_0x123d36;for(var _0xe569ca,_0x573ceb=0x1,_0x5ae06b=arguments[_0x243fa2(0x346)];_0x573ceb<_0x5ae06b;_0x573ceb++){_0xe569ca=arguments[_0x573ceb];for(var _0x1dc36b in _0xe569ca)Object['prototype'][_0x243fa2(0x3c3)][_0x243fa2(0x2b8)](_0xe569ca,_0x1dc36b)&&(_0x431a49[_0x1dc36b]=_0xe569ca[_0x1dc36b]);}return _0x431a49;},_0x306acd[_0x123d36(0x3b7)](this,arguments);},_0x33f642=function(_0x503ef9,_0x5eb3da){const _0x2e9320=_0x3ceef6;var _0x2e3d7e={};for(var _0x2c9282 in _0x503ef9)Object['prototype'][_0x2e9320(0x3c3)][_0x2e9320(0x2b8)](_0x503ef9,_0x2c9282)&&_0x5eb3da[_0x2e9320(0x249)](_0x2c9282)<0x0&&(_0x2e3d7e[_0x2c9282]=_0x503ef9[_0x2c9282]);if(_0x503ef9!=null&&typeof Object[_0x2e9320(0x4a1)]==_0x2e9320(0x2d6)){for(var _0xc24cea=0x0,_0x2c9282=Object[_0x2e9320(0x4a1)](_0x503ef9);_0xc24cea<_0x2c9282[_0x2e9320(0x346)];_0xc24cea++)_0x5eb3da[_0x2e9320(0x249)](_0x2c9282[_0xc24cea])<0x0&&Object['prototype'][_0x2e9320(0x26e)]['call'](_0x503ef9,_0x2c9282[_0xc24cea])&&(_0x2e3d7e[_0x2c9282[_0xc24cea]]=_0x503ef9[_0x2c9282[_0xc24cea]]);}return _0x2e3d7e;},_0x3e99a6=_0x539127[_0x3ceef6(0x3bb)](function(_0x54f60f,_0x55f9f0){const _0x10fff4=_0x3ceef6;var _0x111052=_0x54f60f[_0x10fff4(0x2ed)],_0x41b018=_0x54f60f['id'],_0x1c2f8d=_0x54f60f[_0x10fff4(0xf6)],_0x1de8d4=_0x54f60f[_0x10fff4(0x499)],_0x4ddca7=_0x33f642(_0x54f60f,['icon','id',_0x10fff4(0xf6),_0x10fff4(0x499)]),_0x469619=_0x10fff4(0x47d)[_0x10fff4(0x294)](_0x41b018,'\x20')[_0x10fff4(0x294)](_0x1c2f8d||'')[_0x10fff4(0x42d)](),_0x2634f6=_0x539127['useRef']('_'[_0x10fff4(0x294)](_0x1515a8()));return _0x38d1ea(_0x111052,''[_0x10fff4(0x294)](_0x41b018),{'defIds':_0x111052[_0x10fff4(0x47a)],'idSuffix':_0x2634f6[_0x10fff4(0x2d7)]},_0x306acd({'ref':_0x55f9f0,'className':_0x469619},_0x4ddca7),_0x1de8d4);});function _0x38d1ea(_0x473dac,_0x2df118,_0x1e3506,_0x3b0eb7,_0x312d46){const _0x3a3318=_0x3ceef6;return _0x539127[_0x3a3318(0x2aa)](_0x473dac[_0x3a3318(0x464)],_0x306acd(_0x306acd({'key':_0x2df118},_0x4d1aca(_0x473dac,_0x1e3506,_0x312d46)),_0x3b0eb7),(_0x3d6822(_0x473dac,_0x1e3506)[_0x3a3318(0x47b)]||[])['map'](function(_0x14d7d9,_0x93dbc4){const _0x21cf03=_0x3a3318;return _0x38d1ea(_0x14d7d9,''['concat'](_0x2df118,'-')[_0x21cf03(0x294)](_0x473dac[_0x21cf03(0x464)],'-')[_0x21cf03(0x294)](_0x93dbc4),_0x1e3506,void 0x0,_0x312d46);}));}function _0x4d1aca(_0x335657,_0x543381,_0x194a03){const _0x1313a9=_0x3ceef6;var _0x13cbc5=_0x306acd({},_0x335657[_0x1313a9(0x137)]);_0x194a03!=null&&_0x194a03[_0x1313a9(0x1f2)]&&_0x13cbc5[_0x1313a9(0x168)]===_0x1313a9(0x1f2)&&(_0x13cbc5[_0x1313a9(0x168)]=_0x194a03['colorChannel1']);var _0x7ba297=_0x543381[_0x1313a9(0x47a)];return!_0x7ba297||_0x7ba297[_0x1313a9(0x346)]===0x0||(_0x335657[_0x1313a9(0x464)]===_0x1313a9(0x3d5)&&_0x13cbc5[_0x1313a9(0x164)]&&(_0x13cbc5[_0x1313a9(0x164)]=_0x13cbc5['xlink:href']+_0x543381[_0x1313a9(0x3c2)]),Object[_0x1313a9(0x114)](_0x13cbc5)[_0x1313a9(0x115)](function(_0x48e0a7){const _0x4ff84e=_0x1313a9;var _0xb7ba1d=_0x48e0a7[0x0],_0x274433=_0x48e0a7[0x1];typeof _0x274433==_0x4ff84e(0x430)&&(_0x13cbc5[_0xb7ba1d]=_0x274433[_0x4ff84e(0x130)](/url\(#(.*)\)/,_0x4ff84e(0x1da)[_0x4ff84e(0x294)](_0x543381[_0x4ff84e(0x3c2)],')')));})),_0x13cbc5;}function _0x3d6822(_0x4f8b1e,_0x258b1a){const _0x1bb6cb=_0x3ceef6;var _0x19a49f,_0xa9d1b=_0x258b1a[_0x1bb6cb(0x47a)];return!_0xa9d1b||_0xa9d1b['length']===0x0?_0x4f8b1e:_0x4f8b1e[_0x1bb6cb(0x464)]===_0x1bb6cb(0x10c)&&(!((_0x19a49f=_0x4f8b1e['children'])===null||_0x19a49f===void 0x0)&&_0x19a49f[_0x1bb6cb(0x346)])?_0x306acd(_0x306acd({},_0x4f8b1e),{'children':_0x4f8b1e[_0x1bb6cb(0x47b)][_0x1bb6cb(0x315)](function(_0xd98c11){const _0x176942=_0x1bb6cb;return typeof _0xd98c11['attrs']['id']==_0x176942(0x430)&&_0xa9d1b&&_0xa9d1b[_0x176942(0x249)](_0xd98c11[_0x176942(0x137)]['id'])>-0x1?_0x306acd(_0x306acd({},_0xd98c11),{'attrs':_0x306acd(_0x306acd({},_0xd98c11[_0x176942(0x137)]),{'id':_0xd98c11[_0x176942(0x137)]['id']+_0x258b1a['idSuffix']})}):_0xd98c11;})}):_0x4f8b1e;}function _0x1515a8(){const _0xa58eb4=_0x3ceef6;return Math[_0xa58eb4(0x37e)]()[_0xa58eb4(0xff)](0x24)[_0xa58eb4(0xdc)](0x2,0x8);}_0x3e99a6[_0x3ceef6(0x472)]=_0x3ceef6(0x2e3);var _0x59c402={'tag':'svg','attrs':{'fill':_0x3ceef6(0x3bd),'viewBox':'0\x200\x2016\x2016','width':'1em','height':_0x3ceef6(0x283)},'children':[{'tag':'g','attrs':{'clipPath':'url(#off-line-single_clip0_910_343)'},'children':[{'tag':_0x3ceef6(0x49a),'attrs':{'stroke':_0x3ceef6(0x455),'d':_0x3ceef6(0x34c),'strokeLinecap':_0x3ceef6(0x434),'strokeLinejoin':_0x3ceef6(0x434),'strokeWidth':1.2}}]},{'tag':_0x3ceef6(0x10c),'attrs':{},'children':[{'tag':_0x3ceef6(0x442),'attrs':{'id':_0x3ceef6(0xee)},'children':[{'tag':_0x3ceef6(0x49a),'attrs':{'fill':_0x3ceef6(0x3a8),'d':_0x3ceef6(0x203)}}]}]}],'defIds':[_0x3ceef6(0xee)]},_0x165786=_0x539127[_0x3ceef6(0x3bb)](function(_0x127459,_0x5046f8){const _0x140df1=_0x3ceef6;return _0x539127[_0x140df1(0x2aa)](_0x3e99a6,Object[_0x140df1(0x45c)]({},_0x127459,{'id':_0x140df1(0xb5),'ref':_0x5046f8,'icon':_0x59c402}));});_0x165786[_0x3ceef6(0x472)]=_0x3ceef6(0xaf);var _0x2edb0c={'tag':'svg','attrs':{'fill':_0x3ceef6(0x3bd),'viewBox':'0\x200\x2017\x2016','width':'1em','height':_0x3ceef6(0x283)},'children':[{'tag':'g','attrs':{'clipPath':_0x3ceef6(0x1c3)},'children':[{'tag':_0x3ceef6(0x49a),'attrs':{'stroke':_0x3ceef6(0x455),'d':'M4.5865\x2011.6499C3.36983\x2011.6499\x201.6665\x2011.1024\x201.6665\x208.9124C1.6665\x206.3574\x204.2215\x205.8099\x204.9515\x205.8099C5.3165\x204.5324\x206.0465\x202.5249\x208.9665\x202.5249C11.5215\x202.5249\x2012.6165\x203.9849\x2012.9815\x205.2624C12.9815\x205.2624\x2016.2665\x205.6274\x2016.2665\x208.7299C16.2665\x2010.9199\x2014.8065\x2011.6499\x2013.3465\x2011.6499M6.7767\x2011.6497L8.9667\x2013.4747L11.8867\x209.82466','strokeLinecap':_0x3ceef6(0x434),'strokeLinejoin':_0x3ceef6(0x434),'strokeWidth':1.2}}]},{'tag':'defs','attrs':{},'children':[{'tag':_0x3ceef6(0x442),'attrs':{'id':'on-line-single_clip0_910_349'},'children':[{'tag':_0x3ceef6(0x49a),'attrs':{'fill':'#fff','d':_0x3ceef6(0x203),'transform':_0x3ceef6(0x142)}}]}]}],'defIds':[_0x3ceef6(0x127)]},_0x32f535=_0x539127[_0x3ceef6(0x3bb)](function(_0x21ef4a,_0x2c9f25){const _0xc20b7e=_0x3ceef6;return _0x539127[_0xc20b7e(0x2aa)](_0x3e99a6,Object['assign']({},_0x21ef4a,{'id':_0xc20b7e(0x3c0),'ref':_0x2c9f25,'icon':_0x2edb0c}));});_0x32f535[_0x3ceef6(0x472)]=_0x3ceef6(0x44c);const _0x3fbd4e={'onlineStatusIcon':_0x3ceef6(0x2ad),'onlineStatusTitle':_0x3ceef6(0x233),'onlineStatus':_0x3ceef6(0x146),'online':_0x3ceef6(0x180),'offline':_0x3ceef6(0x383)};function _0x1deb08(_0xa1710b){const _0x184cbd=_0x3ceef6;switch(_0xa1710b){case _0x5a1c45[_0x184cbd(0x27c)]:return _0x184cbd(0x106);case _0x5a1c45[_0x184cbd(0x204)]:return _0x184cbd(0x2fd);case _0x5a1c45[_0x184cbd(0x380)]:return _0x184cbd(0x173);case _0x5a1c45['NOT_COLLAB']:return _0x184cbd(0x34b);case _0x5a1c45['PENDING']:case _0x5a1c45[_0x184cbd(0xeb)]:case _0x5a1c45[_0x184cbd(0x1cc)]:return _0x184cbd(0x1db);case _0x5a1c45[_0x184cbd(0x25a)]:return _0x184cbd(0x1cb);}}function _0x43c850(_0x1b5fe5){const _0x118653=_0x3ceef6,{status$:_0x1e884e}=_0x1b5fe5,_0xe0d321=_0x279279['useObservable'](_0x1e884e,_0x5a1c45['NOT_COLLAB']),_0x145eb5=_0x24e1ed[_0x118653(0xd3)](_0x24e1ed['LocaleService']),_0x3cca7e=_0xe0d321!==_0x5a1c45[_0x118653(0x27c)],_0x463322=_0x145eb5['t'](_0x1deb08(_0xe0d321)),_0x21188b=_0x251dff(_0x3fbd4e[_0x118653(0xf1)],{[_0x3fbd4e[_0x118653(0x2b4)]]:_0x3cca7e,[_0x3fbd4e['offline']]:!_0x3cca7e}),_0x50b916=_0x3cca7e?_0x539127['createElement'](_0x32f535,null):_0x539127[_0x118653(0x2aa)](_0x165786,null);return _0x539127['createElement']('div',{'className':_0x21188b},_0x539127[_0x118653(0x2aa)]('div',{'className':_0x3fbd4e['onlineStatusIcon']},_0x50b916),_0x539127[_0x118653(0x2aa)](_0x118653(0x18a),{'className':_0x3fbd4e[_0x118653(0x23b)]},_0x463322));}var _0xbfd9a1=Object[_0x3ceef6(0x2d1)],_0x356bda=Object[_0x3ceef6(0x3fa)],_0xe60a39=(_0x4e0dd5,_0x3ed7b,_0x25e0fc,_0x21522d)=>{for(var _0x3d3915=_0x21522d>0x1?void 0x0:_0x21522d?_0x356bda(_0x3ed7b,_0x25e0fc):_0x3ed7b,_0x58d134=_0x4e0dd5['length']-0x1,_0x5a8706;_0x58d134>=0x0;_0x58d134--)(_0x5a8706=_0x4e0dd5[_0x58d134])&&(_0x3d3915=(_0x21522d?_0x5a8706(_0x3ed7b,_0x25e0fc,_0x3d3915):_0x5a8706(_0x3d3915))||_0x3d3915);return _0x21522d&&_0x3d3915&&_0xbfd9a1(_0x3ed7b,_0x25e0fc,_0x3d3915),_0x3d3915;},_0x324885=(_0x1a87e8,_0x1b7e17)=>(_0x113340,_0x296587)=>_0x1b7e17(_0x113340,_0x296587,_0x1a87e8);_0x481c9f[_0x3ceef6(0x33a)]=class extends _0x24e1ed[_0x3ceef6(0x26d)]{constructor(_0x49f6c6,_0x486c64,_0x388229,_0x1da7eb){const _0x50e7c9=_0x3ceef6;super(),_0x1b84ec(this,_0x50e7c9(0xdf),new _0x5ba5b9[(_0x50e7c9(0x43c))](_0x5a1c45['NOT_COLLAB'])),(this[_0x50e7c9(0x198)]=_0x49f6c6,this[_0x50e7c9(0x147)]=_0x486c64,this[_0x50e7c9(0x376)]=_0x388229,this[_0x50e7c9(0x3be)]=_0x1da7eb,this[_0x50e7c9(0x2b1)](),this['_initStatusListener']());}[_0x3ceef6(0x2b1)](){const _0x17cef6=_0x3ceef6;this[_0x17cef6(0x184)](this[_0x17cef6(0x147)][_0x17cef6(0x332)](_0x279279['BuiltInUIPart']['HEADER_MENU'],()=>_0x24e1ed[_0x17cef6(0x1e1)](_0x3e1f28({'status$':this[_0x17cef6(0xdf)][_0x17cef6(0x2ce)]()}),this[_0x17cef6(0x376)])));}[_0x3ceef6(0x1d6)](){const _0x16551c=_0x3ceef6;this['disposeWithMe'](_0x24e1ed['toDisposable'](this[_0x16551c(0x198)][_0x16551c(0x1ee)][_0x16551c(0x30e)](_0x5ba5b9['switchMap'](()=>{const _0x13eca8=_0x16551c,_0x3b9207=this['_univerInstanceService'][_0x13eca8(0x158)]();return _0x3b9207?this[_0x13eca8(0x3be)][_0x13eca8(0x408)](_0x3b9207[_0x13eca8(0x398)]()):_0x5ba5b9['of'](null);}),_0x5ba5b9[_0x16551c(0x360)](_0xcb32da=>_0xcb32da?_0xcb32da[_0x16551c(0x17f)]:_0x5ba5b9['of'](_0x5a1c45['NOT_COLLAB'])))['subscribe'](_0x27b4d2=>{const _0x36a350=_0x16551c;this[_0x36a350(0xdf)][_0x36a350(0x48b)](_0x27b4d2);})));}},_0x481c9f['DesktopCollaborationStatusDisplayController']=_0xe60a39([_0x24e1ed['OnLifecycle'](_0x24e1ed[_0x3ceef6(0xf7)][_0x3ceef6(0x1a3)],_0x481c9f['DesktopCollaborationStatusDisplayController']),_0x324885(0x0,_0x24e1ed[_0x3ceef6(0x36c)]),_0x324885(0x1,_0x279279[_0x3ceef6(0x210)]),_0x324885(0x2,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x405)])),_0x324885(0x3,_0x24e1ed[_0x3ceef6(0x48f)](_0x481c9f['CollaborationController']))],_0x481c9f[_0x3ceef6(0x33a)]);function _0x3e1f28(_0x55c992){const {status$:_0x51b953}=_0x55c992;return function(){const _0x3e0929=_0x5b63;return _0x539127[_0x3e0929(0x2aa)](_0x43c850,{'status$':_0x51b953});};}const _0xc2175=_0x24e1ed[_0x3ceef6(0x381)](_0x3ceef6(0x1d3));var _0xfbe72c=Object[_0x3ceef6(0x2d1)],_0x59931b=Object[_0x3ceef6(0x3fa)],_0x43abbc=(_0x22f51e,_0x4ea862,_0x46604e,_0x2e1afa)=>{for(var _0x570a76=_0x2e1afa>0x1?void 0x0:_0x2e1afa?_0x59931b(_0x4ea862,_0x46604e):_0x4ea862,_0x55cc02=_0x22f51e['length']-0x1,_0x28face;_0x55cc02>=0x0;_0x55cc02--)(_0x28face=_0x22f51e[_0x55cc02])&&(_0x570a76=(_0x2e1afa?_0x28face(_0x4ea862,_0x46604e,_0x570a76):_0x28face(_0x570a76))||_0x570a76);return _0x2e1afa&&_0x570a76&&_0xfbe72c(_0x4ea862,_0x46604e,_0x570a76),_0x570a76;},_0x1df2f4=(_0x172ad6,_0x432651)=>(_0x161f93,_0x42b4c4)=>_0x432651(_0x161f93,_0x42b4c4,_0x172ad6);_0x481c9f[_0x3ceef6(0x273)]=class extends _0x24e1ed['RxDisposable']{constructor(_0x2a6323,_0x5d2986,_0x36ca37,_0x17eb67,_0x3c50fe,_0x5651a9){const _0xcbfe0b=_0x3ceef6;super(),this['_urlService']=_0x2a6323,this[_0xcbfe0b(0x256)]=_0x5d2986,this[_0xcbfe0b(0x285)]=_0x36ca37,this[_0xcbfe0b(0x140)]=_0x17eb67,this['_snapshotService']=_0x3c50fe,_0x5651a9?_0x5651a9==null||_0x5651a9[_0xcbfe0b(0x1d4)]()[_0xcbfe0b(0x1df)](()=>this[_0xcbfe0b(0x13c)]()):(this['_logService'][_0xcbfe0b(0x1f3)](_0xcbfe0b(0x37f),'No\x20remote\x20instance\x20service\x20injected.\x20May\x20not\x20syncing\x20edits\x20to\x20the\x20web\x20worker.'),this[_0xcbfe0b(0x13c)]());}async[_0x3ceef6(0x13c)](){const _0x52ed09=_0x3ceef6,_0x38a9c0=this['_urlService']['getParam'](_0x52ed09(0x46c)),_0x496d9a=this[_0x52ed09(0x2ec)][_0x52ed09(0x2bc)](_0x52ed09(0x223));if(!_0x38a9c0||!_0x496d9a){this[_0x52ed09(0x256)][_0x52ed09(0x1f3)](_0x52ed09(0x37f),_0x52ed09(0xe5));return;}switch(Number(_0x496d9a)){case _0x1a91ec[_0x52ed09(0x2b3)]:{const _0x4e3720=await this[_0x52ed09(0x30d)](_0x38a9c0);this[_0x52ed09(0x10a)](_0x4e3720);break;}case _0x1a91ec[_0x52ed09(0x192)]:{await this[_0x52ed09(0x30b)](_0x38a9c0);break;}default:{this[_0x52ed09(0x256)][_0x52ed09(0x457)](_0x52ed09(0x37f),_0x52ed09(0xb6));break;}}}async[_0x3ceef6(0x10a)](_0x4ab01d){const _0x548a3f=_0x3ceef6;await this['_updateSubUnitFromURLParams'](_0x4ab01d),_0x4ab01d['activeSheet$'][_0x548a3f(0x30e)](_0x5ba5b9[_0x548a3f(0x2c3)](this[_0x548a3f(0x318)]))[_0x548a3f(0x1b0)](_0x3a2fb2=>{const _0x3e5b58=_0x548a3f;_0x3a2fb2&&this[_0x3e5b58(0x32c)](_0x3a2fb2);}),this[_0x548a3f(0x2ec)][_0x548a3f(0x446)][_0x548a3f(0x30e)](_0x5ba5b9[_0x548a3f(0x2c3)](this[_0x548a3f(0x318)]))['subscribe'](()=>this[_0x548a3f(0xd1)](_0x4ab01d));}['_updateURLWithCurrentState'](_0x8de496,_0x1bae9e=!0x1){const _0x556f74=_0x3ceef6,_0x2083ec=this[_0x556f74(0x2ec)][_0x556f74(0x2bc)](_0x556f74(0x112));_0x8de496[_0x556f74(0x152)]()!==_0x2083ec&&this[_0x556f74(0x2ec)]['setParam'](_0x556f74(0x112),_0x8de496['getSheetId'](),_0x1bae9e);}async[_0x3ceef6(0xd1)](_0x348323){const _0x10cedb=_0x3ceef6;var _0xc59ec5;const _0x182ef0=this[_0x10cedb(0x2ec)]['getParam'](_0x10cedb(0x112));if(!_0x182ef0||!_0x348323[_0x10cedb(0xba)](_0x182ef0)){const _0x17079f=_0x348323[_0x10cedb(0x25b)]()[0x0],_0x26bbce=_0x348323[_0x10cedb(0xba)](_0x17079f);if(!_0x26bbce)return;this[_0x10cedb(0x32c)](_0x26bbce,!0x0),await this['_commandService']['executeCommand'](_0x5e02d9[_0x10cedb(0x1fc)]['id'],{'unitId':_0x348323[_0x10cedb(0x398)](),'subUnitId':_0x17079f});return;}((_0xc59ec5=_0x348323['getActiveSheet']())==null?void 0x0:_0xc59ec5[_0x10cedb(0x152)]())!==_0x182ef0&&await this[_0x10cedb(0x285)][_0x10cedb(0x2ef)](_0x5e02d9[_0x10cedb(0x1fc)]['id'],{'unitId':_0x348323[_0x10cedb(0x398)](),'subUnitId':_0x182ef0});}async['_loadSheet'](_0x4b14a8){const _0x54e88b=_0x3ceef6;let _0x21db70=0x0;const _0x5e373b=await this['_localCacheService'][_0x54e88b(0x1bf)](_0x4b14a8);return _0x5e373b&&(_0x5e373b[_0x54e88b(0x389)]||_0x5e373b['mutations'][_0x54e88b(0x346)]!==0x0)&&(_0x21db70=_0x5e373b['rev']),_0x21db70===0x0&&this[_0x54e88b(0x256)][_0x54e88b(0x1f3)](_0x54e88b(0x37f),_0x54e88b(0x47c)),this[_0x54e88b(0x321)]['loadSheet'](_0x4b14a8,_0x21db70);}async[_0x3ceef6(0x30b)](_0x55bf12){const _0x7947a2=_0x3ceef6;let _0x5e069e=0x0;const _0x34da0a=await this[_0x7947a2(0x140)][_0x7947a2(0x1bf)](_0x55bf12);return _0x34da0a&&(_0x34da0a[_0x7947a2(0x389)]||_0x34da0a['mutations'][_0x7947a2(0x346)]!==0x0)&&(_0x5e069e=_0x34da0a[_0x7947a2(0x107)]),_0x5e069e===0x0&&this['_logService'][_0x7947a2(0x1f3)](_0x7947a2(0x37f),_0x7947a2(0x47c)),this['_snapshotService'][_0x7947a2(0x263)](_0x55bf12,_0x5e069e);}},_0x481c9f['DataLoaderController']=_0x43abbc([_0x24e1ed[_0x3ceef6(0x25e)](_0x24e1ed['LifecycleStages'][_0x3ceef6(0x1a3)],_0x481c9f[_0x3ceef6(0x273)]),_0x1df2f4(0x0,_0xc2175),_0x1df2f4(0x1,_0x24e1ed[_0x3ceef6(0x250)]),_0x1df2f4(0x2,_0x24e1ed[_0x3ceef6(0x28e)]),_0x1df2f4(0x3,_0x24e1ed[_0x3ceef6(0x48f)](_0x481c9f['LocalCacheService'])),_0x1df2f4(0x4,_0x24e1ed[_0x3ceef6(0x48f)](_0x3c4c3c['SnapshotService'])),_0x1df2f4(0x5,_0x24e1ed[_0x3ceef6(0xcf)](_0x1392e7['IRemoteInstanceService']))],_0x481c9f[_0x3ceef6(0x273)]);var _0x46010f=Object[_0x3ceef6(0x2d1)],_0x2ab8ec=Object[_0x3ceef6(0x3fa)],_0x1c7ef4=(_0x94039a,_0x350287,_0x59db70,_0x57cc0c)=>{const _0x3320bc=_0x3ceef6;for(var _0x8f6b93=_0x57cc0c>0x1?void 0x0:_0x57cc0c?_0x2ab8ec(_0x350287,_0x59db70):_0x350287,_0x3aaad9=_0x94039a[_0x3320bc(0x346)]-0x1,_0x2b5d44;_0x3aaad9>=0x0;_0x3aaad9--)(_0x2b5d44=_0x94039a[_0x3aaad9])&&(_0x8f6b93=(_0x57cc0c?_0x2b5d44(_0x350287,_0x59db70,_0x8f6b93):_0x2b5d44(_0x8f6b93))||_0x8f6b93);return _0x57cc0c&&_0x8f6b93&&_0x46010f(_0x350287,_0x59db70,_0x8f6b93),_0x8f6b93;},_0x59dbb1=(_0x388030,_0x1b505b)=>(_0x38498e,_0x463b94)=>_0x1b505b(_0x38498e,_0x463b94,_0x388030);const _0x2167c4=_0x3ceef6(0x24f),_0x58b554='Univer';let _0x310dfd=class extends _0x24e1ed['Disposable']{constructor(_0x25c909,_0x20882e){const _0xa0a137=_0x3ceef6;super(),this['_univerInstanceService']=_0x25c909,this[_0xa0a137(0x421)]=_0x20882e,this[_0xa0a137(0x13c)]();}[_0x3ceef6(0x13c)](){const _0x5251de=_0x3ceef6;this[_0x5251de(0x184)](_0x24e1ed[_0x5251de(0x18f)](this['_univerInstanceService'][_0x5251de(0x1ee)][_0x5251de(0x1b0)](()=>{const _0x3e99ae=_0x5251de;var _0x2e80f4;const _0xdde1fc=this['_univerInstanceService']['getFocusedUnit']();let _0xc1d67e=(_0x2e80f4=this['_configService'][_0x3e99ae(0x10b)](_0x2167c4))!=null?_0x2e80f4:_0x58b554;_0xdde1fc instanceof _0x24e1ed[_0x3e99ae(0x12c)]&&(_0xc1d67e=_0xdde1fc[_0x3e99ae(0x329)]),document['title']=_0xc1d67e;})));}};_0x310dfd=_0x1c7ef4([_0x24e1ed[_0x3ceef6(0x25e)](_0x24e1ed[_0x3ceef6(0xf7)][_0x3ceef6(0x1b4)],_0x310dfd),_0x59dbb1(0x0,_0x24e1ed[_0x3ceef6(0x36c)]),_0x59dbb1(0x1,_0x24e1ed[_0x3ceef6(0x476)])],_0x310dfd);var _0x2a8fee=Object[_0x3ceef6(0x2d1)],_0x4e7c85=Object[_0x3ceef6(0x3fa)],_0x326b9c=(_0x418f9d,_0x3a906f,_0x4c9de1,_0xdeeb70)=>{const _0x283a45=_0x3ceef6;for(var _0x329435=_0xdeeb70>0x1?void 0x0:_0xdeeb70?_0x4e7c85(_0x3a906f,_0x4c9de1):_0x3a906f,_0x57ecf5=_0x418f9d[_0x283a45(0x346)]-0x1,_0x1efa69;_0x57ecf5>=0x0;_0x57ecf5--)(_0x1efa69=_0x418f9d[_0x57ecf5])&&(_0x329435=(_0xdeeb70?_0x1efa69(_0x3a906f,_0x4c9de1,_0x329435):_0x1efa69(_0x329435))||_0x329435);return _0xdeeb70&&_0x329435&&_0x2a8fee(_0x3a906f,_0x4c9de1,_0x329435),_0x329435;},_0x10d0e1=(_0x5d29f5,_0x431992)=>(_0x1ae956,_0x537894)=>_0x431992(_0x1ae956,_0x537894,_0x5d29f5);_0x481c9f[_0x3ceef6(0x313)]=class{constructor(_0x3ced8e,_0x1a17e4){const _0x12d481=_0x3ceef6;this[_0x12d481(0x421)]=_0x3ced8e,this[_0x12d481(0x1fe)]=_0x1a17e4;}async[_0x3ceef6(0x224)](_0x5e17be,_0x20289b){const _0xb26b81=_0x3ceef6;var _0x1ff1d3;const {unitID:_0x39b721,type:_0x38340f,revision:_0x1a5533=0x0}=_0x20289b,_0x2a5b79=this[_0xb26b81(0x3c1)]()+'/'+_0x38340f+_0xb26b81(0xc2)+_0x39b721+_0xb26b81(0x342)+_0x1a5533,_0x16ea14=(await this['_httpService']['get'](_0x2a5b79))[_0xb26b81(0x314)],_0xb0659e=(_0x1ff1d3=_0x16ea14[_0xb26b81(0x44a)])==null?void 0x0:_0x1ff1d3[_0xb26b81(0x116)];if(_0xb0659e){const _0x57810a=_0xb0659e==null?void 0x0:_0xb0659e[_0xb26b81(0xca)],_0x2be000=_0x24e1ed[_0xb26b81(0x449)][_0xb26b81(0x156)](_0x24e1ed[_0xb26b81(0x197)](_0x57810a));_0xb0659e['originalMeta']=_0x2be000,Object[_0xb26b81(0x114)](_0xb0659e[_0xb26b81(0xfe)])[_0xb26b81(0x115)](([,_0x4d23db])=>{const _0x384039=_0xb26b81,_0x4dba25=_0x4d23db['originalMeta'],_0x4ef5e1=_0x24e1ed[_0x384039(0x449)]['encode'](_0x24e1ed['b64DecodeUnicode'](_0x4dba25));_0x4d23db[_0x384039(0xca)]=_0x4ef5e1;});}return _0x16ea14;}async[_0x3ceef6(0x13e)](_0x52e97c,_0x50545e){const _0x34f8b7=_0x3ceef6,{unitID:_0x760213,type:_0xefce2c,blockID:_0x5d2f56}=_0x50545e,_0x406799=this[_0x34f8b7(0x20f)]()+'/'+_0xefce2c+_0x34f8b7(0xc2)+_0x760213+_0x34f8b7(0xe0)+_0x5d2f56;return(await this['_httpService']['get'](_0x406799))[_0x34f8b7(0x314)];}async[_0x3ceef6(0x2e7)](_0x3339d3,_0x2fb90f){const _0x21b416=_0x3ceef6,{unitID:_0x585302,type:_0x2d4a2b,from:_0x5da807,to:_0x1c2d4c}=_0x2fb90f,_0x30b77c=this[_0x21b416(0x20f)]()+'/'+_0x2d4a2b+_0x21b416(0xc2)+_0x585302+_0x21b416(0xb1)+_0x5da807+'&to='+_0x1c2d4c;return(await this['_httpService'][_0x21b416(0x414)](_0x30b77c))[_0x21b416(0x314)];}[_0x3ceef6(0x3c1)](){const _0x4b6f13=_0x3ceef6;var _0x579e94;return(_0x579e94=this['_configService'][_0x4b6f13(0x10b)](_0x53b238))!=null?_0x579e94:this['_getAPIPrefix']();}['_getAPIPrefix'](){const _0x230e35=_0x3ceef6;var _0x3f544a;return(_0x3f544a=this[_0x230e35(0x421)][_0x230e35(0x10b)](_0x6544dc))!=null?_0x3f544a:_0x2d8cc4;}async[_0x3ceef6(0xe8)](_0x464428,_0x347567){const _0x2272a9=_0x3ceef6,_0x2ecffa=_0x2272a9(0x49e)+_0x347567[_0x2272a9(0x223)]+_0x2272a9(0xc2)+_0x347567[_0x2272a9(0x208)]+_0x2272a9(0x2f1);return(await this[_0x2272a9(0x1fe)][_0x2272a9(0x414)](_0x2ecffa,{'params':{'resourceId':JSON[_0x2272a9(0x1b1)](_0x347567['resourceIDs'])}}))['body'];}[_0x3ceef6(0x484)](){const _0x2ada5b=_0x3ceef6;throw new Error(_0x2ada5b(0xe3));}[_0x3ceef6(0x36e)](){throw new Error('This\x20method\x20should\x20not\x20be\x20called\x20on\x20the\x20client\x20side!');}[_0x3ceef6(0x24e)](){throw new Error('This\x20method\x20should\x20not\x20be\x20called\x20on\x20the\x20client\x20side!');}},_0x481c9f['SnapshotServerOverHTTPService']=_0x326b9c([_0x10d0e1(0x0,_0x24e1ed['IConfigService']),_0x10d0e1(0x1,_0x24e1ed['Inject'](_0x2df7e0[_0x3ceef6(0x3ed)]))],_0x481c9f[_0x3ceef6(0x313)]);var _0x564b59=Object[_0x3ceef6(0x2d1)],_0x1e7e9a=Object[_0x3ceef6(0x3fa)],_0x33facb=(_0x1468c0,_0x35dff2,_0x33f312,_0x13adae)=>{const _0x30da1b=_0x3ceef6;for(var _0x34edf3=_0x13adae>0x1?void 0x0:_0x13adae?_0x1e7e9a(_0x35dff2,_0x33f312):_0x35dff2,_0x19f8d3=_0x1468c0[_0x30da1b(0x346)]-0x1,_0x4e5437;_0x19f8d3>=0x0;_0x19f8d3--)(_0x4e5437=_0x1468c0[_0x19f8d3])&&(_0x34edf3=(_0x13adae?_0x4e5437(_0x35dff2,_0x33f312,_0x34edf3):_0x4e5437(_0x34edf3))||_0x34edf3);return _0x13adae&&_0x34edf3&&_0x564b59(_0x35dff2,_0x33f312,_0x34edf3),_0x34edf3;},_0x52f7e6=(_0x3d628f,_0x4c10f4)=>(_0xdb44ed,_0x34ff0b)=>_0x4c10f4(_0xdb44ed,_0x34ff0b,_0x3d628f);let _0x26c297=class extends _0x24e1ed[_0x3ceef6(0x23d)]{constructor(_0x5ef386,_0x38c876,_0x386999,_0x5854df,_0x4a2a5f){const _0x3457be=_0x3ceef6;super(_0x5ef386,_0x38c876,_0x386999),this['_transformService']=_0x5854df,this[_0x3457be(0x256)]=_0x4a2a5f;}[_0x3ceef6(0x269)](_0x17c62a,_0x1a08d0){const _0x4c12cd=_0x3ceef6,_0x48d31f=this['_getUndoStack'](_0x17c62a);if(_0x48d31f)try{const _0x116391=this['_transformStack'](_0x48d31f,_0x1a08d0);this[_0x4c12cd(0x2af)](_0x17c62a,_0x116391);}catch(_0x13f5e8){this[_0x4c12cd(0x256)]['error']('[CollaborationUndoRedoService]',_0x13f5e8),this[_0x4c12cd(0x440)](_0x17c62a);}const _0x38ad80=this[_0x4c12cd(0x3b3)](_0x17c62a);if(_0x38ad80)try{const _0x4ee559=this['_transformStack'](_0x38ad80,_0x1a08d0);this[_0x4c12cd(0x3e6)](_0x17c62a,_0x4ee559);}catch(_0x19e7c5){this[_0x4c12cd(0x256)][_0x4c12cd(0x457)](_0x19e7c5),this['_clearRedo'](_0x17c62a);}}[_0x3ceef6(0x440)](_0xe1ac8){const _0x15d203=this['_getUndoStack'](_0xe1ac8);_0x15d203&&(_0x15d203['length']=0x0,this['_updateStatus']());}[_0x3ceef6(0x11c)](_0x4682cd){const _0xea4a52=_0x3ceef6,_0x5db9b5=this[_0xea4a52(0x3b3)](_0x4682cd);_0x5db9b5&&(_0x5db9b5['length']=0x0,this[_0xea4a52(0x3c5)]());}[_0x3ceef6(0x2af)](_0x565ca1,_0x202dee){const _0x3f1a9f=_0x3ceef6;this['_undoStacks'][_0x3f1a9f(0xe7)](_0x565ca1,_0x202dee),this[_0x3f1a9f(0x3c5)]();}[_0x3ceef6(0x3e6)](_0x29d947,_0x544f99){const _0x2d1408=_0x3ceef6;this['_redoStacks'][_0x2d1408(0xe7)](_0x29d947,_0x544f99),this[_0x2d1408(0x3c5)]();}[_0x3ceef6(0x27f)](_0x52d54c,_0xf4d473){const _0x77ec70=_0x3ceef6,_0x1f7757=[];let _0x8795fa=_0xf4d473,_0x4a3e79=_0xf4d473;for(let _0x506d1e=_0x52d54c[_0x77ec70(0x346)]-0x1;_0x506d1e>=0x0;_0x506d1e--){const {unitID:_0x1a9c8e,undoMutations:_0x825c8d,redoMutations:_0x4200bb}=_0x52d54c[_0x506d1e],_0x2cae93=this[_0x77ec70(0x428)][_0x77ec70(0x38c)](_0x8795fa,_0x825c8d),_0x1bf97c=this[_0x77ec70(0x428)][_0x77ec70(0x38c)](_0x4a3e79,_0x4200bb);if(_0x3c4c3c[_0x77ec70(0x124)](_0x2cae93)||_0x3c4c3c[_0x77ec70(0x124)](_0x1bf97c)){this[_0x77ec70(0x256)][_0x77ec70(0x457)](_0x77ec70(0x159),_0x77ec70(0x2a2),_0x2cae93,_0x1bf97c);break;}_0x8795fa=_0x2cae93['c1Prime'],_0x4a3e79=_0x1bf97c[_0x77ec70(0x467)],_0x1f7757[_0x77ec70(0x279)]({'unitID':_0x1a9c8e,'undoMutations':_0x2cae93[_0x77ec70(0x49c)],'redoMutations':_0x1bf97c[_0x77ec70(0x49c)]});}return _0x1f7757[_0x77ec70(0x365)]();}};_0x26c297=_0x33facb([_0x52f7e6(0x0,_0x24e1ed[_0x3ceef6(0x36c)]),_0x52f7e6(0x1,_0x24e1ed[_0x3ceef6(0x28e)]),_0x52f7e6(0x2,_0x24e1ed[_0x3ceef6(0x465)]),_0x52f7e6(0x3,_0x3c4c3c[_0x3ceef6(0x2cd)]),_0x52f7e6(0x4,_0x24e1ed['ILogService'])],_0x26c297);class _0x3a3c68 extends _0x24e1ed['RxDisposable']{constructor(){const _0x1baf7c=_0x3ceef6;super(),_0x1b84ec(this,_0x1baf7c(0x446)),this[_0x1baf7c(0x446)]=_0x5ba5b9[_0x1baf7c(0x49b)](window,_0x1baf7c(0x348))[_0x1baf7c(0x30e)](_0x5ba5b9[_0x1baf7c(0x2c3)](this[_0x1baf7c(0x318)]),_0x5ba5b9[_0x1baf7c(0x37c)](0x1),_0x5ba5b9[_0x1baf7c(0x2d5)](void 0x0));}['setParam'](_0x1c2d4f,_0x479a17,_0xb5760b=!0x1){const _0x42eb5a=_0x3ceef6,_0x5385e3=new URL(window['location'][_0x42eb5a(0xfa)]);_0x5385e3[_0x42eb5a(0x1aa)][_0x42eb5a(0xe7)](_0x1c2d4f,_0x479a17),_0xb5760b?window[_0x42eb5a(0x480)][_0x42eb5a(0x254)]('','',_0x5385e3[_0x42eb5a(0xff)]()):window['history']['pushState']('','',_0x5385e3[_0x42eb5a(0xff)]());}[_0x3ceef6(0x2c9)](_0x39c3ee,_0x3b8324=!0x1){const _0x5db0ac=_0x3ceef6,_0x3e9222=new URL(window['location'][_0x5db0ac(0xfa)]);_0x3e9222[_0x5db0ac(0x1aa)]['delete'](_0x39c3ee),_0x3b8324?window[_0x5db0ac(0x480)]['replaceState']('','',_0x3e9222[_0x5db0ac(0xff)]()):window[_0x5db0ac(0x480)][_0x5db0ac(0x262)]('','',_0x3e9222['toString']());}[_0x3ceef6(0x2bc)](_0x57d6cb){const _0x1e810b=_0x3ceef6;var _0x3aa1a2;return(_0x3aa1a2=new URL(window[_0x1e810b(0x19b)][_0x1e810b(0xfa)])[_0x1e810b(0x1aa)][_0x1e810b(0x414)](_0x57d6cb))!=null?_0x3aa1a2:void 0x0;}}const _0x506dfc=_0x3ceef6(0x2c5),_0x14e9cd=_0x3ceef6(0x216),_0x480617=0x6,_0x409464=1.5,_0x45d918=0x4,_0x257a4a=1.5,_0x20e8f9=_0x3ceef6(0xad);class _0x139056{constructor(_0x2bef49,_0x3f6c5c,_0x57ce1,_0x28b823){const _0x83f933=_0x3ceef6;_0x1b84ec(this,'_shapes',[]),_0x1b84ec(this,'_anchor',null),_0x1b84ec(this,_0x83f933(0x128),null),_0x1b84ec(this,_0x83f933(0x350),null),_0x1b84ec(this,'_hideTimer',null),_0x1b84ec(this,_0x83f933(0x458),null),(this[_0x83f933(0x1ae)]=_0x2bef49,this[_0x83f933(0x29e)]=_0x3f6c5c,this['_docSkeleton']=_0x57ce1,this[_0x83f933(0x121)]=_0x28b823,this[_0x83f933(0x43e)]());}set[_0x3ceef6(0xd8)](_0x5428d6){const _0x22e10d=_0x3ceef6;_0x5428d6?(this['_anchorDot']&&this[_0x22e10d(0x350)][_0x22e10d(0x15b)](),this[_0x22e10d(0x128)]&&this['_textBubble'][_0x22e10d(0x38a)]()):(this[_0x22e10d(0x350)]&&this[_0x22e10d(0x350)]['show'](),this[_0x22e10d(0x128)]&&this['_textBubble'][_0x22e10d(0x15b)]());}['dispose'](){const _0x582885=_0x3ceef6;for(const _0x54df70 of this['_shapes'])_0x54df70[_0x582885(0x377)]();this[_0x582885(0x128)]&&this[_0x582885(0x128)][_0x582885(0x377)](),this['_anchorDot']&&this[_0x582885(0x350)][_0x582885(0x377)](),this[_0x582885(0xcc)]&&this[_0x582885(0xcc)][_0x582885(0x377)](),this[_0x582885(0x458)]&&this['_eventUnsubscribe']();}[_0x3ceef6(0x43e)](){const _0x2eb23c=_0x3ceef6,{_docSkeleton:_0x1cc288,_document:_0x227244}=this,{color:_0x5e3264,name:_0x321371,ranges:_0x565794}=this[_0x2eb23c(0x1ae)],_0x10a067=_0x227244[_0x2eb23c(0xc5)](),{docsLeft:_0x32f2ed,docsTop:_0x10e7b3}=_0x10a067,_0x18b90d=new _0x15516e['NodePositionConvertToCursor'](_0x10a067,_0x1cc288);for(const {startOffset:_0x5d5384,endOffset:_0x13682a,collapsed:_0x401a04,isActive:_0x2724bf}of _0x565794){const _0x6f9a77=_0x1cc288['findNodePositionByCharIndex'](_0x5d5384),_0x3446cd=_0x1cc288[_0x2eb23c(0x1e8)](_0x13682a);if(_0x2724bf){const {contentBoxPointGroup:_0x12b6fe}=_0x18b90d['getRangePointData'](_0x3446cd,_0x3446cd);if(_0x12b6fe[_0x2eb23c(0x346)]===0x0)continue;this[_0x2eb23c(0x357)](_0x5e3264,_0x12b6fe,_0x32f2ed,_0x10e7b3,_0x321371),this[_0x2eb23c(0x458)]=this[_0x2eb23c(0x26f)]();}if(!_0x401a04){const {contentBoxPointGroup:_0x275221}=_0x18b90d[_0x2eb23c(0x235)](_0x6f9a77,_0x3446cd);if(_0x275221[_0x2eb23c(0x346)]===0x0)continue;this[_0x2eb23c(0x190)](_0x5e3264,_0x275221,_0x32f2ed,_0x10e7b3);}}}[_0x3ceef6(0x357)](_0x24d16d,_0x2a9d64,_0x47280a,_0x481728,_0x4dcf6d){const _0x118287=_0x3ceef6,_0x5a8b7f=this[_0x118287(0x20d)](_0x2a9d64),{left:_0x55c521,top:_0x4e01fc,height:_0x30a9bc}=_0x5a8b7f,_0x57a531=this[_0x118287(0xe4)](),_0x5e883e=_0x257a4a/_0x57a531,_0x509064=new _0x15516e['Rect'](_0x506dfc+_0x24e1ed[_0x118287(0x11e)][_0x118287(0x20b)](_0x480617),{'left':_0x55c521+_0x47280a-_0x5e883e,'top':_0x4e01fc+_0x481728,'height':_0x30a9bc,'width':_0x409464,'fill':_0x24d16d||_0x15516e[_0x118287(0x461)](_0x24e1ed[_0x118287(0x108)]['black'],0x0),'strokeWidth':_0x5e883e,'stroke':_0x20e8f9,'evented':!0x0});this[_0x118287(0xcc)]=_0x509064,this[_0x118287(0x29e)][_0x118287(0x288)](_0x509064,_0x15516e['TEXT_RANGE_LAYER_INDEX']);const _0x3e1fde=new _0x15516e[(_0x118287(0x306))](_0x506dfc+_0x24e1ed[_0x118287(0x11e)]['generateRandomId'](_0x480617),{'left':_0x55c521+_0x47280a-_0x5e883e,'top':_0x4e01fc+_0x481728-_0x45d918/0x2,'height':_0x45d918,'width':_0x45d918,'fill':_0x24d16d||_0x15516e[_0x118287(0x461)](_0x24e1ed[_0x118287(0x108)]['black'],0x0),'strokeWidth':0x0,'stroke':_0x24d16d||_0x15516e[_0x118287(0x461)](_0x24e1ed['COLORS'][_0x118287(0x37b)],0x0),'evented':!0x1});this[_0x118287(0x350)]=_0x3e1fde,this[_0x118287(0x29e)]['addObject'](_0x3e1fde,_0x15516e[_0x118287(0x3b4)]);const _0x4c9c67=new _0x4ec885(_0x506dfc+_0x24e1ed[_0x118287(0x11e)][_0x118287(0x20b)](_0x480617),{'left':_0x55c521+_0x47280a-_0x5e883e,'top':_0x4e01fc+_0x481728-_0x1b216a,'text':_0x4dcf6d,'color':_0x24d16d});this[_0x118287(0x128)]=_0x4c9c67,this[_0x118287(0x29e)]['addObject'](_0x4c9c67,_0x15516e[_0x118287(0x3b4)]),this['_hover']=!0x1;}[_0x3ceef6(0x26f)](){const _0x32aa8d=_0x3ceef6,_0x5302f2=this['_anchor'][_0x32aa8d(0xb4)][_0x32aa8d(0x211)](()=>{this['_hover']=!0x0;}),_0x102de9=this[_0x32aa8d(0xcc)][_0x32aa8d(0x422)]['subscribeEvent'](()=>{const _0x3c81fd=_0x32aa8d;this[_0x3c81fd(0x20a)]&&clearTimeout(this[_0x3c81fd(0x20a)]),this['_hideTimer']=setTimeout(()=>{const _0x4237cb=_0x3c81fd;this[_0x4237cb(0xd8)]=!0x1;},0x7d0);});return()=>{const _0x12845a=_0x32aa8d;_0x5302f2[_0x12845a(0x291)](),_0x102de9[_0x12845a(0x291)]();};}[_0x3ceef6(0x190)](_0x45a6dc,_0x41d3ce,_0x2ab940,_0x26c7ff){const _0x71961c=_0x3ceef6,_0x1fd16f=new _0x24e1ed['ColorKit'](_0x45a6dc)[_0x71961c(0x34d)](0.2)['toRgbString'](),_0x2e09d2=new _0x15516e[(_0x71961c(0x479))](_0x14e9cd+_0x24e1ed[_0x71961c(0x11e)][_0x71961c(0x20b)](_0x480617),{'pointsGroup':_0x41d3ce,'fill':_0x1fd16f||_0x15516e['getColor'](_0x24e1ed[_0x71961c(0x108)]['black'],0.2),'left':_0x2ab940,'top':_0x26c7ff,'evented':!0x1,'debounceParentDirty':!0x1});this['_shapes'][_0x71961c(0x279)](_0x2e09d2),this[_0x71961c(0x29e)]['addObject'](_0x2e09d2,_0x15516e[_0x71961c(0x3b4)]);}[_0x3ceef6(0x20d)](_0x18f00a){const _0x1c74f1=_0x18f00a[0x0],_0xbf09d1=_0x1c74f1[0x0],_0x1d4e74=_0x1c74f1[0x2],{x:_0x20da9d,y:_0xc0cbf9}=_0xbf09d1,{x:_0x40f122,y:_0x5472f4}=_0x1d4e74;return{'left':_0x20da9d,'top':_0xc0cbf9,'width':_0x40f122-_0x20da9d,'height':_0x5472f4-_0xc0cbf9};}[_0x3ceef6(0xe4)](){const _0x2124a6=_0x3ceef6,{scaleX:_0x466102,scaleY:_0x32c2e4}=this[_0x2124a6(0x29e)][_0x2124a6(0x363)]();return Math[_0x2124a6(0x474)](_0x466102,_0x32c2e4);}}var _0xf754aa=Object['defineProperty'],_0x1fa6c6=Object['getOwnPropertyDescriptor'],_0x8fe292=(_0x2b3061,_0x47e2f8,_0x424278,_0x46c7f4)=>{const _0x158d9b=_0x3ceef6;for(var _0x41cb48=_0x46c7f4>0x1?void 0x0:_0x46c7f4?_0x1fa6c6(_0x47e2f8,_0x424278):_0x47e2f8,_0x21cdfb=_0x2b3061[_0x158d9b(0x346)]-0x1,_0x2e55fc;_0x21cdfb>=0x0;_0x21cdfb--)(_0x2e55fc=_0x2b3061[_0x21cdfb])&&(_0x41cb48=(_0x46c7f4?_0x2e55fc(_0x47e2f8,_0x424278,_0x41cb48):_0x2e55fc(_0x41cb48))||_0x41cb48);return _0x46c7f4&&_0x41cb48&&_0xf754aa(_0x47e2f8,_0x424278,_0x41cb48),_0x41cb48;},_0x5c5758=(_0x1726b9,_0x123829)=>(_0x2eba23,_0x1ac3a5)=>_0x123829(_0x2eba23,_0x1ac3a5,_0x1726b9);let _0x2e8e87=class extends _0x24e1ed[_0x3ceef6(0x379)]{constructor(_0x4482eb,_0x5963d0,_0x33540f,_0x42ee03,_0x3dc4d5){const _0x319baf=_0x3ceef6;super(),_0x1b84ec(this,_0x319baf(0x2a9),[]),(this[_0x319baf(0x396)]=_0x4482eb,this[_0x319baf(0x19d)]=_0x5963d0,this[_0x319baf(0x42f)]=_0x33540f,this['_renderManagerService']=_0x42ee03,this['_themeService']=_0x3dc4d5,this['_init']());}[_0x3ceef6(0x13c)](){const _0x1540cf=_0x3ceef6,_0x1cb320=this[_0x1540cf(0x396)][_0x1540cf(0x167)],_0x4e67d6=this['_docSkeletonManagerService'];this[_0x1540cf(0x184)](_0x5ba5b9['combineLatest']([this[_0x1540cf(0x42f)][_0x1540cf(0x1f8)](_0x1cb320),this['_themeService'][_0x1540cf(0x14f)]])[_0x1540cf(0x30e)](_0xb49021[_0x1540cf(0x315)](([_0x389d2e,_0x30027d])=>({'skeleton':_0x4e67d6[_0x1540cf(0x157)](),'cursors':[..._0x389d2e[_0x1540cf(0x179)]()][_0x1540cf(0x3b6)](_0x2de1ab=>({..._0x2de1ab,'color':_0x30027d[_0x2de1ab[_0x1540cf(0x462)]]}))})))[_0x1540cf(0x1b0)](_0x4907d5=>{if(this['_removeCollabCursors'](),_0x4907d5){const {skeleton:_0x263bae,cursors:_0x49144e}=_0x4907d5;this['_updateCollabCursors'](_0x263bae,_0x49144e);}}));}['_updateCollabCursors'](_0x6573e9,_0x5095d4){const _0x54f128=_0x3ceef6,{scene:_0x2cb2d5,mainComponent:_0x546148}=this['_context'],_0x9688b6=_0x5095d4[_0x54f128(0x315)](_0x2b380e=>new _0x139056(_0x2b380e,_0x2cb2d5,_0x6573e9,_0x546148));this[_0x54f128(0x2a9)]=_0x9688b6;}['_removeCollabCursors'](){const _0x5be037=_0x3ceef6;this['_cursors']['forEach'](_0x45a447=>_0x45a447[_0x5be037(0x377)]()),this[_0x5be037(0x2a9)]=[];}};_0x2e8e87=_0x8fe292([_0x24e1ed['OnLifecycle'](_0x24e1ed[_0x3ceef6(0xf7)][_0x3ceef6(0x299)],_0x2e8e87),_0x5c5758(0x1,_0x24e1ed[_0x3ceef6(0x48f)](_0x2c946a['DocSkeletonManagerService'])),_0x5c5758(0x2,_0x24e1ed[_0x3ceef6(0x48f)](_0x1c89c8)),_0x5c5758(0x3,_0x15516e[_0x3ceef6(0x35c)]),_0x5c5758(0x4,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed['ThemeService']))],_0x2e8e87);var _0x184def=Object[_0x3ceef6(0x2d1)],_0x3dc8b6=Object[_0x3ceef6(0x3fa)],_0x136a5f=(_0x102998,_0x34c88d,_0x283b68,_0x3fed37)=>{for(var _0x40df36=_0x3fed37>0x1?void 0x0:_0x3fed37?_0x3dc8b6(_0x34c88d,_0x283b68):_0x34c88d,_0x528b74=_0x102998['length']-0x1,_0x40bd67;_0x528b74>=0x0;_0x528b74--)(_0x40bd67=_0x102998[_0x528b74])&&(_0x40df36=(_0x3fed37?_0x40bd67(_0x34c88d,_0x283b68,_0x40df36):_0x40bd67(_0x40df36))||_0x40df36);return _0x3fed37&&_0x40df36&&_0x184def(_0x34c88d,_0x283b68,_0x40df36),_0x40df36;},_0x4a3361=(_0x484e06,_0x2041c0)=>(_0x3421aa,_0x3bd896)=>_0x2041c0(_0x3421aa,_0x3bd896,_0x484e06);let _0x297e98=class{constructor(_0x1e01f8,_0x23cdac,_0x3ca13c){const _0x13a593=_0x3ceef6;this[_0x13a593(0x421)]=_0x1e01f8,this[_0x13a593(0x1fe)]=_0x23cdac,this[_0x13a593(0x469)]=_0x3ca13c,this['init']();}[_0x3ceef6(0x143)](){const _0x5c6c43=_0x3ceef6;this['_httpService']['registerHTTPInterceptor']({'priority':0x1,'interceptor':(_0xf8c6f,_0x5acfb4)=>_0x5acfb4(_0xf8c6f)[_0x5c6c43(0x30e)](_0x5ba5b9['concatMap'](async _0x28ce7b=>{const _0x2d5b68=_0x5c6c43,_0x285730=_0x28ce7b;if(_0x285730[_0x2d5b68(0x355)]===0x191&&window[_0x2d5b68(0x253)](this[_0x2d5b68(0x469)]['t'](_0x2d5b68(0x1c7)))){const _0x24ca95=window[_0x2d5b68(0x493)](window[_0x2d5b68(0x19b)][_0x2d5b68(0xfa)]);window[_0x2d5b68(0x19b)]['href']=this[_0x2d5b68(0x222)]()+_0x2d5b68(0x2df)+_0x24ca95;}return _0x285730;}))});}[_0x3ceef6(0x222)](){const _0x31b177=_0x3ceef6;var _0x2c32c2;return(_0x2c32c2=this[_0x31b177(0x421)][_0x31b177(0x10b)](_0x45de66))!=null?_0x2c32c2:_0x56de3f;}};_0x297e98=_0x136a5f([_0x4a3361(0x0,_0x24e1ed[_0x3ceef6(0x476)]),_0x4a3361(0x1,_0x24e1ed[_0x3ceef6(0x48f)](_0x2df7e0[_0x3ceef6(0x3ed)])),_0x4a3361(0x2,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x31c)]))],_0x297e98);var _0xe5d212=Object[_0x3ceef6(0x2d1)],_0x47fa15=Object[_0x3ceef6(0x3fa)],_0x1b23c7=(_0x33ee7b,_0x5cd049,_0x44cbef,_0x3b39ea)=>{const _0x5d9c9d=_0x3ceef6;for(var _0x11909d=_0x3b39ea>0x1?void 0x0:_0x3b39ea?_0x47fa15(_0x5cd049,_0x44cbef):_0x5cd049,_0x442f91=_0x33ee7b[_0x5d9c9d(0x346)]-0x1,_0x4e3303;_0x442f91>=0x0;_0x442f91--)(_0x4e3303=_0x33ee7b[_0x442f91])&&(_0x11909d=(_0x3b39ea?_0x4e3303(_0x5cd049,_0x44cbef,_0x11909d):_0x4e3303(_0x11909d))||_0x11909d);return _0x3b39ea&&_0x11909d&&_0xe5d212(_0x5cd049,_0x44cbef,_0x11909d),_0x11909d;},_0x25568b=(_0x543347,_0x3d06d1)=>(_0x1de8d0,_0x5ad968)=>_0x3d06d1(_0x1de8d0,_0x5ad968,_0x543347);const _0x203929=_0x3ceef6(0x1a2),_0x1395e6=_0x3ceef6(0x27e);_0x481c9f[_0x3ceef6(0x1c2)]=class extends _0x24e1ed['Disposable']{constructor(_0x126131,_0x1dc796){const _0x4cf321=_0x3ceef6;super(),this[_0x4cf321(0x326)]=_0x126131,this[_0x4cf321(0x421)]=_0x1dc796,this[_0x4cf321(0x22b)]();}['_initMergeInterceptor'](){const _0x281a38=_0x3ceef6,_0x5a69b7=this;this[_0x281a38(0x184)](this[_0x281a38(0x326)][_0x281a38(0x3cd)]({'priority':0x3e7,'interceptor':_0x2df7e0[_0x281a38(0x1d8)]({'isMatch'(_0x43a2d1){const _0x5be9b6=_0x281a38;var _0x48a6f9;if(_0x43a2d1[_0x5be9b6(0x261)]===_0x5be9b6(0x485)&&((_0x48a6f9=_0x43a2d1[_0x5be9b6(0x2fe)])!=null&&_0x48a6f9['body'])){const {objectID:_0x1cdf1f,objectType:_0x5c2b4c}=_0x43a2d1[_0x5be9b6(0x2fe)][_0x5be9b6(0x314)]||{};if(!_0x1cdf1f||_0x5c2b4c===void 0x0)return!0x1;const _0x3adce4=_0x5a69b7['_getAPIPrefixPath']()+'/'+_0x5c2b4c+'/object/'+_0x1cdf1f+'/allowed';if(_0x43a2d1[_0x5be9b6(0x1ab)]===_0x3adce4)return!0x0;}return!0x1;},'getParamsFromRequest'(_0x42139f){const _0x818d5c=_0x281a38;var _0x1d85fd;return(_0x1d85fd=_0x42139f['requestParams'])==null?void 0x0:_0x1d85fd[_0x818d5c(0x314)];},'mergeParamsToRequest'(_0x50abf9,_0x32aa5b){const _0x185822=_0x281a38,_0x5717a9=_0x5a69b7['_getAPIPrefixPath']()+'/-/object/-/batch_allowed',_0x2e17e8=_0x50abf9[_0x185822(0x171)]((_0x5b69f2,_0x128e84)=>{const {unitID:_0x3d0344,objectID:_0x1b4446,objectType:_0x2953f9,actions:_0x3f796e}=_0x128e84;return _0x5b69f2[_0x3d0344]||(_0x5b69f2[_0x3d0344]={}),_0x5b69f2[_0x3d0344][_0x1b4446]||(_0x5b69f2[_0x3d0344][_0x1b4446]={'objectID':_0x1b4446,'objectType':_0x2953f9,'actions':[]}),_0x5b69f2[_0x3d0344][_0x1b4446]['actions']['push'](..._0x3f796e),_0x5b69f2;},{}),_0x319581=[];for(const _0x1710d6 in _0x2e17e8)for(const _0x2bd597 in _0x2e17e8[_0x1710d6]){const {actions:_0x22b6a6,objectType:_0x45b639}=_0x2e17e8[_0x1710d6][_0x2bd597],_0x564f6c=[...new Set(_0x22b6a6)];_0x319581[_0x185822(0x279)]({'unitID':_0x1710d6,'objectID':_0x2bd597,'objectType':_0x45b639,'actions':_0x564f6c});}return new _0x2df7e0[(_0x185822(0xb3))](_0x185822(0x485),_0x5717a9,{'headers':_0x32aa5b[_0x185822(0x27a)],'withCredentials':_0x32aa5b[_0x185822(0x231)],'responseType':_0x32aa5b[_0x185822(0x494)],'body':{'requests':_0x319581}});}},{'distributeResult'(_0x4e08ad,_0x20af72){const _0x26f415=_0x281a38,{objectActions:_0x2d8e34}=_0x4e08ad;return _0x20af72[_0x26f415(0x315)](_0xccb6d2=>{const _0x1d86e3=_0x26f415,{unitID:_0x3f155f,objectID:_0x50cdea,actions:_0x25ba95}=_0xccb6d2,_0x3c26be=_0x2d8e34['find'](_0x5deef7=>_0x5deef7[_0x1d86e3(0x208)]===_0x3f155f&&_0x5deef7[_0x1d86e3(0x10d)]===_0x50cdea),_0x29ba89=_0x25ba95[_0x1d86e3(0x315)](_0x589103=>_0x3c26be==null?void 0x0:_0x3c26be['actions'][_0x1d86e3(0x336)](_0xd3333b=>_0xd3333b['action']===_0x589103))[_0x1d86e3(0xd0)](_0x4085eb=>!!_0x4085eb);return{'config':_0xccb6d2,'result':{'actions':_0x29ba89,'error':_0x4e08ad['error']}};});}})}));}[_0x3ceef6(0x1a4)](){const _0x465e30=_0x3ceef6;var _0x2f6aa2;return(_0x2f6aa2=this[_0x465e30(0x421)][_0x465e30(0x10b)](_0x203929))!=null?_0x2f6aa2:_0x1395e6;}async[_0x3ceef6(0x333)](_0x1d5a02){const _0x11a6cc=_0x3ceef6,_0x211df8=this[_0x11a6cc(0x1a4)]()+'/'+_0x1d5a02[_0x11a6cc(0x1af)]+_0x11a6cc(0x33c);return(await this[_0x11a6cc(0x326)][_0x11a6cc(0x290)](_0x211df8,{'body':_0x1d5a02}))[_0x11a6cc(0x314)][_0x11a6cc(0x10d)]||'';}async[_0x3ceef6(0x220)](_0x475f70){const _0x29f8a4=_0x3ceef6,_0x1095a1=this[_0x29f8a4(0x1a4)]()+_0x29f8a4(0x17b);return(await this[_0x29f8a4(0x326)]['post'](_0x1095a1,{'body':_0x475f70}))[_0x29f8a4(0x314)][_0x29f8a4(0x2f0)];}async[_0x3ceef6(0x1c1)](_0x49ecd7){const _0x25e10a=_0x3ceef6,_0x4eebe1=this[_0x25e10a(0x1a4)]()+'/'+_0x49ecd7[_0x25e10a(0x1af)]+_0x25e10a(0x1ed)+_0x49ecd7[_0x25e10a(0x10d)];await this[_0x25e10a(0x326)][_0x25e10a(0x28d)](_0x4eebe1,{'body':_0x49ecd7});}async[_0x3ceef6(0x12e)](_0x3861f9){const _0x26a050=_0x3ceef6,_0x437cc9=this[_0x26a050(0x1a4)]()+'/'+_0x3861f9[_0x26a050(0x1af)]+_0x26a050(0x1ed)+_0x3861f9[_0x26a050(0x10d)]+_0x26a050(0x240);return(await this[_0x26a050(0x326)][_0x26a050(0x290)](_0x437cc9,{'body':_0x3861f9}))[_0x26a050(0x314)][_0x26a050(0x1d0)];}async[_0x3ceef6(0xda)](_0x5ed239){const _0x1bc1ea=_0x3ceef6,_0xf16c32=this[_0x1bc1ea(0x1a4)]()+_0x1bc1ea(0x1b8);return(await this[_0x1bc1ea(0x326)][_0x1bc1ea(0x290)](_0xf16c32,{'body':{'requests':_0x5ed239}}))[_0x1bc1ea(0x314)][_0x1bc1ea(0x2e1)];}async['listRoles'](_0xa55ca0){const _0x2bd8da=_0x3ceef6,_0xe8ed7e=this[_0x2bd8da(0x1a4)]()+'/'+_0xa55ca0[_0x2bd8da(0x1af)]+_0x2bd8da(0x387),_0x428553=await this[_0x2bd8da(0x326)][_0x2bd8da(0x290)](_0xe8ed7e,{'body':_0xa55ca0});return{'roles':_0x428553[_0x2bd8da(0x314)][_0x2bd8da(0x257)],'actions':_0x428553['body']['actions']};}async[_0x3ceef6(0x331)](_0x47c7ca){const _0x39e1bd=_0x3ceef6,_0x56dd35=this[_0x39e1bd(0x1a4)]()+_0x39e1bd(0x473);await this[_0x39e1bd(0x326)][_0x39e1bd(0x15d)](_0x56dd35,{'params':{'collaboratorID':_0x47c7ca[_0x39e1bd(0x131)],'objectID':_0x47c7ca[_0x39e1bd(0x10d)],'unitID':_0x47c7ca[_0x39e1bd(0x208)]}});}async['updateCollaborator'](_0x3d552e){const _0x3a1fd8=_0x3ceef6,_0x5256f5=this[_0x3a1fd8(0x1a4)]()+_0x3a1fd8(0x473);await this[_0x3a1fd8(0x326)][_0x3a1fd8(0x2c7)](_0x5256f5,{'body':_0x3d552e});}async['createCollaborator'](_0x430a90){const _0x5b8193=_0x3ceef6,_0x26b985=this[_0x5b8193(0x1a4)]()+_0x5b8193(0x473);await this[_0x5b8193(0x326)][_0x5b8193(0x290)](_0x26b985,{'body':_0x430a90});}async[_0x3ceef6(0x2d8)](_0xe48ba1){const _0x181167=_0x3ceef6,_0x103ab4=this[_0x181167(0x1a4)]()+_0x181167(0x473);return(await this['_HTTPService'][_0x181167(0x414)](_0x103ab4,{'params':{'objectID':_0xe48ba1[_0x181167(0x10d)],'unitID':_0xe48ba1['unitID']}}))[_0x181167(0x314)][_0x181167(0x463)];}async['putCollaborators'](_0x4e9825){const _0x5b8d2d=_0x3ceef6,_0x43214e=this[_0x5b8d2d(0x1a4)]()+_0x5b8d2d(0x473);await this[_0x5b8d2d(0x326)]['put'](_0x43214e,{'body':_0x4e9825});}},_0x481c9f['AuthzIoHttpService']=_0x1b23c7([_0x25568b(0x0,_0x24e1ed[_0x3ceef6(0x48f)](_0x2df7e0['HTTPService'])),_0x25568b(0x1,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x476)]))],_0x481c9f[_0x3ceef6(0x1c2)]);var _0x484ca0=Object['defineProperty'],_0xc60f=Object['getOwnPropertyDescriptor'],_0x5160a4=(_0x5b3a73,_0x5cfb20,_0x582162,_0x500e45)=>{const _0x3e97a2=_0x3ceef6;for(var _0x531957=_0x500e45>0x1?void 0x0:_0x500e45?_0xc60f(_0x5cfb20,_0x582162):_0x5cfb20,_0x556646=_0x5b3a73[_0x3e97a2(0x346)]-0x1,_0x5416cc;_0x556646>=0x0;_0x556646--)(_0x5416cc=_0x5b3a73[_0x556646])&&(_0x531957=(_0x500e45?_0x5416cc(_0x5cfb20,_0x582162,_0x531957):_0x5416cc(_0x531957))||_0x531957);return _0x500e45&&_0x531957&&_0x484ca0(_0x5cfb20,_0x582162,_0x531957),_0x531957;},_0x28f6cf=(_0x46d1fc,_0x11f932)=>(_0x1650b2,_0x4bdad6)=>_0x11f932(_0x1650b2,_0x4bdad6,_0x46d1fc);const _0x635b41=[_0x3ceef6(0x281),_0x3ceef6(0x382),_0x3ceef6(0xcd),_0x3ceef6(0x319),'image/bmp'],_0x20e9df=0x5*0x400*0x400,_0x1b5890=_0x3ceef6(0x45d),_0x24c61b='/universer-api/stream/file/upload',_0x44f0c9=_0x3ceef6(0x3a4),_0x395b65=_0x3ceef6(0x1a0);_0x481c9f['ImageIoService']=class{constructor(_0xf84088,_0x361677){const _0x20b98e=_0x3ceef6;_0x1b84ec(this,_0x20b98e(0x29b),0x0),_0x1b84ec(this,'_change$',new _0x5ba5b9['Subject']()),_0x1b84ec(this,_0x20b98e(0x316),this[_0x20b98e(0x1ad)]),_0x1b84ec(this,_0x20b98e(0x347),new Map()),(this['_httpService']=_0xf84088,this[_0x20b98e(0x421)]=_0x361677);}['setWaitCount'](_0x44c967){const _0x5037be=_0x3ceef6;this[_0x5037be(0x29b)]=_0x44c967,this['_change$']['next'](_0x44c967);}[_0x3ceef6(0x400)](_0x90d3c3,_0x56c963){const _0x494f80=_0x3ceef6;if(_0x56c963===_0x35d26c['ImageSourceType'][_0x494f80(0x2ab)]){const _0x574b1a=new Image();return _0x574b1a[_0x494f80(0x1eb)]=_0x90d3c3,_0x574b1a;}return this[_0x494f80(0x347)]['get'](_0x90d3c3);}[_0x3ceef6(0x163)](_0x689486,_0x2d86e2,_0x276654){const _0x23da32=_0x3ceef6;_0x2d86e2===_0x35d26c[_0x23da32(0x38f)][_0x23da32(0x2ab)]||_0x276654==null||this[_0x23da32(0x347)][_0x23da32(0xe7)](_0x689486,_0x276654);}async[_0x3ceef6(0x1d9)](_0x348cc6){const _0x36f943=_0x3ceef6;try{const _0xc1a449=this['_replaceFileID'](this[_0x36f943(0xbd)](),''+_0x348cc6),_0x253198=(await this[_0x36f943(0x1fe)][_0x36f943(0x414)](_0xc1a449))[_0x36f943(0x314)];return _0x253198[_0x36f943(0x457)]&&_0x253198[_0x36f943(0x457)][_0x36f943(0x119)]===_0x2aa5e9['OK']?Promise[_0x36f943(0xe6)](_0x253198[_0x36f943(0x1ab)]):Promise['reject'](_0x253198[_0x36f943(0x457)]);}catch(_0x15a453){return Promise[_0x36f943(0xea)](_0x15a453);}}async[_0x3ceef6(0x392)](_0x56d091){const _0x3b62fb=_0x3ceef6;let _0x3f2563='';if(!_0x635b41[_0x3b62fb(0x39e)](_0x56d091[_0x3b62fb(0x223)]))return this['_decreaseWaiting'](),Promise[_0x3b62fb(0xea)](new Error(_0x35d26c[_0x3b62fb(0x33f)]['ERROR_IMAGE_TYPE']));if(_0x56d091[_0x3b62fb(0x1bb)]>_0x20e9df)return this['_decreaseWaiting'](),Promise['reject'](new Error(_0x35d26c[_0x3b62fb(0x33f)][_0x3b62fb(0x378)]));try{const _0x32723e=new FormData();_0x32723e[_0x3b62fb(0x292)]('file',_0x56d091);const _0x3dafb5=this[_0x3b62fb(0x432)]()+_0x3b62fb(0x3c4)+_0x56d091[_0x3b62fb(0x1bb)][_0x3b62fb(0xff)](),_0x3e5675=await(await fetch(_0x3dafb5,{'method':_0x3b62fb(0x485),'body':_0x32723e}))[_0x3b62fb(0x1e3)]();if(typeof _0x3e5675[_0x3b62fb(0x445)]!=_0x3b62fb(0x430))return this['_decreaseWaiting'](),Promise['reject'](new Error(_0x35d26c['ImageUploadStatusType'][_0x3b62fb(0x2ca)]));_0x3f2563=_0x3e5675[_0x3b62fb(0x445)];}catch{return this['_decreaseWaiting'](),Promise[_0x3b62fb(0xea)](new Error(_0x35d26c[_0x3b62fb(0x33f)][_0x3b62fb(0x2ca)]));}return new Promise((_0x16938d,_0x3c4955)=>{const _0x23e38a=_0x3b62fb,_0x1e2176=new FileReader();_0x1e2176[_0x23e38a(0x260)](_0x56d091),_0x1e2176[_0x23e38a(0x293)]=_0x4f4038=>{const _0x2891dd=_0x23e38a;var _0x5c60e5;const _0x2a716e=(_0x5c60e5=_0x4f4038[_0x2891dd(0x3ee)])==null?void 0x0:_0x5c60e5['result'];if(_0x2a716e==null){this[_0x2891dd(0x1ca)](),_0x3c4955(new Error(_0x35d26c[_0x2891dd(0x33f)][_0x2891dd(0x2ca)]));return;}const _0x182583=_0x24e1ed[_0x2891dd(0x11e)]['generateRandomId'](0x6);_0x16938d({'imageId':_0x182583,'imageSourceType':_0x35d26c[_0x2891dd(0x38f)]['UUID'],'source':_0x3f2563,'base64Cache':_0x2a716e,'status':_0x35d26c[_0x2891dd(0x33f)]['SUCCUSS']}),this['_decreaseWaiting']();};});}[_0x3ceef6(0x432)](){const _0x587f89=_0x3ceef6;var _0x20e47d;return(_0x20e47d=this[_0x587f89(0x421)][_0x587f89(0x10b)](_0x1b5890))!=null?_0x20e47d:_0x24c61b;}[_0x3ceef6(0xbd)](){const _0x59a1a8=_0x3ceef6;var _0x24563e;return(_0x24563e=this[_0x59a1a8(0x421)][_0x59a1a8(0x10b)](_0x44f0c9))!=null?_0x24563e:_0x395b65;}[_0x3ceef6(0x286)](_0x1a3c82,_0x1981ff){const _0x200bf8=_0x3ceef6;return _0x1a3c82[_0x200bf8(0x130)](_0x200bf8(0x48c),_0x1981ff);}['_decreaseWaiting'](){const _0x42fdaa=_0x3ceef6;this[_0x42fdaa(0x29b)]-=0x1,this['_change$'][_0x42fdaa(0x48b)](this[_0x42fdaa(0x29b)]);}},_0x481c9f[_0x3ceef6(0x196)]=_0x5160a4([_0x28f6cf(0x0,_0x24e1ed[_0x3ceef6(0x48f)](_0x2df7e0['HTTPService'])),_0x28f6cf(0x1,_0x24e1ed[_0x3ceef6(0x476)])],_0x481c9f['ImageIoService']);var _0x2d12fa=Object[_0x3ceef6(0x2d1)],_0x5a70f4=Object[_0x3ceef6(0x3fa)],_0x244961=(_0x57ec75,_0x4d2fe4,_0x3c1e0f,_0x5a15b1)=>{const _0xf8fbd8=_0x3ceef6;for(var _0x243a6f=_0x5a15b1>0x1?void 0x0:_0x5a15b1?_0x5a70f4(_0x4d2fe4,_0x3c1e0f):_0x4d2fe4,_0x5b216b=_0x57ec75[_0xf8fbd8(0x346)]-0x1,_0x4e5330;_0x5b216b>=0x0;_0x5b216b--)(_0x4e5330=_0x57ec75[_0x5b216b])&&(_0x243a6f=(_0x5a15b1?_0x4e5330(_0x4d2fe4,_0x3c1e0f,_0x243a6f):_0x4e5330(_0x243a6f))||_0x243a6f);return _0x5a15b1&&_0x243a6f&&_0x2d12fa(_0x4d2fe4,_0x3c1e0f,_0x243a6f),_0x243a6f;},_0x707e58=(_0x487f4f,_0x3f08a6)=>(_0x4e16ec,_0x9f4853)=>_0x3f08a6(_0x4e16ec,_0x9f4853,_0x487f4f);let _0x5ec7df=class extends _0x24e1ed['RxDisposable']{constructor(_0x581206,_0x56e006,_0x15938b,_0x38c86f,_0x2eb34f){const _0x1de650=_0x3ceef6;super(),this['_injector']=_0x581206,this[_0x1de650(0x198)]=_0x56e006,this['_permissionService']=_0x15938b,this['_collaborationSessionService']=_0x38c86f,this[_0x1de650(0x109)]=_0x2eb34f,this[_0x1de650(0x287)](),this[_0x1de650(0x3cc)]();}[_0x3ceef6(0x3cc)](){const _0x3820d6=_0x3ceef6,_0xa80ab9=async _0x11fe60=>{const _0x3c5243=_0x5b63;(await this['_collaborationSessionService'][_0x3c5243(0x1b9)](_0x11fe60))[_0x3c5243(0x247)][_0x3c5243(0x30e)](_0xb49021[_0x3c5243(0xd0)](_0x37c87c=>_0x37c87c[_0x3c5243(0x17c)]===_0x3c4c3c[_0x3c5243(0x3ce)]['SHOULD_CLOSE_CONN']),_0xb49021[_0x3c5243(0x2c3)](this[_0x3c5243(0x318)]))[_0x3c5243(0x1b0)](_0x4bde40=>{const _0x2bc827=_0x3c5243,_0x2efa93=_0x4bde40,{reason:_0x315b60}=_0x2efa93[_0x2bc827(0x2e4)];this[_0x2bc827(0x376)][_0x2bc827(0x414)](_0x279279[_0x2bc827(0x3a7)])[_0x2bc827(0x38a)]({'type':_0x49b15b[_0x2bc827(0x1b6)]['Error'],'content':this[_0x2bc827(0x109)]['t']('collaboration.closeRoom')+'('+_0x315b60+')'}),this[_0x2bc827(0x4a2)][_0x2bc827(0x323)](new _0x5e02d9[(_0x2bc827(0x232))](_0x11fe60)['id'],!0x1),this[_0x2bc827(0x492)][_0x2bc827(0x335)](_0x11fe60);});};_0x5ba5b9[_0x3820d6(0x36f)](this[_0x3820d6(0x198)][_0x3820d6(0x1e5)](_0x24e1ed[_0x3820d6(0x1dd)]['UNIVER_SHEET']),this['_univerInstanceService']['getTypeOfUnitAdded$'](_0x24e1ed[_0x3820d6(0x1dd)][_0x3820d6(0x192)]))['pipe'](_0xb49021[_0x3820d6(0x315)](_0xc74eb7=>_0xc74eb7[_0x3820d6(0x398)]()),_0xb49021[_0x3820d6(0xd0)](_0x2cadf2=>!_0x24e1ed[_0x3820d6(0x38d)](_0x2cadf2)),_0xb49021[_0x3820d6(0x2c3)](this[_0x3820d6(0x318)]))['subscribe'](_0x44c942=>{_0xa80ab9(_0x44c942);});}[_0x3ceef6(0x287)](){const _0x4be264=_0x3ceef6,_0x50c1a7=async _0x17d8e4=>{const _0x3b0748=_0x5b63;(await this[_0x3b0748(0x492)][_0x3b0748(0x1b9)](_0x17d8e4))['event$'][_0x3b0748(0x30e)](_0xb49021[_0x3b0748(0xd0)](_0x11277c=>_0x11277c[_0x3b0748(0x17c)]===_0x3c4c3c[_0x3b0748(0x3ce)][_0x3b0748(0x19a)]),_0xb49021[_0x3b0748(0x2c3)](this[_0x3b0748(0x318)]))[_0x3b0748(0x1b0)](_0x33720c=>{const _0xfb646c=_0x3b0748,_0x22c46e=_0x33720c,{objectId:_0x3dfb77}=_0x22c46e[_0xfb646c(0x2e4)];_0x3dfb77===_0x17d8e4&&this[_0xfb646c(0x376)][_0xfb646c(0x414)](_0x5a7986['SheetPermissionInitController'])[_0xfb646c(0xce)](_0x17d8e4);});};_0x5ba5b9['merge'](this['_univerInstanceService'][_0x4be264(0x1e5)](_0x24e1ed[_0x4be264(0x1dd)][_0x4be264(0x2b3)]),this[_0x4be264(0x198)][_0x4be264(0x1e5)](_0x24e1ed[_0x4be264(0x1dd)][_0x4be264(0x192)]))[_0x4be264(0x30e)](_0xb49021['map'](_0x157103=>_0x157103[_0x4be264(0x398)]()),_0xb49021[_0x4be264(0xd0)](_0x2eec16=>!_0x24e1ed[_0x4be264(0x38d)](_0x2eec16)),_0xb49021[_0x4be264(0x2c3)](this[_0x4be264(0x318)]))['subscribe'](_0x5e41f8=>{_0x50c1a7(_0x5e41f8);});}};_0x5ec7df=_0x244961([_0x24e1ed['OnLifecycle'](_0x24e1ed[_0x3ceef6(0xf7)][_0x3ceef6(0x1a3)],_0x5ec7df),_0x707e58(0x0,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x405)])),_0x707e58(0x1,_0x24e1ed[_0x3ceef6(0x36c)]),_0x707e58(0x2,_0x24e1ed['IPermissionService']),_0x707e58(0x3,_0x24e1ed[_0x3ceef6(0x48f)](_0x481c9f[_0x3ceef6(0x2e6)])),_0x707e58(0x4,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x31c)]))],_0x5ec7df);var _0x3ec4ea=Object[_0x3ceef6(0x2d1)],_0x4483a9=Object[_0x3ceef6(0x3fa)],_0x196064=(_0x3e3e05,_0x3b076d,_0x5cee59)=>_0x3b076d in _0x3e3e05?_0x3ec4ea(_0x3e3e05,_0x3b076d,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x5cee59}):_0x3e3e05[_0x3b076d]=_0x5cee59,_0x48112c=(_0x3ecb15,_0x3fe2dd,_0x314428,_0x8e7d9)=>{const _0x86d8c3=_0x3ceef6;for(var _0x2c0371=_0x8e7d9>0x1?void 0x0:_0x8e7d9?_0x4483a9(_0x3fe2dd,_0x314428):_0x3fe2dd,_0x4061c9=_0x3ecb15[_0x86d8c3(0x346)]-0x1,_0x3911ab;_0x4061c9>=0x0;_0x4061c9--)(_0x3911ab=_0x3ecb15[_0x4061c9])&&(_0x2c0371=(_0x8e7d9?_0x3911ab(_0x3fe2dd,_0x314428,_0x2c0371):_0x3911ab(_0x2c0371))||_0x2c0371);return _0x8e7d9&&_0x2c0371&&_0x3ec4ea(_0x3fe2dd,_0x314428,_0x2c0371),_0x2c0371;},_0x69a9cb=(_0x55860,_0x1fd2ae)=>(_0x39cab9,_0x293257)=>_0x1fd2ae(_0x39cab9,_0x293257,_0x55860),_0x3b2e39=(_0x5b3914,_0x3b32b6,_0x4d9816)=>_0x196064(_0x5b3914,_0x3b32b6+'',_0x4d9816);const _0x209a27=_0x3ceef6(0x155);_0x481c9f[_0x3ceef6(0x31e)]=class extends _0x24e1ed['Plugin']{constructor(_0x41703c,_0x3da872,_0x2e0faa,_0x568c03){const _0x49926c=_0x3ceef6;super(),this[_0x49926c(0x12f)]=_0x41703c,this[_0x49926c(0x256)]=_0x3da872,this[_0x49926c(0x475)]=_0x2e0faa,this[_0x49926c(0x376)]=_0x568c03;}[_0x3ceef6(0x270)](_0x2e6c38){const _0x1a41c7=_0x3ceef6;this[_0x1a41c7(0x45a)](_0x2e6c38);}[_0x3ceef6(0x41c)](){const _0x516ede=_0x3ceef6;this[_0x516ede(0x175)]();}[_0x3ceef6(0x45a)](_0x4daa1a){const _0x73a6e6=_0x3ceef6;var _0x400819,_0x144e5d,_0x458666,_0x5d85bf;_0x4daa1a[_0x73a6e6(0x245)](_0x24e1ed[_0x73a6e6(0x1f4)])&&this[_0x73a6e6(0x256)][_0x73a6e6(0x457)](_0x73a6e6(0x3f3),_0x73a6e6(0x1e6));let _0x137e08=[[_0x24e1ed['IUndoRedoService'],{'useClass':_0x26c297}],[_0x481c9f[_0x73a6e6(0x2e6)]],[_0x43bf67],[_0x2df7e0[_0x73a6e6(0x3ed)]],[_0xc2175,{'useClass':_0x3a3c68}],[_0x29dad0],[_0x481c9f[_0x73a6e6(0x271)]],[_0x2df7e0[_0x73a6e6(0x16a)]],[_0x1170ae],[_0x72a7c8],[_0x2884fa],[_0x5a4f60],[_0x297e98],[_0x34d671],[_0x5ec7df],[_0x21ae3a,{'useClass':(_0x144e5d=(_0x400819=this[_0x73a6e6(0x12f)])==null?void 0x0:_0x400819[_0x73a6e6(0x21b)])!=null?_0x144e5d:_0x481c9f[_0x73a6e6(0x35b)]}],[_0x2df7e0[_0x73a6e6(0x17d)],{'useClass':_0x2df7e0[_0x73a6e6(0x22a)]}],[_0x24e1ed['ISnapshotServerService'],{'useClass':_0x481c9f['SnapshotServerOverHTTPService']}],[_0x24e1ed[_0x73a6e6(0x14b)],{'useClass':_0x481c9f['AuthzIoHttpService']}],[_0x35d26c[_0x73a6e6(0x226)],{'useClass':_0x481c9f[_0x73a6e6(0x196)]}],[_0x481c9f[_0x73a6e6(0x3b2)]],[_0x481c9f[_0x73a6e6(0x273)]],[_0x481c9f[_0x73a6e6(0x33a)]],[_0x310dfd],[_0x1c89c8]];(_0x458666=this[_0x73a6e6(0x12f)])!=null&&_0x458666['enableSingleActiveInstanceLock']&&_0x137e08[_0x73a6e6(0x279)]([_0x45c59f,{'useClass':_0x1d3fc2}]),_0x137e08=_0x24e1ed[_0x73a6e6(0x40e)](_0x137e08,(_0x5d85bf=this[_0x73a6e6(0x12f)])==null?void 0x0:_0x5d85bf[_0x73a6e6(0x437)]),_0x137e08[_0x73a6e6(0x115)](_0x49c597=>_0x4daa1a[_0x73a6e6(0x46d)](_0x49c597)),this[_0x73a6e6(0x236)]();}[_0x3ceef6(0x175)](){const _0x46f8db=_0x3ceef6;this[_0x46f8db(0x184)](this['_renderManagerService']['registerRenderModule'](_0x24e1ed[_0x46f8db(0x1dd)][_0x46f8db(0x192)],[_0x2e8e87])),this['disposeWithMe'](this[_0x46f8db(0x475)]['registerRenderModule'](_0x24e1ed[_0x46f8db(0x1dd)]['UNIVER_SHEET'],[_0x2998bc]));}[_0x3ceef6(0x236)](){const _0x32b2cc=_0x3ceef6;var _0x3b2032,_0x13afdd;this[_0x32b2cc(0x376)][_0x32b2cc(0x414)](_0x2df7e0[_0x32b2cc(0x3ed)])[_0x32b2cc(0x3cd)]({'priority':0x14,'interceptor':_0x2df7e0[_0x32b2cc(0x41f)]({'maxParallel':0x6})}),(_0x3b2032=this[_0x32b2cc(0x12f)])!=null&&_0x3b2032[_0x32b2cc(0x418)]||this[_0x32b2cc(0x376)]['get'](_0x481c9f[_0x32b2cc(0x271)])['disableLocalCache'](),(_0x13afdd=this[_0x32b2cc(0x12f)])!=null&&_0x13afdd[_0x32b2cc(0x2c2)]&&this[_0x32b2cc(0x376)][_0x32b2cc(0x414)](_0x297e98);}},_0x3b2e39(_0x481c9f[_0x3ceef6(0x31e)],_0x3ceef6(0xcb),_0x209a27),_0x481c9f[_0x3ceef6(0x31e)]=_0x48112c([_0x24e1ed[_0x3ceef6(0xfb)](_0x3c4c3c['UniverCollaborationPlugin']),_0x69a9cb(0x1,_0x24e1ed['ILogService']),_0x69a9cb(0x2,_0x15516e['IRenderManagerService']),_0x69a9cb(0x3,_0x24e1ed[_0x3ceef6(0x48f)](_0x24e1ed[_0x3ceef6(0x405)]))],_0x481c9f[_0x3ceef6(0x31e)]),_0x481c9f['AUTHZ_URL_KEY']=_0x203929,_0x481c9f[_0x3ceef6(0xc4)]=_0x40ed60,_0x481c9f[_0x3ceef6(0x252)]=_0x4d2ef0,_0x481c9f[_0x3ceef6(0x2c6)]=_0x5a1c45,_0x481c9f[_0x3ceef6(0x217)]=_0x43c850,_0x481c9f[_0x3ceef6(0x3db)]=_0x34d671,_0x481c9f[_0x3ceef6(0x214)]=_0x48841c,_0x481c9f[_0x3ceef6(0x42e)]=_0x9d9eaa,_0x481c9f[_0x3ceef6(0x28a)]=_0x21ae3a,_0x481c9f['IURLService']=_0xc2175,_0x481c9f['LOCAL_CACHE_INTERVAL_KEY']=_0x4d3b79,_0x481c9f[_0x3ceef6(0x404)]=_0x45de66,_0x481c9f[_0x3ceef6(0x471)]=_0x274600,_0x481c9f['SNAPSHOT_SERVER_URL_KEY']=_0x6544dc,_0x481c9f[_0x3ceef6(0x415)]=_0x53b238,_0x481c9f['SessionStatus']=_0x4ad0db,_0x481c9f[_0x3ceef6(0x266)]=_0x9909c4,_0x481c9f[_0x3ceef6(0x1f6)]=_0x3a3c68,_0x481c9f[_0x3ceef6(0x1a1)]=_0x1ada2b,_0x481c9f[_0x3ceef6(0xf2)]=_0x3a7309,Object[_0x3ceef6(0x2d1)](_0x481c9f,Symbol[_0x3ceef6(0x41a)],{'value':_0x3ceef6(0x1a9)});}));function _0x1e11(){const _0x406a20=['_render','IDLE','_clearUndo','_unitID','clipPath','leaveEvent','_startSheetCollabCursor','FileId','urlChange$','isTransformMutationsWithChangesetSuccess','UserManagerService','textEncoder','snapshot','_undoRedoService','OnLineSingle','MSG_FOR_ERROR','roomMembers$','column','InsertRangeMoveRightCommandId','state$','drawWith','some','m1Prime','currentColor','key','error','_eventUnsubscribe','LICENSE_IMPORT_SIZE_EXCEEDED','_registerDependencies','USERS_LEAVE','assign','EXCHANGE_UPLOAD_FILE_SERVER_URL_KEY','UniverDesign','RefRangeService','assignAColorForMemberID','getColor','color','collaborators','tag','IContextService','[PendingState]:\x20received\x20rejection.','c1Prime','getMember','localeService','_toggleOffline','ranges','unit','add','[CollaborationSessionService]:\x20socket\x20error','_syncEditingCollabCursor','replaceTextRanges','SEND_CHANGESET_TIMEOUT_KEY','displayName','/collaborator','max','_renderManagerService','IConfigService','setUndoRedoMutationParamsCache','_onFetchMissResult','RegularPolygon','defIds','children','fetching\x20the\x20latest\x20document\x20from\x20the\x20server.','univerjs-icon\x20univerjs-icon-','DisposableCollection','lodash','history','[CollaborationSocketService]:\x20failed\x20to\x20create\x20socket!','_onRecvEvent','_docTransformIMECacheService','saveSnapshot','POST','toggleOnline','_userManagerService','APPLY_NON_SEQUENTIAL_REVISION','_getSaveTimeout','#FFF','next','{fileID}','onlyLocal','_collabCursorState$','Inject','height','getActiveSheet','_collaborationSessionService','encodeURIComponent','responseType','112ugHypW','_scheduleCollaborationTimeoutTimer','object','members','extend','path','fromEvent','m2Prime','574600ImNtqR','/universer-api/snapshot/','@univerjs/rpc','updateCursorEvent','getOwnPropertySymbols','_permissionService','rgba(255,\x20255,\x20255,\x200.01)','12nIRrrF','OffLineSingle','UniverCollaboration','/fetchmissing?from=','_transformPreviousActiveRange','HTTPRequest','onPointerEnter$','off-line-single','Unknown\x20type\x20in\x20URL.\x20Will\x20not\x20load\x20files\x20from\x20remote\x20address.','onTransformSelections','_entityInit$','onCommandExecuted','getSheetBySheetId','_heartbeatTimer','isActive','_getSignURL','params','appendMutation','USERS_ENTER','CollaborationSession','/unit/','clearTimeout','COLLAB_SUBMIT_CHANGESET_URL_KEY','getOffsetConfig','_colorAssignService','isArray','...','[PendingState]:\x20invalid\x20calling\x20to\x20`resend`.','originalMeta','pluginName','_anchor','image/jpg','initWorkbookPermissionChange','Optional','filter','_updateSubUnitFromURLParams','_selfUnitIDs','useDependency','_transformRemoteChangesetByIMECache','SEND_CHANGESET_TIMEOUT','CHANGESET_REVISION_CONFILICT','getActiveRange','_hover','LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED','batchAllowed','setInterval','substring','save','take','_status$','/block/','_collaborationTimeoutTimer','[FetchingMissState]:\x20not\x20expected\x20to\x20receive\x20ack\x20when\x20`this._awaitingChangeset`\x20is\x20null!','This\x20method\x20should\x20not\x20be\x20called\x20on\x20the\x20client\x20side!','_getScale','No\x20unitID\x20or\x20type\x20in\x20URL.\x20Will\x20not\x20load\x20files\x20from\x20remote\x20address.','resolve','set','getResourcesRequest','joinEvent','reject','AWAITING','permission.title','fromCollab','off-line-single_clip0_910_343','toggleOffline','fetchThroughInterceptors','onlineStatus','serializeCombRequest','[ClientCollaborationController]:\x20invalid\x20state\x20transition!\x20State\x20transferred\x20from\x20is\x20not\x20the\x20current\x20state.\x0aBefore:\x20','MoveRangeCommandId','syncEditingCollabCursor','className','LifecycleStages','interceptor','UNAUTHENTICATED','href','DependentOn','onMissedChangesetFetched','NEW_CHANGESETS','sheets','toString','[OfflineState]:\x20invalid\x20calling\x20to\x20`resend`.','_send','_disableEditing','_incrementRevisionNumber','[CollaborationEntity]:\x20cannot\x20apply\x20missing\x20results\x20on\x20other\x20states!','_clearLocalCache','collabStatus.offline','rev','COLORS','_localeService','_setupSubUnitSync','getConfig','defs','objectID','_clearHeartbeatTimer','_applyRemoteChangeset','liveShareOperation','_createInitialState','subunit','\x0aCurrent:\x20','entries','forEach','workbook','_awaitingChangeset','_members','code','runRefRangeMutations','onStateChange','_clearRedo','failed\x20to\x20apply\x20missed\x20changesets!','Tools','_rescheduleHeartbeatEvent','_queuedRemoteChangesets','_document','@univerjs/drawing','_roomMembers','isTransformMutationsWithChangesetFailure','_submitChangeset','_sendHeartbeatTimer','on-line-single_clip0_910_349','_textBubble','RemoveRowCommandId','arc','collaboration-client.offline-data-not-saved','Workbook','_sessions','allowed','_config','replace','collaboratorID','fetch_missing','ILocalStorageService','INVALID_ARGUMENT','_onJoinRoomEvent','_ws','attrs','_singleActiveUnitService','React','Unknown\x20user','_retryCount','_init','onCommentUpdate','getSheetBlock','updateMember','_localCacheService','_removeClearOtherTimer','translate(.97)','init','_online','fillStyle','univer-online-status','_uiPartsService','bold\x2013px\x20Source\x20Han\x20Sans\x20CN','awaiting_with_pending','operators','IAuthzIoService','createSocket','getUniverSheetInstance','endRow','currentTheme$','_handleEvent','getValue','getSheetId','catch','handleIRemoveCol','UNIVER_COLLABORATION_CLIENT_PLUGIN','encode','getSkeleton','getFocusedUnit','[CollaborationUndoRedoService]','split','hide','combineLatest','delete','DocStateChangeManagerService','makeDirty','_scheduleHeartbeat','IBeforeCloseService','conflict','addImageSourceCache','xlink:href','onRemoteRej','JOINING','unitId','fill','onRemoteChangeset','WebSocketService','handleIRemoveRow','HEARTBEAT_INTERVAL','_pendingMutations','roomInfos','IPermissionService','selections','reduce','amd','collabStatus.fetchMiss','_onMessage','_registerRenderDependencies','COMMENT_UPDATE','TextSelectionManagerService','top','values','[CollaborationEntity]:\x20cannot\x20lock\x20transition\x20twice!\x20This\x20is\x20an\x20implementation\x20error,\x20meaning\x20you\x20transit\x20the\x20collaboration\x20state\x20again\x20in\x20the\x20process\x20of\x20a\x20previous\x20transition.\x20This\x20should\x20never\x20happen.','/-/object/list','eventID','IHTTPImplementation','UniverSheets','status$','univer-online','_revisionService','resend','sheetID','disposeWithMe','Error','_showConflictNotification','exhaustSavingTask','collabCursorState$','debounce','div','handleDeleteRangeMoveLeft','_handleHeartbeatEvent','[SyncedState]:\x20received\x20rejection.','FAIL','toDisposable','_drawRange','socket\x20close','UNIVER_DOC','onTransformIME','getCoordByCell','_onRefRangeChange','ImageIoService','b64DecodeUnicode','_univerInstanceService','getCollabEntity','UPDATE_PERMISSION_OBJ','location','ws://127.0.0.1:8000/universer-api/comb/connect','_docSkeletonManagerService','_executeRemoteChangeset','roomMembers','/universer-api/file/{fileID}/sign-url','deserializeToCombResponse','AUTHZ_URL_KEY','Starting','_getAPIPrefixPath','fillText','@univerjs/design','LOCAL_CACHE_INTERVAL','_toggleOnline','Module','searchParams','url','getUndoRedoMutationParamsCache','_change$','_cursor','objectType','subscribe','stringify','Error\x20on\x20receiving\x20event','_unitStatus','Ready','_onCombEvent','MessageType','_clearCollaborationTimeoutTimer','/-/object/-/batch_allowed','requireSession','Shape','size','INGEST','FromArray','_joinRoom','loadOfflineData','[FetchingMissState]:\x20invalid\x20calling\x20to\x20`resend`.','update','AuthzIoHttpService','url(#on-line-single_clip0_910_349)','createInstance','_onRemoteRejected','_roomMembers$','auth.needGotoLoginAlert','LIVESHARE_TERMINATE','_cursorInfo$','_decreaseWaiting','collabStatus.synced','AWAITING_WITH_PENDING','lineTo','isPermissionRej','disposeUnit','actions','revision','NO_OTHER_CLIENTS_EDITING','uni.network.url-service','whenReady','CHANGESET_ACK','_initStatusListener','onRemoteAck','MergeInterceptorFactory','getImage','url(#$1','collabStatus.syncing','_removeCollabCursors','UniverInstanceType','_updateState','then','_memberService','connectInjector','permission.content','json','setShapeProps','getTypeOfUnitAdded$','you\x20should\x20override\x20\x22IUndoRedoService\x22\x20provided\x20in\x20\x22core\x22\x20package!','editingUnit','findNodePositionByCharIndex','2410OasyNf','_unitOnClients','src','sequenceExecute','/object/','focused$','_lastPointer','INTERNAL_ERROR','[CollaborationSessionService]','colorChannel1','debug','IUndoRedoService','conflict.content','WebURLService','_waitForHeartbeatResponse','getCollabCursors$','LIVESHARE_OPERATION','saveOfflineData','[PendingState]:\x20received\x20acknowledgement.','SetWorksheetActivateCommand','getTypeOfUnitDisposed$','_httpService','shouldCloseConn','editing\x20status\x20changed\x20to','slice','VIEW_MAIN','M0\x200H16V16H0z','CONFLICT','FETCH_MISSING','SetTextSelectionsOperation','1411927EPysgL','unitID','onSyncEditingCollabCursor','_hideTimer','generateRandomId','_name','_getAnchorBounding','registerOnClose','_getAPIPrefix','IUIPartsService','subscribeEvent','selection','_onCursorDelete','HEARTBEAT_INTERVAL_KEY','updatePermissionObjEvent','collab-text-range-','CollaborationStatusDisplay','connection\x20error','parseProtocolChangeset','@univerjs-pro/collaboration','socketService','getCurrentSelections','COLLAB_WEB_SOCKET_URL','_localStorageService','@univerjs/core','list','SetSelectionsOperation','_getLoginPath','type','getUnitOnRev','_clearOtherTimers','IImageIoService','measureText','jiqing500','_assignedColors','XHRHTTPImplementation','_initMergeInterceptor','complete','_scheduleClearOtherTimer','_lockTransition','closePath','_updateLocalCursor','withCredentials','WorkbookEditablePermission','univer-online-status-title','pauseCollaboration','getRangePointData','_initModules','_getCurrentRevision','transformSelections','UniverDocs','UniverSheetsUi','onlineStatusTitle','unshift','LocalUndoRedoService','_color','error$','/allowed','InsertSheetMutation','moveTo','_scheduleSaving','@univerjs/docs','has','_socketReady','event$','transform','indexOf','CommandType','c2Prime','_checkMissing','INotificationService','saveChangeset','DEFAULT_FILE_NAME','ILogService','deepClone','COLLAB_WEB_SOCKET_URL_KEY','confirm','replaceState','@univerjs/sheets-ui','_logService','roles','_range','224682plJfTX','SYNCED','getUnhiddenWorksheets','_socket$','_handleJoinEvent','OnLifecycle','_commentService','readAsDataURL','method','pushState','loadDoc','_createHandler','joinRsp','SheetCollabCursorShape','_tryEnsureSocket','getRoom','transformUndoRedo','result','[OfflineState]:\x20received\x20acknowledgement.','fetching\x20missing\x20changesets\x20from\x20','Disposable','propertyIsEnumerable','_handleHover','onStarting','LocalCacheService','getCurrentUser','DataLoaderController','_startCollaboration','clsx','unknown','_saveCache','@univerjs/engine-render','push','headers','message$','OFFLINE','parse','/universer-api/authz','_transformStack','close$','image/png','rxjs','1em','Cannot\x20assemble\x20a\x20changeset\x20from\x20multiple\x20mutations\x20of\x20different\x20types:\x20','_commandService','_replaceFileID','_initUnitPermissionChange','addObject','\x20-\x20','ICollaborationSocketService','EmptyMutation','_transformIMECache','put','ICommandService','SheetsSelectionsService','post','unsubscribe','append','onload','concat','CompressMutationService','gold400','[CollaborationState]:\x20apply\x20error!','_transformUndoRedoStack','Steady','serializeRangeWithSheet','_waitCount','isTransformMutationFailure','transformMutation','_scene','CHANGESET_REJ','@univerjs/network','red300','transformStack\x20failed!','[CollaborationSession]:\x20should\x20not\x20send\x20message\x20when\x20the\x20session\x20is\x20offline!','UNIVER_UNKNOWN','_transitionLocked','_onConnectionOpen','rxjs/operators','OTHER_CLIENTS_EDITING','_cursors','createElement','BASE64','_syncEditingCollabCursorService','univer-online-status-icon','memberID','_substituteUndoStack','react','_initStatusComponent','UniverNetwork','UNIVER_SHEET','online','_removeRoom','HELLO','userID','call','getInterceptPoints','restore','from','getParam','_transformSelections','\x20to\x20','_snapshotServerService','@univerjs/sheets','_updateLocalCache','enableAuthServer','takeUntil','@univerjs/engine-formula','collab-text-anchor-','CollaborationStatus','patch','_collaborationPaused','removeParam','ERROR_IMAGE','getCurrentRevForDocument','\x20in\x20_schedule.','ITransformService','asObservable','commentUpdateEvent','PERMISSION_REJ','defineProperty','_disabled','setTimeout','APPLY_REVISION_CONFILICT','mapTo','function','current','listCollaborators','serializeTextRange','getItem','_socketMessageSubscription','_refRangeService','clearInterval','TOO_MANY_REQUESTS','?url=','_onConflict','objectActions','newCsEvent','UniverIcon','data','handleDeleteRangeMoveUp','CollaborationSessionService','fetchMissingChangesets','commentUpdate$','/universer-api/snapshot','cursorInfo','row','_urlService','icon','backgroundColor','executeCommand','objects','/resources','InsertColCommandId','COMPRESS_MUTATION_SEND','handleInsertRangeMoveDown','_getSheetObject','_messageService','InsertRangeMoveDownCommandId','_transformUndoredo','getSheetObject','_retryConnectingTimer','purple300','handleInsertRow','collabStatus.conflict','requestParams','APPLY_PERMISSION_DENIED','blue400','_id','_backgroundColor','collaboration.single-unit.warning','RemoveColCommandId','_exhaustRemoteChangesetQueue','Rect','[CollaborationSession]','getVpScrollXYInfoByPosToVp','_onConnectionFailed','UniverEngineFormula','_loadDoc','text','_loadSheet','pipe','1397268BgNZed','cmd','transformRemoteChangeset','_updateCollabCursors','SnapshotServerOverHTTPService','body','map','change$','SheetSkeletonManagerService','dispose$','image/gif','awaiting','isTransformChangesetsSuccess','LocaleService','YUUMI_URL_COL_OUT_OF_RANGE','UniverCollaborationClientPlugin','_entities','exports','_snapshotService','_getSendChangesetTimeout','updatePermissionPoint','LICENSE_EXPORT_SIZE_EXCEEDED','_ensureSubject','_HTTPService','ThemeService','_notificationService','name','ONLINE','changesets','_updateURLWithCurrentState','_createSocket','symbol','_state','_onRemoteChangeset','deleteCollaborator','registerComponent','create','getUnitStatus$','closeSession','find','univer-pro.collaboration-client.single-active-unit-service','font','NOT_COLLAB','DesktopCollaborationStatusDisplayController','LICENSE_DISTRO_REJECTED','/object','InsertRowCommandId','getCellPositionByOffset','ImageUploadStatusType','_scheduleReconnection','DeleteRangeMoveUpCommandId','/rev/','UniverDrawing','SNAPSHOT_HAS_BEEN_REMOVED','csAckEvent','length','_imageSourceCache','popstate','_collabSessionService','mutations','collabStatus.notCollab','M3.61971\x2011.6499C2.40304\x2011.6499\x200.699707\x2011.1024\x200.699707\x208.9124C0.699707\x206.3574\x203.25471\x205.8099\x203.98471\x205.8099C4.34971\x204.5324\x205.07971\x202.5249\x207.99971\x202.5249C10.5547\x202.5249\x2011.6497\x203.9849\x2012.0147\x205.2624C12.0147\x205.2624\x2015.2997\x205.6274\x2015.2997\x208.7299C15.2997\x2010.9199\x2013.8397\x2011.6499\x2012.3797\x2011.6499M9.82471\x209.82466L6.17471\x2013.4747M6.17471\x209.82466L9.82471\x2013.4747','setAlpha','_fetchMissChangesets','Subject','_anchorDot','_event$','offline','transformChangesets','LIVESHARE_REQUEST_HOST','status','removeMember','_drawAnchor','_sessionStatus$','all','_getMergeRange','CollaborationSocketService','IRenderManagerService','ACTIVE_UNIT_EVENT_CHANNEL','bottom','startColumn','switchMap','1244860MQpRlY','UPDATE_CURSOR','getAncestorScale','@univerjs/ui','reverse','VIEWPORT_KEY','CONNECTOR_DATA_TOO_LARGE','debounceTime','width','unload','handleInsertCol','IUniverInstanceService','_setupBeforeClosingHandler','saveSheetBlock','merge','_scheduleTimestamp','getCurrentUnitForType','_http','_replayCachedMutations','cursorInfo$','UniverEngineRender','_injector','dispose','ERROR_EXCEED_SIZE','RxDisposable','updateOfflineData','black','shareReplay','onSendChangeset','random','[DataLoaderController]','FETCH_MISS','createIdentifier','image/jpeg','univer-offline','RETRY_CONNECTING_INTERVAL','_session','min','/role','[SyncedState]:\x20invalid\x20calling\x20to\x20`resend`.','awaitingChangeset','show','_sheetTransformSelectionsService','transformMutationsWithChangeset','isInternalEditorID','MUTATION','ImageSourceType','onMissingChangesets','_createInitialStateImpl','saveImage','_handler','pending','UNDEFINED','_context','_hovered','getUnitId','/universer-api/comb','_state$','_schedule','UNIVER_SLIDE','HEARTBEAT','includes','deserializeRangeWithSheet','_clearScheduledTask','setCurrentUser','hovered','onTransformRemoteChangesetByIMECache','EXCHANGE_SIGN_URL_SERVER_URL_KEY','clear','UNRECOGNIZED','IMessageService','#fff','APPLY_REJECT','disableLocalCache','_sendHeartbeat','_socket','[SyncedState]:\x20received\x20acknowledgement.','baseRev','isEditing','transformIMECache','distinctUntilChanged','CollaborationController','_getRedoStack','TEXT_RANGE_LAYER_INDEX','RETRY_CONNECTING_MAX_COUNT','flatMap','apply','_onUserLeave','_saveTaskMap','getRelativeToViewportCoord','forwardRef','close','none','_collaborationController','skeleton','on-line-single','_getSnapshotAPIPrefix','idSuffix','hasOwnProperty','?size=','_updateStatus','_colorIndex','_cachedData','SHOULD_CLOSE_CONN','Warning','_compressMutationService','subUnitId','_initCloseConn','registerHTTPInterceptor','CollaborationEvent','_sendingTimer','UniverCore','_acknowledgedAwaitingChangeset','UNKNOWN_CODE','PERMISSION_DENIED','getMergeData','use','_timeoutTimer','ALREADY_EXISTS','UNKNOWN_CMD','COMPRESS_MUTATION_APPLY','_draw','CommentService','[PendingState]:\x20unhandled\x20univer\x20type:\x20','RevisionService','delay','_type','every','_startDocCollabCursor','_onCursorUpdate','_beforeCloseService','[CollaborationEntity]','unit-cache-','_substituteRedoStack','PENDING','routeKey','getMemberID','collaMsg','not_collab','LIVESHARE_FETCH_OPERATIONS','HTTPService','target','_clearTimeoutTimer','_remoteChangesetQueue','COMPLETION_FINISHED','beginPath','[UniverCollaborationClientPlugin]','[OfflineState]:\x20received\x20changeset.','_onLocalMutation','getTime','setItem','RichTextEditingMutation','_isPermissionRej','getOwnPropertyDescriptor','_labelPosition','newValue','YUUMI_UNABLE_LOAD_URL','_docSyncEditingCollabCursorService','doc.mutation.rich-text-editing','getImageSourceCache','362260CIgkoQ','_unlockTransition','_commentUpdate$','LOGIN_URL_KEY','Injector','_handleLeaveEvent','/new_changes','getCollabEntity$','compose','sessionStatus$','_docTransformSelectionsService','LIVESHARE_NEW_HOST','_socketService','mergeOverrideWithDependencies','evenodd','textRanges','HEARTBEAT_TIMEOUT','lodash/debounce','_sheetSkeletonManagerService','get','SNAPSHOT_URL_KEY','SNAPSHOT_INVALID_SNAPSHOT','LEAVE','enableOfflineEditing','UniverUi','toStringTag','session','onRendered','103959uAUnVK','SheetCollaborationEntity','ThresholdInterceptorFactory','onPointerMove$','_configService','onPointerLeave$','infoRsp','Rectangle','transformByState','SUBMIT_CHANGESET','onMouseMove','_transformService','handleMoveRange','getUnitType','fillRule','send','trim','HEARTBEAT_TIMEOUT_KEY','_collabCursorController','string','conflict.title','_getUploadFileURL','JOIN','round','JSONX','getWorkbookSelections','override','registerBeforeClose','submit\x20changeset\x20error!','EffectRefRangId','IMEInputManagerService','BehaviorSubject','RECV'];_0x1e11=function(){return _0x406a20;};return _0x1e11();}